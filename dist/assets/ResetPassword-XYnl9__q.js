import{j as s}from"./query-vendor-C7aRRP05.js";import{r,u as P}from"./react-vendor-mnpoGfEl.js";import{f as u,I as w,B as i,az as x,aw as h,s as f,J as n}from"./index-CV3rVyoS.js";import{L as g}from"./lock-Cb1_IJxT.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./date-vendor-Dhms5dOu.js";const F=()=>{const[p,m]=r.useState(!1),[t,j]=r.useState(""),[d,y]=r.useState(""),[o,N]=r.useState(!1),[l,v]=r.useState(!1),c=P();r.useEffect(()=>{(async()=>{const{data:e}=await f.auth.getSession();e.session||(n.error("Invalid or expired reset link"),c("/login"))})()},[c]);const b=async a=>{if(a.preventDefault(),t!==d){n.error("Passwords do not match");return}try{m(!0);const{error:e}=await f.auth.updateUser({password:t});if(e)throw e;n.success("Password updated successfully"),c("/login")}catch(e){console.error("Error updating password:",e),n.error(e instanceof Error?e.message:"Failed to update password")}finally{m(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{children:[s.jsx("img",{src:"/lovable-uploads/a065be26-80b7-4e50-b683-b6afb0add925.png",alt:"Mobirides Logo",className:"mx-auto h-48 w-48"}),s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Reset your password"}),s.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Enter a new password for your account"})]}),s.jsxs("form",{onSubmit:b,className:"mt-8 space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(u,{htmlFor:"password",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(g,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s.jsx(w,{id:"password",type:o?"text":"password",placeholder:"Enter new password",value:t,onChange:a=>j(a.target.value),className:"pl-10 pr-10",required:!0}),s.jsxs(i,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 text-muted-foreground hover:text-foreground",onClick:()=>N(!o),children:[o?s.jsx(x,{className:"h-4 w-4"}):s.jsx(h,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:o?"Hide password":"Show password"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(u,{htmlFor:"confirmPassword",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(g,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s.jsx(w,{id:"confirmPassword",type:l?"text":"password",placeholder:"Confirm new password",value:d,onChange:a=>y(a.target.value),className:"pl-10 pr-10",required:!0}),s.jsxs(i,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 text-muted-foreground hover:text-foreground",onClick:()=>v(!l),children:[l?s.jsx(x,{className:"h-4 w-4"}):s.jsx(h,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:l?"Hide password":"Show password"})]})]})]})]}),s.jsx(i,{type:"submit",className:"w-full",disabled:p||!t||!d,children:p?"Updating...":"Reset Password"})]})]})})};export{F as default};
