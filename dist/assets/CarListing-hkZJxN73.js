import{j as s}from"./query-vendor-Bsfdn-Hb.js";import{r,h as L}from"./react-vendor-mnpoGfEl.js";import{B as _,s as M,J as P}from"./index-CEKMvnhM.js";import{C as B}from"./CarGrid-COO1MlRU.js";import{S as T}from"./SearchFilters-BAlQluFb.js";import{S as o}from"./skeleton-CHo5tvc9.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./date-vendor-Dhms5dOu.js";import"./card-DVWWM3IP.js";import"./savedCarService-CB31jJUv.js";import"./separator-CNMPkK_g.js";import"./popover-CCHOPsgy.js";import"./chevron-left-DfLvTpd6.js";import"./select-BAtoiU29.js";import"./index-DXD4kVr2.js";import"./LocationSearchInput-CZ6FE_Yq.js";import"./map-pin-DSx0xkt_.js";import"./star-CEtrV90q.js";import"./clock-BYxaZ7Am.js";import"./calendar-BxEe8nw1.js";import"./arrow-up-down-DH39S7db.js";const m=12,rs=()=>{const[c,d]=r.useState([]),[l,p]=r.useState(!0),[i,h]=r.useState(1),[b,y]=r.useState(0),[g,k]=L(),[a,x]=r.useState({startDate:void 0,endDate:void 0,vehicleType:void 0,location:"",sortBy:"price",sortOrder:"asc"}),[u,N]=r.useState(!0);r.useEffect(()=>{const t=g.get("location")||"";x(e=>({...e,location:t}))},[g]),r.useEffect(()=>{(async()=>{p(!0);try{let e=M.from("cars").select("*",{count:"exact"}).range((i-1)*m,i*m-1);a.location&&(e=e.ilike("location",`%${a.location}%`)),a.vehicleType&&(e=e.eq("vehicle_type",a.vehicleType));const w=a.sortBy==="price"?"rental_price":"created_at";e=e.order(w,{ascending:a.sortOrder==="asc"});const{data:n,error:j,count:E}=await e;if(j)throw j;d(F=>i===1?n:[...F,...n]),y(E||0),N(n.length===m)}catch(e){console.error("Error fetching cars:",e),P.error("Failed to fetch cars.")}finally{p(!1)}})()},[a,i]);const v=t=>{d([]),h(1),x(t)},C=()=>{h(t=>t+1)},S=l&&c.length===0,f=l&&c.length>0;return s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx("h1",{className:"text-3xl font-semibold mb-4",children:"Car Listings"}),s.jsx(T,{onFiltersChange:v}),S?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(8)].map((t,e)=>s.jsxs("div",{className:"space-y-3",children:[s.jsx(o,{className:"h-[150px] w-full rounded-md"}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(o,{className:"h-4 w-3/4"}),s.jsx(o,{className:"h-4 w-1/2"})]})]},e))}):s.jsxs(s.Fragment,{children:[s.jsx(B,{cars:c,hasMoreItems:u}),f&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(4)].map((t,e)=>s.jsxs("div",{className:"space-y-3",children:[s.jsx(o,{className:"h-[150px] w-full rounded-md"}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(o,{className:"h-4 w-3/4"}),s.jsx(o,{className:"h-4 w-1/2"})]})]},e))}),u&&!f&&s.jsx(_,{onClick:C,className:"w-full mt-4",children:"Load More"}),c.length===0&&!l&&s.jsx("div",{className:"text-center mt-4",children:"No cars found."})]})]})};export{rs as default};
