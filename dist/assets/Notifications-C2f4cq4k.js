import{j as e,a as zt}from"./query-vendor-BOSMW7hd.js";import{r as h,u as _t}from"./react-vendor-DmU5vXC9.js";import{N as It}from"./Navigation-fdodg-AN.js";import{c as Pe,B as w,s as Q,J as D,a2 as He,a3 as Be,a4 as X,a7 as Tt,I as Mt,n as M,t as Ke,T as ye,y as Ne,a8 as je,D as Dt,b as Pt,d as Ot,e as At,m as Rt}from"./index-ByqmTec-.js";import{S as Ce}from"./separator-D3RZtFXH.js";import{S as Ve}from"./skeleton-CLXLgSMQ.js";import{S as ze}from"./switch-BC4DIA0f.js";import{S as Et}from"./slider-BxgBER1A.js";import{C as be}from"./checkbox-D4Yx9lnD.js";import{A as Lt,a as Ut,b as Ft,c as qt,d as $t}from"./alert-dialog-COW9ybb7.js";import{C as Wt}from"./calendar-Cn2gPQb0.js";import{N as F,c as Ht}from"./NotificationClassifier-DRBvVVRC.js";import{B as Bt}from"./bell-sR4KUoYm.js";import{C as Kt}from"./circle-check-big-BdHHmxBu.js";import{S as Vt}from"./settings-DxJzbhZI.js";import{U as Qt}from"./user-CrwdbYLY.js";import{C as Gt}from"./car-DcHPLaSp.js";import{M as Qe}from"./mail-B2le86zI.js";import{C as Ge}from"./chevron-down-CR2ALfoj.js";import{C as _e}from"./clock-Dg92kA5o.js";import"./map-pin-B-9tSSOy.js";import"./supabase-vendor-B3A6ooRR.js";import"./mapbox-vendor-ueN8uhVJ.js";import"./date-vendor-Dhms5dOu.js";import"./index-CEVvJeOa.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=Pe("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=Pe("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=Pe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);function Me(){return Me=Object.assign?Object.assign.bind():function(o){for(var a=1;a<arguments.length;a++){var c=arguments[a];for(var p in c)({}).hasOwnProperty.call(c,p)&&(o[p]=c[p])}return o},Me.apply(null,arguments)}function De(o,a){return De=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,p){return c.__proto__=p,c},De(o,a)}function Xt(o,a){o.prototype=Object.create(a.prototype),o.prototype.constructor=o,De(o,a)}function Je(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}const Zt=[{label:"1 hour",value:1*60*60*1e3},{label:"1 day",value:24*60*60*1e3},{label:"1 week",value:7*24*60*60*1e3}],es=({open:o,onClose:a,onSnooze:c,notification:p})=>{const[f,A]=h.useState(null),[_,C]=h.useState(""),[z,I]=h.useState(""),R=y=>{A(y),C(""),I("")},E=y=>{C(y.target.value),A(null),I("")},T=()=>{let y=null;if(f)y=new Date(Date.now()+f);else if(_){const S=new Date(_);if(isNaN(S.getTime())||S<=new Date){I("Please select a valid future date/time.");return}y=S}else{I("Please select a snooze duration.");return}c(y),a()};return e.jsx(Lt,{open:o,onOpenChange:a,children:e.jsxs(Ut,{className:"max-w-md",children:[e.jsx(Ft,{children:e.jsx(qt,{children:"Snooze Notification"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2",children:Zt.map(y=>e.jsx(w,{variant:f===y.value?"default":"outline",onClick:()=>R(y.value),className:"flex-1",children:y.label},y.label))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wt,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"datetime-local",value:_,onChange:E,className:"border rounded px-2 py-1 w-full",min:new Date(Date.now()+60*1e3).toISOString().slice(0,16)})]}),z&&e.jsx("div",{className:"text-red-500 text-sm",children:z})]}),e.jsxs($t,{children:[e.jsx(w,{variant:"outline",onClick:a,children:"Cancel"}),e.jsx(w,{onClick:T,children:"Snooze"})]})]})})};var Ye=Number.isNaN||function(a){return typeof a=="number"&&a!==a};function ts(o,a){return!!(o===a||Ye(o)&&Ye(a))}function ss(o,a){if(o.length!==a.length)return!1;for(var c=0;c<o.length;c++)if(!ts(o[c],a[c]))return!1;return!0}function Ie(o,a){a===void 0&&(a=ss);var c,p=[],f,A=!1;function _(){for(var C=[],z=0;z<arguments.length;z++)C[z]=arguments[z];return A&&c===this&&a(C,p)||(f=o.apply(this,C),A=!0,c=this,p=C),f}return _}var rs=typeof performance=="object"&&typeof performance.now=="function",Xe=rs?function(){return performance.now()}:function(){return Date.now()};function Ze(o){cancelAnimationFrame(o.id)}function is(o,a){var c=Xe();function p(){Xe()-c>=a?o.call(null):f.id=requestAnimationFrame(p)}var f={id:requestAnimationFrame(p)};return f}var Te=-1;function et(o){if(o===void 0&&(o=!1),Te===-1||o){var a=document.createElement("div"),c=a.style;c.width="50px",c.height="50px",c.overflow="scroll",document.body.appendChild(a),Te=a.offsetWidth-a.clientWidth,document.body.removeChild(a)}return Te}var se=null;function tt(o){if(o===void 0&&(o=!1),se===null||o){var a=document.createElement("div"),c=a.style;c.width="50px",c.height="50px",c.overflow="scroll",c.direction="rtl";var p=document.createElement("div"),f=p.style;return f.width="100px",f.height="100px",a.appendChild(p),document.body.appendChild(a),a.scrollLeft>0?se="positive-descending":(a.scrollLeft=1,a.scrollLeft===0?se="negative":se="positive-ascending"),document.body.removeChild(a),se}return se}var as=150,ns=function(a,c){return a};function os(o){var a,c=o.getItemOffset,p=o.getEstimatedTotalSize,f=o.getItemSize,A=o.getOffsetForIndexAndAlignment,_=o.getStartIndexForOffset,C=o.getStopIndexForStartIndex,z=o.initInstanceProps,I=o.shouldResetStyleCacheOnItemSizeChange,R=o.validateProps;return a=function(E){Xt(T,E);function T(S){var i;return i=E.call(this,S)||this,i._instanceProps=z(i.props,Je(i)),i._outerRef=void 0,i._resetIsScrollingTimeoutId=null,i.state={instance:Je(i),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof i.props.initialScrollOffset=="number"?i.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},i._callOnItemsRendered=void 0,i._callOnItemsRendered=Ie(function(l,d,u,g){return i.props.onItemsRendered({overscanStartIndex:l,overscanStopIndex:d,visibleStartIndex:u,visibleStopIndex:g})}),i._callOnScroll=void 0,i._callOnScroll=Ie(function(l,d,u){return i.props.onScroll({scrollDirection:l,scrollOffset:d,scrollUpdateWasRequested:u})}),i._getItemStyle=void 0,i._getItemStyle=function(l){var d=i.props,u=d.direction,g=d.itemSize,b=d.layout,x=i._getItemStyleCache(I&&g,I&&b,I&&u),j;if(x.hasOwnProperty(l))j=x[l];else{var m=c(i.props,l,i._instanceProps),P=f(i.props,l,i._instanceProps),q=u==="horizontal"||b==="horizontal",$=u==="rtl",Z=q?m:0;x[l]=j={position:"absolute",left:$?void 0:Z,right:$?Z:void 0,top:q?0:m,height:q?"100%":P,width:q?P:"100%"}}return j},i._getItemStyleCache=void 0,i._getItemStyleCache=Ie(function(l,d,u){return{}}),i._onScrollHorizontal=function(l){var d=l.currentTarget,u=d.clientWidth,g=d.scrollLeft,b=d.scrollWidth;i.setState(function(x){if(x.scrollOffset===g)return null;var j=i.props.direction,m=g;if(j==="rtl")switch(tt()){case"negative":m=-g;break;case"positive-descending":m=b-u-g;break}return m=Math.max(0,Math.min(m,b-u)),{isScrolling:!0,scrollDirection:x.scrollOffset<m?"forward":"backward",scrollOffset:m,scrollUpdateWasRequested:!1}},i._resetIsScrollingDebounced)},i._onScrollVertical=function(l){var d=l.currentTarget,u=d.clientHeight,g=d.scrollHeight,b=d.scrollTop;i.setState(function(x){if(x.scrollOffset===b)return null;var j=Math.max(0,Math.min(b,g-u));return{isScrolling:!0,scrollDirection:x.scrollOffset<j?"forward":"backward",scrollOffset:j,scrollUpdateWasRequested:!1}},i._resetIsScrollingDebounced)},i._outerRefSetter=function(l){var d=i.props.outerRef;i._outerRef=l,typeof d=="function"?d(l):d!=null&&typeof d=="object"&&d.hasOwnProperty("current")&&(d.current=l)},i._resetIsScrollingDebounced=function(){i._resetIsScrollingTimeoutId!==null&&Ze(i._resetIsScrollingTimeoutId),i._resetIsScrollingTimeoutId=is(i._resetIsScrolling,as)},i._resetIsScrolling=function(){i._resetIsScrollingTimeoutId=null,i.setState({isScrolling:!1},function(){i._getItemStyleCache(-1,null)})},i}T.getDerivedStateFromProps=function(i,l){return ls(i,l),R(i),null};var y=T.prototype;return y.scrollTo=function(i){i=Math.max(0,i),this.setState(function(l){return l.scrollOffset===i?null:{scrollDirection:l.scrollOffset<i?"forward":"backward",scrollOffset:i,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},y.scrollToItem=function(i,l){l===void 0&&(l="auto");var d=this.props,u=d.itemCount,g=d.layout,b=this.state.scrollOffset;i=Math.max(0,Math.min(i,u-1));var x=0;if(this._outerRef){var j=this._outerRef;g==="vertical"?x=j.scrollWidth>j.clientWidth?et():0:x=j.scrollHeight>j.clientHeight?et():0}this.scrollTo(A(this.props,i,l,b,this._instanceProps,x))},y.componentDidMount=function(){var i=this.props,l=i.direction,d=i.initialScrollOffset,u=i.layout;if(typeof d=="number"&&this._outerRef!=null){var g=this._outerRef;l==="horizontal"||u==="horizontal"?g.scrollLeft=d:g.scrollTop=d}this._callPropsCallbacks()},y.componentDidUpdate=function(){var i=this.props,l=i.direction,d=i.layout,u=this.state,g=u.scrollOffset,b=u.scrollUpdateWasRequested;if(b&&this._outerRef!=null){var x=this._outerRef;if(l==="horizontal"||d==="horizontal")if(l==="rtl")switch(tt()){case"negative":x.scrollLeft=-g;break;case"positive-ascending":x.scrollLeft=g;break;default:var j=x.clientWidth,m=x.scrollWidth;x.scrollLeft=m-j-g;break}else x.scrollLeft=g;else x.scrollTop=g}this._callPropsCallbacks()},y.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&Ze(this._resetIsScrollingTimeoutId)},y.render=function(){var i=this.props,l=i.children,d=i.className,u=i.direction,g=i.height,b=i.innerRef,x=i.innerElementType,j=i.innerTagName,m=i.itemCount,P=i.itemData,q=i.itemKey,$=q===void 0?ns:q,Z=i.layout,ce=i.outerElementType,ee=i.outerTagName,re=i.style,de=i.useIsScrolling,ie=i.width,ae=this.state.isScrolling,G=u==="horizontal"||Z==="horizontal",me=G?this._onScrollHorizontal:this._onScrollVertical,v=this._getRangeToRender(),k=v[0],J=v[1],te=[];if(m>0)for(var W=k;W<=J;W++)te.push(h.createElement(l,{data:P,key:$(W,P),index:W,isScrolling:de?ae:void 0,style:this._getItemStyle(W)}));var Y=p(this.props,this._instanceProps);return h.createElement(ce||ee||"div",{className:d,onScroll:me,ref:this._outerRefSetter,style:Me({position:"relative",height:g,width:ie,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:u},re)},h.createElement(x||j||"div",{children:te,ref:b,style:{height:G?"100%":Y,pointerEvents:ae?"none":void 0,width:G?Y:"100%"}}))},y._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var i=this.props.itemCount;if(i>0){var l=this._getRangeToRender(),d=l[0],u=l[1],g=l[2],b=l[3];this._callOnItemsRendered(d,u,g,b)}}if(typeof this.props.onScroll=="function"){var x=this.state,j=x.scrollDirection,m=x.scrollOffset,P=x.scrollUpdateWasRequested;this._callOnScroll(j,m,P)}},y._getRangeToRender=function(){var i=this.props,l=i.itemCount,d=i.overscanCount,u=this.state,g=u.isScrolling,b=u.scrollDirection,x=u.scrollOffset;if(l===0)return[0,0,0,0];var j=_(this.props,x,this._instanceProps),m=C(this.props,j,x,this._instanceProps),P=!g||b==="backward"?Math.max(1,d):1,q=!g||b==="forward"?Math.max(1,d):1;return[Math.max(0,j-P),Math.max(0,Math.min(l-1,m+q)),j,m]},T}(h.PureComponent),a.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},a}var ls=function(a,c){a.children,a.direction,a.height,a.layout,a.innerTagName,a.outerTagName,a.width,c.instance},st=os({getItemOffset:function(a,c){var p=a.itemSize;return c*p},getItemSize:function(a,c){var p=a.itemSize;return p},getEstimatedTotalSize:function(a){var c=a.itemCount,p=a.itemSize;return p*c},getOffsetForIndexAndAlignment:function(a,c,p,f,A,_){var C=a.direction,z=a.height,I=a.itemCount,R=a.itemSize,E=a.layout,T=a.width,y=C==="horizontal"||E==="horizontal",S=y?T:z,i=Math.max(0,I*R-S),l=Math.min(i,c*R),d=Math.max(0,c*R-S+R+_);switch(p==="smart"&&(f>=d-S&&f<=l+S?p="auto":p="center"),p){case"start":return l;case"end":return d;case"center":{var u=Math.round(d+(l-d)/2);return u<Math.ceil(S/2)?0:u>i+Math.floor(S/2)?i:u}case"auto":default:return f>=d&&f<=l?f:f<d?d:l}},getStartIndexForOffset:function(a,c){var p=a.itemCount,f=a.itemSize;return Math.max(0,Math.min(p-1,Math.floor(c/f)))},getStopIndexForStartIndex:function(a,c,p){var f=a.direction,A=a.height,_=a.itemCount,C=a.itemSize,z=a.layout,I=a.width,R=f==="horizontal"||z==="horizontal",E=c*C,T=R?I:A,y=Math.ceil((T+p-E)/C);return Math.max(0,Math.min(_-1,c+y-1))},initInstanceProps:function(a){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(a){a.itemSize}});function As(){const o=_t(),a=zt(),[c,p]=h.useState(""),[f,A]=h.useState("all"),[_,C]=h.useState(!0),[z,I]=h.useState(!0),[R,E]=h.useState(!1),[T,y]=h.useState(!1),[S,i]=h.useState(!0),[l,d]=h.useState(!1),[u,g]=h.useState(100),[b,x]=h.useState("active"),j=t=>{x(t)},[m,P]=h.useState([]),[q,$]=h.useState(0),[Z,ce]=h.useState(0),ee=50,[re,de]=h.useState(!0),[ie,ae]=h.useState(!1),G=h.useCallback(async(t,r="")=>{ae(!0);const s=t*ee,n=s+ee-1;let N=Q.from("notifications").select("*").order("created_at",{ascending:!1}).range(s,n);r&&(N=N.ilike("content",`%${r}%`));const{data:O,error:Ct}=await N;return ae(!1),Ct?[]:O||[]},[]);h.useEffect(()=>{(async()=>{const t=await G(0,c);k(t),de(t.length===ee),ce(0)})()},[G,c]);const me=async()=>{if(ie||!re)return;const t=Z+1,r=await G(t,c);k(s=>{const n=new Set(s.map(N=>N.id));return[...s,...r.filter(N=>!n.has(N.id))]}),de(r.length===ee),ce(t)},[v,k]=h.useState([]);h.useEffect(()=>{k([])},[]);const J=(v==null?void 0:v.filter(t=>{var n;if(!t.content.toLowerCase().includes(c.toLowerCase()))return!1;const s=F.classifyNotification(t);return f==="payments"?s.type==="payment":f==="bookings"?s.type==="booking":f==="active_rentals"?t.type==="pickup_reminder"||t.type==="return_reminder"||t.type==="handover_ready"||t.type==="message_received"&&((n=t.content)==null?void 0:n.toLowerCase().includes("handover")):!0}))||[];h.useEffect(()=>{const t=setInterval(()=>{const r=new Date;v.some(n=>n.snoozedUntil&&new Date(n.snoozedUntil)<=r)&&k(n=>[...n])},6e4);return()=>clearInterval(t)},[v]);const te=new Date,W=v.filter(t=>!t.archived&&(!t.snoozedUntil||new Date(t.snoozedUntil)<=te)),Y=J.filter(t=>{const r=new Date(t.created_at);return te.getTime()-r.getTime()<24*60*60*1e3&&!t.is_read}),rt=J.filter(t=>{const r=new Date(t.created_at);return t.is_read||te.getTime()-r.getTime()>=24*60*60*1e3});h.useEffect(()=>{Y.length===0?(C(!1),I(!0)):C(!0)},[Y.length]);const it=(v==null?void 0:v.filter(t=>!t.is_read).length)||0,at=(v==null?void 0:v.filter(t=>t.is_read?!1:F.classifyNotification(t).type==="payment").length)||0,nt=(v==null?void 0:v.filter(t=>t.is_read?!1:F.classifyNotification(t).type==="booking").length)||0,we=(v==null?void 0:v.filter(t=>t.is_read?!1:t.type==="pickup_reminder"||t.type==="return_reminder"||t.type==="handover_ready").length)||0,ne={all:{label:"All Notifications",count:it},payments:{label:"Payments",count:at},bookings:{label:"Bookings",count:nt},active_rentals:{label:"Active Rentals",count:we}}[f],ue=(v==null?void 0:v.filter(t=>!t.is_read).length)||0,ot=J.filter(t=>F.classifyNotification(t).type==="booking"&&(t.type==="booking_confirmed"||t.content.toLowerCase().includes("confirmed"))).length,lt=J.filter(t=>F.classifyNotification(t).type==="booking"&&(t.type==="booking_cancelled"||t.content.toLowerCase().includes("cancelled"))).length,ct=J.filter(t=>F.classifyNotification(t).type==="booking"&&(t.type==="booking_request"||t.content.toLowerCase().includes("pending"))).length,H=t=>{console.log("Navigating to notification:",t),o(`/notifications/${t}`)},dt=async()=>{try{const{data:{user:t}}=await Q.auth.getUser();if(!t)return;const{error:r}=await Q.from("notifications").update({is_read:!0}).eq("user_id",t.id).eq("is_read",!1);if(r){console.error("Error marking notifications as read:",r),D.error("Couldn't mark notifications as read");return}await a.invalidateQueries({queryKey:["notifications"]}),await a.invalidateQueries({queryKey:["messages"]}),await a.invalidateQueries({queryKey:["unreadMessagesCount"]}),await a.invalidateQueries({queryKey:["unreadNotificationsCount"]}),D.success("All notifications marked as read")}catch(t){console.error("Error in markAllAsRead:",t),D.error("Failed to mark notifications as read")}},oe=t=>{const r=new Date(t),n=Math.floor((new Date().getTime()-r.getTime())/(1e3*60*60));return n<1?"Just now":n<24?`${n}h ago`:n<48?"Yesterday":r.toLocaleDateString()},he=t=>{const r=F.classifyNotification(t);return r.type==="payment"?"bg-blue-500":r.type==="booking"?t.type==="booking_confirmed"||t.content.toLowerCase().includes("confirmed")?"bg-green-500":t.type==="booking_cancelled"||t.content.toLowerCase().includes("cancelled")?"bg-red-500":"bg-yellow-500":"bg-gray-500"},Oe=Y.some(t=>!t.is_read),Ae=h.useRef(ue);h.useEffect(()=>{ue>Ae.current&&D.info("You have a new notification!",{duration:4e3}),Ae.current=ue},[ue]),h.useEffect(()=>{l&&(C(!1),I(!1))},[l,f]);const B=Y.slice(0,u),K=rt.slice(0,u);h.useEffect(()=>{T&&_&&B.length>0&&B.forEach(t=>{t.is_read||H(t.id)})},[T,_,B]),h.useEffect(()=>{T&&z&&K.length>0&&K.forEach(t=>{t.is_read||H(t.id)})},[T,z,K]);const mt=async t=>{const{error:r}=await Q.from("notifications").update({is_read:!t.is_read}).eq("id",t.id);r?D.error("Failed to update notification"):(k(s=>s.map(n=>n.id===t.id?{...n,is_read:!t.is_read}:n)),$(s=>s+1),D.success(t.is_read?"Marked as unread":"Marked as read"))},pe=async t=>{if(window.confirm("Are you sure you want to delete this notification?"))try{k(s=>s.filter(n=>n.id!==t.id));const{error:r}=await Q.from("notifications").delete().eq("id",t.id);r?(console.error("Error deleting notification:",r),k(s=>[...s,t]),D.error("Failed to delete notification")):(D.success("Notification deleted"),await a.invalidateQueries({queryKey:["notifications"]}),await a.invalidateQueries({queryKey:["unreadNotificationsCount"]}))}catch(r){console.error("Error in delete notification:",r),k(s=>[...s,t]),D.error("Failed to delete notification")}},Re=t=>{P(r=>r.includes(t)?r.filter(s=>s!==t):[...r,t])},ut=t=>{P(t.map(r=>r.id))},fe=()=>P([]),Ee=t=>{m.length===t.length?fe():ut(t)},Le=async()=>{if(m.length!==0&&window.confirm(`Are you sure you want to delete ${m.length} notification${m.length>1?"s":""}?`))try{const t=m.map(s=>v.find(n=>n.id===s)).filter(Boolean);k(s=>s.filter(n=>!m.includes(n.id)));const{error:r}=await Q.from("notifications").delete().in("id",m);r?(console.error("Error bulk deleting notifications:",r),k(s=>[...s,...t]),D.error("Failed to delete notifications")):(D.success(`${m.length} notification${m.length>1?"s":""} deleted`),await a.invalidateQueries({queryKey:["notifications"]}),await a.invalidateQueries({queryKey:["unreadNotificationsCount"]}))}catch(t){console.error("Error in bulk delete:",t);const r=m.map(s=>v.find(n=>n.id===s)).filter(Boolean);k(s=>[...s,...r]),D.error("Failed to delete notifications")}finally{fe()}},Ue=()=>{m.forEach(t=>{const r=v.find(s=>s.id===t);r&&!r.is_read&&mt(r)}),fe()};function ht(){m.forEach(t=>{const r=v.find(s=>s.id===t);r&&xe(r)}),fe()}function xe(t){k(r=>r.map(s=>s.id===t.id?{...s,archived:!0}:s)),$(r=>r+1)}function pt(t){k(r=>r.map(s=>s.id===t.id?{...s,archived:!1}:s)),$(r=>r+1)}const[ft,Se]=h.useState(!1),[Fe,qe]=h.useState(null);function xt(t){qe(t),Se(!0)}function gt(t){k(r=>r.map(s=>s.id===Fe.id?{...s,snoozedUntil:t}:s)),Se(!1),qe(null),$(r=>r+1)}const vt=v.filter(t=>t.archived),yt=v.filter(t=>t.snoozedUntil?new Date(t.snoozedUntil)>new Date:!1),[ge,Nt]=h.useState({opens:{},deletes:{},important:{},favorites:[]});function ke(t,r){Nt(s=>{const n={...s};return n[t+"s"]={...n[t+"s"],[r.type]:(n[t+"s"][r.type]||0)+1},n})}function jt(t){return t.type!=="booking"||!t.startDate?!1:new Date(t.startDate).getTime()-new Date().getTime()<24*60*60*1e3}function ve(t,r){const s=Ht(t);let n=0;s==="payment"&&(n+=3),s==="booking"&&jt(t)&&(n+=4),r.favorites.includes(t.senderId)&&(n+=2),(r.opens[s]||0)>5&&(n+=2),(r.deletes[s]||0)>3&&(n-=2),(r.important[s]||0)>0&&(n+=3),t.urgency==="high"&&(n+=2);let N="low";return n>=5?N="high":n>=2&&(N="medium"),{...t,priority:N,score:n,classifiedType:s}}function V(t){return t==="high"?2:t==="medium"?1:0}const bt=B.map(t=>ve(t,ge)).sort((t,r)=>V(r.priority)-V(t.priority)),wt=K.map(t=>ve(t,ge)).sort((t,r)=>V(r.priority)-V(t.priority)),$e=yt.map(t=>ve(t,ge)).sort((t,r)=>V(r.priority)-V(t.priority)),We=vt.map(t=>ve(t,ge)).sort((t,r)=>V(r.priority)-V(t.priority));function St(t){k(r=>r.map(s=>s.id===t.id?{...s,snoozedUntil:null}:s))}const L=h.useMemo(()=>We,[We]),U=h.useMemo(()=>$e,[$e]),kt=t=>{A(t)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(It,{}),e.jsx("div",{className:"container mx-auto px-4 pt-6 max-w-4xl",children:e.jsx(He,{value:b,onValueChange:j,className:"mb-6",children:e.jsxs(Be,{className:"grid w-full grid-cols-3",children:[e.jsxs(X,{value:"active",className:"flex items-center gap-2",children:["Active",W.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full bg-purple-100 text-purple-700 text-xs font-medium",children:W.length})]}),e.jsxs(X,{value:"archived",className:"flex items-center gap-2",children:["Archived",L.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-xs font-medium",children:L.length})]}),e.jsxs(X,{value:"snoozed",className:"flex items-center gap-2",children:["Snoozed",U.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full bg-amber-100 text-amber-700 text-xs font-medium",children:U.length})]})]})})}),e.jsxs("div",{children:[b==="active"&&e.jsxs("div",{className:"container mx-auto px-4 py-0 max-w-4xl",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Bt,{className:"h-7 w-7 text-purple-500"}),ne.count>0&&e.jsx("span",{className:"absolute -top-2 -right-2 flex items-center justify-center w-7 h-7 rounded-full bg-gradient-to-br from-purple-400 to-purple-600 text-white font-bold text-base shadow-md border-2 border-white",children:ne.count})]}),e.jsx("h1",{className:"text-3xl font-extrabold",children:ne.label}),ne.count>0&&e.jsxs("span",{className:"ml-2 px-4 py-1 rounded-full bg-gradient-to-br from-purple-400 to-purple-600 text-white font-semibold text-base shadow inline-block",children:[ne.count," unread"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:dt,className:"flex items-center gap-2 px-4 py-2 border border-gray-200 bg-white rounded-lg shadow-sm hover:bg-gray-50 transition-colors text-sm font-medium text-gray-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-ring",title:"Mark all as read","aria-label":"Mark all as read",type:"button",children:[e.jsx(Kt,{className:"h-5 w-5 text-green-500"}),"Mark all read"]}),e.jsx("button",{onClick:()=>E(!0),className:"p-2 rounded-full hover:bg-muted focus:outline-none focus-visible:ring-2 focus-visible:ring-ring",title:"Notification Settings","aria-label":"Notification Settings",type:"button",children:e.jsx(Vt,{className:"h-6 w-6 text-muted-foreground"})})]})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Mt,{placeholder:"Search transactions...",value:c,onChange:t=>p(t.target.value),className:"pl-10"})]}),e.jsx(He,{value:f,onValueChange:kt,className:"mb-6",children:e.jsxs(Be,{className:"grid w-full grid-cols-3",children:[e.jsxs(X,{value:"all",className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-4 w-4"}),"All"]}),e.jsxs(X,{value:"payments",className:"flex items-center gap-2",children:[e.jsx(Yt,{className:"h-4 w-4"}),"Payments"]}),e.jsxs(X,{value:"bookings",className:"flex items-center gap-2",children:[e.jsx(Qt,{className:"h-4 w-4"}),"Bookings"]}),e.jsxs(X,{value:"active_rentals",className:"flex items-center gap-2 relative",children:[e.jsx(Gt,{className:"h-4 w-4"}),"Active Rentals",we>0&&e.jsx(M,{variant:"secondary",className:"ml-2 text-xs",children:we})]})]})}),f==="bookings"&&e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Confirmed: ",ot]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Cancelled: ",lt]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Pending: ",ct]})]})]}),e.jsxs("div",{className:"bg-card rounded-lg border mb-6",children:[e.jsxs("button",{onClick:()=>C(!_),className:"w-full flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 relative",children:[Oe&&e.jsx("span",{className:"mail-pulse-ring"}),e.jsx(Qe,{className:`h-5 w-5 text-primary ${Oe?"mail-pulse":""}`}),e.jsx("span",{className:"font-semibold",children:"Recent Notifications"})]}),e.jsx(Ge,{className:`h-4 w-4 transition-transform ${_?"rotate-180":""}`})]}),_&&e.jsxs(e.Fragment,{children:[e.jsx(Ce,{}),e.jsx(Ke,{className:"min-h-[3.5rem] max-h-[90vh]",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(be,{checked:m.length===B.length&&B.length>0,onCheckedChange:()=>Ee(B),"aria-label":"Select all recent notifications"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Select All"}),m.length>0&&e.jsxs("div",{className:"ml-4 flex gap-2",children:[e.jsx(w,{size:"sm",variant:"outline",onClick:Ue,children:"Mark as Read"}),e.jsx(w,{size:"sm",variant:"outline",onClick:ht,children:"Archive"}),e.jsx(w,{size:"sm",variant:"destructive",onClick:Le,children:"Delete"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[m.length," selected"]})]})]}),B.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(ye,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:"No recent notifications"})]}):bt.map(t=>{const r=F.classifyNotification(t);return e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border transition-colors cursor-pointer relative ${t.priority==="high"?"border-red-500":t.priority==="medium"?"border-yellow-500":"border-gray-300"}`,onClick:()=>{H(t.id),ke("open",t)},children:[e.jsx(be,{checked:m.includes(t.id),onClick:s=>s.stopPropagation(),onCheckedChange:()=>Re(t.id),"aria-label":"Select notification",className:"mt-1 mr-2"}),e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${he(t)}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium leading-relaxed",children:t.content}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:oe(t.created_at)}),e.jsxs(M,{variant:"outline",className:"text-xs",children:[t.classifiedType," (",t.score,")"]}),t.priority&&e.jsx(M,{variant:t.priority==="high"?"destructive":t.priority==="medium"?"warning":"secondary",className:"text-xs",title:t.priority==="high"?"High priority: Important or urgent based on type, sender, and your behavior.":t.priority==="medium"?"Medium priority: Moderately important or relevant.":"Low priority: Less important or less relevant to you.",children:t.priority.toUpperCase()})]})]}),e.jsxs("div",{className:"flex gap-1 absolute bottom-2 right-2 opacity-100",children:[e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Delete",onClick:s=>{s.stopPropagation(),pe(t)},children:e.jsx(Ne,{className:"h-4 w-4"})}),r.type==="payment"&&e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"View receipt",onClick:s=>{s.stopPropagation()},children:e.jsx(je,{className:"h-4 w-4"})}),r.type==="booking"&&e.jsx(e.Fragment,{}),r.type==="other"&&e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"View details",onClick:s=>{s.stopPropagation(),H(t.id)},children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Archive",onClick:s=>{s.stopPropagation(),xe(t)},children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Snooze",onClick:s=>{s.stopPropagation(),xt(t)},children:e.jsx(_e,{className:"h-4 w-4"})}),r.type==="booking"&&t.type==="booking_request"&&t.related_booking_id&&!t._actionTaken&&/(received|pending)/i.test(t.content)&&e.jsxs("span",{className:"flex gap-2 ml-2",children:[e.jsx(w,{size:"sm",className:"px-2 py-1 text-xs",variant:"default",disabled:t._actionLoading==="accept",onClick:async s=>{s.stopPropagation(),k(n=>n.map(N=>N.id===t.id?{...N,_actionLoading:"accept",_actionTaken:"accepted"}:N));try{const{error:n}=await Q.from("bookings").update({status:"confirmed"}).eq("id",t.related_booking_id);if(n)throw n;setTimeout(()=>{k(N=>N.filter(O=>O.id!==t.id))},1200)}catch{D.error("Failed to accept booking request."),k(N=>N.map(O=>O.id===t.id?{...O,_actionLoading:null,_actionTaken:null}:O))}},children:t._actionLoading==="accept"?"Accepting...":"Accept"}),e.jsx(w,{size:"sm",className:"px-2 py-1 text-xs",variant:"destructive",disabled:t._actionLoading==="decline",onClick:async s=>{s.stopPropagation(),k(n=>n.map(N=>N.id===t.id?{...N,_actionLoading:"decline",_actionTaken:"declined"}:N));try{const{error:n}=await Q.from("bookings").update({status:"cancelled"}).eq("id",t.related_booking_id);if(n)throw n;setTimeout(()=>{k(N=>N.filter(O=>O.id!==t.id))},1200)}catch{D.error("Failed to decline booking request."),k(N=>N.map(O=>O.id===t.id?{...O,_actionLoading:null,_actionTaken:null}:O))}},children:t._actionLoading==="decline"?"Declining...":"Decline"}),t._actionTaken&&e.jsx(M,{variant:t._actionTaken==="accepted"?"default":"destructive",className:"ml-2",children:t._actionTaken==="accepted"?"Accepted":"Declined"})]})]}),!t.is_read&&e.jsx(M,{variant:"secondary",className:"text-xs",children:"New"})]},t.id)})]})})]})]}),e.jsxs("div",{className:"bg-card rounded-lg border",children:[e.jsxs("button",{onClick:()=>I(!z),className:"w-full flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{className:"font-semibold",children:"Older Notifications"})]}),e.jsx(Ge,{className:`h-4 w-4 transition-transform ${z?"rotate-180":""}`})]}),z&&e.jsxs(e.Fragment,{children:[e.jsx(Ce,{}),e.jsx(Ke,{className:"min-h-[3.5rem] max-h-[90vh]",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(be,{checked:m.length===K.length&&K.length>0,onCheckedChange:()=>Ee(K),"aria-label":"Select all older notifications"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Select All"}),m.length>0&&e.jsxs("div",{className:"ml-4 flex gap-2",children:[e.jsx(w,{size:"sm",variant:"outline",onClick:Ue,children:"Mark as Read"}),e.jsx(w,{size:"sm",variant:"destructive",onClick:Le,children:"Delete"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[m.length," selected"]})]})]}),K.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(ye,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:"No older notifications"})]}):wt.map(t=>{const r=F.classifyNotification(t);return e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border transition-colors cursor-pointer relative ${t.priority==="high"?"border-red-500":t.priority==="medium"?"border-yellow-500":"border-gray-300"}`,onClick:()=>H(t.id),children:[e.jsx(be,{checked:m.includes(t.id),onClick:s=>s.stopPropagation(),onCheckedChange:()=>Re(t.id),"aria-label":"Select notification",className:"mt-1 mr-2"}),e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${he(t)}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium leading-relaxed",children:t.content}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:oe(t.created_at)}),e.jsxs(M,{variant:"outline",className:"text-xs",children:[t.classifiedType," (",t.score,")"]}),t.priority&&e.jsx(M,{variant:t.priority==="high"?"destructive":t.priority==="medium"?"warning":"secondary",className:"text-xs",title:t.priority==="high"?"High priority: Important or urgent based on type, sender, and your behavior.":t.priority==="medium"?"Medium priority: Moderately important or relevant.":"Low priority: Less important or less relevant to you.",children:t.priority.toUpperCase()})]})]}),e.jsxs("div",{className:"flex gap-1 absolute bottom-2 right-2 opacity-100",children:[e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Delete",onClick:s=>{s.stopPropagation(),pe(t)},children:e.jsx(Ne,{className:"h-4 w-4"})}),r.type==="payment"&&e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"View receipt",onClick:s=>{s.stopPropagation()},children:e.jsx(je,{className:"h-4 w-4"})}),r.type==="booking"&&e.jsx(e.Fragment,{}),r.type==="other"&&e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"View details",onClick:s=>{s.stopPropagation(),H(t.id)},children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Archive",onClick:s=>{s.stopPropagation(),xe(t)},children:e.jsx(le,{className:"h-4 w-4"})})]}),!t.is_read&&e.jsx(M,{variant:"secondary",className:"text-xs",children:"New"})]},t.id)})]})})]})]})]}),e.jsx(Dt,{open:R,onOpenChange:E,children:e.jsxs(Pt,{children:[e.jsxs(Ot,{children:[e.jsx(At,{children:"Notification Settings"}),e.jsx(Rt,{children:"Manage your notification preferences"})]}),e.jsxs("div",{className:"space-y-6 pt-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Auto mark as read"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Automatically mark notifications as read when viewed"})]}),e.jsx(ze,{checked:T,onCheckedChange:y})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Sound notifications"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Play sound when new notifications arrive"})]}),e.jsx(ze,{checked:S,onCheckedChange:i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Collapse groups by default"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"New notification groups will be collapsed"})]}),e.jsx(ze,{checked:l,onCheckedChange:d})]}),e.jsx(Ce,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium",children:"Maximum notifications"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Keep up to ",u," notifications"]})]}),e.jsx(Et,{min:10,max:200,step:1,value:[u],onValueChange:t=>g(t[0])})]})]})]})})]}),b==="archived"&&e.jsxs("div",{className:"container mx-auto px-4 py-0 max-w-4xl",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"h-7 w-7 text-blue-500"}),L.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 flex items-center justify-center w-7 h-7 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 text-white font-bold text-base shadow-md border-2 border-white",children:L.length})]}),e.jsx("h1",{className:"text-3xl font-extrabold",children:"Archived Notifications"}),L.length>0&&e.jsxs("span",{className:"ml-2 px-4 py-1 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 text-white font-semibold text-base shadow inline-block",children:[L.length," archived"]})]})}),L.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(ye,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:"No archived notifications"})]}):e.jsx(st,{height:Math.min(400,L.length*80),itemCount:L.length,itemSize:80,width:"100%",onItemsRendered:({visibleStopIndex:t})=>{t>=L.length-5&&re&&me()},children:({index:t,style:r})=>{const s=L[t];return F.classifyNotification(s),e.jsx("div",{style:r,className:"p-2",children:e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border transition-colors cursor-pointer relative ${s.priority==="high"?"border-red-500":s.priority==="medium"?"border-yellow-500":"border-gray-300"}`,onClick:()=>{H(s.id),ke("open",s)},children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${he(s)}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium leading-relaxed",children:s.content}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:oe(s.created_at)}),e.jsxs(M,{variant:"outline",className:"text-xs",children:[s.classifiedType," (",s.score,")"]}),s.priority&&e.jsx(M,{variant:s.priority==="high"?"destructive":s.priority==="medium"?"warning":"secondary",className:"text-xs",title:s.priority==="high"?"High priority: Important or urgent based on type, sender, and your behavior.":s.priority==="medium"?"Medium priority: Moderately important or relevant.":"Low priority: Less important or less relevant to you.",children:s.priority.toUpperCase()})]})]}),e.jsxs("div",{className:"flex gap-1 absolute bottom-2 right-2 opacity-100",children:[e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Unarchive",onClick:n=>{n.stopPropagation(),pt(s)},children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Delete",onClick:n=>{n.stopPropagation(),pe(s)},children:e.jsx(Ne,{className:"h-4 w-4"})})]}),!s.is_read&&e.jsx(M,{variant:"secondary",className:"text-xs",children:"New"})]})})}}),ie&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Ve,{className:"h-8 w-8 rounded-full animate-spin"})})]}),b==="snoozed"&&e.jsxs("div",{className:"container mx-auto px-4 py-0 max-w-4xl",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_e,{className:"h-7 w-7 text-amber-500"}),U.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 flex items-center justify-center w-7 h-7 rounded-full bg-gradient-to-br from-amber-400 to-amber-600 text-white font-bold text-base shadow-md border-2 border-white",children:U.length})]}),e.jsx("h1",{className:"text-3xl font-extrabold",children:"Snoozed Notifications"}),U.length>0&&e.jsxs("span",{className:"ml-2 px-4 py-1 rounded-full bg-gradient-to-br from-amber-400 to-amber-600 text-white font-semibold text-base shadow inline-block",children:[U.length," snoozed"]})]})}),U.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(ye,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:"No snoozed notifications"})]}):e.jsx(st,{height:Math.min(400,U.length*80),itemCount:U.length,itemSize:80,width:"100%",onItemsRendered:({visibleStopIndex:t})=>{t>=U.length-5&&re&&me()},children:({index:t,style:r})=>{const s=U[t];return F.classifyNotification(s),e.jsx("div",{style:r,className:"p-2",children:e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border transition-colors cursor-pointer relative ${s.priority==="high"?"border-red-500":s.priority==="medium"?"border-yellow-500":"border-gray-300"}`,onClick:()=>{H(s.id),ke("open",s)},children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${he(s)}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium leading-relaxed",children:s.content}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:oe(s.created_at)}),e.jsxs(M,{variant:"outline",className:"text-xs",children:[s.classifiedType," (",s.score,")"]}),s.priority&&e.jsx(M,{variant:s.priority==="high"?"destructive":s.priority==="medium"?"warning":"secondary",className:"text-xs",title:s.priority==="high"?"High priority: Important or urgent based on type, sender, and your behavior.":s.priority==="medium"?"Medium priority: Moderately important or relevant.":"Low priority: Less important or less relevant to you.",children:s.priority.toUpperCase()}),e.jsxs(M,{variant:"secondary",className:"text-xs",children:["Snoozed until ",oe(s.snoozedUntil)]})]})]}),e.jsxs("div",{className:"flex gap-1 absolute bottom-2 right-2 opacity-100",children:[e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Unsnooze",onClick:n=>{n.stopPropagation(),St(s)},children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Archive",onClick:n=>{n.stopPropagation(),xe(s)},children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",title:"Delete",onClick:n=>{n.stopPropagation(),pe(s)},children:e.jsx(Ne,{className:"h-4 w-4"})})]}),!s.is_read&&e.jsx(M,{variant:"secondary",className:"text-xs",children:"New"})]})})}}),ie&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Ve,{className:"h-8 w-8 rounded-full animate-spin"})})]})]}),e.jsx(es,{open:ft,onClose:()=>Se(!1),onSnooze:gt,notification:Fe})]})}export{As as default};
