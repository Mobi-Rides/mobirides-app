import{a as W,u as K,b as L,j as t}from"./query-vendor-Bsfdn-Hb.js";import{r as R,u as U}from"./react-vendor-mnpoGfEl.js";import{a3 as I,s as p,J as H,n as b,B as k,C as M,X as E,ak as F,y as O,W as X,a2 as G,D as J,al as Z,b as ee,d as te,e as se,I as re,af as ie,ag as ae,ah as C,ai as ne}from"./index-P3CM6KeI.js";import{N as Y}from"./Navigation-CSI_6Xlv.js";import{C as oe,d as ce}from"./card-CfBwv9RV.js";import{N as f,n as B}from"./notificationHelpers-DZFPT44-.js";import{B as A}from"./bell-BXMTfvW8.js";import{M as z}from"./message-square-B-A4He7I.js";import{C as le}from"./calendar-BKgmIjQf.js";import{C as de}from"./credit-card-Cb116MBj.js";import{C as Q}from"./car-BJ1V2yVZ.js";import{M as me}from"./map-pin-DPjPx-xp.js";import{W as ue}from"./wallet-D-Tke-Q7.js";import{f as pe}from"./date-vendor-Dhms5dOu.js";import{S as P}from"./skeleton-B2cG361V.js";import{S as _e}from"./settings-BI3euaaP.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./user-BqRr4HZa.js";const ge=()=>{const{user:s}=I(),e=W(),{data:r=[],isLoading:i,error:d}=K({queryKey:["notifications",s==null?void 0:s.id],queryFn:async()=>{if(!(s!=null&&s.id))return[];const{data:l,error:u}=await p.from("notifications").select(`
          *,
          bookings:related_booking_id (
            id,
            start_date,
            end_date,
            total_price,
            status,
            cars (
              id,
              brand,
              model,
              image_url
            )
          ),
          cars:related_car_id (
            id,
            brand,
            model,
            image_url
          )
        `).eq("user_id",s.id).order("created_at",{ascending:!1});if(u)throw u;return l||[]},enabled:!!(s!=null&&s.id)}),c=r.filter(l=>!l.is_read).length;return R.useEffect(()=>{if(!(s!=null&&s.id))return;const l=p.channel("notifications-changes").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${s.id}`},()=>{e.invalidateQueries({queryKey:["notifications",s.id]})}).subscribe();return()=>{p.removeChannel(l)}},[s==null?void 0:s.id,e]),{notifications:r,unreadCount:c,isLoading:i,error:d,markAsRead:async l=>{const{error:u}=await p.from("notifications").update({is_read:!0}).eq("id",l);return u||e.invalidateQueries({queryKey:["notifications",s==null?void 0:s.id]}),{error:u}},markAllAsRead:async()=>{if(!(s!=null&&s.id))return{error:new Error("No user")};const{error:l}=await p.from("notifications").update({is_read:!0}).eq("user_id",s.id).eq("is_read",!1);return l||e.invalidateQueries({queryKey:["notifications",s.id]}),{error:l}},deleteNotification:async l=>{const{error:u}=await p.from("notifications").delete().eq("id",l);return u||e.invalidateQueries({queryKey:["notifications",s==null?void 0:s.id]}),{error:u}}}};class he{static async createBookingReminders(){try{const e=new Date,r=new Date(e);r.setDate(r.getDate()+1);const i=new Date(e);i.setHours(i.getHours()+2);const d=new Date(e);d.setMinutes(d.getMinutes()+30);const{data:c}=await p.from("bookings").select(`
          id,
          start_date,
          start_time,
          renter_id,
          cars (
            id,
            brand,
            model,
            owner_id
          )
        `).eq("status","confirmed").eq("start_date",r.toISOString().split("T")[0]).eq("preparation_reminder_sent",!1),{data:n}=await p.from("bookings").select(`
          id,
          start_date,
          start_time,
          renter_id,
          cars (
            id,
            brand,
            model,
            owner_id
          )
        `).eq("status","confirmed").eq("start_date",e.toISOString().split("T")[0]),{data:_}=await p.from("bookings").select(`
          id,
          start_date,
          start_time,
          renter_id,
          cars (
            id,
            brand,
            model,
            owner_id
          )
        `).eq("status","confirmed").eq("start_date",e.toISOString().split("T")[0]);if(c)for(const a of c){const l=`${a.cars.brand} ${a.cars.model}`;await p.from("notifications").insert({user_id:a.renter_id,type:"pickup_reminder_renter",title:"Pickup Reminder",description:`Your rental of ${l} starts tomorrow at ${a.start_time}. Please prepare for pickup.`,content:`Your rental of ${l} starts tomorrow at ${a.start_time}. Please prepare for pickup.`,related_booking_id:a.id,related_car_id:a.cars.id,role_target:"renter_only",metadata:{}}),await p.from("notifications").insert({user_id:a.cars.owner_id,type:"pickup_reminder_host",title:"Pickup Reminder",description:`Your ${l} rental starts tomorrow at ${a.start_time}. Please prepare for handover.`,content:`Your ${l} rental starts tomorrow at ${a.start_time}. Please prepare for handover.`,related_booking_id:a.id,related_car_id:a.cars.id,role_target:"host_only",metadata:{}}),await p.from("bookings").update({preparation_reminder_sent:!0}).eq("id",a.id)}if(n)for(const a of n){const h=(new Date(`${a.start_date}T${a.start_time}`).getTime()-e.getTime())/(1e3*60*60);if(h<=2.5&&h>=1.5){const g=`${a.cars.brand} ${a.cars.model}`;await p.from("notifications").insert({user_id:a.renter_id,type:"pickup_reminder_renter",title:"2 Hour Pickup Reminder",description:`Your rental of ${g} starts in 2 hours at ${a.start_time}. Time to head to pickup location!`,content:`Your rental of ${g} starts in 2 hours at ${a.start_time}. Time to head to pickup location!`,related_booking_id:a.id,related_car_id:a.cars.id,role_target:"renter_only",metadata:{}}),await p.from("notifications").insert({user_id:a.cars.owner_id,type:"pickup_reminder_host",title:"2 Hour Pickup Reminder",description:`Your ${g} handover is in 2 hours at ${a.start_time}. Please ensure the car is ready.`,content:`Your ${g} handover is in 2 hours at ${a.start_time}. Please ensure the car is ready.`,related_booking_id:a.id,related_car_id:a.cars.id,role_target:"host_only",metadata:{}})}}if(_)for(const a of _){const h=(new Date(`${a.start_date}T${a.start_time}`).getTime()-e.getTime())/(1e3*60);if(h<=35&&h>=25){const g=`${a.cars.brand} ${a.cars.model}`;await p.from("notifications").insert({user_id:a.renter_id,type:"pickup_reminder_renter",title:"30 Minute Pickup Reminder",description:`Your rental of ${g} starts in 30 minutes! Time for final preparations.`,content:`Your rental of ${g} starts in 30 minutes! Time for final preparations.`,related_booking_id:a.id,related_car_id:a.cars.id,role_target:"renter_only",metadata:{}}),await p.from("notifications").insert({user_id:a.cars.owner_id,type:"pickup_reminder_host",title:"30 Minute Pickup Reminder",description:`Your ${g} handover is in 30 minutes! Please be ready at the pickup location.`,content:`Your ${g} handover is in 30 minutes! Please be ready at the pickup location.`,related_booking_id:a.id,related_car_id:a.cars.id,role_target:"host_only",metadata:{}})}}}catch(e){console.error("Error creating booking reminders:",e)}}static async sendPostConfirmationGuidance(e,r){try{const{data:i}=await p.from("bookings").select(`
          id,
          start_date,
          start_time,
          renter_id,
          cars (
            id,
            brand,
            model,
            owner_id
          )
        `).eq("id",e).single();if(!i)return;const d=`${i.cars.brand} ${i.cars.model}`,c=`${i.start_date} at ${i.start_time}`;r==="host"?await p.from("notifications").insert({user_id:i.cars.owner_id,type:"booking_confirmed_host",title:"Booking Confirmed - Next Steps",description:`Booking confirmed! Next steps: 1) Prepare your ${d} for handover on ${c}. 2) Ensure fuel tank is full. 3) Clean the vehicle. 4) Be ready 15 minutes early.`,content:`Booking confirmed! Next steps: 1) Prepare your ${d} for handover on ${c}. 2) Ensure fuel tank is full. 3) Clean the vehicle. 4) Be ready 15 minutes early.`,related_booking_id:i.id,related_car_id:i.cars.id,role_target:"host_only",metadata:{}}):await p.from("notifications").insert({user_id:i.renter_id,type:"booking_confirmed_renter",title:"Booking Confirmed - Next Steps",description:`Booking confirmed! Next steps: 1) Prepare for pickup on ${c}. 2) Bring your driver's license. 3) Complete any required verification. 4) Arrive 15 minutes early.`,content:`Booking confirmed! Next steps: 1) Prepare for pickup on ${c}. 2) Bring your driver's license. 3) Complete any required verification. 4) Arrive 15 minutes early.`,related_booking_id:i.id,related_car_id:i.cars.id,role_target:"renter_only",metadata:{}})}catch(i){console.error("Error sending post-confirmation guidance:",i)}}}const fe=()=>{const s=W(),{user:e}=I(),r=L({mutationFn:async({bookingId:c,status:n})=>{const{error:_}=await p.from("bookings").update({status:n}).eq("id",c);if(_)throw _},onSuccess:(c,n)=>{const _=n.status==="confirmed"?"approved":"cancelled";H.success(`Booking ${_}`),n.status==="confirmed"&&e&&he.sendPostConfirmationGuidance(n.bookingId,"host"),s.invalidateQueries({queryKey:["booking-request",n.bookingId]}),s.invalidateQueries({queryKey:["notifications"]}),s.invalidateQueries({queryKey:["bookings"]})},onError:c=>{H.error("Failed to update the booking status. Please try again.")}});return{acceptBooking:c=>{r.mutate({bookingId:c,status:"confirmed"})},declineBooking:c=>{r.mutate({bookingId:c,status:"cancelled"})},isLoading:r.status==="pending",error:r.error}};class q{static extractMetadata(e){const r=e.metadata||{},i=e.type;switch(!0){case this.isBookingType(i):return this.extractBookingMetadata(r);case this.isPaymentType(i):return this.extractPaymentMetadata(r);case this.isHandoverType(i):return this.extractHandoverMetadata(r);case this.isMessageType(i):return this.extractMessageMetadata(r);case this.isSystemType(i):return this.extractSystemMetadata(r);case this.isRentalType(i):return this.extractRentalMetadata(r);default:return r}}static getMetadataSummary(e){const r=this.extractMetadata(e),i=e.type;switch(!0){case this.isBookingType(i):return this.getBookingSummary(r);case this.isPaymentType(i):return this.getPaymentSummary(r);case this.isHandoverType(i):return this.getHandoverSummary(r);case this.isMessageType(i):return this.getMessageSummary(r);case this.isSystemType(i):return this.getSystemSummary(r);case this.isRentalType(i):return this.getRentalSummary(r);default:return[]}}static getActionButtons(e){const r=this.extractMetadata(e),i=e.type,d=[];switch(!0){case this.isBookingType(i):i.includes("request")&&!e.is_read&&d.push({label:"Accept",action:"accept_booking",variant:"default",icon:"Check"},{label:"Decline",action:"decline_booking",variant:"outline",icon:"X"}),r.booking_id&&d.push({label:"View Booking",action:"view_booking",variant:"outline",icon:"Eye"});break;case this.isPaymentType(i):d.push({label:"View Wallet",action:"view_wallet",variant:"outline",icon:"Wallet"}),(i.includes("failed")||i.includes("error"))&&d.push({label:"Retry Payment",action:"retry_payment",variant:"default",icon:"RefreshCw"});break;case this.isHandoverType(i):const c=r;(c.status==="ready"||c.status==="in_progress")&&d.push({label:"View on Map",action:"view_map",variant:"default",icon:"MapPin"}),e.related_booking_id&&d.push({label:"View Booking",action:"view_booking",variant:"outline",icon:"Eye"});break;case this.isMessageType(i):d.push({label:"View Messages",action:"view_messages",variant:"default",icon:"MessageSquare"});break;case this.isRentalType(i):e.related_booking_id&&d.push({label:"View Rental",action:"view_rental",variant:"default",icon:"Car"});break}return d}static isBookingType(e){return e.includes("booking")||e.includes("request")||e.includes("confirmed")||e.includes("cancelled")}static isPaymentType(e){return e.includes("payment")||e.includes("wallet")||e.includes("topup")||e.includes("deduction")}static isHandoverType(e){return e.includes("handover")}static isMessageType(e){return e.includes("message")}static isSystemType(e){return e.includes("system")||e.includes("maintenance")}static isRentalType(e){return e.includes("rental")||e.includes("earnings")}static extractBookingMetadata(e){return{booking_id:e.booking_id,car_make:e.car_make,car_model:e.car_model,pickup_location:e.pickup_location,return_location:e.return_location,pickup_date:e.pickup_date,return_date:e.return_date,total_amount:e.total_amount,status:e.status,host_name:e.host_name,renter_name:e.renter_name}}static extractPaymentMetadata(e){return{amount:e.amount,currency:e.currency||"BWP",transaction_id:e.transaction_id,payment_method:e.payment_method,status:e.status,description:e.description,wallet_balance:e.wallet_balance}}static extractHandoverMetadata(e){return{handover_type:e.handover_type,car_make:e.car_make,car_model:e.car_model,location:e.location,status:e.status,step_name:e.step_name,progress_percentage:e.progress_percentage,estimated_time:e.estimated_time,other_party_name:e.other_party_name}}static extractMessageMetadata(e){return{sender_name:e.sender_name,conversation_id:e.conversation_id,message_preview:e.message_preview,message_type:e.message_type,attachment_count:e.attachment_count}}static extractSystemMetadata(e){return{system_event:e.system_event,severity:e.severity||"info",action_required:e.action_required,maintenance_window:e.maintenance_window}}static extractRentalMetadata(e){return{rental_id:e.rental_id,car_make:e.car_make,car_model:e.car_model,current_location:e.current_location,status:e.status,earnings:e.earnings,duration:e.duration}}static getBookingSummary(e){const r=[];return e.car_make&&e.car_model&&r.push(`Vehicle: ${e.car_make} ${e.car_model}`),e.pickup_location&&r.push(`Pickup: ${e.pickup_location}`),e.pickup_date&&r.push(`Date: ${new Date(e.pickup_date).toLocaleDateString()}`),e.total_amount&&r.push(`Amount: BWP ${e.total_amount.toFixed(2)}`),r}static getPaymentSummary(e){const r=[];return e.amount&&r.push(`Amount: ${e.currency||"BWP"} ${e.amount.toFixed(2)}`),e.payment_method&&r.push(`Method: ${e.payment_method}`),e.status&&r.push(`Status: ${e.status}`),e.wallet_balance!==void 0&&r.push(`Balance: BWP ${e.wallet_balance.toFixed(2)}`),r}static getHandoverSummary(e){const r=[];return e.car_make&&e.car_model&&r.push(`Vehicle: ${e.car_make} ${e.car_model}`),e.location&&r.push(`Location: ${e.location}`),e.status&&r.push(`Status: ${e.status.replace("_"," ").toUpperCase()}`),e.progress_percentage!==void 0&&r.push(`Progress: ${e.progress_percentage}%`),e.step_name&&r.push(`Current Step: ${e.step_name}`),r}static getMessageSummary(e){const r=[];return e.sender_name&&r.push(`From: ${e.sender_name}`),e.message_preview&&r.push(`Preview: ${e.message_preview}`),e.attachment_count&&e.attachment_count>0&&r.push(`Attachments: ${e.attachment_count}`),r}static getSystemSummary(e){const r=[];return e.severity&&r.push(`Severity: ${e.severity.toUpperCase()}`),e.action_required&&r.push("Action Required"),e.maintenance_window&&r.push(`Maintenance: ${e.maintenance_window}`),r}static getRentalSummary(e){const r=[];return e.car_make&&e.car_model&&r.push(`Vehicle: ${e.car_make} ${e.car_model}`),e.earnings&&r.push(`Earnings: BWP ${e.earnings.toFixed(2)}`),e.duration&&r.push(`Duration: ${e.duration}`),e.status&&r.push(`Status: ${e.status}`),r}}function ye(s){return{summary:q.getMetadataSummary(s),actions:q.getActionButtons(s),metadata:q.extractMetadata(s)}}function V({notification:s,onMarkAsRead:e,onDelete:r,onAcceptBooking:i,onDeclineBooking:d,compact:c=!1}){const n=U(),_=f.classifyNotification(s),{summary:a,actions:l}=ye(s),u=()=>{switch(_.type){case"booking":return t.jsx(Q,{className:"h-5 w-5"});case"payment":return t.jsx(de,{className:"h-5 w-5"});case"handover":return t.jsx(le,{className:"h-5 w-5"});case"message":return t.jsx(z,{className:"h-5 w-5"});default:return t.jsx(A,{className:"h-5 w-5"})}},h=()=>{switch(_.type){case"booking":return s.type.includes("booking_confirmed")?"text-green-600":s.type.includes("booking_cancelled")?"text-red-600":"text-blue-600";case"payment":return"text-emerald-600";case"handover":return"text-orange-600";case"message":return"text-purple-600";default:return"text-gray-600"}},g=()=>{switch(_.type){case"booking":return s.type.includes("booking_confirmed")?"default":s.type.includes("booking_cancelled")?"destructive":"secondary";case"payment":return"default";case"handover":return"secondary";case"message":return"outline";default:return"outline"}},v=()=>{!s.is_read&&e&&e(s.id),f.isHandoverNotification(s)?s.related_booking_id?n(`/map?booking=${s.related_booking_id}&handover=true`):n("/map"):f.isActiveRentalNotification(s)?s.related_booking_id?n(`/rental-details/${s.related_booking_id}`):n(`/notifications/${s.id}`):_.type==="booking"&&s.related_booking_id?n(`/bookings/${s.related_booking_id}`):_.type==="payment"||f.isPaymentNotification(s)?n("/wallet"):f.isMessageNotification(s)?n("/messages"):n(`/notifications/${s.id}`)},N=s.type.includes("booking_request")&&!s.is_read&&i&&d,w=m=>{switch(m){case"accept_booking":i&&s.related_booking_id&&i(s.related_booking_id);break;case"decline_booking":d&&s.related_booking_id&&d(s.related_booking_id);break;case"view_booking":s.related_booking_id&&n(`/bookings/${s.related_booking_id}`);break;case"view_wallet":n("/wallet");break;case"view_messages":n("/messages");break;case"view_map":s.related_booking_id?n(`/map?booking=${s.related_booking_id}&handover=true`):n("/map");break;case"view_rental":s.related_booking_id&&n(`/rental-details/${s.related_booking_id}`);break;case"retry_payment":n("/wallet");break}},j=m=>{switch(m){case"Check":return t.jsx(M,{className:"h-4 w-4"});case"X":return t.jsx(E,{className:"h-4 w-4"});case"Eye":return t.jsx(F,{className:"h-4 w-4"});case"Wallet":return t.jsx(ue,{className:"h-4 w-4"});case"RefreshCw":return t.jsx(G,{className:"h-4 w-4"});case"MapPin":return t.jsx(me,{className:"h-4 w-4"});case"MessageSquare":return t.jsx(z,{className:"h-4 w-4"});case"Car":return t.jsx(Q,{className:"h-4 w-4"});default:return null}};return t.jsx(oe,{className:`
        transition-all duration-200 hover:shadow-md cursor-pointer
        ${s.is_read?"hover:bg-muted/50":"border-primary/50 bg-primary/5"}
        ${c?"p-3":""}
      `,onClick:v,children:t.jsx(ce,{className:c?"p-0":"p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:`mt-1 ${h()}`,children:u()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:`text-sm ${s.is_read?"font-medium":"font-semibold"}`,children:s.title}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description}),a.length>0&&t.jsx("div",{className:"mt-2 space-y-1",children:a.map((m,y)=>t.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[t.jsx("span",{className:"w-1 h-1 bg-muted-foreground rounded-full"}),m]},y))}),a.length===0&&s.bookings&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.bookings.brand," ",s.bookings.model]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-1",children:[t.jsx(b,{variant:g(),className:"text-xs",children:_.type}),t.jsx("span",{className:"text-xs text-muted-foreground",children:pe(new Date(s.created_at),{addSuffix:!0})})]})]}),N&&t.jsxs("div",{className:"flex gap-2 mt-3",onClick:m=>m.stopPropagation(),children:[t.jsxs(k,{size:"sm",onClick:()=>i(s.related_booking_id),className:"flex-1",children:[t.jsx(M,{className:"h-4 w-4 mr-1"}),"Accept"]}),t.jsxs(k,{size:"sm",variant:"outline",onClick:()=>d(s.related_booking_id),className:"flex-1",children:[t.jsx(E,{className:"h-4 w-4 mr-1"}),"Decline"]})]}),!c&&t.jsxs("div",{className:"space-y-2 mt-3",onClick:m=>m.stopPropagation(),children:[l.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2",children:l.slice(0,2).map((m,y)=>t.jsxs(k,{size:"sm",variant:m.variant||"outline",onClick:()=>w(m.action),className:"flex-1 min-w-0",children:[m.icon&&j(m.icon),m.icon&&t.jsx("span",{className:"ml-1"}),m.label]},y))}),l.length>2&&t.jsx("div",{className:"flex flex-wrap gap-2",children:l.slice(2).map((m,y)=>t.jsxs(k,{size:"sm",variant:"ghost",onClick:()=>w(m.action),className:"flex-1 min-w-0",children:[m.icon&&j(m.icon),m.icon&&t.jsx("span",{className:"ml-1"}),m.label]},y+2))}),t.jsxs("div",{className:"flex items-center gap-2",children:[!s.is_read&&e&&t.jsxs(k,{size:"sm",variant:"ghost",onClick:()=>e(s.id),children:[t.jsx(F,{className:"h-4 w-4 mr-1"}),"Mark as read"]}),r&&t.jsxs(k,{size:"sm",variant:"ghost",onClick:()=>r(s.id),children:[t.jsx(O,{className:"h-4 w-4 mr-1"}),"Delete"]}),t.jsx("div",{className:"flex-1"}),t.jsx(X,{className:"h-4 w-4 text-muted-foreground"})]})]})]})]})})})}const Fe=()=>{const{notifications:s,unreadCount:e,isLoading:r,markAsRead:i,markAllAsRead:d,deleteNotification:c}=ge(),{acceptBooking:n,declineBooking:_}=fe(),[a,l]=R.useState(""),[u,h]=R.useState("all"),g=s.filter(o=>{const x=B(o),S=`${x.title||""} ${x.description||""}`.toLowerCase();return a&&!S.includes(a.toLowerCase())?!1:u==="all"?!0:u==="active_rentals"?f.isActiveRentalNotification(x):f.classifyNotification(x).type===u}),v=g.filter(o=>!o.is_read),N=g.filter(o=>o.is_read),w=async o=>{await i(o)},j=async o=>{await c(o)},m=async()=>{await d()},y=async o=>{await n(o)},D=async o=>{await _(o)},$=(()=>{const o={all:s.length,booking:0,payment:0,active_rentals:0,system:0};return s.forEach(x=>{const S=B(x),T=f.classifyNotification(S);T.type==="booking"&&o.booking++,T.type==="payment"&&o.payment++,T.type==="system"&&o.system++,f.isActiveRentalNotification(S)&&o.active_rentals++}),o})();return r?t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(P,{className:"h-8 w-32"}),t.jsx(P,{className:"h-8 w-8 rounded-full"})]}),t.jsx(P,{className:"h-10 w-full"}),t.jsx("div",{className:"space-y-3",children:[...Array(5)].map((o,x)=>t.jsx(P,{className:"h-20 w-full"},x))})]}),t.jsx(Y,{})]}):t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(A,{className:"h-6 w-6 text-primary"}),t.jsx("h1",{className:"text-2xl font-bold",children:"Notifications"}),e>0&&t.jsx(b,{variant:"destructive",className:"ml-2",children:e})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(J,{children:[t.jsx(Z,{asChild:!0,children:t.jsx(k,{variant:"outline",size:"sm",children:t.jsx(_e,{className:"h-4 w-4"})})}),t.jsxs(ee,{children:[t.jsx(te,{children:t.jsx(se,{children:"Notification Settings"})}),t.jsx("div",{className:"p-4",children:t.jsx("p",{className:"text-muted-foreground",children:"Notification preferences coming soon..."})})]})]}),e>0&&t.jsx(k,{onClick:m,variant:"outline",size:"sm",children:"Mark all read"})]})]}),t.jsx("div",{className:"mb-4",children:t.jsx(re,{placeholder:"Search notifications...",value:a,onChange:o=>l(o.target.value),className:"w-full"})}),t.jsxs(ie,{value:u,onValueChange:h,className:"w-full mb-6",children:[t.jsxs(ae,{className:"grid w-full grid-cols-5",children:[t.jsxs(C,{value:"all",className:"flex items-center gap-2",children:["All",t.jsx(b,{variant:"secondary",className:"text-xs",children:$.all})]}),t.jsxs(C,{value:"booking",className:"flex items-center gap-2",children:["Bookings",t.jsx(b,{variant:"secondary",className:"text-xs",children:$.booking})]}),t.jsxs(C,{value:"payment",className:"flex items-center gap-2",children:["Payments",t.jsx(b,{variant:"secondary",className:"text-xs",children:$.payment})]}),t.jsxs(C,{value:"active_rentals",className:"flex items-center gap-2",children:["Rentals",t.jsx(b,{variant:"secondary",className:"text-xs",children:$.active_rentals})]}),t.jsxs(C,{value:"system",className:"flex items-center gap-2",children:["System",t.jsx(b,{variant:"secondary",className:"text-xs",children:$.system})]})]}),t.jsx(ne,{value:u,className:"mt-4",children:t.jsxs("div",{className:"space-y-4",children:[v.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("h3",{className:"text-sm font-medium text-muted-foreground",children:["Unread (",v.length,")"]}),v.map(o=>t.jsx(V,{notification:B(o),onMarkAsRead:w,onDelete:j,onAcceptBooking:y,onDeclineBooking:D},`unread-${o.id}`))]}),N.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("h3",{className:"text-sm font-medium text-muted-foreground",children:["Read (",N.length,")"]}),N.map(o=>t.jsx(V,{notification:B(o),onMarkAsRead:w,onDelete:j,onAcceptBooking:y,onDeclineBooking:D},`read-${o.id}`))]}),g.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium mb-2",children:"No notifications found"}),t.jsx("p",{className:"text-muted-foreground",children:a?"Try adjusting your search terms":u==="all"?"You're all caught up!":`No ${u} notifications found`})]})]})})]})]}),t.jsx(Y,{})]})};export{Fe as default};
