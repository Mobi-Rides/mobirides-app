import{c as B,S as $e,aM as re,r as o,j as e,f as ze,O as He,W as ae,aN as Ye,C as qe,V as Xe,aO as We,T as Ge,D as Je,d as ie,P as Ke,R as Qe,b as L,ao as ne,aP as E,B as g,aI as Ze,g as _,I as R,J as j,x as X,y as W,m as le,p as q,k as Z,aQ as b,X as es,aR as D,aS as ss}from"./index-B1v-fdDy.js";import{C as w,d as C,a as A,b as k}from"./card-BByP0N-G.js";import{P as oe}from"./progress-BdAEPFoL.js";import{B as U}from"./badge-CMWgFMV2.js";import"./separator-BMDiheLN.js";import{I as ts}from"./info-BxQ4NhRw.js";import{U as ee,M as ce}from"./user-ClMVbWgE.js";import{A as M}from"./arrow-right-wlC4lylp.js";import{F as de}from"./file-text-25BybcTk.js";import{C as v}from"./circle-check-big-BC5npB6H.js";import{U as rs}from"./upload-BHCRT7r9.js";import{A as Y}from"./arrow-left-C5bMyyle.js";import{C as I}from"./circle-alert-B4G_r9SV.js";import{E as me}from"./eye-LbV3jpij.js";import{C as xe}from"./camera-BVx23dB2.js";import{R as as}from"./rotate-ccw-CZKC6MAN.js";import{P as K}from"./phone-C1RE3XPx.js";import{S as is}from"./send-BDkAZ2Oi.js";import{C as J}from"./clock-CASyaKu3.js";import{M as ue}from"./mail-DK2js5Ys.js";import{S as G}from"./shield-BbSxX3Ts.js";import{t as ns}from"./useVerificationStatus-BsTQxagy.js";import{S as he}from"./star-C2MEvl-w.js";import{C as se}from"./car-ggFPcI9D.js";import{U as te}from"./users-BmNgVsFF.js";import{C as ls}from"./calendar-D-otnCnk.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=B("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=B("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=B("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=B("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=B("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=B("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=B("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var pe="AlertDialog",[ps,jt]=$e(pe,[re]),O=re(),fe=r=>{const{__scopeAlertDialog:s,...t}=r,a=O(s);return e.jsx(Qe,{...a,...t,modal:!0})};fe.displayName=pe;var fs="AlertDialogTrigger",je=o.forwardRef((r,s)=>{const{__scopeAlertDialog:t,...a}=r,c=O(t);return e.jsx(ze,{...c,...a,ref:s})});je.displayName=fs;var js="AlertDialogPortal",ge=r=>{const{__scopeAlertDialog:s,...t}=r,a=O(s);return e.jsx(Ke,{...a,...t})};ge.displayName=js;var gs="AlertDialogOverlay",Ne=o.forwardRef((r,s)=>{const{__scopeAlertDialog:t,...a}=r,c=O(t);return e.jsx(He,{...c,...a,ref:s})});Ne.displayName=gs;var H="AlertDialogContent",[Ns,vs]=ps(H),ve=o.forwardRef((r,s)=>{const{__scopeAlertDialog:t,children:a,...c}=r,i=O(t),l=o.useRef(null),p=ae(s,l),m=o.useRef(null);return e.jsx(Ye,{contentName:H,titleName:be,docsSlug:"alert-dialog",children:e.jsx(Ns,{scope:t,cancelRef:m,children:e.jsxs(qe,{role:"alertdialog",...i,...c,ref:p,onOpenAutoFocus:Xe(c.onOpenAutoFocus,u=>{var x;u.preventDefault(),(x=m.current)==null||x.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[e.jsx(We,{children:a}),e.jsx(ys,{contentRef:l})]})})})});ve.displayName=H;var be="AlertDialogTitle",ye=o.forwardRef((r,s)=>{const{__scopeAlertDialog:t,...a}=r,c=O(t);return e.jsx(Ge,{...c,...a,ref:s})});ye.displayName=be;var we="AlertDialogDescription",Ce=o.forwardRef((r,s)=>{const{__scopeAlertDialog:t,...a}=r,c=O(t);return e.jsx(Je,{...c,...a,ref:s})});Ce.displayName=we;var bs="AlertDialogAction",Se=o.forwardRef((r,s)=>{const{__scopeAlertDialog:t,...a}=r,c=O(t);return e.jsx(ie,{...c,...a,ref:s})});Se.displayName=bs;var Pe="AlertDialogCancel",Ae=o.forwardRef((r,s)=>{const{__scopeAlertDialog:t,...a}=r,{cancelRef:c}=vs(Pe,t),i=O(t),l=ae(s,c);return e.jsx(ie,{...i,...a,ref:l})});Ae.displayName=Pe;var ys=({contentRef:r})=>{const s=`\`${H}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${H}\` by passing a \`${we}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${H}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return o.useEffect(()=>{var a;document.getElementById((a=r.current)==null?void 0:a.getAttribute("aria-describedby"))||console.warn(s)},[s,r]),null},ws=fe,Cs=je,Ss=ge,ke=Ne,De=ve,Te=Se,Ie=Ae,_e=ye,Re=Ce;const Ps=ws,As=Cs,ks=Ss,Ee=o.forwardRef(({className:r,...s},t)=>e.jsx(ke,{className:L("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s,ref:t}));Ee.displayName=ke.displayName;const Oe=o.forwardRef(({className:r,...s},t)=>e.jsxs(ks,{children:[e.jsx(Ee,{}),e.jsx(De,{ref:t,className:L("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...s})]}));Oe.displayName=De.displayName;const Ve=({className:r,...s})=>e.jsx("div",{className:L("flex flex-col space-y-2 text-center sm:text-left",r),...s});Ve.displayName="AlertDialogHeader";const Fe=({className:r,...s})=>e.jsx("div",{className:L("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...s});Fe.displayName="AlertDialogFooter";const Me=o.forwardRef(({className:r,...s},t)=>e.jsx(_e,{ref:t,className:L("text-lg font-semibold",r),...s}));Me.displayName=_e.displayName;const Le=o.forwardRef(({className:r,...s},t)=>e.jsx(Re,{ref:t,className:L("text-sm text-muted-foreground",r),...s}));Le.displayName=Re.displayName;const Ue=o.forwardRef(({className:r,...s},t)=>e.jsx(Te,{ref:t,className:L(ne(),r),...s}));Ue.displayName=Te.displayName;const Be=o.forwardRef(({className:r,...s},t)=>e.jsx(Ie,{ref:t,className:L(ne({variant:"outline"}),"mt-2 sm:mt-0",r),...s}));Be.displayName=Ie.displayName;const Ds=({onNext:r})=>{const{verificationData:s,updatePersonalInfo:t,isLoading:a,refreshFromProfile:c}=E(),[i,l]=o.useState({fullName:"",dateOfBirth:"",nationalIdNumber:"",phoneNumber:"",email:"",address:{street:"",area:"",city:"",postalCode:""}}),[p,m]=o.useState(!1),[u,x]=o.useState(!1);o.useEffect(()=>{var n,d,N,P;if(console.log("[PersonalInfoStep] Verification data updated:",s),s!=null&&s.personal_info){const y=s.personal_info;console.log("[PersonalInfoStep] Setting form data from personal_info:",y);const $={fullName:y.fullName||"",dateOfBirth:y.dateOfBirth||"",nationalIdNumber:y.nationalIdNumber||"",phoneNumber:y.phoneNumber||"",email:y.email||"",address:{street:((n=y.address)==null?void 0:n.street)||"",area:((d=y.address)==null?void 0:d.area)||"",city:((N=y.address)==null?void 0:N.city)||"",postalCode:((P=y.address)==null?void 0:P.postalCode)||""}};console.log("[PersonalInfoStep] New form data:",$),l($);const z=y.fullName||y.phoneNumber||y.email;console.log("[PersonalInfoStep] Has prefilled data:",z),m(!!z)}},[s]);const f=async n=>{if(n.preventDefault(),!i.fullName||!i.dateOfBirth||!i.nationalIdNumber){j.error("Please fill in all required fields");return}try{await t(i),j.success("Personal information saved successfully!"),r()}catch(d){console.error("Failed to save personal information:",d),j.error("Failed to save personal information")}},h=(n,d)=>{if(n.includes("address.")){const N=n.split(".")[1];l(P=>({...P,address:{...P.address,[N]:d}}))}else l(N=>({...N,[n]:d}))},S=async()=>{if(s!=null&&s.user_id)try{x(!0),console.log("[PersonalInfoStep] Refreshing from profile"),await c(),j.success("Profile data refreshed successfully!")}catch(n){console.error("Failed to refresh from profile:",n),j.error("Failed to refresh profile data")}finally{x(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Personal Information"}),e.jsx("p",{className:"text-muted-foreground",children:"Please provide your personal details for verification"})]}),e.jsx(w,{className:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950",children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ts,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:p?"Profile Data Available":"Import Profile Data"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:p?"Some fields have been pre-filled from your profile. You can refresh or update as needed.":"Click to import available data from your profile to speed up the process."}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:S,disabled:u,className:"text-blue-700 border-blue-300 hover:bg-blue-100 dark:text-blue-300 dark:border-blue-700 dark:hover:bg-blue-900",children:[e.jsx(Ze,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),u?"Refreshing...":"Refresh from Profile"]})]})]})})}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsx("span",{children:"Basic Information"})]})}),e.jsx(C,{children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"fullName",children:"Full Name *"}),e.jsx(R,{id:"fullName",value:i.fullName,onChange:n=>h("fullName",n.target.value),placeholder:"Enter your full name",required:!0})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"dateOfBirth",children:"Date of Birth *"}),e.jsx(R,{id:"dateOfBirth",type:"date",value:i.dateOfBirth,onChange:n=>h("dateOfBirth",n.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"nationalIdNumber",children:"National ID Number *"}),e.jsx(R,{id:"nationalIdNumber",value:i.nationalIdNumber,onChange:n=>h("nationalIdNumber",n.target.value),placeholder:"Enter your Omang number",required:!0})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(R,{id:"phoneNumber",type:"tel",value:i.phoneNumber,onChange:n=>h("phoneNumber",n.target.value),placeholder:"+267 XX XXX XXX"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"email",children:"Email Address"}),e.jsx(R,{id:"email",type:"email",value:i.email,onChange:n=>h("email",n.target.value),placeholder:"your.email@example.com"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Address Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"street",children:"Street Address"}),e.jsx(R,{id:"street",value:i.address.street,onChange:n=>h("address.street",n.target.value),placeholder:"Street address"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"area",children:"Area/Suburb"}),e.jsx(R,{id:"area",value:i.address.area,onChange:n=>h("address.area",n.target.value),placeholder:"Area or suburb"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"city",children:"City"}),e.jsx(R,{id:"city",value:i.address.city,onChange:n=>h("address.city",n.target.value),placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"postalCode",children:"Postal Code"}),e.jsx(R,{id:"postalCode",value:i.address.postalCode,onChange:n=>h("address.postalCode",n.target.value),placeholder:"Postal code"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-6",children:e.jsxs(g,{type:"submit",disabled:a,className:"flex items-center space-x-2",children:[e.jsx("span",{children:a?"Saving...":"Continue to Documents"}),e.jsx(M,{className:"h-4 w-4"})]})})]})})]})]})},Ts=({onNext:r,onPrevious:s})=>{const{isLoading:t}=E(),[a,c]=o.useState([]),i=[{id:"national_id_front",title:"National ID (Front)",description:"Front side of your Botswana National ID (Omang)"},{id:"national_id_back",title:"National ID (Back)",description:"Back side of your Botswana National ID (Omang)"},{id:"driving_license_front",title:"Driving License (Front)",description:"Front side of your valid driving license"},{id:"proof_of_address",title:"Proof of Address",description:"Utility bill or bank statement (max 3 months old)"}],l=(m,u)=>{setTimeout(()=>{c(x=>[...x,m]),j.success(`${u.name} uploaded successfully`)},1e3)},p=()=>{if(a.length<i.length){j.error("Please upload all required documents");return}r()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Document Upload"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload clear photos of your required documents"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(m=>e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"h-5 w-5"}),e.jsx("span",{children:m.title})]}),a.includes(m.id)&&e.jsx(v,{className:"h-5 w-5 text-green-500"})]})}),e.jsxs(C,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:m.description}),a.includes(m.id)?e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(v,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Document uploaded"})]}):e.jsxs("div",{children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:u=>{var f;const x=(f=u.target.files)==null?void 0:f[0];x&&l(m.id,x)},className:"hidden",id:`file-${m.id}`}),e.jsx("label",{htmlFor:`file-${m.id}`,className:"flex items-center justify-center w-full p-4 border-2 border-dashed border-muted-foreground/25 rounded-lg cursor-pointer hover:border-primary/50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(rs,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload or drag and drop"})]})})]})]})]},m.id))}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:s,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:p,disabled:t,children:[e.jsx("span",{children:"Continue to Selfie"}),e.jsx(M,{className:"h-4 w-4 ml-2"})]})]})]})},Is=({onCapture:r,onRetake:s,isCapturing:t,hasPhoto:a})=>e.jsx("div",{className:"flex justify-center space-x-4 mt-6",children:a?e.jsx("div",{className:"flex space-x-3",children:e.jsxs(g,{variant:"outline",onClick:s,className:"flex items-center space-x-2",children:[e.jsx(as,{className:"h-4 w-4"}),e.jsx("span",{children:"Retake"})]})}):e.jsxs(g,{onClick:r,disabled:t,size:"lg",className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-5 w-5"}),e.jsx("span",{children:t?"Capturing...":"Take Selfie"})]})}),_s=()=>e.jsxs(w,{className:"mb-6",children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center space-x-2 text-lg",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsx("span",{children:"Selfie Guidelines"})]})}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-green-600 flex items-center space-x-2",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:"Do This"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(me,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Look directly at the camera"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(us,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Have a neutral expression"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(v,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Ensure good lighting on your face"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(v,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Remove sunglasses and hats"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(v,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Face the camera directly"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-red-600 flex items-center space-x-2",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:"Avoid This"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't cover your face"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't take photos in dark lighting"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't blur the image"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't include other people"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't tilt your head significantly"})]})]})]})]})})]}),Rs=({onPhotoCapture:r,photoUrl:s,onRetake:t})=>{const a=o.useRef(null),c=o.useRef(null),[i,l]=o.useState(null),[p,m]=o.useState(!1),[u,x]=o.useState(!1),f=o.useCallback(async()=>{try{l(null);const d=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});a.current&&(a.current.srcObject=d,a.current.onloadedmetadata=()=>{x(!0)})}catch(d){console.error("Camera initialization error:",d),l("Unable to access camera. Please ensure camera permissions are granted.")}},[]),h=o.useCallback(()=>{var d;(d=a.current)!=null&&d.srcObject&&a.current.srcObject.getTracks().forEach(P=>P.stop())},[]),S=o.useCallback(async()=>{if(!(!a.current||!c.current||!u)){m(!0);try{const d=a.current,N=c.current,P=N.getContext("2d");if(!P)return;N.width=d.videoWidth,N.height=d.videoHeight,P.drawImage(d,0,0,N.width,N.height),N.toBlob(y=>{y&&(r(y),j.success("Selfie captured successfully!"))},"image/jpeg",.8)}catch(d){console.error("Photo capture error:",d),j.error("Failed to capture photo")}finally{m(!1)}}},[u,r]),n=o.useCallback(()=>{t(),u||f()},[t,u,f]);return o.useEffect(()=>(s||f(),h),[s,f,h]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden aspect-[4/3] max-w-md mx-auto",children:i?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-red-600 mb-4",children:i}),e.jsx(g,{onClick:f,size:"sm",children:"Try Again"})]})}):s?e.jsx("img",{src:s,alt:"Captured selfie",className:"w-full h-full object-cover"}):e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-48 h-48 border-2 border-white/50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-44 h-44 border border-white/30 rounded-full"})})}),e.jsx("div",{className:"absolute top-4 left-4 right-4",children:e.jsx("div",{className:"bg-black/50 text-white text-center py-2 px-4 rounded",children:e.jsx("p",{className:"text-sm",children:u?"Position your face in the circle":"Loading camera..."})})})]})})]})}),e.jsx("canvas",{ref:c,className:"hidden"}),e.jsx(Is,{onCapture:S,onRetake:n,isCapturing:p,hasPhoto:!!s})]})},Es=({onNext:r,onPrevious:s})=>{const{verificationData:t,completeSelfieVerification:a,isLoading:c}=E(),[i,l]=o.useState(null),[p,m]=o.useState(null),[u,x]=o.useState(!1),f=o.useCallback(d=>{l(d);const N=URL.createObjectURL(d);m(N)},[]),h=o.useCallback(()=>{p&&URL.revokeObjectURL(p),l(null),m(null)},[p]),S=async()=>{if(!i){j.error("Please take a selfie first");return}try{x(!0),await a(),j.success("Selfie verification completed!"),setTimeout(()=>{r()},1e3)}catch(d){console.error("Failed to submit selfie:",d),j.error("Failed to submit selfie verification")}finally{x(!1)}};return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Take Your Verification Selfie"}),e.jsx("p",{className:"text-muted-foreground",children:"We need to verify that you're the same person as in your ID documents"})]}),e.jsx(_s,{}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Capture Your Selfie"}),p&&e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),"Photo Captured"]})]})}),e.jsx(C,{children:e.jsx(Rs,{onPhotoCapture:f,photoUrl:p,onRetake:h})})]}),e.jsxs(X,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(W,{children:[e.jsx("strong",{children:"Privacy Notice:"})," Your selfie is used only for identity verification and is processed securely. We do not use your photo for any other purposes."]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:s,className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]}),e.jsxs(g,{onClick:S,disabled:!p||u||c,className:"flex items-center space-x-2",children:[e.jsx("span",{children:u?"Submitting...":"Continue to Phone Verification"}),e.jsx(M,{className:"h-4 w-4"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Camera Not Supported"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Your browser doesn't support camera access. Please use a modern browser or upload a selfie manually."}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(g,{variant:"outline",onClick:s,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:r,children:["Skip for Now",e.jsx(M,{className:"h-4 w-4 ml-2"})]})]})]})},Os=({onNext:r,onPrevious:s})=>{const{updatePhoneVerification:t,isLoading:a}=E(),[c,i]=o.useState(""),[l,p]=o.useState(""),[m,u]=o.useState(!1),[x,f]=o.useState(!1),h=async()=>{if(!c){j.error("Please enter your phone number");return}setTimeout(()=>{u(!0),j.success("Verification code sent to your phone")},1e3)},S=async()=>{if(!l){j.error("Please enter the verification code");return}l==="123456"||l.length===6?(f(!0),await t({phoneNumber:c,countryCode:"+267",verificationCode:l,isVerified:!0}),j.success("Phone number verified successfully!")):j.error("Invalid verification code")},n=()=>{if(!x){j.error("Please verify your phone number first");return}r()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Phone Verification"}),e.jsx("p",{className:"text-muted-foreground",children:"Verify your phone number to secure your account"})]}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"h-5 w-5"}),e.jsx("span",{children:"Phone Number Verification"})]})}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(R,{id:"phoneNumber",type:"tel",value:c,onChange:d=>i(d.target.value),placeholder:"+267 XX XXX XXX",disabled:m}),e.jsx(g,{onClick:h,disabled:m||!c,variant:"outline",children:m?"Code Sent":"Send Code"})]})]}),m&&!x&&e.jsxs("div",{children:[e.jsxs(_,{htmlFor:"verificationCode",children:[e.jsx(xs,{className:"h-4 w-4 inline mr-2"}),"Verification Code"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(R,{id:"verificationCode",value:l,onChange:d=>p(d.target.value),placeholder:"Enter 6-digit code",maxLength:6}),e.jsx(g,{onClick:S,disabled:!l,children:"Verify"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Enter the 6-digit code sent to your phone"})]}),x&&e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(K,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Phone number verified successfully!"})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:s,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:n,disabled:a||!x,children:[e.jsx("span",{children:"Continue to Address"}),e.jsx(M,{className:"h-4 w-4 ml-2"})]})]})]})},Vs=({onNext:r,onPrevious:s})=>{var u,x,f,h,S,n,d,N;const{verificationData:t,updateAddressConfirmation:a,isLoading:c}=E(),[i,l]=o.useState(!1),p=async()=>{var P;await a({currentAddress:((P=t==null?void 0:t.personal_info)==null?void 0:P.address)||{street:"",area:"",city:"",postalCode:""},confirmationMethod:"document",isConfirmed:!0,confirmationDate:new Date().toISOString()}),l(!0),j.success("Address confirmed successfully!")},m=()=>{if(!i){j.error("Please confirm your address first");return}r()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Address Confirmation"}),e.jsx("p",{className:"text-muted-foreground",children:"Confirm your residential address details"})]}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5"}),e.jsx("span",{children:"Residential Address"})]})}),e.jsxs(C,{className:"space-y-4",children:[e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Street:"})," ",((x=(u=t==null?void 0:t.personal_info)==null?void 0:u.address)==null?void 0:x.street)||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Area:"})," ",((h=(f=t==null?void 0:t.personal_info)==null?void 0:f.address)==null?void 0:h.area)||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"City:"})," ",((n=(S=t==null?void 0:t.personal_info)==null?void 0:S.address)==null?void 0:n.city)||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Postal Code:"})," ",((N=(d=t==null?void 0:t.personal_info)==null?void 0:d.address)==null?void 0:N.postalCode)||"Not provided"]})]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsx("p",{children:"Please confirm that the address above is correct. This address will be used for verification purposes and should match your proof of address document."})}),i?e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(v,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Address confirmed successfully!"})]}):e.jsxs(g,{onClick:p,className:"w-full",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Confirm Address"]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:s,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:m,disabled:c||!i,children:[e.jsx("span",{children:"Continue to Review"}),e.jsx(M,{className:"h-4 w-4 ml-2"})]})]})]})},Fs=({onNext:r,onPrevious:s})=>{var u,x,f;const{verificationData:t,submitForReview:a,isLoading:c}=E(),[i,l]=o.useState(!1),p=async()=>{try{l(!0),await a(),j.success("Verification submitted for review!"),r()}catch(h){console.error("Failed to submit verification:",h),j.error("Failed to submit verification")}finally{l(!1)}},m=[{title:"Personal Information",completed:!!((u=t==null?void 0:t.personal_info)!=null&&u.fullName),details:((x=t==null?void 0:t.personal_info)==null?void 0:x.fullName)||"Not completed"},{title:"Document Upload",completed:!0,details:"All required documents uploaded"},{title:"Selfie Verification",completed:!0,details:"Selfie photo captured"},{title:"Phone Verification",completed:!0,details:((f=t==null?void 0:t.personal_info)==null?void 0:f.phoneNumber)||"Phone verified"},{title:"Address Confirmation",completed:!0,details:"Address confirmed"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Review & Submit"}),e.jsx("p",{className:"text-muted-foreground",children:"Review your information before submitting for verification"})]}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsx(k,{children:"Verification Summary"})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-4",children:m.map((h,S)=>e.jsx("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(v,{className:`h-5 w-5 ${h.completed?"text-green-500":"text-gray-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.details})]})]})},S))})})]}),e.jsx(w,{children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"text-sm text-muted-foreground space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"What happens next?"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Your verification will be reviewed by our team"}),e.jsx("li",{children:"You'll receive email updates on the status"}),e.jsx("li",{children:"Processing typically takes 1-3 business days"}),e.jsx("li",{children:"You can check progress anytime in your profile"})]})]})})}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:s,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:p,disabled:c||i,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:i?"Submitting...":"Submit for Review"})]})]})]})},Ms=({title:r,description:s,icon:t,status:a,estimatedTime:c})=>{const i=()=>{switch(a){case"completed":return"text-green-600";case"in_progress":return"text-blue-600";default:return"text-gray-400"}},l=()=>{switch(a){case"completed":return e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),"Complete"]});case"in_progress":return e.jsxs(U,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"Processing"]});default:return e.jsx(U,{variant:"outline",children:"Pending"})}};return e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${a==="completed"?"bg-green-100":a==="in_progress"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx("div",{className:i(),children:t})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium",children:r}),l()]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s}),a==="in_progress"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm text-blue-600",children:"Processing..."})]}),c&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Estimated time: ",c]})]})]})]})},Ls=({onNext:r})=>{le();const{verificationData:s,refreshData:t}=E(),[a,c]=o.useState(25),[i,l]=o.useState(0);o.useState(!1);const p=[{title:"Document Review",description:"Our team is reviewing your uploaded documents for authenticity and completeness",icon:e.jsx(ds,{className:"h-5 w-5"}),estimatedTime:"2-4 hours"},{title:"Identity Verification",description:"Verifying your identity against official databases and cross-referencing documents",icon:e.jsx(hs,{className:"h-5 w-5"}),estimatedTime:"4-8 hours"},{title:"Address Confirmation",description:"Confirming your residential address and proof of address documents",icon:e.jsx(me,{className:"h-5 w-5"}),estimatedTime:"1-2 hours"},{title:"Final Approval",description:"Final review and approval of your verification application",icon:e.jsx(G,{className:"h-5 w-5"}),estimatedTime:"30 minutes"}];o.useEffect(()=>{const n=setInterval(()=>{c(d=>{const N=Math.min(d+8,100);return N>=25&&i<1&&l(1),N>=50&&i<2&&l(2),N>=75&&i<3&&l(3),N})},2e3);return()=>clearInterval(n)},[i]),o.useEffect(()=>{if(a>=100){const n=setTimeout(()=>{console.log("[ProcessingStatusStep] Auto-advancing to completion step"),r()},3e3);return()=>clearTimeout(n)}},[a,r]),o.useEffect(()=>{const n=setInterval(()=>{t()},1e4);return()=>clearInterval(n)},[t]);const m=n=>n<i?"completed":n===i?"in_progress":"pending",u=()=>{const n=new Date,d=Math.max(1,Math.ceil((100-a)/10));return new Date(n.getTime()+d*60*60*1e3).toLocaleString("en-BW",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},x=(s==null?void 0:s.overall_status)==="completed",[f]=q.useState(Date.now()),[h,S]=q.useState(!1);return q.useEffect(()=>{const n=setInterval(()=>{Date.now()-f>36e5&&S(!0)},6e4);return()=>clearInterval(n)},[f]),q.useEffect(()=>{if(x){const n=setTimeout(()=>{console.log("[ProcessingStatusStep] Verification already complete, advancing"),r()},1e3);return()=>clearTimeout(n)}},[x,r]),x?e.jsxs("div",{className:"text-center p-8",children:[e.jsx(v,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-700 mb-2",children:"Verification Complete!"}),e.jsx("p",{className:"text-muted-foreground",children:"Redirecting to completion step..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Verification in Progress"}),e.jsx("p",{className:"text-muted-foreground",children:"Your verification is being processed by our team"})]}),h&&e.jsxs("div",{className:"p-4 bg-yellow-100 border border-yellow-300 rounded text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," Verification processing is taking longer than usual. If you have any concerns, please contact our support team with your reference number."]}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Overall Progress"}),e.jsxs(U,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"Processing"]})]})}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Verification Progress"}),e.jsxs("span",{children:[a,"%"]})]}),e.jsx(oe,{value:a,className:"h-3"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Estimated Completion"}),e.jsx("p",{className:"text-muted-foreground",children:u()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Reference Number"}),e.jsx("p",{className:"text-muted-foreground font-mono",children:s!=null&&s.user_id?`VER-${s.user_id.slice(-8).toUpperCase()}`:"Generating..."})]})]})]})]}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsx(k,{children:"Processing Stages"})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-4",children:p.map((n,d)=>e.jsx(Ms,{title:n.title,description:n.description,icon:n.icon,status:m(d),estimatedTime:m(d)==="in_progress"?n.estimatedTime:void 0},d))})})]}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"h-5 w-5"}),e.jsx("span",{children:"Status Updates"})]})}),e.jsx(C,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(v,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-700",children:"Verification Submitted"}),e.jsx("p",{className:"text-sm text-green-600",children:s!=null&&s.created_at?new Date(s.created_at).toLocaleString():"Just now"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-700",children:"Review in Progress"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Our verification team is currently reviewing your documents"})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(X,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(W,{children:[e.jsx("strong",{children:"What happens next?"})," You'll receive email notifications for any status updates. You can close this page and return anytime to check progress."]})]}),e.jsxs(X,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(W,{children:[e.jsx("strong",{children:"Need help?"})," If you have questions about your verification, contact our support team with your reference number."]})]})]}),!1]})},Us=({verificationData:r})=>{const s=r!=null&&r.user_id?`VER-${r.user_id.slice(-8).toUpperCase()}`:"Unknown",t=r!=null&&r.completed_at?new Date(r.completed_at).toLocaleDateString():new Date().toLocaleDateString(),a=()=>{navigator.clipboard.writeText(s),j.success("Verification ID copied to clipboard")};return e.jsxs(w,{className:"border-green-200 bg-green-50",children:[e.jsxs(A,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"h-16 w-16 text-green-600 mx-auto"}),e.jsx(v,{className:"h-6 w-6 text-green-600 absolute -bottom-1 -right-1 bg-white rounded-full"})]})}),e.jsx(k,{className:"text-green-700",children:"Verification Complete!"})]}),e.jsx(C,{className:"space-y-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700 mb-4",children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),"Verified User"]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Verification ID"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("code",{className:"text-green-600 font-mono",children:s}),e.jsx(g,{variant:"ghost",size:"icon",onClick:a,className:"h-6 w-6",children:e.jsx(os,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Completion Date"}),e.jsx("p",{className:"text-green-600",children:t})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"User Role"}),e.jsx("p",{className:"text-green-600 capitalize",children:(r==null?void 0:r.user_role)||"Renter"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Status"}),e.jsx("p",{className:"text-green-600",children:"Active"})]})]})]})]})})]})},Bs=({userRole:r})=>{const s=Z(),c=r==="host"?[{title:"Add Your First Car",description:"List your vehicle and start earning",icon:e.jsx(se,{className:"h-5 w-5 text-blue-500"}),action:()=>s("/add-car"),buttonText:"Add Car"},{title:"Set Up Hosting Profile",description:"Complete your hosting profile and preferences",icon:e.jsx(te,{className:"h-5 w-5 text-purple-500"}),action:()=>s("/profile"),buttonText:"Setup Profile"},{title:"View Dashboard",description:"Monitor your bookings and earnings",icon:e.jsx(he,{className:"h-5 w-5 text-orange-500"}),action:()=>s("/dashboard"),buttonText:"Open Dashboard"}]:[{title:"Browse Available Cars",description:"Explore cars available for rent in your area",icon:e.jsx(se,{className:"h-5 w-5 text-blue-500"}),action:()=>s("/"),buttonText:"Browse Cars"},{title:"Complete Your Profile",description:"Add a profile photo and additional details",icon:e.jsx(te,{className:"h-5 w-5 text-purple-500"}),action:()=>s("/profile"),buttonText:"Edit Profile"},{title:"Make Your First Booking",description:"Find and book your first rental car",icon:e.jsx(ls,{className:"h-5 w-5 text-green-500"}),action:()=>s("/"),buttonText:"Start Booking"}];return e.jsxs(w,{children:[e.jsx(A,{children:e.jsx(k,{children:"What's Next?"})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-4",children:c.map((i,l)=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:i.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium mb-1",children:i.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:i.description}),e.jsxs(g,{onClick:i.action,size:"sm",className:"flex items-center space-x-2",children:[e.jsx("span",{children:i.buttonText}),e.jsx(M,{className:"h-3 w-3"})]})]})]},l))})})]})},$s=()=>{const{verificationData:r}=E(),s=Z();if(q.useEffect(()=>{ns();const i=sessionStorage.getItem("verification_return_context");if(i)try{const l=JSON.parse(i);console.log("[CompletionStep] Found return context:",l),sessionStorage.removeItem("verification_return_context"),setTimeout(()=>{if(l.action==="booking"&&l.carData){const p=l.carData.id||l.carData.car_id;s(`/cars/${p}`),j.success("Verification complete! You can now book this car.")}else l.action==="listing"?(s("/add-car"),j.success("Verification complete! You can now list your vehicle.")):s("/")},3e3)}catch(l){console.error("[CompletionStep] Failed to parse return context:",l)}},[s]),!r)return e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No verification data found"})});const t=()=>{r.user_role==="host"?s("/dashboard"):s("/")},a=()=>{j.success("Certificate download started (Feature coming soon)")},c=r.user_role==="host"?"host":"renter";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"mx-auto mb-6",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"animate-bounce",children:e.jsx(v,{className:"h-20 w-20 text-green-500 mx-auto"})})})}),e.jsx("h1",{className:"text-3xl font-bold text-green-700 mb-2",children:"🎉 Verification Complete!"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Welcome to MobiRides! Your identity has been successfully verified."})]}),e.jsx(Us,{verificationData:r}),e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(he,{className:"h-5 w-5 text-orange-500"}),e.jsx("span",{children:"Your Verification Benefits"})]})}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(v,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Trusted Member Badge"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show other users you're verified"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(v,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Full Platform Access"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Book cars and access all features"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(v,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Priority Support"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get faster help when needed"})]})]}),r.user_role==="host"&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(v,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Host Privileges"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"List cars and start earning"})]})]})]})]})})]}),e.jsx(Bs,{userRole:c}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(X,{children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsxs(W,{children:[e.jsx("strong",{children:"Email Confirmation:"})," A verification certificate has been sent to your email address. Keep this for your records."]})]}),e.jsxs(X,{children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs(W,{children:[e.jsx("strong",{children:"Security Notice:"})," Your verification is valid indefinitely. Contact support if you need to update any verified information."]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[e.jsxs(g,{onClick:a,variant:"outline",className:"flex items-center space-x-2 flex-1",children:[e.jsx(cs,{className:"h-4 w-4"}),e.jsx("span",{children:"Download Certificate"})]}),e.jsxs(g,{onClick:t,className:"flex items-center space-x-2 flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx("span",{children:r.user_role==="host"?"Go to Dashboard":"Start Using MobiRides"}),e.jsx(M,{className:"h-4 w-4"})]})]}),!1]})},Q={[b.PERSONAL_INFO]:{title:"Personal Information",description:"Provide your basic details",icon:ee,component:Ds},[b.DOCUMENT_UPLOAD]:{title:"Document Upload",description:"Upload required documents",icon:de,component:Ts},[b.SELFIE_VERIFICATION]:{title:"Selfie Verification",description:"Take a verification selfie",icon:xe,component:Es},[b.PHONE_VERIFICATION]:{title:"Phone Verification",description:"Verify your phone number",icon:K,component:Os},[b.ADDRESS_CONFIRMATION]:{title:"Address Confirmation",description:"Confirm your address",icon:ce,component:Vs},[b.REVIEW_SUBMIT]:{title:"Review & Submit",description:"Review and submit verification",icon:v,component:Fs},[b.PROCESSING_STATUS]:{title:"Processing",description:"Verification in progress",icon:J,component:Ls},[b.COMPLETION]:{title:"Completed",description:"Verification complete",icon:G,component:$s}},zs=({currentStep:r,stepStatuses:s,onStepClick:t,canNavigateToStep:a})=>{const c=Object.values(b);return e.jsx("div",{className:"w-full mb-8",children:e.jsx("div",{className:"flex items-center justify-between mb-4",children:c.map((i,l)=>{const p=Q[i],m=p.icon,u=s[i],x=i===r,f=u===D.COMPLETED,h=a(i);return e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(g,{variant:x?"default":f?"secondary":"outline",size:"icon",className:`
                    relative h-12 w-12 rounded-full mb-2
                    ${x?"ring-2 ring-primary ring-offset-2":""}
                    ${f?"bg-green-500 hover:bg-green-600":""}
                    ${!h&&!x&&!f?"opacity-50 cursor-not-allowed":""}
                  `,onClick:()=>h&&t(i),disabled:!h&&!x&&!f,children:[f?e.jsx(v,{className:"h-6 w-6 text-white"}):e.jsx(m,{className:`h-6 w-6 ${x?"text-white":""}`}),e.jsx(U,{variant:"secondary",className:"absolute -top-2 -right-2 h-5 w-5 p-0 text-xs",children:l+1})]}),e.jsxs("div",{className:"text-center max-w-[80px]",children:[e.jsx("p",{className:`text-xs font-medium ${x?"text-primary":"text-muted-foreground"}`,children:p.title}),e.jsx("p",{className:"text-xs text-muted-foreground hidden sm:block",children:p.description})]})]}),l<c.length-1&&e.jsx("div",{className:`
                  flex-1 h-0.5 mx-2 mb-8
                  ${f?"bg-green-500":"bg-muted"}
                `})]},i)})})})},Hs=()=>{const{user:r}=le(),s=Z(),{verificationData:t,isLoading:a,error:c,isInitialized:i,initializeVerification:l,navigateToStep:p,canNavigateToStep:m,getStepProgress:u,resetVerification:x}=E();o.useState(!1);const[f,h]=o.useState(!1);o.useEffect(()=>{if(!(r!=null&&r.id)){console.log("[VerificationHub] No user ID available");return}if(i||a||t)return;(async()=>{var V;try{const F=((V=r.user_metadata)==null?void 0:V.role)||"renter";console.log("[VerificationHub] Initializing verification for user:",r.id,"Role:",F),await l(r.id,F)}catch(F){console.error("[VerificationHub] Failed to initialize verification:",F),j.error("Failed to initialize verification process")}})()},[r==null?void 0:r.id,i,a,t,l]);const S=T=>{if(!m(T)){j.error("Please complete the previous steps first");return}p(T)},n=()=>{if(!t)return;const T=Object.values(b),V=T.indexOf(t.current_step);if(V<T.length-1){const F=T[V+1];S(F)}},d=()=>{if(!t)return;const T=Object.values(b),V=T.indexOf(t.current_step);if(V>0){const F=T[V-1];p(F)}},N=()=>{j.info("Verification canceled. You can resume anytime from your profile."),s("/")},P=()=>{s("/")},y=()=>{if(!t)return null;const T=Q[t.current_step].component;return e.jsx(T,{onNext:n,onPrevious:d})};if(c)return e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",style:{backgroundColor:"#020817"},children:e.jsxs(w,{className:"w-full max-w-md",children:[e.jsxs(A,{className:"text-center",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx(k,{className:"text-red-600",children:"Verification Error"})]}),e.jsxs(C,{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:c}),e.jsx(g,{onClick:()=>window.location.reload(),children:"Try Again"})]})]})});if(a||!t)return e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",style:{backgroundColor:"#020817"},children:e.jsx(w,{className:"w-full max-w-md",children:e.jsxs(C,{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Initializing verification..."})]})})});const $=u(),z=Q[t.current_step];return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#020817"},children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6 p-4 bg-white/10 rounded-lg border border-white/20",children:[e.jsxs(g,{variant:"outline",onClick:P,className:"flex items-center gap-2 bg-white/90 hover:bg-white text-gray-900",children:[e.jsx(ms,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to Home"}),e.jsx("span",{className:"sm:hidden",children:"Home"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white/80 text-sm",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Secure verification process"}),e.jsx("span",{className:"sm:hidden",children:"Secure process"})]}),e.jsxs(Ps,{open:f,onOpenChange:h,children:[e.jsx(As,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:"flex items-center gap-2 bg-white/90 hover:bg-white text-gray-900 border-red-200 hover:border-red-300",children:[e.jsx(es,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Cancel Verification"}),e.jsx("span",{className:"sm:hidden",children:"Cancel"})]})}),e.jsxs(Oe,{children:[e.jsxs(Ve,{children:[e.jsx(Me,{children:"Cancel Verification?"}),e.jsx(Le,{children:"Are you sure you want to cancel the verification process? Your progress will be saved and you can resume later from your profile."})]}),e.jsxs(Fe,{children:[e.jsx(Be,{children:"Continue Verification"}),e.jsx(Ue,{onClick:N,children:"Yes, Cancel"})]})]})]})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Identity Verification"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"Complete your verification to start using MobiRides"}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[$.completed," of ",$.total," steps"]})]}),e.jsx(oe,{value:$.percentage,className:"h-2"})]})]}),e.jsx(zs,{currentStep:t.current_step,stepStatuses:{[b.PERSONAL_INFO]:t.personal_info_completed?D.COMPLETED:D.NOT_STARTED,[b.DOCUMENT_UPLOAD]:t.documents_completed?D.COMPLETED:D.NOT_STARTED,[b.SELFIE_VERIFICATION]:t.selfie_completed?D.COMPLETED:D.NOT_STARTED,[b.PHONE_VERIFICATION]:t.phone_verified?D.COMPLETED:D.NOT_STARTED,[b.ADDRESS_CONFIRMATION]:t.address_confirmed?D.COMPLETED:D.NOT_STARTED,[b.REVIEW_SUBMIT]:D.NOT_STARTED,[b.PROCESSING_STATUS]:D.NOT_STARTED,[b.COMPLETION]:D.NOT_STARTED},onStepClick:S,canNavigateToStep:m}),e.jsxs(w,{className:"mb-8",children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z.icon,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{children:[e.jsx(k,{children:z.title}),e.jsx("p",{className:"text-muted-foreground",children:z.description})]})]})}),e.jsx(C,{children:y()})]}),!1]})})},gt=()=>e.jsx(ss,{children:e.jsx(Hs,{})});export{gt as default};
