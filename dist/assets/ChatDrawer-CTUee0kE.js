import{ar as o,O as Tt,C as Dt,f as Et,d as Ct,T as Ot,D as Nt,r as W,R as $t,P as At,j as w,b as oe,B as be,X as Mt,q as Pt,s as Z}from"./index-BAM2AQzj.js";import{A as jt,a as _t,b as It}from"./avatar-A32ilikL.js";import{C as kt,a as Ht}from"./chevron-right-DpKt2Wag.js";import{T as Lt}from"./textarea-D1hXqD0k.js";import{S as Bt}from"./send-CyKCJr7A.js";import{S as Ut}from"./scroll-area-C8WYL-tw.js";function zt(e){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",n.appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}const qe=o.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),ie=()=>{const e=o.useContext(qe);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};zt(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const Ft=24,Wt=typeof window<"u"?W.useLayoutEffect:W.useEffect;function Fe(...e){return(...n)=>{for(let t of e)typeof t=="function"&&t(...n)}}function Vt(){return Pe(/^Mac/)}function Yt(){return Pe(/^iPhone/)}function We(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function qt(){return Pe(/^iPad/)||Vt()&&navigator.maxTouchPoints>1}function Xe(){return Yt()||qt()}function Pe(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const Ce=typeof document<"u"&&window.visualViewport;function Ve(e){let n=window.getComputedStyle(e);return/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY)}function Ke(e){for(Ve(e)&&(e=e.parentElement);e&&!Ve(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const Xt=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let ve=0,Oe;function Kt(e={}){let{isDisabled:n}=e;Wt(()=>{if(!n)return ve++,ve===1&&Xe()&&(Oe=Gt()),()=>{ve--,ve===0&&(Oe==null||Oe())}},[n])}function Gt(){let e,n=0,t=h=>{e=Ke(h.target),!(e===document.documentElement&&e===document.body)&&(n=h.changedTouches[0].pageY)},r=h=>{if(!e||e===document.documentElement||e===document.body){h.preventDefault();return}let g=h.changedTouches[0].pageY,j=e.scrollTop,k=e.scrollHeight-e.clientHeight;k!==0&&((j<=0&&g>n||j>=k&&g<n)&&h.preventDefault(),n=g)},i=h=>{let g=h.target;Ae(g)&&g!==document.activeElement&&(h.preventDefault(),g.style.transform="translateY(-2000px)",g.focus(),requestAnimationFrame(()=>{g.style.transform=""}))},a=h=>{let g=h.target;Ae(g)&&(g.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{g.style.transform="",Ce&&(Ce.height<window.innerHeight?requestAnimationFrame(()=>{Ye(g)}):Ce.addEventListener("resize",()=>Ye(g),{once:!0}))}))},f=()=>{window.scrollTo(0,0)},d=window.pageXOffset,y=window.pageYOffset,R=Fe(Jt(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let v=Fe(fe(document,"touchstart",t,{passive:!1,capture:!0}),fe(document,"touchmove",r,{passive:!1,capture:!0}),fe(document,"touchend",i,{passive:!1,capture:!0}),fe(document,"focus",a,!0),fe(window,"scroll",f));return()=>{R(),v(),window.scrollTo(d,y)}}function Jt(e,n,t){let r=e.style[n];return e.style[n]=t,()=>{e.style[n]=r}}function fe(e,n,t,r){return e.addEventListener(n,t,r),()=>{e.removeEventListener(n,t,r)}}function Ye(e){let n=document.scrollingElement||document.documentElement;for(;e&&e!==n;){let t=Ke(e);if(t!==document.documentElement&&t!==document.body&&t!==e){let r=t.getBoundingClientRect().top,i=e.getBoundingClientRect().top,a=e.getBoundingClientRect().bottom;const f=t.getBoundingClientRect().bottom+Ft;a>f&&(t.scrollTop+=i-r)}e=t.parentElement}}function Ae(e){return e instanceof HTMLInputElement&&!Xt.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function Qt(e,n){typeof e=="function"?e(n):e!=null&&(e.current=n)}function Zt(...e){return n=>e.forEach(t=>Qt(t,n))}function Ge(...e){return W.useCallback(Zt(...e),e)}const Je=new WeakMap;function M(e,n,t=!1){if(!e||!(e instanceof HTMLElement))return;let r={};Object.entries(n).forEach(([i,a])=>{if(i.startsWith("--")){e.style.setProperty(i,a);return}r[i]=e.style[i],e.style[i]=a}),!t&&Je.set(e,r)}function en(e,n){if(!e||!(e instanceof HTMLElement))return;let t=Je.get(e);t&&(e.style[n]=t[n])}const P=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function ye(e,n){if(!e)return null;const t=window.getComputedStyle(e),r=t.transform||t.webkitTransform||t.mozTransform;let i=r.match(/^matrix3d\((.+)\)$/);return i?parseFloat(i[1].split(", ")[P(n)?13:12]):(i=r.match(/^matrix\((.+)\)$/),i?parseFloat(i[1].split(", ")[P(n)?5:4]):null)}function tn(e){return 8*(Math.log(e+1)-2)}function Ne(e,n){if(!e)return()=>{};const t=e.style.cssText;return Object.assign(e.style,n),()=>{e.style.cssText=t}}function nn(...e){return(...n)=>{for(const t of e)typeof t=="function"&&t(...n)}}const O={DURATION:.5,EASE:[.32,.72,0,1]},Qe=.4,rn=.25,an=100,Ze=8,ne=16,Me=26,$e="vaul-dragging";function et(e){const n=o.useRef(e);return o.useEffect(()=>{n.current=e}),o.useMemo(()=>(...t)=>n.current==null?void 0:n.current.call(n,...t),[])}function on({defaultProp:e,onChange:n}){const t=o.useState(e),[r]=t,i=o.useRef(r),a=et(n);return o.useEffect(()=>{i.current!==r&&(a(r),i.current=r)},[r,i,a]),t}function tt({prop:e,defaultProp:n,onChange:t=()=>{}}){const[r,i]=on({defaultProp:n,onChange:t}),a=e!==void 0,f=a?e:r,d=et(t),y=o.useCallback(R=>{if(a){const h=typeof R=="function"?R(e):R;h!==e&&d(h)}else i(R)},[a,e,i,d]);return[f,y]}function sn({activeSnapPointProp:e,setActiveSnapPointProp:n,snapPoints:t,drawerRef:r,overlayRef:i,fadeFromIndex:a,onSnapPointChange:f,direction:d="bottom",container:y,snapToSequentialPoint:R}){const[v,h]=tt({prop:e,defaultProp:t==null?void 0:t[0],onChange:n}),[g,j]=o.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);o.useEffect(()=>{function p(){j({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]);const k=o.useMemo(()=>v===(t==null?void 0:t[t.length-1])||null,[t,v]),T=o.useMemo(()=>t==null?void 0:t.findIndex(p=>p===v),[t,v]),B=t&&t.length>0&&(a||a===0)&&!Number.isNaN(a)&&t[a]===v||!t,c=o.useMemo(()=>{const p=y?{width:y.getBoundingClientRect().width,height:y.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var D;return(D=t==null?void 0:t.map(b=>{const H=typeof b=="string";let l=0;if(H&&(l=parseInt(b,10)),P(d)){const _=H?l:g?b*p.height:0;return g?d==="bottom"?p.height-_:-p.height+_:_}const I=H?l:g?b*p.width:0;return g?d==="right"?p.width-I:-p.width+I:I}))!=null?D:[]},[t,g,y]),$=o.useMemo(()=>T!==null?c==null?void 0:c[T]:null,[c,T]),A=o.useCallback(p=>{var D;const b=(D=c==null?void 0:c.findIndex(H=>H===p))!=null?D:null;f(b),M(r.current,{transition:`transform ${O.DURATION}s cubic-bezier(${O.EASE.join(",")})`,transform:P(d)?`translate3d(0, ${p}px, 0)`:`translate3d(${p}px, 0, 0)`}),c&&b!==c.length-1&&b!==a&&b<a?M(i.current,{transition:`opacity ${O.DURATION}s cubic-bezier(${O.EASE.join(",")})`,opacity:"0"}):M(i.current,{transition:`opacity ${O.DURATION}s cubic-bezier(${O.EASE.join(",")})`,opacity:"1"}),h(t==null?void 0:t[Math.max(b,0)])},[r.current,t,c,a,i,h]);o.useEffect(()=>{if(v||e){var p;const D=(p=t==null?void 0:t.findIndex(b=>b===e||b===v))!=null?p:-1;c&&D!==-1&&typeof c[D]=="number"&&A(c[D])}},[v,e,t,c,A]);function s({draggedDistance:p,closeDrawer:D,velocity:b,dismissible:H}){if(a===void 0)return;const l=d==="bottom"||d==="right"?($??0)-p:($??0)+p,I=T===a-1,_=T===0,U=p>0;if(I&&M(i.current,{transition:`opacity ${O.DURATION}s cubic-bezier(${O.EASE.join(",")})`}),!R&&b>2&&!U){H?D():A(c[0]);return}if(!R&&b>2&&U&&c&&t){A(c[t.length-1]);return}const z=c==null?void 0:c.reduce((F,ee)=>typeof F!="number"||typeof ee!="number"?F:Math.abs(ee-l)<Math.abs(F-l)?ee:F),J=P(d)?window.innerHeight:window.innerWidth;if(b>Qe&&Math.abs(p)<J*.4){const F=U?1:-1;if(F>0&&k){A(c[t.length-1]);return}if(_&&F<0&&H&&D(),T===null)return;A(c[T+F]);return}A(z)}function N({draggedDistance:p}){if($===null)return;const D=d==="bottom"||d==="right"?$-p:$+p;(d==="bottom"||d==="right")&&D<c[c.length-1]||(d==="top"||d==="left")&&D>c[c.length-1]||M(r.current,{transform:P(d)?`translate3d(0, ${D}px, 0)`:`translate3d(${D}px, 0, 0)`})}function Y(p,D){if(!t||typeof T!="number"||!c||a===void 0)return null;const b=T===a-1;if(T>=a&&D)return 0;if(b&&!D)return 1;if(!B&&!b)return null;const l=b?T+1:T-1,I=b?c[l]-c[l-1]:c[l+1]-c[l],_=p/Math.abs(I);return b?1-_:_}return{isLastSnapPoint:k,activeSnapPoint:v,shouldFade:B,getPercentageDragged:Y,setActiveSnapPoint:h,activeSnapPointIndex:T,onRelease:s,onDrag:N,snapPointsOffset:c}}const ln=()=>()=>{};function un(){const{direction:e,isOpen:n,shouldScaleBackground:t,setBackgroundColorOnScale:r,noBodyStyles:i}=ie(),a=o.useRef(null),f=W.useMemo(()=>document.body.style.backgroundColor,[]);function d(){return(window.innerWidth-Me)/window.innerWidth}o.useEffect(()=>{if(n&&t){a.current&&clearTimeout(a.current);const y=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!y)return;nn(r&&!i?Ne(document.body,{background:"black"}):ln,Ne(y,{transformOrigin:P(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${O.DURATION}s`,transitionTimingFunction:`cubic-bezier(${O.EASE.join(",")})`}));const R=Ne(y,{borderRadius:`${Ze}px`,overflow:"hidden",...P(e)?{transform:`scale(${d()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${d()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{R(),a.current=window.setTimeout(()=>{f?document.body.style.background=f:document.body.style.removeProperty("background")},O.DURATION*1e3)}}},[n,t,f])}let me=null;function cn({isOpen:e,modal:n,nested:t,hasBeenOpened:r,preventScrollRestoration:i,noBodyStyles:a}){const[f,d]=o.useState(()=>typeof window<"u"?window.location.href:""),y=o.useRef(0),R=o.useCallback(()=>{if(We()&&me===null&&e&&!a){me={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:h,innerHeight:g}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-y.current}px`,left:`${-h}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const j=g-window.innerHeight;j&&y.current>=g&&(document.body.style.top=`${-(y.current+j)}px`)}),300)}},[e]),v=o.useCallback(()=>{if(We()&&me!==null&&!a){const h=-parseInt(document.body.style.top,10),g=-parseInt(document.body.style.left,10);Object.assign(document.body.style,me),window.requestAnimationFrame(()=>{if(i&&f!==window.location.href){d(window.location.href);return}window.scrollTo(g,h)}),me=null}},[f]);return o.useEffect(()=>{function h(){y.current=window.scrollY}return h(),window.addEventListener("scroll",h),()=>{window.removeEventListener("scroll",h)}},[]),o.useEffect(()=>{t||!r||(e?(!window.matchMedia("(display-mode: standalone)").matches&&R(),n||window.setTimeout(()=>{v()},500)):v())},[e,r,f,n,t,R,v]),{restorePositionSetting:v}}function nt({open:e,onOpenChange:n,children:t,onDrag:r,onRelease:i,snapPoints:a,shouldScaleBackground:f=!1,setBackgroundColorOnScale:d=!0,closeThreshold:y=rn,scrollLockTimeout:R=an,dismissible:v=!0,handleOnly:h=!1,fadeFromIndex:g=a&&a.length-1,activeSnapPoint:j,setActiveSnapPoint:k,fixed:T,modal:B=!0,onClose:c,nested:$,noBodyStyles:A,direction:s="bottom",defaultOpen:N=!1,disablePreventScroll:Y=!0,snapToSequentialPoint:p=!1,preventScrollRestoration:D=!1,repositionInputs:b=!0,onAnimationEnd:H,container:l,autoFocus:I=!1}){var _,U;const[z=!1,J]=tt({defaultProp:N,prop:e,onChange:u=>{n==null||n(u),!u&&!$&&gt(),setTimeout(()=>{H==null||H(u)},O.DURATION*1e3),u&&!B&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),u||(document.body.style.pointerEvents="auto")}}),[F,ee]=o.useState(!1),[se,xe]=o.useState(!1),[ct,je]=o.useState(!1),re=o.useRef(null),pe=o.useRef(null),Se=o.useRef(null),Re=o.useRef(null),he=o.useRef(null),le=o.useRef(!1),Te=o.useRef(null),De=o.useRef(0),ae=o.useRef(!1),_e=o.useRef(0),m=o.useRef(null),Ie=o.useRef(((_=m.current)==null?void 0:_.getBoundingClientRect().height)||0),ke=o.useRef(((U=m.current)==null?void 0:U.getBoundingClientRect().width)||0),Ee=o.useRef(0),dt=o.useCallback(u=>{a&&u===ce.length-1&&(pe.current=new Date)},[]),{activeSnapPoint:ft,activeSnapPointIndex:ue,setActiveSnapPoint:He,onRelease:mt,snapPointsOffset:ce,onDrag:pt,shouldFade:Le,getPercentageDragged:ht}=sn({snapPoints:a,activeSnapPointProp:j,setActiveSnapPointProp:k,drawerRef:m,fadeFromIndex:g,overlayRef:re,onSnapPointChange:dt,direction:s,container:l,snapToSequentialPoint:p});Kt({isDisabled:!z||se||!B||ct||!F||!b||!Y});const{restorePositionSetting:gt}=cn({isOpen:z,modal:B,nested:$,hasBeenOpened:F,preventScrollRestoration:D,noBodyStyles:A});function ge(){return(window.innerWidth-Me)/window.innerWidth}function wt(u){var x,E;!v&&!a||m.current&&!m.current.contains(u.target)||(Ie.current=((x=m.current)==null?void 0:x.getBoundingClientRect().height)||0,ke.current=((E=m.current)==null?void 0:E.getBoundingClientRect().width)||0,xe(!0),Se.current=new Date,Xe()&&window.addEventListener("touchend",()=>le.current=!1,{once:!0}),u.target.setPointerCapture(u.pointerId),De.current=P(s)?u.pageY:u.pageX)}function Be(u,x){var E,C;let S=u;const q=(E=window.getSelection())==null?void 0:E.toString(),L=m.current?ye(m.current,s):null,V=new Date;if(S.hasAttribute("data-vaul-no-drag")||S.closest("[data-vaul-no-drag]"))return!1;if(s==="right"||s==="left")return!0;if(pe.current&&V.getTime()-pe.current.getTime()<500)return!1;if(L!==null&&(s==="bottom"?L>0:L<0))return!0;if(q&&q.length>0)return!1;if(V.getTime()-((C=he.current)==null?void 0:C.getTime())<R&&L===0||x)return he.current=V,!1;for(;S;){if(S.scrollHeight>S.clientHeight){if(S.scrollTop!==0)return he.current=new Date,!1;if(S.getAttribute("role")==="dialog")return!0}S=S.parentNode}return!0}function vt(u){if(m.current&&se){const x=s==="bottom"||s==="right"?1:-1,E=(De.current-(P(s)?u.pageY:u.pageX))*x,C=E>0,S=a&&!v&&!C;if(S&&ue===0)return;const q=Math.abs(E),L=document.querySelector("[data-vaul-drawer-wrapper]"),V=s==="bottom"||s==="top"?Ie.current:ke.current;let X=q/V;const te=ht(q,C);if(te!==null&&(X=te),S&&X>=1||!le.current&&!Be(u.target,C))return;if(m.current.classList.add($e),le.current=!0,M(m.current,{transition:"none"}),M(re.current,{transition:"none"}),a&&pt({draggedDistance:E}),C&&!a){const K=tn(E),we=Math.min(K*-1,0)*x;M(m.current,{transform:P(s)?`translate3d(0, ${we}px, 0)`:`translate3d(${we}px, 0, 0)`});return}const Q=1-X;if((Le||g&&ue===g-1)&&(r==null||r(u,X),M(re.current,{opacity:`${Q}`,transition:"none"},!0)),L&&re.current&&f){const K=Math.min(ge()+X*(1-ge()),1),we=8-X*8,ze=Math.max(0,14-X*14);M(L,{borderRadius:`${we}px`,transform:P(s)?`scale(${K}) translate3d(0, ${ze}px, 0)`:`scale(${K}) translate3d(${ze}px, 0, 0)`,transition:"none"},!0)}if(!a){const K=q*x;M(m.current,{transform:P(s)?`translate3d(0, ${K}px, 0)`:`translate3d(${K}px, 0, 0)`})}}}o.useEffect(()=>{var u;function x(){if(!m.current||!b)return;const E=document.activeElement;if(Ae(E)||ae.current){var C;const S=((C=window.visualViewport)==null?void 0:C.height)||0,q=window.innerHeight;let L=q-S;const V=m.current.getBoundingClientRect().height||0,X=V>q*.8;Ee.current||(Ee.current=V);const te=m.current.getBoundingClientRect().top;if(Math.abs(_e.current-L)>60&&(ae.current=!ae.current),a&&a.length>0&&ce&&ue){const Q=ce[ue]||0;L+=Q}if(_e.current=L,V>S||ae.current){const Q=m.current.getBoundingClientRect().height;let K=Q;Q>S&&(K=S-(X?te:Me)),T?m.current.style.height=`${Q-Math.max(L,0)}px`:m.current.style.height=`${Math.max(K,S-te)}px`}else m.current.style.height=`${Ee.current}px`;a&&a.length>0&&!ae.current?m.current.style.bottom="0px":m.current.style.bottom=`${Math.max(L,0)}px`}}return(u=window.visualViewport)==null||u.addEventListener("resize",x),()=>{var E;return(E=window.visualViewport)==null?void 0:E.removeEventListener("resize",x)}},[ue,a,ce]);function de(u){yt(),c==null||c(),u||J(!1),setTimeout(()=>{a&&He(a[0])},O.DURATION*1e3)}function Ue(){if(!m.current)return;const u=document.querySelector("[data-vaul-drawer-wrapper]"),x=ye(m.current,s);M(m.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${O.DURATION}s cubic-bezier(${O.EASE.join(",")})`}),M(re.current,{transition:`opacity ${O.DURATION}s cubic-bezier(${O.EASE.join(",")})`,opacity:"1"}),f&&x&&x>0&&z&&M(u,{borderRadius:`${Ze}px`,overflow:"hidden",...P(s)?{transform:`scale(${ge()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${ge()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${O.DURATION}s`,transitionTimingFunction:`cubic-bezier(${O.EASE.join(",")})`},!0)}function yt(){!se||!m.current||(m.current.classList.remove($e),le.current=!1,xe(!1),Re.current=new Date)}function bt(u){if(!se||!m.current)return;m.current.classList.remove($e),le.current=!1,xe(!1),Re.current=new Date;const x=ye(m.current,s);if(!Be(u.target,!1)||!x||Number.isNaN(x)||Se.current===null)return;const E=Re.current.getTime()-Se.current.getTime(),C=De.current-(P(s)?u.pageY:u.pageX),S=Math.abs(C)/E;if(S>.05&&(je(!0),setTimeout(()=>{je(!1)},200)),a){mt({draggedDistance:C*(s==="bottom"||s==="right"?1:-1),closeDrawer:de,velocity:S,dismissible:v}),i==null||i(u,!0);return}if(s==="bottom"||s==="right"?C>0:C<0){Ue(),i==null||i(u,!0);return}if(S>Qe){de(),i==null||i(u,!1);return}var q;const L=Math.min((q=m.current.getBoundingClientRect().height)!=null?q:0,window.innerHeight);var V;const X=Math.min((V=m.current.getBoundingClientRect().width)!=null?V:0,window.innerWidth),te=s==="left"||s==="right";if(Math.abs(x)>=(te?X:L)*y){de(),i==null||i(u,!1);return}i==null||i(u,!0),Ue()}o.useEffect(()=>(z&&(M(document.documentElement,{scrollBehavior:"auto"}),pe.current=new Date),()=>{en(document.documentElement,"scrollBehavior")}),[z]);function xt(u){const x=u?(window.innerWidth-ne)/window.innerWidth:1,E=u?-ne:0;Te.current&&window.clearTimeout(Te.current),M(m.current,{transition:`transform ${O.DURATION}s cubic-bezier(${O.EASE.join(",")})`,transform:`scale(${x}) translate3d(0, ${E}px, 0)`}),!u&&m.current&&(Te.current=setTimeout(()=>{const C=ye(m.current,s);M(m.current,{transition:"none",transform:P(s)?`translate3d(0, ${C}px, 0)`:`translate3d(${C}px, 0, 0)`})},500))}function St(u,x){if(x<0)return;const E=(window.innerWidth-ne)/window.innerWidth,C=E+x*(1-E),S=-ne+x*ne;M(m.current,{transform:P(s)?`scale(${C}) translate3d(0, ${S}px, 0)`:`scale(${C}) translate3d(${S}px, 0, 0)`,transition:"none"})}function Rt(u,x){const E=P(s)?window.innerHeight:window.innerWidth,C=x?(E-ne)/E:1,S=x?-ne:0;x&&M(m.current,{transition:`transform ${O.DURATION}s cubic-bezier(${O.EASE.join(",")})`,transform:P(s)?`scale(${C}) translate3d(0, ${S}px, 0)`:`scale(${C}) translate3d(${S}px, 0, 0)`})}return o.createElement($t,{defaultOpen:N,onOpenChange:u=>{!v&&!u||(u?ee(!0):de(!0),J(u))},open:z},o.createElement(qe.Provider,{value:{activeSnapPoint:ft,snapPoints:a,setActiveSnapPoint:He,drawerRef:m,overlayRef:re,onOpenChange:n,onPress:wt,onRelease:bt,onDrag:vt,dismissible:v,handleOnly:h,isOpen:z,isDragging:se,shouldFade:Le,closeDrawer:de,onNestedDrag:St,onNestedOpenChange:xt,onNestedRelease:Rt,keyboardIsOpen:ae,modal:B,snapPointsOffset:ce,direction:s,shouldScaleBackground:f,setBackgroundColorOnScale:d,noBodyStyles:A,container:l,autoFocus:I}},t))}const rt=o.forwardRef(function({...e},n){const{overlayRef:t,snapPoints:r,onRelease:i,shouldFade:a,isOpen:f,modal:d}=ie(),y=Ge(n,t),R=r&&r.length>0;return d?o.createElement(Tt,{onMouseUp:i,ref:y,"data-vaul-overlay":"","data-vaul-snap-points":f&&R?"true":"false","data-vaul-snap-points-overlay":f&&a?"true":"false",...e}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});rt.displayName="Drawer.Overlay";const at=o.forwardRef(function({onPointerDownOutside:e,style:n,onOpenAutoFocus:t,...r},i){const{drawerRef:a,onPress:f,onRelease:d,onDrag:y,keyboardIsOpen:R,snapPointsOffset:v,modal:h,isOpen:g,direction:j,snapPoints:k,container:T,handleOnly:B,autoFocus:c}=ie(),[$,A]=o.useState(!1),s=Ge(i,a),N=o.useRef(null),Y=o.useRef(null),p=o.useRef(!1),D=k&&k.length>0;un();const b=(l,I,_=0)=>{if(p.current)return!0;const U=Math.abs(l.y),z=Math.abs(l.x),J=z>U,F=["bottom","right"].includes(I)?1:-1;if(I==="left"||I==="right"){if(!(l.x*F<0)&&z>=0&&z<=_)return J}else if(!(l.y*F<0)&&U>=0&&U<=_)return!J;return p.current=!0,!0};o.useEffect(()=>{D&&window.requestAnimationFrame(()=>{A(!0)})},[]);function H(l){N.current=null,p.current=!1,d(l)}return o.createElement(Dt,{"data-vaul-drawer-direction":j,"data-vaul-drawer":"","data-vaul-delayed-snap-points":$?"true":"false","data-vaul-snap-points":g&&D?"true":"false","data-vaul-custom-container":T?"true":"false",...r,ref:s,style:v&&v.length>0?{"--snap-point-height":`${v[0]}px`,...n}:n,onPointerDown:l=>{B||(r.onPointerDown==null||r.onPointerDown.call(r,l),N.current={x:l.pageX,y:l.pageY},f(l))},onOpenAutoFocus:l=>{t==null||t(l),c||l.preventDefault()},onPointerDownOutside:l=>{if(e==null||e(l),!h||l.defaultPrevented){l.preventDefault();return}R.current&&(R.current=!1)},onFocusOutside:l=>{if(!h){l.preventDefault();return}},onPointerMove:l=>{if(Y.current=l,B||(r.onPointerMove==null||r.onPointerMove.call(r,l),!N.current))return;const I=l.pageY-N.current.y,_=l.pageX-N.current.x,U=l.pointerType==="touch"?10:2;b({x:_,y:I},j,U)?y(l):(Math.abs(_)>U||Math.abs(I)>U)&&(N.current=null)},onPointerUp:l=>{r.onPointerUp==null||r.onPointerUp.call(r,l),N.current=null,p.current=!1,d(l)},onPointerOut:l=>{r.onPointerOut==null||r.onPointerOut.call(r,l),H(Y.current)},onContextMenu:l=>{r.onContextMenu==null||r.onContextMenu.call(r,l),H(Y.current)}})});at.displayName="Drawer.Content";const dn=250,fn=120,ot=o.forwardRef(function({preventCycle:e=!1,children:n,...t},r){const{closeDrawer:i,isDragging:a,snapPoints:f,activeSnapPoint:d,setActiveSnapPoint:y,dismissible:R,handleOnly:v,isOpen:h,onPress:g,onDrag:j}=ie(),k=o.useRef(null),T=o.useRef(!1);function B(){if(T.current){A();return}window.setTimeout(()=>{c()},fn)}function c(){if(a||e||T.current){A();return}if(A(),(!f||f.length===0)&&R){i();return}if(d===f[f.length-1]&&R){i();return}const N=f.findIndex(p=>p===d);if(N===-1)return;const Y=f[N+1];y(Y)}function $(){k.current=window.setTimeout(()=>{T.current=!0},dn)}function A(){window.clearTimeout(k.current),T.current=!1}return o.createElement("div",{onClick:B,onPointerCancel:A,onPointerDown:s=>{v&&g(s),$()},onPointerMove:s=>{v&&j(s)},ref:r,"data-vaul-drawer-visible":h?"true":"false","data-vaul-handle":"","aria-hidden":"true",...t},o.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},n))});ot.displayName="Drawer.Handle";function mn({onDrag:e,onOpenChange:n,...t}){const{onNestedDrag:r,onNestedOpenChange:i,onNestedRelease:a}=ie();if(!r)throw new Error("Drawer.NestedRoot must be placed in another drawer");return o.createElement(nt,{nested:!0,onClose:()=>{i(!1)},onDrag:(f,d)=>{r(f,d),e==null||e(f,d)},onOpenChange:f=>{f&&i(f)},onRelease:a,...t})}function pn(e){const n=ie(),{container:t=n.container,...r}=e;return o.createElement(At,{container:t,...r})}const G={Root:nt,NestedRoot:mn,Content:at,Overlay:rt,Trigger:Et,Portal:pn,Handle:ot,Close:Ct,Title:Ot,Description:Nt},it=({shouldScaleBackground:e=!0,...n})=>w.jsx(G.Root,{shouldScaleBackground:e,...n});it.displayName="Drawer";const hn=G.Portal,st=W.forwardRef(({className:e,...n},t)=>w.jsx(G.Overlay,{ref:t,className:oe("fixed inset-0 z-50 bg-black/80",e),...n}));st.displayName=G.Overlay.displayName;const lt=W.forwardRef(({className:e,children:n,...t},r)=>w.jsxs(hn,{children:[w.jsx(st,{}),w.jsxs(G.Content,{ref:r,className:oe("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",e),...t,children:[w.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),n]})]}));lt.displayName="DrawerContent";const ut=W.forwardRef(({className:e,...n},t)=>w.jsx(G.Title,{ref:t,className:oe("text-lg font-semibold leading-none tracking-tight",e),...n}));ut.displayName=G.Title.displayName;const gn=W.forwardRef(({className:e,...n},t)=>w.jsx(G.Description,{ref:t,className:oe("text-sm text-muted-foreground",e),...n}));gn.displayName=G.Description.displayName;const wn=({receiverName:e,receiverAvatar:n,onClose:t,onPrevious:r,onNext:i})=>w.jsxs("div",{className:"flex items-center justify-between p-4",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(be,{variant:"ghost",size:"icon",onClick:t,children:w.jsx(Mt,{className:"h-4 w-4"})}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(ut,{children:e}),w.jsxs(jt,{className:"h-8 w-8",children:[w.jsx(_t,{src:n||void 0,alt:e}),w.jsx(It,{children:e.split(" ").map(a=>a[0]).join("")})]})]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(be,{variant:"ghost",size:"icon",onClick:r,children:w.jsx(kt,{className:"h-4 w-4"})}),w.jsx(be,{variant:"ghost",size:"icon",onClick:i,children:w.jsx(Ht,{className:"h-4 w-4"})})]})]}),vn=({newMessage:e,onChange:n,onSend:t,sending:r})=>w.jsx("div",{className:"p-4 border-t",children:w.jsxs("div",{className:"flex gap-2",children:[w.jsx(Lt,{value:e,onChange:i=>n(i.target.value),placeholder:"Type a message...",className:"resize-none"}),w.jsx(be,{onClick:t,disabled:r||!e.trim(),size:"icon",children:w.jsx(Bt,{className:"h-4 w-4"})})]})}),yn=({messages:e,currentUserId:n})=>w.jsx(Ut,{className:"flex-1 p-4",children:w.jsx("div",{className:"space-y-4",children:e.map(t=>w.jsx("div",{className:oe("flex",t.sender_id===n?"justify-end":"justify-start"),children:w.jsx("div",{className:oe("rounded-lg px-4 py-2 max-w-[80%]",t.sender_id===n?"bg-primary text-primary-foreground":"bg-muted"),children:t.content})},t.id))})}),En=({isOpen:e,onClose:n,receiverId:t,receiverName:r,carId:i})=>{const[a,f]=W.useState([]),[d,y]=W.useState(""),[R,v]=W.useState(!1),[h,g]=W.useState(null),[j,k]=W.useState(null),{toast:T}=Pt();W.useEffect(()=>{if(!e)return;const c=async()=>{const{data:s}=await Z.from("profiles").select("avatar_url").eq("id",t).single();if(s!=null&&s.avatar_url){const{data:N}=Z.storage.from("avatars").getPublicUrl(s.avatar_url);g(N.publicUrl)}},$=async()=>{const{data:{user:s}}=await Z.auth.getUser();if(!s)return;k(s.id);const{data:N,error:Y}=await Z.from("messages").select("*").or(`sender_id.eq.${s.id},receiver_id.eq.${s.id}`).order("created_at",{ascending:!0});if(Y){console.error("Error fetching messages:",Y);return}f(N||[])};c(),$();const A=Z.channel("messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},s=>{console.log("New message received:",s),f(N=>[...N,s.new])}).subscribe();return()=>{Z.removeChannel(A)}},[e,t]);const B=async()=>{if(d.trim()){v(!0);try{const{data:{user:c}}=await Z.auth.getUser();if(!c){T({title:"Error",description:"You must be logged in to send messages",variant:"destructive"});return}const{error:$}=await Z.from("messages").insert({content:d.trim(),sender_id:c.id,receiver_id:t,related_car_id:i});if($)throw $;y("")}catch(c){console.error("Error sending message:",c),T({title:"Error",description:"Could not send message. Please try again.",variant:"destructive"})}finally{v(!1)}}};return w.jsx(it,{open:e,onOpenChange:n,children:w.jsxs(lt,{className:"h-[90%] flex flex-col",children:[w.jsx(wn,{receiverName:r,receiverAvatar:h,onClose:n}),j&&w.jsx(yn,{messages:a,currentUserId:j}),w.jsx(vn,{newMessage:d,onChange:y,onSend:B,sending:R})]})})};export{En as C};
