const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/notificationService-Cdrrj01r.js","assets/index-P3CM6KeI.js","assets/query-vendor-Bsfdn-Hb.js","assets/react-vendor-mnpoGfEl.js","assets/supabase-vendor-BOn0LdFJ.js","assets/mapbox-vendor-fnXFVHMy.js","assets/date-vendor-Dhms5dOu.js","assets/index-CJE7JmnA.css"])))=>i.map(i=>d[i]);
import{j as t,a as ts,u as Fe}from"./query-vendor-Bsfdn-Hb.js";import{c as z,s as $,J as H,a8 as ss,D as Re,b as ze,d as qe,e as Ve,m as Nt,t as ns,B as J,Y as St,R as ce,W as rs,a9 as os,aa as as,l as Ct,g as ct,ab as lt,h as dt,ac as is,U as cs,q as ls,u as ds,a6 as us,T as fs}from"./index-P3CM6KeI.js";import{S as me}from"./skeleton-B2cG361V.js";import{N as Be}from"./Navigation-CSI_6Xlv.js";import{r as x,u as He,k as Lt,L as ut}from"./react-vendor-mnpoGfEl.js";import{_ as ms}from"./supabase-vendor-BOn0LdFJ.js";import{C as hs,P as xs,a as gs,b as ps}from"./popover-CQTTAH3d.js";import{s as ys,p as ft,a as W}from"./date-vendor-Dhms5dOu.js";import{u as Et}from"./useVerificationStatus-fqM8qHb1.js";import{V as Mt}from"./VerificationRequiredDialog-D_aTo2Mj.js";import{G as mt}from"./mapbox-gl-DiEiWHZN.js";import{L as bs}from"./LocationSearchInput-DmYmOygm.js";import{m as he}from"./mapbox-vendor-fnXFVHMy.js";import{C as Pt,K as ks,a as js,b as vs}from"./CarDescription-CtKCPcV9.js";import{C as Dt}from"./clock-BMQl8Y3I.js";import{C as Ue}from"./calendar-BKgmIjQf.js";import{C as ws}from"./circle-alert-CnS2w5gW.js";import{M as Ge}from"./map-pin-DPjPx-xp.js";import{H as Ns,i as Ss,u as Cs,s as Ls,C as Es}from"./savedCarService-Bv2i0KyT.js";import{C as Ke,a as Je,b as Ye,d as Qe}from"./card-CfBwv9RV.js";import{C as Ms}from"./car-BJ1V2yVZ.js";import{C as ht}from"./camera-DadvHD0M.js";import{S as Ps}from"./shield-CXGhqkUx.js";import{A as Ds}from"./arrow-right--OEAnneY.js";import{S as Is}from"./star-C5u9QfUh.js";import{d as Ts}from"./index-BAdw-eVA.js";import"./bell-BXMTfvW8.js";import"./user-BqRr4HZa.js";import"./chevron-left-BoqDzWcX.js";import"./file-text-KLanAaZO.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=z("AirVent",[["path",{d:"M6 12H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"larmp2"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"M18.3 17.7a2.5 2.5 0 0 1-3.16 3.83 2.53 2.53 0 0 1-1.14-2V12",key:"1bo8pg"}],["path",{d:"M6.6 15.6A2 2 0 1 0 10 17v-5",key:"t9h90c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=z("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=z("Bluetooth",[["path",{d:"m7 7 10 10-5 5V2l5 5L7 17",key:"1q5490"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=z("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=z("CalendarX",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m14 14-4 4",key:"rymu2i"}],["path",{d:"m10 14 4 4",key:"3sz06r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=z("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=z("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=z("Locate",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=z("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=z("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=z("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=z("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=z("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=z("Sofa",[["path",{d:"M20 9V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3",key:"1dgpiv"}],["path",{d:"M2 16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v1.5a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5V11a2 2 0 0 0-4 0z",key:"xacw8m"}],["path",{d:"M4 18v2",key:"jwo5n2"}],["path",{d:"M20 18v2",key:"1ar1qi"}],["path",{d:"M12 4v9",key:"oqhhn3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=z("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=z("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=z("Umbrella",[["path",{d:"M22 12a10.06 10.06 1 0 0-20 0Z",key:"1teyop"}],["path",{d:"M12 12v8a2 2 0 0 0 4 0",key:"ulpmoc"}],["path",{d:"M12 2v1",key:"11qlp1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=z("Webcam",[["circle",{cx:"12",cy:"10",r:"8",key:"1gshiw"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 22h10",key:"10w4w3"}],["path",{d:"M12 22v-4",key:"1utk9m"}]]),pt=async()=>{console.log("Checking for expired booking requests...");try{const e=ys(new Date),{data:s,error:n}=await $.from("bookings").select("*").eq("status","pending").lt("start_date",e.toISOString());if(n)throw n;if(s&&s.length>0){const{error:o}=await $.from("bookings").update({status:"expired"}).in("id",s.map(i=>i.id));if(o)throw o;console.log(`Updated ${s.length} expired booking requests`)}}catch(e){console.error("Error in handleExpiredBookings:",e instanceof Error?e.message:JSON.stringify(e,null,2))}},yt=async(e,s,n,o)=>{try{let i=$.from("bookings").select("*").eq("car_id",e).in("status",["confirmed","pending"]).or(`and(start_date.lte.${W(n,"yyyy-MM-dd")},end_date.gte.${W(s,"yyyy-MM-dd")})`);const{data:r,error:a}=await i;return a?(console.error("Error checking car availability:",a),!1):!r||r.length===0}catch(i){return console.error("Error in checkCarAvailability:",i),!1}},Qs=async e=>{try{const{data:s,error:n}=await $.from("bookings").select("start_date, end_date").eq("car_id",e).in("status",["confirmed","pending"]);if(n)return console.error("Error fetching booked dates:",n),[];const o=[];return s==null||s.forEach(i=>{const r=ft(i.start_date),a=ft(i.end_date),l=new Date(r);for(;l<=a;)o.push(new Date(l)),l.setDate(l.getDate()+1)}),o}catch(s){return console.error("Error in getBookedDates:",s),[]}},Xs=(e,s)=>s.some(n=>e.getDate()===n.getDate()&&e.getMonth()===n.getMonth()&&e.getFullYear()===n.getFullYear());var bt=["light","dark"],Zs="(prefers-color-scheme: dark)",Ws=x.createContext(void 0),en={setTheme:e=>{},themes:[]},tn=()=>{var e;return(e=x.useContext(Ws))!=null?e:en};x.memo(({forcedTheme:e,storageKey:s,attribute:n,enableSystem:o,enableColorScheme:i,defaultTheme:r,value:a,attrs:l,nonce:d})=>{let c=r==="system",b=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(u=>`'${u}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,f=i?bt.includes(r)&&r?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${r}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",m=(u,g=!1,y=!0)=>{let h=a?a[u]:u,k=g?u+"|| ''":`'${h}'`,j="";return i&&y&&!g&&bt.includes(u)&&(j+=`d.style.colorScheme = '${u}';`),n==="class"?g||h?j+=`c.add(${k})`:j+="null":h&&(j+=`d[s](n,${k})`),j},p=e?`!function(){${b}${m(e)}}()`:o?`!function(){try{${b}var e=localStorage.getItem('${s}');if('system'===e||(!e&&${c})){var t='${Zs}',m=window.matchMedia(t);if(m.media!==t||m.matches){${m("dark")}}else{${m("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${m(a?"x[e]":"e",!0)}}${c?"":"else{"+m(r,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${b}var e=localStorage.getItem('${s}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${m(a?"x[e]":"e",!0)}}else{${m(r,!1,!1)};}${f}}catch(t){}}();`;return x.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:p}})});const sn=({mapboxToken:e,selectedLocation:s,onMapClick:n,onMapRef:o,onGeolocateRef:i,onUserLocationUpdate:r,mapStyle:a="mapbox://styles/mapbox/streets-v12"})=>{const l=x.useRef(null),d=x.useRef(null),c=x.useRef(null),[b,f]=x.useState(!1);return x.useEffect(()=>{if(!e||!l.current||d.current)return;he.accessToken=e,d.current=new he.Map({container:l.current,style:a,center:[25.9087,-24.6541],zoom:14,interactive:!0}),d.current.addControl(new he.NavigationControl,"top-right");const m=new he.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0});return d.current.addControl(m,"top-right"),i(m),m.on("geolocate",p=>{console.log("Geolocate event:",p.coords),r({latitude:p.coords.latitude,longitude:p.coords.longitude})}),m.on("error",p=>{console.error("Geolocation error:",p),H.error("Unable to access your location. Please check permissions.")}),d.current.on("load",()=>{console.log("Map loaded successfully"),f(!0),o(d.current)}),d.current.on("error",p=>{console.error("Map error:",p),H.error("Error loading map. Please refresh.")}),d.current.on("click",p=>{console.log("Map clicked at:",p.lngLat),n(p.lngLat.lng,p.lngLat.lat)}),()=>{d.current&&(d.current.remove(),d.current=null,o(null),i(null))}},[e,a,o,i,r,n]),x.useEffect(()=>{if(!(!d.current||!b)&&(c.current&&(c.current.remove(),c.current=null),s)){const m=document.createElement("div");if(m.className="location-marker",m.style.width="20px",m.style.height="20px",m.style.borderRadius="50%",m.style.backgroundColor="#ef4444",m.style.border="3px solid white",m.style.boxShadow="0 0 10px rgba(0, 0, 0, 0.3)",m.style.cursor="pointer",m.style.animation="pulse 2s infinite",!document.querySelector("#location-marker-styles")){const p=document.createElement("style");p.id="location-marker-styles",p.textContent=`
          @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
          }
        `,document.head.appendChild(p)}c.current=new he.Marker(m,{draggable:!0}).setLngLat([s.lng,s.lat]).addTo(d.current),c.current.on("dragend",()=>{var u;const p=(u=c.current)==null?void 0:u.getLngLat();p&&(console.log("Marker dragged to:",p),n(p.lng,p.lat))}),d.current.flyTo({center:[s.lng,s.lat],zoom:16,essential:!0})}},[s,b,n]),t.jsx("div",{className:"relative w-full h-full",children:t.jsx("div",{ref:l,className:"w-full h-full"})})},nn=({isOpen:e,onClose:s,onLocationSelected:n})=>{const[o,i]=x.useState(null),[r,a]=x.useState(""),l=x.useRef(null),d=x.useRef(null),[c,b]=x.useState(null),[f,m]=x.useState(!0),[p,u]=x.useState(null),{theme:g}=tn(),y=x.useCallback(async(v,N)=>{if(c)try{const E=await(await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${N},${v}.json?access_token=${c}`)).json();E.features&&E.features.length>0&&a(E.features[0].place_name)}catch(T){console.error("Error fetching address:",T)}},[c,a]),h=x.useCallback((v,N)=>{console.log("Map clicked at:",{lat:N,lng:v}),i({lat:N,lng:v}),y(N,v)},[y]),k=x.useCallback(v=>{l.current=v},[]),j=()=>g==="dark"?"mapbox://styles/mapbox/navigation-night-v1":"mapbox://styles/mapbox/navigation-day-v1";x.useEffect(()=>{(async()=>{try{const N=await St();if(!N){H.error("Failed to get the map token");return}console.log("Mapbox token retrieved successfully"),b(N),m(!1)}catch(N){console.error("Error getting Mapbox token:",N),H.error("Failed to load map configuration")}})()},[]);const L=()=>{o?(n(o.lat,o.lng),s()):H.error("Please select a location first")},M=()=>{d.current?d.current.trigger():H.error("Geolocation not available")},C=x.useCallback(v=>{console.log("User location updated:",v),u({lat:v.latitude,lng:v.longitude}),i({lat:v.latitude,lng:v.longitude}),y(v.latitude,v.longitude)},[y]),S=v=>{const[N,T]=v.coordinates;i({lat:T,lng:N}),a(v.full_address),l.current&&l.current.flyTo({center:[N,T],zoom:16,essential:!0})};return x.useEffect(()=>{e&&(i(null),a(""),u(null))},[e]),t.jsx(ss,{children:t.jsx(Re,{open:e,onOpenChange:v=>{v||s()},children:t.jsxs(ze,{className:"sm:max-w-[700px] h-[85vh] max-h-[900px] flex flex-col overflow-hidden p-0",children:[t.jsxs(qe,{className:"p-6 pb-4",children:[t.jsx(Ve,{children:"Select Pickup Location"}),t.jsx(Nt,{className:"text-sm text-muted-foreground",children:"Search for a location, click on the map, or use your current location."})]}),t.jsx("div",{className:"px-6 pb-4",children:t.jsx(bs,{placeholder:"Search for addresses, landmarks, places...",onLocationSelect:S,className:"w-full"})}),t.jsxs(ns,{className:"flex-1 overflow-auto px-6 py-2",children:[t.jsxs("div",{className:"relative w-full rounded-md overflow-hidden border border-border mb-4",style:{height:"400px",minHeight:"300px"},children:[(f||!c)&&t.jsx("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-sm",children:t.jsx(me,{className:"w-full h-full"})}),t.jsx(sn,{mapboxToken:c,selectedLocation:o,onMapClick:h,onMapRef:k,onGeolocateRef:v=>d.current=v,onUserLocationUpdate:C,mapStyle:j()}),o&&t.jsxs("div",{className:"absolute top-2 left-2 bg-background/90 p-2 rounded-md shadow-sm border border-border text-xs max-w-[200px]",children:[t.jsx("p",{className:"font-medium",children:"Selected Location"}),t.jsxs("p",{children:["Lat: ",o.lat.toFixed(6)]}),t.jsxs("p",{children:["Lng: ",o.lng.toFixed(6)]}),r&&t.jsx("p",{className:"mt-1 text-muted-foreground truncate",children:r})]}),t.jsx("div",{className:"absolute top-2 right-2",children:t.jsxs(J,{size:"sm",variant:"secondary",className:"h-8 shadow-sm",onClick:M,disabled:!c||f,children:[t.jsx(zs,{className:"h-4 w-4 mr-1"}),"Use My Location"]})})]}),t.jsx("div",{className:"flex flex-col gap-2 mb-4",children:t.jsx("p",{className:"text-xs text-muted-foreground",children:f?"Loading map...":c?o?`Location selected${r?`: ${r}`:". Click confirm to use this location."}`:"Search for a location above, click on the map, or use your current location.":"Map configuration not available"})})]}),t.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t sticky bottom-0 bg-background",children:[t.jsx(J,{variant:"outline",onClick:s,children:"Cancel"}),t.jsx(J,{onClick:L,disabled:!o,children:"Confirm Location"})]})]})})})},It=x.forwardRef(({...e},s)=>t.jsx("nav",{ref:s,"aria-label":"breadcrumb",...e}));It.displayName="Breadcrumb";const Tt=x.forwardRef(({className:e,...s},n)=>t.jsx("ol",{ref:n,className:ce("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...s}));Tt.displayName="BreadcrumbList";const At=x.forwardRef(({className:e,...s},n)=>t.jsx("li",{ref:n,className:ce("inline-flex items-center gap-1.5",e),...s}));At.displayName="BreadcrumbItem";const rn=x.forwardRef(({asChild:e,className:s,...n},o)=>{const i=e?os:"a";return t.jsx(i,{ref:o,className:ce("transition-colors hover:text-foreground",s),...n})});rn.displayName="BreadcrumbLink";const _t=x.forwardRef(({className:e,...s},n)=>t.jsx("span",{ref:n,role:"link","aria-disabled":"true","aria-current":"page",className:ce("font-normal text-foreground",e),...s}));_t.displayName="BreadcrumbPage";const Bt=({children:e,className:s,...n})=>t.jsx("li",{role:"presentation","aria-hidden":"true",className:ce("[&>svg]:size-3.5",s),...n,children:e??t.jsx(rs,{})});Bt.displayName="BreadcrumbSeparator";const Ot=({currentStep:e,bookingId:s})=>{const n=[{key:"selection",label:"Car Selection",completed:!0},{key:"confirmation",label:"Booking Details",completed:e!=="selection"},{key:"success",label:"Confirmation",completed:["success","handover"].includes(e)},{key:"handover",label:"Handover",completed:e==="handover"}],o=i=>i.completed&&e!==i.key?t.jsx(Pt,{className:"h-4 w-4 text-green-600"}):e===i.key?t.jsx(Dt,{className:"h-4 w-4 text-primary"}):t.jsx(as,{className:"h-4 w-4 text-muted-foreground"});return t.jsxs("div",{className:"p-4 bg-muted/50 border-b",children:[t.jsx(It,{children:t.jsx(Tt,{children:n.map((i,r)=>t.jsxs("div",{className:"flex items-center",children:[t.jsxs(At,{className:"flex items-center gap-2",children:[o(i),e===i.key?t.jsx(_t,{className:"font-medium",children:i.label}):t.jsx("span",{className:`text-sm ${i.completed?"text-green-600 font-medium":"text-muted-foreground"}`,children:i.label})]}),r<n.length-1&&t.jsx(Bt,{})]},i.key))})}),s&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Booking ID: ",s]})]})},on=({isOpen:e,onClose:s,bookingData:n})=>{const o=He(),[i,r]=x.useState(5),a=x.useCallback(()=>{s(),o("/bookings")},[s,o]);x.useEffect(()=>{if(!e){r(5);return}const d=setInterval(()=>{r(c=>c<=1?(a(),0):c-1)},1e3);return()=>clearInterval(d)},[e,a]);const l=()=>{s()};return t.jsx(Re,{open:e,onOpenChange:l,children:t.jsxs(ze,{className:"sm:max-w-[500px] p-0",children:[t.jsx(Ot,{currentStep:"success",bookingId:n==null?void 0:n.id}),t.jsxs("div",{className:"p-6",children:[t.jsxs(qe,{className:"text-center",children:[t.jsx("div",{className:"mx-auto mb-4 w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:t.jsx(Pt,{className:"h-8 w-8 text-green-600"})}),t.jsx(Ve,{className:"text-xl font-semibold",children:"Booking Request Submitted!"})]}),t.jsxs("div",{className:"space-y-4 mt-6",children:[t.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-3",children:[t.jsx("h3",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide",children:"Booking Details"}),n&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:t.jsx(Ue,{className:"h-4 w-4 text-primary"})}),t.jsxs("div",{children:[t.jsxs("p",{className:"font-medium",children:[n.carBrand," ",n.carModel]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["BWP ",n.totalPrice]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-50 rounded-full flex items-center justify-center",children:t.jsx(Dt,{className:"h-4 w-4 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Rental Period"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.startDate," to ",n.endDate]})]})]})]})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[t.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"What happens next?"}),t.jsxs("ul",{className:"space-y-1 text-sm text-blue-800 dark:text-blue-200",children:[t.jsx("li",{children:"â€¢ The car owner will review your request"}),t.jsx("li",{children:"â€¢ You'll be notified once it's approved"}),t.jsx("li",{children:"â€¢ Pickup details will be shared via messages"}),t.jsx("li",{children:"â€¢ Handover process will be available on booking day"})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[t.jsx(J,{variant:"outline",onClick:l,className:"flex-1",children:"Close"}),t.jsxs(J,{onClick:a,className:"flex-1",children:["View My Bookings ",i>0&&`(${i}s)`]})]})]})]})]})})},an=({car:e,isOpen:s,onClose:n})=>{const[o,i]=x.useState(),[r,a]=x.useState(),[l,d]=x.useState("09:00"),[c,b]=x.useState("18:00"),[f,m]=x.useState(!1),[p,u]=x.useState(!1),[g,y]=x.useState(null),[h,k]=x.useState([]),[j,L]=x.useState(!1),[M,C]=x.useState(!0),[S,v]=x.useState(!1),[N,T]=x.useState(null),[E,R]=x.useState(!1),[te,ee]=x.useState(!1),[se,le]=x.useState(null),Y=x.useRef(!0),{toast:q}=Ct(),ne=He(),{isVerified:ie,isLoading:U}=Et();x.useEffect(()=>{(async()=>{var F,I;const{data:P}=await $.auth.getSession(),V=(I=(F=P.session)==null?void 0:F.user)==null?void 0:I.id;Y.current&&(y(V),V&&e.owner_id===V&&u(!0))})()},[e.owner_id]),x.useEffect(()=>{s&&e.id&&((async()=>{const P=await Qs(e.id);k(P)})(),pt().catch(console.error))},[s,e.id]),x.useEffect(()=>{o&&r?(async()=>{if(o&&r&&e.id){L(!0);try{const P=await yt(e.id,o,r);C(P)}catch(P){console.error("Error checking availability:",P),C(!1)}finally{L(!1)}}})():C(!0)},[o,r,e.id]),x.useEffect(()=>(s&&pt().catch(console.error),()=>{}),[s]),x.useEffect(()=>{e.latitude&&e.longitude&&T({latitude:e.latitude,longitude:e.longitude})},[e]),x.useEffect(()=>()=>{Y.current=!1},[]);const de=async(D,P,V,F,I)=>{console.log("Creating notification:",{userId:D,type:P,content:V,carId:F,bookingId:I});const{error:w}=await $.rpc("create_booking_notification",{p_booking_id:I,p_notification_type:"booking_request",p_content:V});return w?(console.error("Error creating notification:",w.message||JSON.stringify(w,null,2)),!1):!0},ue=async()=>{var I,w,_;const{data:D,error:P}=await $.auth.getSession();if(P||!((I=D.session)!=null&&I.user)){q({title:"Session expired",description:"Please sign in again to continue with your booking",variant:"destructive"}),ne("/login");return}if(!ie&&!U){R(!0);return}if(p){q({title:"Not allowed",description:"You cannot book your own car",variant:"destructive"});return}if(!o||!r){q({title:"Error",description:"Please select both start and end dates",variant:"destructive"});return}if(!await yt(e.id,o,r)){q({title:"Not available",description:"This car is not available for the selected dates. Please choose different dates."});return}if(!N){q({title:"Error",description:"Please select a pickup location",variant:"destructive"});return}m(!0);const F=setTimeout(()=>{Y.current&&(m(!1),q({title:"Timeout",description:"Booking is taking longer than expected. Please check your bookings page.",variant:"destructive"}))},3e4);try{console.log("[BookingDialog] Starting booking process...");const{data:A}=await $.auth.getSession();if(!((w=A.session)!=null&&w.user))throw new Error("No authenticated user");const Z=(Math.ceil((r.getTime()-o.getTime())/(1e3*60*60*24))+1)*e.price_per_day;console.log("[BookingDialog] Creating booking in database...");const{data:K,error:oe}=await $.from("bookings").insert({car_id:e.id,renter_id:A.session.user.id,start_date:W(o,"yyyy-MM-dd"),end_date:W(r,"yyyy-MM-dd"),start_time:l,end_time:c,total_price:Z,latitude:N.latitude,longitude:N.longitude,status:"pending"}).select().single();if(oe)throw oe;console.log("[BookingDialog] Booking created successfully:",K.id),console.log("[BookingDialog] Creating notifications and sending Twilio alerts...");const{data:Q}=await $.from("profiles").select("full_name, phone_number").eq("id",A.session.user.id).single(),{data:X}=await $.from("profiles").select("full_name, phone_number").eq("id",e.owner_id).single(),{TwilioNotificationService:pe}=await ms(async()=>{const{TwilioNotificationService:O}=await import("./notificationService-Cdrrj01r.js");return{TwilioNotificationService:O}},__vite__mapDeps([0,1,2,3,4,5,6,7])),be=pe.getInstance(),ke={bookingId:K.id,customerName:(Q==null?void 0:Q.full_name)||"Customer",hostName:(X==null?void 0:X.full_name)||"Host",carBrand:e.brand,carModel:e.model,pickupDate:W(o,"PPP"),pickupTime:l,pickupLocation:e.location||"Pickup location",dropoffLocation:e.location||"Return location",totalAmount:Z,bookingReference:`MR-${K.id.slice(-8).toUpperCase()}`};if(Q)try{const O=await be.sendBookingConfirmation({id:A.session.user.id,name:Q.full_name||"Customer",email:A.session.user.email,phone:Q.phone_number,whatsappEnabled:!0,emailEnabled:!0},ke);console.log("âœ… Renter Twilio notifications sent:",O)}catch(O){console.error("âŒ Failed to send renter Twilio notifications:",O)}if(X)try{const{data:O}=await $.auth.admin.getUserById(e.owner_id),Le=await be.sendBookingConfirmation({id:e.owner_id,name:X.full_name||"Host",email:(_=O.user)==null?void 0:_.email,phone:X.phone_number,whatsappEnabled:!0,emailEnabled:!0},{...ke,customerName:X.full_name||"Host"});console.log("âœ… Host Twilio notifications sent:",Le)}catch(O){console.error("âŒ Failed to send host Twilio notifications:",O)}try{await de(A.session.user.id,"booking_request",`Your booking request for ${e.brand} ${e.model} from ${W(o,"PPP")} to ${W(r,"PPP")} has been submitted.`,e.id,K.id)}catch(O){console.error("Failed to create renter notification (non-blocking):",O instanceof Error?O.message:JSON.stringify(O,null,2))}try{await de(e.owner_id,"booking_request",`New booking request received for your ${e.brand} ${e.model} from ${W(o,"PPP")} to ${W(r,"PPP")}.`,e.id,K.id)}catch(O){console.error("Failed to create host notification (non-blocking):",O instanceof Error?O.message:JSON.stringify(O,null,2))}if(!Y.current)return;console.log("[BookingDialog] Booking flow completed successfully, showing success modal..."),le({id:K.id,carBrand:e.brand,carModel:e.model,startDate:W(o,"PPP"),endDate:W(r,"PPP"),totalPrice:Z}),n(),ee(!0)}catch(A){if(!Y.current)return;console.error("Booking error:",A instanceof Error?A.message:JSON.stringify(A,null,2)),q({title:"Error",description:"Failed to create booking. Please try again.",variant:"destructive"})}finally{clearTimeout(F),Y.current&&m(!1)}},re=(D,P)=>{T({latitude:D,longitude:P})},xe=()=>N?N.latitude===e.latitude&&N.longitude===e.longitude?`Default: ${e.location}`:`Custom location (${N.latitude.toFixed(4)}, ${N.longitude.toFixed(4)})`:"No location selected",ge=D=>{const P=new Date;return P.setDate(P.getDate()),P.setHours(0,0,0,0),D<P?!0:Xs(D,h)};return t.jsxs(t.Fragment,{children:[t.jsx(Re,{open:s,onOpenChange:n,children:t.jsxs(ze,{className:"sm:max-w-[425px] max-h-[90vh] overflow-y-auto p-0",children:[t.jsx(Ot,{currentStep:"confirmation"}),t.jsxs("div",{className:"p-6",children:[t.jsxs(qe,{children:[t.jsxs(Ve,{children:["Book ",e.brand," ",e.model]}),t.jsx(Nt,{className:"text-muted-foreground",children:"Select your rental dates and pickup location"})]}),p&&t.jsxs(ct,{variant:"destructive",className:"mb-4",children:[t.jsx(ws,{className:"h-4 w-4"}),t.jsx(lt,{children:"Not allowed"}),t.jsx(dt,{children:"You cannot book your own car. This is for other renters only."})]}),!M&&o&&r&&t.jsxs(ct,{variant:"destructive",className:"mb-4",children:[t.jsx($s,{className:"h-4 w-4"}),t.jsx(lt,{children:"Not available"}),t.jsx(dt,{children:"This car is not available for the selected dates. Please choose different dates."})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("h4",{className:"font-medium",children:"Select dates"}),t.jsx(hs,{mode:"range",selected:{from:o,to:r},onSelect:D=>{i(D==null?void 0:D.from),a(D==null?void 0:D.to)},numberOfMonths:1,disabled:ge,modifiers:{booked:h},modifiersStyles:{booked:{backgroundColor:"rgba(239, 68, 68, 0.1)",color:"rgb(239, 68, 68)",textDecoration:"line-through"}}})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h4",{className:"font-medium",children:"Pickup Location"}),t.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(Ge,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),t.jsx("div",{className:"text-sm",children:t.jsx("p",{children:xe()})})]}),t.jsx(J,{variant:"outline",size:"sm",onClick:()=>v(!0),children:"Change"})]})]}),o&&r&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("h4",{className:"font-medium",children:"Summary"}),t.jsxs("div",{className:"text-sm space-y-1 p-4 bg-primary/5 rounded-md",children:[t.jsxs("p",{children:["Start date: ",W(o,"PPP")]}),t.jsxs("p",{children:["End date: ",W(r,"PPP")]}),t.jsx("div",{className:"border-t border-border pt-2 mt-2",children:t.jsxs("p",{className:"font-medium text-primary",children:["Total: BWP"," ",Math.ceil((r.getTime()-o.getTime())/(1e3*60*60*24)+1)*e.price_per_day]})}),t.jsx(J,{variant:"outline",size:"sm",onClick:()=>v(!0),children:"Change"})]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-4 border-t",children:[t.jsx(J,{variant:"outline",onClick:n,className:"w-full sm:w-auto",children:"Cancel"}),t.jsx(J,{onClick:!ie&&!U?()=>R(!0):ue,disabled:!o||!r||f||p||j||!M||!N||U,className:"w-full sm:w-auto",variant:!ie&&!U?"outline":"default",children:f?"Booking...":j?"Checking...":U?"Checking verification...":ie?"Confirm":"Start Verification"})]})]})]})}),t.jsx(Mt,{isOpen:E,onClose:()=>R(!1),action:"booking",carData:e}),t.jsx(nn,{isOpen:S,onClose:()=>v(!1),onLocationSelected:re}),t.jsx(on,{isOpen:te,onClose:()=>ee(!1),bookingData:se})]})},cn=({car:e})=>{const[s,n]=x.useState(!1),[o,i]=x.useState(!1),[r,a]=x.useState(!1),[l,d]=x.useState(!1),[c,b]=x.useState(!1),[f,m]=x.useState(!1),{isVerified:p,isLoading:u}=Et(),g=He(),y=ts();x.useEffect(()=>{(async()=>{var S;const{data:M}=await $.auth.getSession(),C=!!M.session;if(b(C),C&&((S=M.session)!=null&&S.user)){const v=M.session.user.id;m(v===e.owner_id)}})();const{data:{subscription:L}}=$.auth.onAuthStateChange((M,C)=>{const S=!!C;if(b(S),S&&C){const v=C.user.id;m(v===e.owner_id)}else m(!1)});return()=>L.unsubscribe()},[e.owner_id]),x.useEffect(()=>{(async()=>{if(c)try{const L=await Ss(e.id);a(L)}catch(L){console.error("Failed to check if car is saved:",L)}})()},[e.id,c]);const h=()=>{if(!c){g("/login");return}if(f){H.error("You cannot book your own vehicle");return}if(!p&&!u){i(!0);return}n(!0)},k=async()=>{if(!c){g("/login");return}if(!l){d(!0);try{r?await Cs(e.id)&&(a(!1),H.success("Vehicle removed from saved list"),y.invalidateQueries({queryKey:["saved-cars-full"]}),y.invalidateQueries({queryKey:["saved-car-ids"]})):await Ls(e.id)&&(a(!0),H.success("Vehicle added to saved list"),y.invalidateQueries({queryKey:["saved-cars-full"]}),y.invalidateQueries({queryKey:["saved-car-ids"]}))}catch{H.error("An error occurred. Please try again.")}finally{d(!1)}}};return t.jsxs("div",{className:"sticky bottom-[72px] bg-background dark:bg-gray-800 p-4 rounded-t-lg border-t border-gray-200 dark:border-gray-700 shadow-lg",children:[f?t.jsxs("div",{className:"flex items-center justify-center p-2 bg-muted rounded-lg",children:[t.jsx(Us,{className:"h-5 w-5 mr-2 text-amber-500"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"You own this vehicle"})]}):t.jsxs("div",{className:"flex gap-2",children:[t.jsx(J,{variant:"outline",className:"w-12 flex-shrink-0",onClick:k,disabled:l,children:t.jsx(Ns,{className:`${r?"fill-red-500 text-red-500":"text-gray-600 dark:text-gray-400"}`})}),t.jsxs(J,{className:"flex-1 flex items-center justify-center gap-2",onClick:h,children:[t.jsx(Ue,{className:"w-5 h-5"}),"Book Now"]})]}),t.jsx(an,{car:e,isOpen:s,onClose:()=>n(!1)}),t.jsx(Mt,{isOpen:o,onClose:()=>i(!1),action:"booking",carData:e})]})},ln=({brand:e,model:s,year:n,location:o,pricePerDay:i})=>{const{id:r}=Lt(),[a,l]=x.useState(!1),[d,c]=x.useState(!0),[b,f]=x.useState(!1);x.useEffect(()=>{(async()=>{var u,g;try{c(!0);const{data:y}=await $.auth.getSession(),h=(g=(u=y==null?void 0:y.session)==null?void 0:u.user)==null?void 0:g.id;if(!h||!r){l(!1);return}const{data:k}=await $.from("cars").select("owner_id").eq("id",r).single();l((k==null?void 0:k.owner_id)===h)}catch(y){console.error("Error checking car ownership:",y),l(!1)}finally{c(!1)}})()},[r]);const m=async()=>{if(!r)return;const p=`${window.location.origin}/cars/${r}`;try{navigator.share?(await navigator.share({title:`${e} ${s} (${n})`,text:`Let's rent this ${e} ${s} on Mobi Rides`,url:p}),H.success("Shared successfully")):(await navigator.clipboard.writeText(p),f(!0),H.success("Link copied to clipboard"),setTimeout(()=>{f(!1)},2e3))}catch(u){console.error("Error sharing:",u),H.error("Failed to share. Please try again.")}};return t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 p-4",children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-start",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl md:text-3xl text-left text-gray-700 dark:text-white font-bold",children:[e," ",s]}),t.jsxs("div",{className:"flex items-center gap-1 mt-1 text-sm md:text-base text-muted-foreground dark:text-white",children:[t.jsx(Os,{size:16,className:"h-4 w-4 mr-1 text-blue-500"}),t.jsx("span",{className:"text-sm md:text-base text-muted-foreground",children:n})]}),t.jsxs("div",{className:"flex items-center gap-1 mt-1 ",children:[t.jsx(Ge,{size:16,className:"h-4 w-4 mr-1 text-red-500"}),t.jsx("span",{className:"text-sm md:text-base text-muted-foreground",children:o})]}),t.jsxs("div",{className:"mt-8 flex items-center gap-1",children:[t.jsxs("h2",{className:"font-bold text-lg md:text-xl  text-primary",children:["BWP ",i]}),t.jsx("p",{className:"text-xs md:text-sm text-muted-foreground dark:text-white",children:"/day"})]})]}),t.jsxs("div",{className:"flex gap-2 mt-4 md:mt-0",children:[a&&t.jsx(J,{variant:"outline",size:"icon",className:"rounded-2xl md:size-auto md:px-4 md:py-2 md:flex md:items-center md:gap-2",asChild:!0,children:t.jsxs(ut,{to:`/edit-car/${r}`,children:[t.jsx(is,{className:"h-4 w-4 text-[#581CFA] dark:text-white"}),t.jsx("span",{className:"hidden md:inline-block",children:t.jsx("p",{className:"text-[#581CFA] dark:text-white text-xs md:text-sm lg:text-base font-semibold",children:"Edit Car"})})]})}),t.jsxs(xs,{open:b,onOpenChange:f,children:[t.jsx(gs,{asChild:!0,children:t.jsxs(J,{variant:"outline",size:"icon",className:"rounded-2xl md:size-auto md:px-4 md:py-2 md:flex md:items-center md:gap-2",onClick:m,children:[t.jsx(Hs,{className:"h-4 w-4 text-[#581CFA] dark:text-white"}),t.jsx("span",{className:"hidden md:inline-block",children:t.jsx("p",{className:"text-[#581CFA] dark:text-white text-xs md:text-sm lg:text-base font-semibold",children:"Share"})})]})}),t.jsx(ps,{className:"w-auto p-2 text-sm",children:"Link copied!"})]}),t.jsx(J,{variant:"outline",size:"icon",className:"rounded-2xl md:size-auto md:px-4 md:py-2 md:flex md:items-center md:gap-2",asChild:!0,children:t.jsxs(ut,{to:"/bookings",children:[t.jsx(Ue,{className:"h-4 w-4 text-[#581CFA] dark:text-white"}),t.jsx("span",{className:"hidden md:inline-block",children:t.jsx("p",{className:"text-[#581CFA] dark:text-white text-xs md:text-sm lg:text-base font-semibold",children:"Bookings"})})]})})]})]})})},dn=({transmission:e,fuel:s,seats:n,pricePerDay:o,features:i=[],variant:r="card"})=>{const a=l=>{switch(l){case"Air Conditioning":return t.jsx(As,{className:"h-4 w-4"});case"Bluetooth":return t.jsx(Bs,{className:"h-4 w-4"});case"Cruise Control":return t.jsx(mt,{className:"h-4 w-4"});case"Navigation System":return t.jsx(Fs,{className:"h-4 w-4"});case"Leather Seats":return t.jsx(gt,{className:"h-4 w-4"});case"Sunroof":return t.jsx(Js,{className:"h-4 w-4"});case"Backup Camera":return t.jsx(ht,{className:"h-4 w-4"});case"Parking Sensors":return t.jsx(Ys,{className:"h-4 w-4"});case"Keyless Entry":return t.jsx(ks,{className:"h-4 w-4"});case"Push Start":return t.jsx(qs,{className:"h-4 w-4"});case"Heated Seats":return t.jsx(Ks,{className:"h-4 w-4"});case"Premium Sound":return t.jsx(Vs,{className:"h-4 w-4"});case"Third Row Seating":return t.jsx(gt,{className:"h-4 w-4"});case"Blind Spot Monitor":return t.jsx(Ps,{className:"h-4 w-4"});case"360 Degree Camera":return t.jsx(ht,{className:"h-4 w-4"});case"Apple CarPlay":return t.jsx(xt,{className:"h-4 w-4"});case"Android Auto":return t.jsx(xt,{className:"h-4 w-4"});case"Roof Rack":return t.jsx(Rs,{className:"h-4 w-4"});case"Child Seat Anchor":return t.jsx(_s,{className:"h-4 w-4"});case"Autonomous Driving":return t.jsx(mt,{className:"h-4 w-4"});default:return t.jsx(Gs,{className:"h-4 w-4"})}};return r==="grid"?t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm text-gray-600",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Ms,{className:"w-4 h-4"}),e]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("i",{className:"w-4 h-4",children:"â›½"}),s]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("i",{className:"w-4 h-4",children:"ðŸ‘¥"}),n," Seats"]})]}):t.jsxs(Ke,{className:"dark:bg-gray-800 dark:border-gray-700",children:[t.jsx(Je,{className:"pb-2",children:t.jsx(Ye,{className:"text-base text-left text-muted-foreground dark:text-white font-medium",children:"Car Specifications"})}),t.jsxs(Qe,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-6",children:[t.jsxs("div",{className:"p-4 bg-muted rounded-lg text-left w-full",children:[t.jsx(Es,{className:"w-4 h-4 text-primary dark:text-primary-foreground"}),t.jsx("p",{className:"text-base md:text-xl text-left text-gray-700 dark:text-white font-medium mt-4",children:e}),t.jsx("p",{className:"text-xs md:text-sm text-muted-foreground",children:"Car Fuel"})]}),t.jsxs("div",{className:"p-4 bg-muted rounded-lg text-left",children:[t.jsx(cs,{className:"w-4 h-4 text-primary dark:text-primary-foreground"}),t.jsx("p",{className:"text-base md:text-xl text-left text-gray-700 dark:text-white font-medium mt-4",children:n}),t.jsx("p",{className:"text-xs md:text-sm text-muted-foreground",children:"Passenger Seats"})]})]}),i&&i.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("h3",{className:"mb-3 text-base text-left text-muted-foreground dark:text-white font-medium",children:"Car Features"}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2",children:i.map(l=>t.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-md border bg-muted/30",children:[t.jsx("span",{className:"text-primary",children:a(l)}),t.jsx("span",{className:"text-xs md:text-sm text-muted-foreground",children:l})]},l))})]})]})]})},un=({pricePerDay:e,transmission:s,seats:n,features:o=[]})=>t.jsx(dn,{transmission:s,fuel:"Petrol",seats:n,pricePerDay:e,features:o,variant:"card"});function fn(e){return Object.prototype.toString.call(e)==="[object Object]"}function kt(e){return fn(e)||Array.isArray(e)}function mn(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Xe(e,s){const n=Object.keys(e),o=Object.keys(s);if(n.length!==o.length)return!1;const i=JSON.stringify(Object.keys(e.breakpoints||{})),r=JSON.stringify(Object.keys(s.breakpoints||{}));return i!==r?!1:n.every(a=>{const l=e[a],d=s[a];return typeof l=="function"?`${l}`==`${d}`:!kt(l)||!kt(d)?l===d:Xe(l,d)})}function jt(e){return e.concat().sort((s,n)=>s.name>n.name?1:-1).map(s=>s.options)}function hn(e,s){if(e.length!==s.length)return!1;const n=jt(e),o=jt(s);return n.every((i,r)=>{const a=o[r];return Xe(i,a)})}function Ze(e){return typeof e=="number"}function Oe(e){return typeof e=="string"}function Pe(e){return typeof e=="boolean"}function vt(e){return Object.prototype.toString.call(e)==="[object Object]"}function B(e){return Math.abs(e)}function We(e){return Math.sign(e)}function ve(e,s){return B(e-s)}function xn(e,s){if(e===0||s===0||B(e)<=B(s))return 0;const n=ve(B(e),B(s));return B(n/e)}function we(e){return Ne(e).map(Number)}function ae(e){return e[Ce(e)]}function Ce(e){return Math.max(0,e.length-1)}function et(e,s){return s===Ce(e)}function wt(e,s=0){return Array.from(Array(e),(n,o)=>s+o)}function Ne(e){return Object.keys(e)}function $t(e,s){return[e,s].reduce((n,o)=>(Ne(o).forEach(i=>{const r=n[i],a=o[i],l=vt(r)&&vt(a);n[i]=l?$t(r,a):a}),n),{})}function $e(e,s){return typeof s.MouseEvent<"u"&&e instanceof s.MouseEvent}function gn(e,s){const n={start:o,center:i,end:r};function o(){return 0}function i(d){return r(d)/2}function r(d){return s-d}function a(d,c){return Oe(e)?n[e](d):e(s,d,c)}return{measure:a}}function Se(){let e=[];function s(i,r,a,l={passive:!0}){let d;if("addEventListener"in i)i.addEventListener(r,a,l),d=()=>i.removeEventListener(r,a,l);else{const c=i;c.addListener(a),d=()=>c.removeListener(a)}return e.push(d),o}function n(){e=e.filter(i=>i())}const o={add:s,clear:n};return o}function pn(e,s,n,o){const i=Se(),r=1e3/60;let a=null,l=0,d=0;function c(){i.add(e,"visibilitychange",()=>{e.hidden&&u()})}function b(){p(),i.clear()}function f(y){if(!d)return;a||(a=y);const h=y-a;for(a=y,l+=h;l>=r;)n(r),l-=r;const k=l/r;o(k),d&&s.requestAnimationFrame(f)}function m(){d||(d=s.requestAnimationFrame(f))}function p(){s.cancelAnimationFrame(d),a=null,l=0,d=0}function u(){a=null,l=0}return{init:c,destroy:b,start:m,stop:p,update:()=>n(r),render:o}}function yn(e,s){const n=s==="rtl",o=e==="y",i=o?"y":"x",r=o?"x":"y",a=!o&&n?-1:1,l=b(),d=f();function c(u){const{height:g,width:y}=u;return o?g:y}function b(){return o?"top":n?"right":"left"}function f(){return o?"bottom":n?"left":"right"}function m(u){return u*a}return{scroll:i,cross:r,startEdge:l,endEdge:d,measureSize:c,direction:m}}function ye(e=0,s=0){const n=B(e-s);function o(c){return c<e}function i(c){return c>s}function r(c){return o(c)||i(c)}function a(c){return r(c)?o(c)?e:s:c}function l(c){return n?c-n*Math.ceil((c-s)/n):c}return{length:n,max:s,min:e,constrain:a,reachedAny:r,reachedMax:i,reachedMin:o,removeOffset:l}}function Ft(e,s,n){const{constrain:o}=ye(0,e),i=e+1;let r=a(s);function a(m){return n?B((i+m)%i):o(m)}function l(){return r}function d(m){return r=a(m),f}function c(m){return b().set(l()+m)}function b(){return Ft(e,l(),n)}const f={get:l,set:d,add:c,clone:b};return f}function bn(e,s,n,o,i,r,a,l,d,c,b,f,m,p,u,g,y,h,k){const{cross:j,direction:L}=e,M=["INPUT","SELECT","TEXTAREA"],C={passive:!1},S=Se(),v=Se(),N=ye(50,225).constrain(p.measure(20)),T={mouse:300,touch:400},E={mouse:500,touch:600},R=u?43:25;let te=!1,ee=0,se=0,le=!1,Y=!1,q=!1,ne=!1;function ie(w){if(!k)return;function _(G){(Pe(k)||k(w,G))&&ge(G)}const A=s;S.add(A,"dragstart",G=>G.preventDefault(),C).add(A,"touchmove",()=>{},C).add(A,"touchend",()=>{}).add(A,"touchstart",_).add(A,"mousedown",_).add(A,"touchcancel",P).add(A,"contextmenu",P).add(A,"click",V,!0)}function U(){S.clear(),v.clear()}function de(){const w=ne?n:s;v.add(w,"touchmove",D,C).add(w,"touchend",P).add(w,"mousemove",D,C).add(w,"mouseup",P)}function ue(w){const _=w.nodeName||"";return M.includes(_)}function re(){return(u?E:T)[ne?"mouse":"touch"]}function xe(w,_){const A=f.add(We(w)*-1),G=b.byDistance(w,!u).distance;return u||B(w)<N?G:y&&_?G*.5:b.byIndex(A.get(),0).distance}function ge(w){const _=$e(w,o);ne=_,q=u&&_&&!w.buttons&&te,te=ve(i.get(),a.get())>=2,!(_&&w.button!==0)&&(ue(w.target)||(le=!0,r.pointerDown(w),c.useFriction(0).useDuration(0),i.set(a),de(),ee=r.readPoint(w),se=r.readPoint(w,j),m.emit("pointerDown")))}function D(w){if(!$e(w,o)&&w.touches.length>=2)return P(w);const A=r.readPoint(w),G=r.readPoint(w,j),Z=ve(A,ee),K=ve(G,se);if(!Y&&!ne&&(!w.cancelable||(Y=Z>K,!Y)))return P(w);const oe=r.pointerMove(w);Z>g&&(q=!0),c.useFriction(.3).useDuration(.75),l.start(),i.add(L(oe)),w.preventDefault()}function P(w){const A=b.byDistance(0,!1).index!==f.get(),G=r.pointerUp(w)*re(),Z=xe(L(G),A),K=xn(G,Z),oe=R-10*K,Q=h+K/50;Y=!1,le=!1,v.clear(),c.useDuration(oe).useFriction(Q),d.distance(Z,!u),ne=!1,m.emit("pointerUp")}function V(w){q&&(w.stopPropagation(),w.preventDefault(),q=!1)}function F(){return le}return{init:ie,destroy:U,pointerDown:F}}function kn(e,s){let o,i;function r(f){return f.timeStamp}function a(f,m){const u=`client${(m||e.scroll)==="x"?"X":"Y"}`;return($e(f,s)?f:f.touches[0])[u]}function l(f){return o=f,i=f,a(f)}function d(f){const m=a(f)-a(i),p=r(f)-r(o)>170;return i=f,p&&(o=f),m}function c(f){if(!o||!i)return 0;const m=a(i)-a(o),p=r(f)-r(o),u=r(f)-r(i)>170,g=m/p;return p&&!u&&B(g)>.1?g:0}return{pointerDown:l,pointerMove:d,pointerUp:c,readPoint:a}}function jn(){function e(n){const{offsetTop:o,offsetLeft:i,offsetWidth:r,offsetHeight:a}=n;return{top:o,right:i+r,bottom:o+a,left:i,width:r,height:a}}return{measure:e}}function vn(e){function s(o){return e*(o/100)}return{measure:s}}function wn(e,s,n,o,i,r,a){const l=[e].concat(o);let d,c,b=[],f=!1;function m(y){return i.measureSize(a.measure(y))}function p(y){if(!r)return;c=m(e),b=o.map(m);function h(k){for(const j of k){if(f)return;const L=j.target===e,M=o.indexOf(j.target),C=L?c:b[M],S=m(L?e:o[M]);if(B(S-C)>=.5){y.reInit(),s.emit("resize");break}}}d=new ResizeObserver(k=>{(Pe(r)||r(y,k))&&h(k)}),n.requestAnimationFrame(()=>{l.forEach(k=>d.observe(k))})}function u(){f=!0,d&&d.disconnect()}return{init:p,destroy:u}}function Nn(e,s,n,o,i,r){let a=0,l=0,d=i,c=r,b=e.get(),f=0;function m(C){const S=C/1e3,v=d*S,N=o.get()-e.get(),T=!d;let E=0;return T?(a=0,n.set(o),e.set(o),E=N):(n.set(e),a+=N/v,a*=c,b+=a,e.add(a*S),E=b-f),l=We(E),f=b,M}function p(){const C=o.get()-s.get();return B(C)<.001}function u(){return d}function g(){return l}function y(){return a}function h(){return j(i)}function k(){return L(r)}function j(C){return d=C,M}function L(C){return c=C,M}const M={direction:g,duration:u,velocity:y,seek:m,settled:p,useBaseFriction:k,useBaseDuration:h,useFriction:L,useDuration:j};return M}function Sn(e,s,n,o,i){const r=i.measure(10),a=i.measure(50),l=ye(.1,.99);let d=!1;function c(){return!(d||!e.reachedAny(n.get())||!e.reachedAny(s.get()))}function b(p){if(!c())return;const u=e.reachedMin(s.get())?"min":"max",g=B(e[u]-s.get()),y=n.get()-s.get(),h=l.constrain(g/a);n.subtract(y*h),!p&&B(y)<r&&(n.set(e.constrain(n.get())),o.useDuration(25).useBaseFriction())}function f(p){d=!p}return{shouldConstrain:c,constrain:b,toggleActive:f}}function Cn(e,s,n,o,i){const r=ye(-s+e,0),a=f(),l=b(),d=m();function c(u,g){return ve(u,g)<1}function b(){const u=a[0],g=ae(a),y=a.lastIndexOf(u),h=a.indexOf(g)+1;return ye(y,h)}function f(){return n.map((u,g)=>{const{min:y,max:h}=r,k=r.constrain(u),j=!g,L=et(n,g);return j?h:L||c(y,k)?y:c(h,k)?h:k}).map(u=>parseFloat(u.toFixed(3)))}function m(){if(s<=e+i)return[r.max];if(o==="keepSnaps")return a;const{min:u,max:g}=l;return a.slice(u,g)}return{snapsContained:d,scrollContainLimit:l}}function Ln(e,s,n){const o=s[0],i=n?o-e:ae(s);return{limit:ye(i,o)}}function En(e,s,n,o){const r=s.min+.1,a=s.max+.1,{reachedMin:l,reachedMax:d}=ye(r,a);function c(m){return m===1?d(n.get()):m===-1?l(n.get()):!1}function b(m){if(!c(m))return;const p=e*(m*-1);o.forEach(u=>u.add(p))}return{loop:b}}function Mn(e){const{max:s,length:n}=e;function o(r){const a=r-s;return n?a/-n:0}return{get:o}}function Pn(e,s,n,o,i){const{startEdge:r,endEdge:a}=e,{groupSlides:l}=i,d=f().map(s.measure),c=m(),b=p();function f(){return l(o).map(g=>ae(g)[a]-g[0][r]).map(B)}function m(){return o.map(g=>n[r]-g[r]).map(g=>-B(g))}function p(){return l(c).map(g=>g[0]).map((g,y)=>g+d[y])}return{snaps:c,snapsAligned:b}}function Dn(e,s,n,o,i,r){const{groupSlides:a}=i,{min:l,max:d}=o,c=b();function b(){const m=a(r),p=!e||s==="keepSnaps";return n.length===1?[r]:p?m:m.slice(l,d).map((u,g,y)=>{const h=!g,k=et(y,g);if(h){const j=ae(y[0])+1;return wt(j)}if(k){const j=Ce(r)-ae(y)[0]+1;return wt(j,ae(y)[0])}return u})}return{slideRegistry:c}}function In(e,s,n,o,i){const{reachedAny:r,removeOffset:a,constrain:l}=o;function d(u){return u.concat().sort((g,y)=>B(g)-B(y))[0]}function c(u){const g=e?a(u):l(u),y=s.map((k,j)=>({diff:b(k-g,0),index:j})).sort((k,j)=>B(k.diff)-B(j.diff)),{index:h}=y[0];return{index:h,distance:g}}function b(u,g){const y=[u,u+n,u-n];if(!e)return u;if(!g)return d(y);const h=y.filter(k=>We(k)===g);return h.length?d(h):ae(y)-n}function f(u,g){const y=s[u]-i.get(),h=b(y,g);return{index:u,distance:h}}function m(u,g){const y=i.get()+u,{index:h,distance:k}=c(y),j=!e&&r(y);if(!g||j)return{index:h,distance:u};const L=s[h]-k,M=u+b(L,0);return{index:h,distance:M}}return{byDistance:m,byIndex:f,shortcut:b}}function Tn(e,s,n,o,i,r,a){function l(f){const m=f.distance,p=f.index!==s.get();r.add(m),m&&(o.duration()?e.start():(e.update(),e.render(1),e.update())),p&&(n.set(s.get()),s.set(f.index),a.emit("select"))}function d(f,m){const p=i.byDistance(f,m);l(p)}function c(f,m){const p=s.clone().set(f),u=i.byIndex(p.get(),m);l(u)}return{distance:d,index:c}}function An(e,s,n,o,i,r,a,l){const d={passive:!0,capture:!0};let c=0;function b(p){if(!l)return;function u(g){if(new Date().getTime()-c>10)return;a.emit("slideFocusStart"),e.scrollLeft=0;const k=n.findIndex(j=>j.includes(g));Ze(k)&&(i.useDuration(0),o.index(k,0),a.emit("slideFocus"))}r.add(document,"keydown",f,!1),s.forEach((g,y)=>{r.add(g,"focus",h=>{(Pe(l)||l(p,h))&&u(y)},d)})}function f(p){p.code==="Tab"&&(c=new Date().getTime())}return{init:b}}function je(e){let s=e;function n(){return s}function o(d){s=a(d)}function i(d){s+=a(d)}function r(d){s-=a(d)}function a(d){return Ze(d)?d:d.get()}return{get:n,set:o,add:i,subtract:r}}function Rt(e,s){const n=e.scroll==="x"?r:a,o=s.style;let i=!1;function r(f){return`translate3d(${f}px,0px,0px)`}function a(f){return`translate3d(0px,${f}px,0px)`}function l(f){i||(o.transform=n(e.direction(f)))}function d(f){i=!f}function c(){i||(o.transform="",s.getAttribute("style")||s.removeAttribute("style"))}return{clear:c,to:l,toggleActive:d}}function _n(e,s,n,o,i,r,a,l,d){const b=we(i),f=we(i).reverse(),m=h().concat(k());function p(S,v){return S.reduce((N,T)=>N-i[T],v)}function u(S,v){return S.reduce((N,T)=>p(N,v)>0?N.concat([T]):N,[])}function g(S){return r.map((v,N)=>({start:v-o[N]+.5+S,end:v+s-.5+S}))}function y(S,v,N){const T=g(v);return S.map(E=>{const R=N?0:-n,te=N?n:0,ee=N?"end":"start",se=T[E][ee];return{index:E,loopPoint:se,slideLocation:je(-1),translate:Rt(e,d[E]),target:()=>l.get()>se?R:te}})}function h(){const S=a[0],v=u(f,S);return y(v,n,!1)}function k(){const S=s-a[0]-1,v=u(b,S);return y(v,-n,!0)}function j(){return m.every(({index:S})=>{const v=b.filter(N=>N!==S);return p(v,s)<=.1})}function L(){m.forEach(S=>{const{target:v,translate:N,slideLocation:T}=S,E=v();E!==T.get()&&(N.to(E),T.set(E))})}function M(){m.forEach(S=>S.translate.clear())}return{canLoop:j,clear:M,loop:L,loopPoints:m}}function Bn(e,s,n){let o,i=!1;function r(d){if(!n)return;function c(b){for(const f of b)if(f.type==="childList"){d.reInit(),s.emit("slidesChanged");break}}o=new MutationObserver(b=>{i||(Pe(n)||n(d,b))&&c(b)}),o.observe(e,{childList:!0})}function a(){o&&o.disconnect(),i=!0}return{init:r,destroy:a}}function On(e,s,n,o){const i={};let r=null,a=null,l,d=!1;function c(){l=new IntersectionObserver(u=>{d||(u.forEach(g=>{const y=s.indexOf(g.target);i[y]=g}),r=null,a=null,n.emit("slidesInView"))},{root:e.parentElement,threshold:o}),s.forEach(u=>l.observe(u))}function b(){l&&l.disconnect(),d=!0}function f(u){return Ne(i).reduce((g,y)=>{const h=parseInt(y),{isIntersecting:k}=i[h];return(u&&k||!u&&!k)&&g.push(h),g},[])}function m(u=!0){if(u&&r)return r;if(!u&&a)return a;const g=f(u);return u&&(r=g),u||(a=g),g}return{init:c,destroy:b,get:m}}function $n(e,s,n,o,i,r){const{measureSize:a,startEdge:l,endEdge:d}=e,c=n[0]&&i,b=u(),f=g(),m=n.map(a),p=y();function u(){if(!c)return 0;const k=n[0];return B(s[l]-k[l])}function g(){if(!c)return 0;const k=r.getComputedStyle(ae(o));return parseFloat(k.getPropertyValue(`margin-${d}`))}function y(){return n.map((k,j,L)=>{const M=!j,C=et(L,j);return M?m[j]+b:C?m[j]+f:L[j+1][l]-k[l]}).map(B)}return{slideSizes:m,slideSizesWithGaps:p,startGap:b,endGap:f}}function Fn(e,s,n,o,i,r,a,l,d){const{startEdge:c,endEdge:b,direction:f}=e,m=Ze(n);function p(h,k){return we(h).filter(j=>j%k===0).map(j=>h.slice(j,j+k))}function u(h){return h.length?we(h).reduce((k,j,L)=>{const M=ae(k)||0,C=M===0,S=j===Ce(h),v=i[c]-r[M][c],N=i[c]-r[j][b],T=!o&&C?f(a):0,E=!o&&S?f(l):0,R=B(N-E-(v+T));return L&&R>s+d&&k.push(j),S&&k.push(h.length),k},[]).map((k,j,L)=>{const M=Math.max(L[j-1]||0);return h.slice(M,k)}):[]}function g(h){return m?p(h,n):u(h)}return{groupSlides:g}}function Rn(e,s,n,o,i,r,a){const{align:l,axis:d,direction:c,startIndex:b,loop:f,duration:m,dragFree:p,dragThreshold:u,inViewThreshold:g,slidesToScroll:y,skipSnaps:h,containScroll:k,watchResize:j,watchSlides:L,watchDrag:M,watchFocus:C}=r,S=2,v=jn(),N=v.measure(s),T=n.map(v.measure),E=yn(d,c),R=E.measureSize(N),te=vn(R),ee=gn(l,R),se=!f&&!!k,le=f||!!k,{slideSizes:Y,slideSizesWithGaps:q,startGap:ne,endGap:ie}=$n(E,N,T,n,le,i),U=Fn(E,R,y,f,N,T,ne,ie,S),{snaps:de,snapsAligned:ue}=Pn(E,ee,N,T,U),re=-ae(de)+ae(q),{snapsContained:xe,scrollContainLimit:ge}=Cn(R,re,ue,k,S),D=se?xe:ue,{limit:P}=Ln(re,D,f),V=Ft(Ce(D),b,f),F=V.clone(),I=we(n),w=({dragHandler:fe,scrollBody:Te,scrollBounds:Ae,options:{loop:Ee}},_e)=>{Ee||Ae.constrain(fe.pointerDown()),Te.seek(_e)},_=({scrollBody:fe,translate:Te,location:Ae,offsetLocation:Ee,scrollLooper:_e,slideLooper:Yt,dragHandler:Qt,animation:Xt,eventHandler:nt,scrollBounds:Zt,options:{loop:rt}},ot)=>{const at=fe.settled(),Wt=!Zt.shouldConstrain(),it=rt?at:at&&Wt;it&&!Qt.pointerDown()&&(Xt.stop(),nt.emit("settle")),it||nt.emit("scroll");const es=Ae.get()*ot+oe.get()*(1-ot);Ee.set(es),rt&&(_e.loop(fe.direction()),Yt.loop()),Te.to(Ee.get())},A=pn(o,i,fe=>w(Ie,fe),fe=>_(Ie,fe)),G=.68,Z=D[V.get()],K=je(Z),oe=je(Z),Q=je(Z),X=je(Z),pe=Nn(K,Q,oe,X,m,G),be=In(f,D,re,P,X),ke=Tn(A,V,F,pe,be,X,a),O=Mn(P),Le=Se(),Kt=On(s,n,a,g),{slideRegistry:st}=Dn(se,k,D,ge,U,I),Jt=An(e,n,st,ke,pe,Le,a,C),Ie={ownerDocument:o,ownerWindow:i,eventHandler:a,containerRect:N,slideRects:T,animation:A,axis:E,dragHandler:bn(E,e,o,i,X,kn(E,i),K,A,ke,pe,be,V,a,te,p,u,h,G,M),eventStore:Le,percentOfView:te,index:V,indexPrevious:F,limit:P,location:K,offsetLocation:Q,previousLocation:oe,options:r,resizeHandler:wn(s,a,i,n,E,j,v),scrollBody:pe,scrollBounds:Sn(P,Q,X,pe,te),scrollLooper:En(re,P,Q,[K,Q,oe,X]),scrollProgress:O,scrollSnapList:D.map(O.get),scrollSnaps:D,scrollTarget:be,scrollTo:ke,slideLooper:_n(E,R,re,Y,q,de,D,Q,n),slideFocus:Jt,slidesHandler:Bn(s,a,L),slidesInView:Kt,slideIndexes:I,slideRegistry:st,slidesToScroll:U,target:X,translate:Rt(E,s)};return Ie}function zn(){let e={},s;function n(c){s=c}function o(c){return e[c]||[]}function i(c){return o(c).forEach(b=>b(s,c)),d}function r(c,b){return e[c]=o(c).concat([b]),d}function a(c,b){return e[c]=o(c).filter(f=>f!==b),d}function l(){e={}}const d={init:n,emit:i,off:a,on:r,clear:l};return d}const qn={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function Vn(e){function s(r,a){return $t(r,a||{})}function n(r){const a=r.breakpoints||{},l=Ne(a).filter(d=>e.matchMedia(d).matches).map(d=>a[d]).reduce((d,c)=>s(d,c),{});return s(r,l)}function o(r){return r.map(a=>Ne(a.breakpoints||{})).reduce((a,l)=>a.concat(l),[]).map(e.matchMedia)}return{mergeOptions:s,optionsAtMedia:n,optionsMediaQueries:o}}function Hn(e){let s=[];function n(r,a){return s=a.filter(({options:l})=>e.optionsAtMedia(l).active!==!1),s.forEach(l=>l.init(r,e)),a.reduce((l,d)=>Object.assign(l,{[d.name]:d}),{})}function o(){s=s.filter(r=>r.destroy())}return{init:n,destroy:o}}function Me(e,s,n){const o=e.ownerDocument,i=o.defaultView,r=Vn(i),a=Hn(r),l=Se(),d=zn(),{mergeOptions:c,optionsAtMedia:b,optionsMediaQueries:f}=r,{on:m,off:p,emit:u}=d,g=E;let y=!1,h,k=c(qn,Me.globalOptions),j=c(k),L=[],M,C,S;function v(){const{container:I,slides:w}=j;C=(Oe(I)?e.querySelector(I):I)||e.children[0];const A=Oe(w)?C.querySelectorAll(w):w;S=[].slice.call(A||C.children)}function N(I){const w=Rn(e,C,S,o,i,I,d);if(I.loop&&!w.slideLooper.canLoop()){const _=Object.assign({},I,{loop:!1});return N(_)}return w}function T(I,w){y||(k=c(k,I),j=b(k),L=w||L,v(),h=N(j),f([k,...L.map(({options:_})=>_)]).forEach(_=>l.add(_,"change",E)),j.active&&(h.translate.to(h.location.get()),h.animation.init(),h.slidesInView.init(),h.slideFocus.init(F),h.eventHandler.init(F),h.resizeHandler.init(F),h.slidesHandler.init(F),h.options.loop&&h.slideLooper.loop(),C.offsetParent&&S.length&&h.dragHandler.init(F),M=a.init(F,L)))}function E(I,w){const _=U();R(),T(c({startIndex:_},I),w),d.emit("reInit")}function R(){h.dragHandler.destroy(),h.eventStore.clear(),h.translate.clear(),h.slideLooper.clear(),h.resizeHandler.destroy(),h.slidesHandler.destroy(),h.slidesInView.destroy(),h.animation.destroy(),a.destroy(),l.clear()}function te(){y||(y=!0,l.clear(),R(),d.emit("destroy"),d.clear())}function ee(I,w,_){!j.active||y||(h.scrollBody.useBaseFriction().useDuration(w===!0?0:j.duration),h.scrollTo.index(I,_||0))}function se(I){const w=h.index.add(1).get();ee(w,I,-1)}function le(I){const w=h.index.add(-1).get();ee(w,I,1)}function Y(){return h.index.add(1).get()!==U()}function q(){return h.index.add(-1).get()!==U()}function ne(){return h.scrollSnapList}function ie(){return h.scrollProgress.get(h.location.get())}function U(){return h.index.get()}function de(){return h.indexPrevious.get()}function ue(){return h.slidesInView.get()}function re(){return h.slidesInView.get(!1)}function xe(){return M}function ge(){return h}function D(){return e}function P(){return C}function V(){return S}const F={canScrollNext:Y,canScrollPrev:q,containerNode:P,internalEngine:ge,destroy:te,off:p,on:m,emit:u,plugins:xe,previousScrollSnap:de,reInit:g,rootNode:D,scrollNext:se,scrollPrev:le,scrollProgress:ie,scrollSnapList:ne,scrollTo:ee,selectedScrollSnap:U,slideNodes:V,slidesInView:ue,slidesNotInView:re};return T(s,n),setTimeout(()=>d.emit("init"),0),F}Me.globalOptions=void 0;function tt(e={},s=[]){const n=x.useRef(e),o=x.useRef(s),[i,r]=x.useState(),[a,l]=x.useState(),d=x.useCallback(()=>{i&&i.reInit(n.current,o.current)},[i]);return x.useEffect(()=>{Xe(n.current,e)||(n.current=e,d())},[e,d]),x.useEffect(()=>{hn(o.current,s)||(o.current=s,d())},[s,d]),x.useEffect(()=>{if(mn()&&a){Me.globalOptions=tt.globalOptions;const c=Me(a,n.current,o.current);return r(c),()=>c.destroy()}else r(void 0)},[a,r]),[l,i]}tt.globalOptions=void 0;const zt=x.createContext(null);function De(){const e=x.useContext(zt);if(!e)throw new Error("useCarousel must be used within a <Carousel />");return e}const qt=x.forwardRef(({orientation:e="horizontal",opts:s,setApi:n,plugins:o,className:i,children:r,...a},l)=>{const[d,c]=tt({...s,axis:e==="horizontal"?"x":"y"},o),[b,f]=x.useState(!1),[m,p]=x.useState(!1),u=x.useCallback(k=>{k&&(f(k.canScrollPrev()),p(k.canScrollNext()))},[]),g=x.useCallback(()=>{c==null||c.scrollPrev()},[c]),y=x.useCallback(()=>{c==null||c.scrollNext()},[c]),h=x.useCallback(k=>{k.key==="ArrowLeft"?(k.preventDefault(),g()):k.key==="ArrowRight"&&(k.preventDefault(),y())},[g,y]);return x.useEffect(()=>{!c||!n||n(c)},[c,n]),x.useEffect(()=>{if(c)return u(c),c.on("reInit",u),c.on("select",u),()=>{c==null||c.off("select",u)}},[c,u]),t.jsx(zt.Provider,{value:{carouselRef:d,api:c,opts:s,orientation:e||((s==null?void 0:s.axis)==="y"?"vertical":"horizontal"),scrollPrev:g,scrollNext:y,canScrollPrev:b,canScrollNext:m},children:t.jsx("div",{ref:l,onKeyDownCapture:h,className:ce("relative",i),role:"region","aria-roledescription":"carousel",...a,children:r})})});qt.displayName="Carousel";const Vt=x.forwardRef(({className:e,...s},n)=>{const{carouselRef:o,orientation:i}=De();return t.jsx("div",{ref:o,className:"overflow-hidden",children:t.jsx("div",{ref:n,className:ce("flex",i==="horizontal"?"-ml-4":"-mt-4 flex-col",e),...s})})});Vt.displayName="CarouselContent";const Ht=x.forwardRef(({className:e,...s},n)=>{const{orientation:o}=De();return t.jsx("div",{ref:n,role:"group","aria-roledescription":"slide",className:ce("min-w-0 shrink-0 grow-0 basis-full",o==="horizontal"?"pl-4":"pt-4",e),...s})});Ht.displayName="CarouselItem";const Ut=x.forwardRef(({className:e,variant:s="outline",size:n="icon",...o},i)=>{const{orientation:r,scrollPrev:a,canScrollPrev:l}=De();return t.jsxs(J,{ref:i,variant:s,size:n,className:ce("absolute  h-8 w-8 rounded-full",r==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",e),disabled:!l,onClick:a,...o,children:[t.jsx(ls,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Previous slide"})]})});Ut.displayName="CarouselPrevious";const Gt=x.forwardRef(({className:e,variant:s="outline",size:n="icon",...o},i)=>{const{orientation:r,scrollNext:a,canScrollNext:l}=De();return t.jsxs(J,{ref:i,variant:s,size:n,className:ce("absolute h-8 w-8 rounded-full",r==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",e),disabled:!l,onClick:a,...o,children:[t.jsx(Ds,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Next slide"})]})});Gt.displayName="CarouselNext";const Un=({carId:e,mainImageUrl:s})=>{const{data:n,isLoading:o}=Fe({queryKey:["car-images",e],queryFn:async()=>{console.log("Fetching images for car:",e);const{data:i,error:r}=await $.from("car_images").select("*").eq("car_id",e);if(r)throw console.error("Error fetching car images:",r),r;const a=s?[{id:"main",image_url:s},...i||[]]:i||[];return console.log("Retrieved images:",a),a}});return o?t.jsx(me,{className:"w-full h-64 rounded-lg"}):n!=null&&n.length?t.jsxs(qt,{className:"w-full",children:[t.jsx(Vt,{children:n.map(i=>t.jsx(Ht,{children:t.jsx("img",{src:i.image_url,alt:"Car",className:"w-full h-64 object-cover rounded-lg"})},i.id))}),t.jsx(Ut,{className:"left-2"}),t.jsx(Gt,{className:"right-2"})]}):t.jsx("div",{className:"w-full h-64 bg-muted rounded-lg flex items-center justify-center",children:t.jsx("p",{className:"text-muted-foreground",children:"No images available"})})},Gn=({car:e})=>{const[s,n]=x.useState(!1),[o,i]=x.useState(0),[r,a]=x.useState("");Ct();const{data:l,isLoading:d}=Fe({queryKey:["car-reviews",e.id],queryFn:async()=>{console.log("Fetching reviews for car:",e.id);const{data:c,error:b}=await $.from("reviews").select(`
          *,
          reviewer:profiles!reviewer_id (
            full_name,
            avatar_url
          )
        `).eq("car_id",e.id).eq("review_type","car").order("created_at",{ascending:!1});if(b)throw console.error("Error fetching reviews:",b),b;return console.log("Retrieved reviews:",c),c}});return t.jsxs(Ke,{className:"dark:bg-gray-800 dark:border-gray-700",children:[t.jsx(Je,{className:"pb-2",children:t.jsxs(Ye,{className:"text-lg flex items-center justify-between dark:text-white",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("span",{className:"text-base text-left text-muted-foreground dark:text-white font-medium",children:"Reviews"})}),t.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:[(l==null?void 0:l.length)||0," ",(l==null?void 0:l.length)===1?"review":"reviews"]})]})}),t.jsx(Qe,{children:t.jsxs("div",{className:"space-y-4",children:[(l==null?void 0:l.length)===0&&t.jsx("div",{className:"text-center py-6",children:t.jsx("span",{className:"text-xs md:text-sm text-muted-foreground",children:"No reviews yet"})}),l==null?void 0:l.map(c=>t.jsxs("div",{className:"border rounded-lg p-4 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:c.reviewer.avatar_url?$.storage.from("avatars").getPublicUrl(c.reviewer.avatar_url).data.publicUrl:"/placeholder.svg",alt:c.reviewer.full_name,className:"w-8 h-8 rounded-full object-cover"}),t.jsx("span",{className:"font-medium",children:c.reviewer.full_name})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex gap-0.5 mr-2",children:Array.from({length:c.rating}).map((b,f)=>t.jsx(Is,{className:"h-4 w-4 text-yellow-500",fill:"currentColor"},f))}),t.jsx("span",{className:"text-xs text-muted-foreground",children:c.created_at?W(new Date(c.created_at),"MMM d, yyyy"):""})]})]}),c.comment&&t.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:c.comment})]},c.id))]})})]})},Kn=({latitude:e,longitude:s,location:n,mapStyle:o="mapbox://styles/mapbox/streets-v12"})=>{const i=x.useRef(null),r=x.useRef(null),a=x.useRef(null),l=x.useRef(!1),[d,c]=x.useState(null),[b,f]=x.useState(!0),m="mapbox://styles/mapbox/light-v11";return x.useEffect(()=>{(async()=>{try{const u=await St();if(!u){H.error("Failed to get the map token");return}c(u),f(!1)}catch(u){console.error("Error getting Mapbox token:",u),H.error("Failed to load map configuration")}})()},[]),x.useEffect(()=>{if(b||!i.current)return;const p=i.current;if(p.offsetWidth===0||p.offsetHeight===0){console.error("Map container has zero width or height");return}if(console.log("Initializing map with coordinates:",{longitude:s,latitude:e}),d)he.accessToken=d;else{console.error("No Mapbox token available");return}try{r.current=new he.Map({container:i.current,style:o||m,center:[s,e],zoom:13,interactive:!1}),r.current.on("load",()=>{console.log("Map loaded successfully"),a.current=new he.Marker({color:"#7C3AED"}).setLngLat([s,e]).addTo(r.current),l.current=!0}),r.current.on("style.load",()=>{console.log("Map style loaded successfully")}),r.current.on("error",u=>{var g;console.error("Map error:",u),H.error("Error loading location map"),u.error&&u.error.message.includes("style")&&o!==m&&(console.log("Attempting to load fallback style"),(g=r.current)==null||g.setStyle(m))})}catch(u){console.error("Error initializing map:",u),H.error("Could not initialize location map")}return()=>{r.current&&(r.current.remove(),r.current=null,a.current=null,l.current=!1)}},[e,s,d,o,b]),x.useEffect(()=>{r.current&&l.current&&a.current&&(r.current.setCenter([s,e]),a.current.setLngLat([s,e]))},[e,s]),x.useEffect(()=>{r.current&&l.current&&r.current.setStyle(o||m)},[o]),t.jsxs(Ke,{className:"dark:bg-gray-800 dark:border-gray-700",children:[t.jsx(Je,{className:"pb-2",children:t.jsx(Ye,{className:"text-base text-left text-muted-foreground dark:text-white font-medium",children:"Location"})}),t.jsxs(Qe,{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(Ge,{size:16,className:"text-red-500 "}),t.jsx("p",{className:"text-xs md:text-sm text-left text-muted-foreground dark:text-gray-300",children:n})]}),t.jsx("div",{ref:i,className:"w-full h-40 rounded-md overflow-hidden border border-muted dark:border-gray-700"})]})]})},Jn=e=>({...e,description:e.description??"No description available",features:e.features??[],image_url:e.image_url??"/placeholder-car.jpg",latitude:e.latitude??0,longitude:e.longitude??0,is_available:e.is_available??!0}),Sr=()=>{var a,l;const{carId:e}=Lt(),{theme:s}=ds();Ts.useUser();const{data:n,isLoading:o,error:i}=Fe({queryKey:["car",e],queryFn:async()=>{const{data:d,error:c}=await $.from("cars").select("*, profiles:owner_id (full_name, avatar_url)").eq("id",e).maybeSingle();if(c)throw c;if(!d)throw new Error("Car not found");return Jn(d)}});if(o)return t.jsxs("div",{className:"min-h-screen bg-background dark:bg-gray-900",children:[t.jsxs("div",{className:"container mx-auto",children:[t.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[200px] w-full p-4",children:[t.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-400 mb-3",children:"Loading vehicle details..."}),t.jsx(us,{color:"#7c3aed",width:100})]}),t.jsxs("div",{className:"space-y-4 p-4 mt-4",children:[t.jsx(me,{className:"h-64 w-full bg-gray-200 dark:bg-gray-700"}),t.jsx(me,{className:"h-8 w-3/4 bg-gray-200 dark:bg-gray-700"}),t.jsx(me,{className:"h-4 w-1/2 bg-gray-200 dark:bg-gray-700"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx(me,{className:"h-20 bg-gray-200 dark:bg-gray-700"}),t.jsx(me,{className:"h-20 bg-gray-200 dark:bg-gray-700"}),t.jsx(me,{className:"h-20 bg-gray-200 dark:bg-gray-700"})]})]})]}),t.jsx(Be,{})]});if(i||!n)return t.jsxs("div",{className:"min-h-screen bg-background dark:bg-gray-900",children:[t.jsx("div",{className:"container mx-auto",children:t.jsxs("div",{className:"p-4 text-center space-y-4",children:[t.jsx(fs,{className:"h-12 w-12 text-red-500 mx-auto"}),t.jsx("h2",{className:"text-xl font-semibold text-red-500",children:"Error loading vehicle details"}),t.jsx("p",{className:"text-muted-foreground dark:text-gray-400",children:"Please try again later"})]})}),t.jsx(Be,{})]});const r=((a=n.profiles)==null?void 0:a.avatar_url)||null;return t.jsxs("div",{className:"min-h-screen bg-background dark:bg-gray-900 pb-20",children:[t.jsx("div",{className:"container mx-auto",children:t.jsxs("div",{className:"space-y-4 p-4",children:[t.jsx(Un,{carId:n.id,mainImageUrl:n.image_url}),t.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[t.jsx(ln,{brand:n.brand,model:n.model,year:n.year,location:n.location,pricePerDay:n.price_per_day}),t.jsx(un,{pricePerDay:n.price_per_day,transmission:n.transmission,seats:n.seats,features:n.features}),n.description&&t.jsx(js,{description:n.description}),t.jsx(Kn,{latitude:n.latitude,longitude:n.longitude,location:n.location,mapStyle:s==="dark"?"mapbox://styles/mapbox/dark-v11":"mapbox://styles/mapbox/light-v11"}),t.jsx(vs,{ownerName:((l=n.profiles)==null?void 0:l.full_name)||"Car Owner",avatarUrl:r,ownerId:n.owner_id}),t.jsx(Gn,{car:n})]}),t.jsx(cn,{car:n})]})}),t.jsx(Be,{})]})};export{Sr as default};
