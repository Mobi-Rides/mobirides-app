import{k as x,r as u,n as f,j as e,B as g,o as v,s as l,J as h}from"./index-B1v-fdDy.js";import{C as j}from"./CarGrid-Bwj_3Ehp.js";import{N as y}from"./Navigation-B7IoAuwX.js";import{A as N}from"./arrow-left-C5bMyyle.js";import"./card-BByP0N-G.js";import"./savedCarService-CH1V1nh4.js";import"./calendar-Blx7UGIQ.js";import"./format-BOBWS5Wu.js";import"./addDays-Di48Ycau.js";import"./chevron-right-CgiltgM9.js";import"./useVerificationStatus-BsTQxagy.js";import"./VerificationRequiredDialog-BhXpjI7V.js";import"./badge-CMWgFMV2.js";import"./shield-BbSxX3Ts.js";import"./file-text-25BybcTk.js";import"./camera-BVx23dB2.js";import"./phone-C1RE3XPx.js";import"./circle-check-big-BC5npB6H.js";import"./arrow-right-wlC4lylp.js";import"./scroll-area-DG1WSctR.js";import"./index-BdQq_4o_.js";import"./CustomMapbox-B-n_RDKf.js";import"./send-BDkAZ2Oi.js";import"./OnlineStatusToggle-jbesaRgw.js";import"./select-DXEtncUe.js";import"./check-BnE2eJB3.js";import"./skeleton-B5zSXtNC.js";import"./user-ClMVbWgE.js";import"./star-C2MEvl-w.js";import"./clock-CASyaKu3.js";import"./circle-alert-B4G_r9SV.js";import"./separator-BMDiheLN.js";import"./users-BmNgVsFF.js";const re=()=>{const d=x(),m=u.useRef(null),{data:a=[],isLoading:i,error:n}=f({queryKey:["saved-cars-full"],queryFn:async()=>{console.log("Fetching saved cars...");const{data:{session:s}}=await l.auth.getSession();if(!s)return console.log("No active session found when fetching saved cars"),[];console.log("Using user ID for saved cars:",s.user.id);const{data:r,error:o}=await l.from("saved_cars").select(`
          car_id,
          cars:car_id(*)
        `).eq("user_id",s.user.id);if(o)throw console.error("Error fetching saved cars:",o),h.error("Could not load your saved cars. Please try again."),o;if(console.log("Raw saved cars data:",r),!Array.isArray(r)||r.length===0)return console.log("No saved cars found for user"),[];const c=r.filter(t=>t.cars).map(t=>({...t.cars,isSaved:!0}));return console.log("Processed cars:",c),c}}),p=()=>{console.log("Load more triggered in SavedCars")};return e.jsxs("div",{className:"min-h-screen px-4 pb-20",children:[e.jsxs("div",{className:"px-4 py-4 mb-4 flex items-center gap-4",children:[e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>d(-1),children:e.jsx(N,{className:"h-4 w-4"})}),e.jsx("h1",{className:"text-xl md:text-2xl text-left font-semibold",children:"Profile"})]}),e.jsx("main",{className:"px-4 py-6",children:i?e.jsx(v,{}):n?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("p",{className:"text-base text-muted-foreground mb-4",children:"Unable to load saved cars"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"text-sm text-primary hover:underline",children:"Try again"})]}):a.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:e.jsx("p",{className:"text-base text-muted-foreground",children:"No saved cars yet"})}):e.jsx(j,{cars:a,isLoading:i,error:n,loadMoreRef:m,onLoadMore:p,isFetchingNextPage:!1,isAuthenticated:!0})}),e.jsx(y,{})]})};export{re as default};
