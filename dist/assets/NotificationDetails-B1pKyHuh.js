import{u as y,j as e}from"./query-vendor-Bsfdn-Hb.js";import{k as w,u as v,R as k,N as l}from"./react-vendor-mnpoGfEl.js";import{a3 as _,L as C,B as c,n as d,s as m}from"./index-CEKMvnhM.js";import{C as R,a as B,b as A,d as P}from"./card-DVWWM3IP.js";import{N as i,n as q}from"./notificationHelpers-By0WKI5A.js";import{C as D}from"./calendar-BxEe8nw1.js";import{U as M}from"./user-C-qQU3Ry.js";import{B as x}from"./bell-B1Cg_jQL.js";import{C as f}from"./car-CVWSXvWw.js";import{M as V}from"./message-square-CfnZ98V9.js";import{M as E}from"./map-pin-DSx0xkt_.js";import{W as I}from"./wallet-CUOn1Ur_.js";import{a as L}from"./date-vendor-Dhms5dOu.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";const Z=()=>{const{id:t}=w(),{user:o}=_(),n=v(),{data:s,isLoading:p,error:u}=y({queryKey:["notification",t],queryFn:async()=>{if(!t)throw new Error("Notification ID is required");const{data:a,error:r}=await m.from("notifications").select("*").eq("id",t).single();if(r)throw r;return q(a)},enabled:!!t});if(k.useEffect(()=>{s&&!s.is_read&&(async()=>await m.from("notifications").update({is_read:!0}).eq("id",parseInt(s.id)))()},[s]),!t)return e.jsx(l,{to:"/notifications",replace:!0});if(p)return e.jsx(C,{});if(u||!s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Notification Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The notification you're looking for doesn't exist or you don't have permission to view it."}),e.jsx(c,{onClick:()=>n("/notifications"),children:"Back to Notifications"})]})});if((o==null?void 0:o.id)!==s.user_id)return e.jsx(l,{to:"/notifications",replace:!0});const N=a=>{switch(i.classifyNotification(a)){case"booking":return e.jsx(f,{className:"h-5 w-5"});case"payment":return e.jsx(I,{className:"h-5 w-5"});case"handover":return e.jsx(E,{className:"h-5 w-5"});case"system":return e.jsx(x,{className:"h-5 w-5"});default:return e.jsx(V,{className:"h-5 w-5"})}},h=a=>{switch(i.classifyNotification(a)){case"booking":return"bg-blue-100 text-blue-800";case"payment":return"bg-green-100 text-green-800";case"handover":return"bg-purple-100 text-purple-800";case"system":return"bg-gray-100 text-gray-800";default:return"bg-orange-100 text-orange-800"}},j=a=>L(new Date(a),"PPP p"),g=a=>{a.related_booking_id?n(`/bookings/${a.related_booking_id}`):i.isPaymentNotification(a)?n("/wallet"):i.isActiveRentalNotification(a)&&n("/map")},b=a=>a.related_booking_id||i.isPaymentNotification(a)||i.isActiveRentalNotification(a);return e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-2xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(c,{variant:"outline",onClick:()=>n("/notifications"),className:"mb-4",children:"â† Back to Notifications"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Notification Details"})]}),e.jsxs(R,{children:[e.jsx(B,{children:e.jsxs(A,{className:"flex items-center gap-3",children:[N(s),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{children:"Notification"}),e.jsx(d,{className:h(s),children:i.classifyNotification(s)}),!s.is_read&&e.jsx(d,{variant:"secondary",children:"New"})]})})]})}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:s.title}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:s.description})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Created:"}),e.jsx("span",{children:j(s.created_at)})]}),s.is_read&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx("span",{children:"Read"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Type:"}),e.jsx("span",{className:"font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:s.type})]}),s.related_booking_id&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Related Booking:"}),e.jsxs("span",{className:"font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:["#",s.related_booking_id]})]})]}),b(s)&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(c,{onClick:()=>g(s),className:"w-full",children:[s.related_booking_id&&"View Booking Details",!s.related_booking_id&&i.isPaymentNotification(s)&&"View Wallet",!s.related_booking_id&&i.isActiveRentalNotification(s)&&"View on Map"]})})]})]})]})};export{Z as NotificationDetails,Z as default};
