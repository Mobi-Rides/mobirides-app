var f=Object.defineProperty;var b=(d,s,t)=>s in d?f(d,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[s]=t;var a=(d,s,t)=>b(d,typeof s!="symbol"?s+"":s,t);class i{static classifyNotification(s){const t=(s.content||"").toLowerCase(),p=(s.type||"").toLowerCase();let o=0,n=0;const e=[];p.includes("booking")?(n+=2,e.push("Type contains 'booking' (weak hint)")):(p.includes("wallet")||p.includes("payment"))&&(o+=2,e.push("Type contains 'wallet' or 'payment' (weak hint)")),this.CURRENCY_PATTERNS.some(r=>r.test(t))&&(o+=12,e.push("Currency pattern detected")),(t.includes("wallet")||t.includes("topup")||t.includes("topped up"))&&(o+=15,e.push("Strong payment indicator (wallet/topup)"));const c=this.PAYMENT_KEYWORDS.filter(r=>t.includes(r)).length,u=this.BOOKING_KEYWORDS.filter(r=>t.includes(r)).length;o+=c,n+=u,c>0&&e.push(`Payment keywords: ${c}`),u>0&&e.push(`Booking keywords: ${u}`);const h=this.PAYMENT_ACTIONS.filter(r=>t.includes(r)).length,m=this.BOOKING_ACTIONS.filter(r=>t.includes(r)).length;if(o+=h*3,n+=m*3,h>0&&e.push(`Payment actions: ${h}`),m>0&&e.push(`Booking actions: ${m}`),this.CAR_BRANDS.some(r=>t.includes(r))&&(n+=5,e.push("Car brand detected")),this.TIME_PATTERNS.some(r=>r.test(t))&&(n+=3,e.push("Time/date pattern detected")),(t.includes("earned")||t.includes("commission")||t.includes("profit"))&&(o+=6,e.push("Semantic: earning/profit context")),(t.includes("pickup")||t.includes("return")||t.includes("handover"))&&(n+=6,e.push("Semantic: rental logistics context")),s.related_booking_id&&(n+=10,e.push("related_booking_id present (strong booking clue)")),s.related_car_id&&(n+=5,e.push("related_car_id present (booking clue)")),typeof s.amount=="number"&&s.amount>0&&(o+=10,e.push("amount field present (strong payment clue)")),(s.currency||s.currency_code)&&(o+=5,e.push("currency field present (payment clue)")),s.sender_role==="host"&&t.includes("payment")&&(o+=2,e.push("sender_role host with payment context")),s.sender_role==="renter"&&t.includes("booking")&&(n+=2,e.push("sender_role renter with booking context")),c>0&&(n-=c*1.5,e.push(`Booking score penalized by payment keywords: -${c*1.5}`),n=Math.max(0,n)),u>0&&(o-=u*1.5,e.push(`Payment score penalized by booking keywords: -${u*1.5}`),o=Math.max(0,o)),o>10&&n>10)return e.push("Both payment and booking clues are strong: ambiguous"),{type:"other",confidence:50,reasons:e};if(t.length>100&&o===0&&n===0)return n+=1,e.push("Fallback: long message, default to booking"),{type:"booking",confidence:50,reasons:e};let l;o>n&&o>0?l="payment":n>o&&n>0?l="booking":l="other";const y=o+n;let g=y>0?Math.round(Math.max(o,n)/y*100):0;return g<60&&(e.push("Low confidence: marked as other"),l="other"),{type:l,confidence:g,reasons:e}}}a(i,"PAYMENT_KEYWORDS",["wallet","payment","earned","commission","balance","transaction","funds","credit","debit","withdrawal","deposit","refund","charge","billing","invoice","receipt","transfer","settlement","payout","revenue","income","profit","fee","cost","amount","dollar","usd","$","peso","pesos","pâ‚±","â‚±"]),a(i,"BOOKING_KEYWORDS",["booking","rental","car","vehicle","reservation","pickup","return","host","renter","trip","journey","drive","start","end","schedule","cancel","request","appointment","time","date","duration","location","address","dropoff","handover","inspection"]),a(i,"PAYMENT_ACTIONS",["topped up","deducted","received","processed","sent","withdrawn","credited","debited","completed","successful","failed","pending","approved","rejected","settled","transferred","deposited"]),a(i,"BOOKING_ACTIONS",["confirmed","cancelled","requested","started","ended","scheduled","rescheduled","extended","shortened","approved","rejected","pending","completed","active","inactive","expired","terminated"]),a(i,"CURRENCY_PATTERNS",[/\$[\d,]+\.?\d*/g,/\bP\d+\.?\d*\b/i,/\b\d+\.?\d*\s*pesos?\b/i,/\d+\.?\d*\s*(dollars?|USD|usd)/gi,/amount:\s*\$?[\d,]+\.?\d*/gi,/total:\s*\$?[\d,]+\.?\d*/gi]),a(i,"CAR_BRANDS",["toyota","honda","bmw","mercedes","audi","ford","chevrolet","nissan","hyundai","kia","volkswagen","volvo","lexus","acura","infiniti","cadillac","buick","dodge","chrysler","jeep","ram","gmc","subaru","mazda","mitsubishi","suzuki","fiat","alfa romeo","maserati","ferrari","lamborghini","porsche","bentley","rolls royce","aston martin","jaguar","land rover","range rover","mini","smart","tesla","rivian","lucid"]),a(i,"TIME_PATTERNS",[/tomorrow/i,/today/i,/yesterday/i,/\d{1,2}:\d{2}\s*(am|pm)/i,/\d{1,2}\/\d{1,2}\/\d{4}/,/\d{4}-\d{2}-\d{2}/,/monday|tuesday|wednesday|thursday|friday|saturday|sunday/i,/january|february|march|april|may|june|july|august|september|october|november|december/i]);function _(d){return i.classifyNotification(d).type}export{i as N,_ as c};
