import{j as e,u as C}from"./query-vendor-Bsfdn-Hb.js";import{T as A,a as L,b as f,c as t,d as S,e as r,A as k,f as D}from"./table-LmMVSYSc.js";import{r as R}from"./react-vendor-mnpoGfEl.js";import{c as g,an as M,I as H,n as F,s as I}from"./index-CEKMvnhM.js";import{C as o,d,a as x,b as h}from"./card-DVWWM3IP.js";import{S as p}from"./skeleton-CHo5tvc9.js";import{D as w}from"./dollar-sign-CUzFtw-3.js";import"./separator-CNMPkK_g.js";import"./sheet-CcFgStQt.js";import"./car-CVWSXvWw.js";import"./credit-card-CocXzOfZ.js";import"./message-square-CfnZ98V9.js";import"./house-Bsui6dM0.js";import"./settings-Bd5GrtQ9.js";import"./log-out-C9uCL1sx.js";import"./useIsAdmin-zCX1SCL8.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./date-vendor-Dhms5dOu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=g("ArrowDownLeft",[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=g("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),z=()=>C({queryKey:["admin-transactions"],queryFn:async()=>{const{data:i,error:l}=await I.from("wallet_transactions").select(`
          id, amount, transaction_type, status, description, created_at, 
          booking_id, payment_method,
          host_wallets:wallet_id (
            host_id,
            profiles:host_id (full_name)
          )
        `).order("created_at",{ascending:!1});if(l)throw l;return i||[]}}),B=()=>{const[i,l]=R.useState(""),{data:m,isLoading:y,error:v}=z(),c=(m==null?void 0:m.filter(s=>{var a,n,u,j;return((a=s.description)==null?void 0:a.toLowerCase().includes(i.toLowerCase()))||s.transaction_type.toLowerCase().includes(i.toLowerCase())||((j=(u=(n=s.host_wallets)==null?void 0:n.profiles)==null?void 0:u.full_name)==null?void 0:j.toLowerCase().includes(i.toLowerCase()))}))||[],_=s=>{switch(s){case"completed":return"default";case"pending":return"secondary";case"failed":return"destructive";default:return"outline"}},T=s=>{switch(s){case"top_up":case"earning":return e.jsx(N,{className:"h-4 w-4 text-green-600"});case"commission":case"withdrawal":return e.jsx(U,{className:"h-4 w-4 text-red-600"});default:return e.jsx(w,{className:"h-4 w-4"})}},b=c.filter(s=>s.transaction_type==="commission"&&s.status==="completed").reduce((s,a)=>s+Number(a.amount),0);return v?e.jsx(o,{children:e.jsx(d,{className:"p-6",children:e.jsx("p",{className:"text-destructive",children:"Failed to load transactions"})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["P",b.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Commission earnings"})]})]}),e.jsxs(o,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:"Total Transactions"}),e.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(M,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(H,{placeholder:"Search transactions...",value:i,onChange:s=>l(s.target.value),className:"pl-8"})]})}),e.jsxs(o,{children:[e.jsx(x,{children:e.jsxs(h,{children:["Transaction History (",c.length,")"]})}),e.jsx(d,{children:y?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,a)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(p,{className:"h-12 w-12"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{className:"h-4 w-[200px]"}),e.jsx(p,{className:"h-4 w-[100px]"})]})]},a))}):e.jsxs(A,{children:[e.jsx(L,{children:e.jsxs(f,{children:[e.jsx(t,{children:"Type"}),e.jsx(t,{children:"User"}),e.jsx(t,{children:"Amount"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Description"}),e.jsx(t,{children:"Method"}),e.jsx(t,{children:"Date"})]})}),e.jsx(S,{children:c.map(s=>{var a,n;return e.jsxs(f,{children:[e.jsx(r,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[T(s.transaction_type),e.jsx("span",{className:"capitalize",children:s.transaction_type.replace("_"," ")})]})}),e.jsx(r,{children:((n=(a=s.host_wallets)==null?void 0:a.profiles)==null?void 0:n.full_name)||"Unknown"}),e.jsxs(r,{className:"font-medium",children:["P",Number(s.amount).toFixed(2)]}),e.jsx(r,{children:e.jsx(F,{variant:_(s.status),children:s.status})}),e.jsx(r,{children:s.description||"N/A"}),e.jsx(r,{children:s.payment_method||"N/A"}),e.jsx(r,{children:new Date(s.created_at).toLocaleDateString()})]},s.id)})})]})})]})]})},ie=()=>e.jsx(k,{children:e.jsx(D,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Transaction Ledger"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor all financial transactions, commissions, and wallet activity"})]}),e.jsx(B,{})]})})});export{ie as default};
