import{c as i,n as m,r as c,K as y,j as a,N as v,b as g,s,U as b}from"./index-BAM2AQzj.js";import{a as h}from"./useQuery-BBHzqejZ.js";import{B as k}from"./badge-La64XLSg.js";import{M as N}from"./map-pin-CoQHT-KY.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=i("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=i("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=i("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),S=()=>{const o=m(),[x,l]=c.useState(0),n=y(),{data:p=0}=h({queryKey:["unreadMessagesCount"],queryFn:async()=>{const{data:{user:e}}=await s.auth.getUser();if(!e)return 0;const{count:t,error:r}=await s.from("messages").select("*",{count:"exact",head:!0}).eq("receiver_id",e.id).eq("status","sent");return r?(console.error("Error fetching unread messages count:",r),0):t||0},refetchInterval:1e4}),{data:f=0}=h({queryKey:["unreadNotificationsCount"],queryFn:async()=>{const{data:{user:e}}=await s.auth.getUser();if(!e)return 0;const{count:t,error:r}=await s.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",e.id).eq("is_read",!1);return r?(console.error("Error fetching unread notifications count:",r),0):t||0},refetchInterval:5e3});c.useEffect(()=>{(async()=>{const{data:{user:t}}=await s.auth.getUser();if(!t)return;const r=s.channel("wallet-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications"},()=>{n.invalidateQueries({queryKey:["unreadNotificationsCount"]}),n.invalidateQueries({queryKey:["notifications"]})}).subscribe();return()=>{s.removeChannel(r)}})()},[n]);const d=p+f,u=[{path:"/",label:"Explore",icon:a.jsx(w,{className:"w-5 h-5"}),activeIndex:0},{path:"/map",label:"Map",icon:a.jsx(N,{className:"w-5 h-5"}),activeIndex:1},{path:"/bookings",label:"Bookings",icon:a.jsx(q,{className:"w-5 h-5"}),activeIndex:2},{path:"/notifications",label:"Inbox",icon:a.jsx(j,{className:"w-5 h-5"}),activeIndex:3,badge:d>0?d:void 0},{path:"/profile",label:"Profile",icon:a.jsx(b,{className:"w-5 h-5"}),activeIndex:4}];return c.useEffect(()=>{const e=u.find(t=>o.pathname===t.path);e&&l(e.activeIndex)},[o.pathname]),a.jsx("div",{className:"fixed bottom-4 left-0 right-0 z-50 flex justify-center px-4",children:a.jsx("nav",{className:"container max-w-md mx-auto bg-white dark:bg-gray-900 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-800 h-16",children:a.jsx("div",{className:"grid grid-cols-5 h-full w-full",children:u.map(e=>a.jsxs(v,{to:e.path,className:g("flex flex-col items-center justify-center h-full transition-colors px-1 relative",x===e.activeIndex?"text-primary dark:text-primary":"text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-primary"),onClick:()=>l(e.activeIndex),children:[a.jsxs("div",{className:"relative",children:[e.icon,e.badge&&a.jsx(k,{variant:"destructive",className:"absolute -top-2 -right-2 min-w-5 h-5 flex items-center justify-center p-0 text-xs",children:e.badge>99?"99+":e.badge})]}),a.jsx("span",{className:"text-xs mt-1",children:e.label})]},e.path))})})})};export{j as B,q as C,S as N,w as S};
