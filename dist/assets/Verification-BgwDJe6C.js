var xe=Object.defineProperty;var he=(t,r,s)=>r in t?xe(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var Q=(t,r,s)=>he(t,typeof r!="symbol"?r+"":r,s);import{j as e}from"./query-vendor-BOSMW7hd.js";import{c as te,al as D,Y as ue,B as g,R as re,f as I,I as E,am as pe,J as h,O as J,q as B,n as U,g as Y,h as z,a8 as ae,an as fe,P as W,r as je,ao as ge,U as ee,ap as w,X as Ne,aq as A,T as ve,ar as be}from"./index-ByqmTec-.js";import{r as m,R as M,u as K}from"./react-vendor-DmU5vXC9.js";import{C,d as S,a as k,b as T,c as ye}from"./card-Dn1_7TKZ.js";import{R as we,P as ie}from"./progress-CXS1UcDG.js";import"./separator-D3RZtFXH.js";import{A as Ce,e as Se,a as Pe,b as ke,c as Te,f as Ie,d as Ee,g as Ae,h as _e}from"./alert-dialog-COW9ybb7.js";import{U as Z}from"./user-CrwdbYLY.js";import{A as O}from"./arrow-right-RRvKZqjh.js";import{F as ne}from"./file-text-4CeUdrl2.js";import{C as y}from"./circle-check-big-BdHHmxBu.js";import{U as Ve}from"./upload-B2QBpx4x.js";import{C as V}from"./circle-alert-CcellCUN.js";import{C as le}from"./camera-DAu_2Lp7.js";import{M as De}from"./message-square-C-ovA3oT.js";import{M as ce}from"./map-pin-B-9tSSOy.js";import{C as X}from"./clock-Dg92kA5o.js";import{M as oe}from"./mail-B2le86zI.js";import{U as Fe}from"./user-check-CJneZ_LO.js";import{S as H}from"./shield-fAaK4GMV.js";import{t as Re}from"./useVerificationStatus-DqwvtjbH.js";import{S as de}from"./star-Dt-lKoZi.js";import{D as Oe}from"./download-DURrII-i.js";import{C as se}from"./car-DcHPLaSp.js";import{C as Le}from"./calendar-Cn2gPQb0.js";import{H as Ue}from"./house-BXQSFKXu.js";import"./supabase-vendor-B3A6ooRR.js";import"./mapbox-vendor-ueN8uhVJ.js";import"./date-vendor-Dhms5dOu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=te("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=te("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),Ye=({onNext:t})=>{const{verificationData:r,updatePersonalInfo:s,isLoading:o,refreshData:d}=D(),[n,l]=m.useState({fullName:"",dateOfBirth:"",nationalIdNumber:"",phoneNumber:"",email:"",address:{street:"",area:"",city:"",postalCode:""}}),[u,v]=m.useState(!1);m.useEffect(()=>{var i,j,b,x;if(r!=null&&r.personal_info){const c=r.personal_info,p={fullName:c.fullName||"",dateOfBirth:c.dateOfBirth||"",nationalIdNumber:c.nationalIdNumber||"",phoneNumber:c.phoneNumber||"",email:c.email||"",address:{street:((i=c.address)==null?void 0:i.street)||"",area:((j=c.address)==null?void 0:j.area)||"",city:((b=c.address)==null?void 0:b.city)||"",postalCode:((x=c.address)==null?void 0:x.postalCode)||""}};l(p);const P=c.fullName||c.phoneNumber||c.email;v(!!P)}},[r]);const N=async i=>{if(i.preventDefault(),!n.fullName||!n.dateOfBirth||!n.nationalIdNumber){h.error("Please fill in all required fields");return}try{await s(n),h.success("Personal information saved successfully!"),t()}catch(j){console.error("Failed to save personal information:",j),h.error("Failed to save personal information")}},a=(i,j)=>{if(i.includes("address.")){const b=i.split(".")[1];l(x=>({...x,address:{...x.address,[b]:j}}))}else l(b=>({...b,[i]:j}))},f=async()=>{if(r!=null&&r.user_id)try{await pe.refreshFromProfile(r.user_id)?(await d(),h.success("Profile data refreshed successfully!")):h.error("Failed to refresh profile data")}catch(i){console.error("Failed to refresh from profile:",i),h.error("Failed to refresh profile data")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Personal Information"}),e.jsx("p",{className:"text-muted-foreground",children:"Please provide your personal details for verification"})]}),u&&e.jsx(C,{className:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950",children:e.jsx(S,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ue,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"Profile Data Imported"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"We've pre-filled some fields from your profile. Please review and update as needed."}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:f,className:"text-blue-700 border-blue-300 hover:bg-blue-100 dark:text-blue-300 dark:border-blue-700 dark:hover:bg-blue-900",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Refresh from Profile"]})]})]})})}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Basic Information"})]})}),e.jsx(S,{children:e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"fullName",children:"Full Name *"}),e.jsx(E,{id:"fullName",value:n.fullName,onChange:i=>a("fullName",i.target.value),placeholder:"Enter your full name",required:!0})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"dateOfBirth",children:"Date of Birth *"}),e.jsx(E,{id:"dateOfBirth",type:"date",value:n.dateOfBirth,onChange:i=>a("dateOfBirth",i.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"nationalIdNumber",children:"National ID Number *"}),e.jsx(E,{id:"nationalIdNumber",value:n.nationalIdNumber,onChange:i=>a("nationalIdNumber",i.target.value),placeholder:"Enter your Omang number",required:!0})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(E,{id:"phoneNumber",type:"tel",value:n.phoneNumber,onChange:i=>a("phoneNumber",i.target.value),placeholder:"+267 XX XXX XXX"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"email",children:"Email Address"}),e.jsx(E,{id:"email",type:"email",value:n.email,onChange:i=>a("email",i.target.value),placeholder:"your.email@example.com"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Address Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"street",children:"Street Address"}),e.jsx(E,{id:"street",value:n.address.street,onChange:i=>a("address.street",i.target.value),placeholder:"Street address"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"area",children:"Area/Suburb"}),e.jsx(E,{id:"area",value:n.address.area,onChange:i=>a("address.area",i.target.value),placeholder:"Area or suburb"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"city",children:"City"}),e.jsx(E,{id:"city",value:n.address.city,onChange:i=>a("address.city",i.target.value),placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"postalCode",children:"Postal Code"}),e.jsx(E,{id:"postalCode",value:n.address.postalCode,onChange:i=>a("address.postalCode",i.target.value),placeholder:"Postal code"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-6",children:e.jsxs(g,{type:"submit",disabled:o,className:"flex items-center space-x-2",children:[e.jsx("span",{children:o?"Saving...":"Continue to Documents"}),e.jsx(O,{className:"h-4 w-4"})]})})]})})]})]})},ze=({onNext:t,onPrevious:r})=>{const{isLoading:s,completeDocumentUpload:o}=D(),{user:d}=J(),[n,l]=m.useState([]),u=[{id:"national_id_front",title:"National ID (Front)",description:"Front side of your Botswana National ID (Omang)"},{id:"national_id_back",title:"National ID (Back)",description:"Back side of your Botswana National ID (Omang)"},{id:"driving_license_front",title:"Driving License (Front)",description:"Front side of your valid driving license"},{id:"proof_of_address",title:"Proof of Address",description:"Utility bill or bank statement (max 3 months old)"}],v=(a,f)=>{setTimeout(()=>{l(i=>[...i,a]),h.success(`${f.name} uploaded successfully`)},1e3)},N=async()=>{if(n.length<u.length){h.error("Please upload all required documents");return}if(!(d!=null&&d.id)){h.error("User not authenticated");return}try{await o(d.id)?(h.success("Documents verified successfully!"),t()):h.error("Failed to complete document upload. Please try again.")}catch(a){console.error("Error completing document upload:",a),h.error("An error occurred. Please try again.")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Document Upload"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload clear photos of your required documents"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map(a=>e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:a.title})]}),n.includes(a.id)&&e.jsx(y,{className:"h-5 w-5 text-green-500"})]})}),e.jsxs(S,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:a.description}),n.includes(a.id)?e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(y,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Document uploaded"})]}):e.jsxs("div",{children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:f=>{var j;const i=(j=f.target.files)==null?void 0:j[0];i&&v(a.id,i)},className:"hidden",id:`file-${a.id}`}),e.jsx("label",{htmlFor:`file-${a.id}`,className:"flex items-center justify-center w-full p-4 border-2 border-dashed border-muted-foreground/25 rounded-lg cursor-pointer hover:border-primary/50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ve,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload or drag and drop"})]})})]})]})]},a.id))}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:r,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:N,disabled:s,children:[e.jsx("span",{children:"Continue to Selfie"}),e.jsx(O,{className:"h-4 w-4 ml-2"})]})]})]})},He=({onCapture:t,onRetake:r,isCapturing:s,hasPhoto:o})=>e.jsx("div",{className:"flex justify-center space-x-4 mt-6",children:o?e.jsx("div",{className:"flex space-x-3",children:e.jsxs(g,{variant:"outline",onClick:r,className:"flex items-center space-x-2",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{children:"Retake"})]})}):e.jsxs(g,{onClick:t,disabled:s,size:"lg",className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-5 w-5"}),e.jsx("span",{children:s?"Capturing...":"Take Selfie"})]})}),Xe=()=>e.jsxs(C,{className:"mb-6",children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2 text-lg",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Selfie Guidelines"})]})}),e.jsx(S,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-green-600 flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:"Do This"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(ae,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Look directly at the camera"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Have a neutral expression"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Ensure good lighting on your face"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Remove sunglasses and hats"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Face the camera directly"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-red-600 flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{children:"Avoid This"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't cover your face"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't take photos in dark lighting"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't blur the image"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't include other people"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't tilt your head significantly"})]})]})]})]})})]}),$e=({onPhotoCapture:t,photoUrl:r,onRetake:s})=>{const o=m.useRef(null),d=m.useRef(null),[n,l]=m.useState(null),[u,v]=m.useState(!1),[N,a]=m.useState(!1),f=m.useCallback(async()=>{try{l(null);const x=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});o.current&&(o.current.srcObject=x,o.current.onloadedmetadata=()=>{a(!0)})}catch(x){console.error("Camera initialization error:",x),l("Unable to access camera. Please ensure camera permissions are granted.")}},[]),i=m.useCallback(()=>{var x;(x=o.current)!=null&&x.srcObject&&o.current.srcObject.getTracks().forEach(p=>p.stop())},[]),j=m.useCallback(async()=>{if(!(!o.current||!d.current||!N)){v(!0);try{const x=o.current,c=d.current,p=c.getContext("2d");if(!p)return;c.width=x.videoWidth,c.height=x.videoHeight,p.drawImage(x,0,0,c.width,c.height),c.toBlob(P=>{P&&(t(P),h.success("Selfie captured successfully!"))},"image/jpeg",.8)}catch(x){console.error("Photo capture error:",x),h.error("Failed to capture photo")}finally{v(!1)}}},[N,t]),b=m.useCallback(()=>{s(),N||f()},[s,N,f]);return m.useEffect(()=>(r||f(),i),[r,f,i]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden aspect-[4/3] max-w-md mx-auto",children:n?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx(V,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-red-600 mb-4",children:n}),e.jsx(g,{onClick:f,size:"sm",children:"Try Again"})]})}):r?e.jsx("img",{src:r,alt:"Captured selfie",className:"w-full h-full object-cover"}):e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-48 h-48 border-2 border-white/50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-44 h-44 border border-white/30 rounded-full"})})}),e.jsx("div",{className:"absolute top-4 left-4 right-4",children:e.jsx("div",{className:"bg-black/50 text-white text-center py-2 px-4 rounded",children:e.jsx("p",{className:"text-sm",children:N?"Position your face in the circle":"Loading camera..."})})})]})})]})}),e.jsx("canvas",{ref:d,className:"hidden"}),e.jsx(He,{onCapture:j,onRetake:b,isCapturing:u,hasPhoto:!!r})]})},qe=({onNext:t,onPrevious:r})=>{const{verificationData:s,completeSelfieVerification:o,isLoading:d}=D(),[n,l]=m.useState(null),[u,v]=m.useState(null),[N,a]=m.useState(!1),f=m.useCallback(x=>{l(x);const c=URL.createObjectURL(x);v(c)},[]),i=m.useCallback(()=>{u&&URL.revokeObjectURL(u),l(null),v(null)},[u]),j=async()=>{if(!n){h.error("Please take a selfie first");return}try{a(!0),await o(),h.success("Selfie verification completed!"),setTimeout(()=>{t()},1e3)}catch(x){console.error("Failed to submit selfie:",x),h.error("Failed to submit selfie verification")}finally{a(!1)}};return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Take Your Verification Selfie"}),e.jsx("p",{className:"text-muted-foreground",children:"We need to verify that you're the same person as in your ID documents"})]}),e.jsx(Xe,{}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Capture Your Selfie"}),u&&e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"Photo Captured"]})]})}),e.jsx(S,{children:e.jsx($e,{onPhotoCapture:f,photoUrl:u,onRetake:i})})]}),e.jsxs(Y,{children:[e.jsx(V,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"Privacy Notice:"})," Your selfie is used only for identity verification and is processed securely. We do not use your photo for any other purposes."]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:r,className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]}),e.jsxs(g,{onClick:j,disabled:!u||N||d,className:"flex items-center space-x-2",children:[e.jsx("span",{children:N?"Submitting...":"Continue to Phone Verification"}),e.jsx(O,{className:"h-4 w-4"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(V,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Camera Not Supported"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Your browser doesn't support camera access. Please use a modern browser or upload a selfie manually."}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(g,{variant:"outline",onClick:r,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:t,children:["Skip for Now",e.jsx(O,{className:"h-4 w-4 ml-2"})]})]})]})},We=({onNext:t,onPrevious:r})=>{const{updatePhoneVerification:s,isLoading:o}=D(),[d,n]=m.useState(""),[l,u]=m.useState(""),[v,N]=m.useState(!1),[a,f]=m.useState(!1),i=async()=>{if(!d){h.error("Please enter your phone number");return}setTimeout(()=>{N(!0),h.success("Verification code sent to your phone")},1e3)},j=async()=>{if(!l){h.error("Please enter the verification code");return}l==="123456"||l.length===6?(f(!0),await s({phoneNumber:d,countryCode:"+267",verificationCode:l,isVerified:!0}),h.success("Phone number verified successfully!")):h.error("Invalid verification code")},b=()=>{if(!a){h.error("Please verify your phone number first");return}t()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Phone Verification"}),e.jsx("p",{className:"text-muted-foreground",children:"Verify your phone number to secure your account"})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5"}),e.jsx("span",{children:"Phone Number Verification"})]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(E,{id:"phoneNumber",type:"tel",value:d,onChange:x=>n(x.target.value),placeholder:"+267 XX XXX XXX",disabled:v}),e.jsx(g,{onClick:i,disabled:v||!d,variant:"outline",children:v?"Code Sent":"Send Code"})]})]}),v&&!a&&e.jsxs("div",{children:[e.jsxs(I,{htmlFor:"verificationCode",children:[e.jsx(De,{className:"h-4 w-4 inline mr-2"}),"Verification Code"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(E,{id:"verificationCode",value:l,onChange:x=>u(x.target.value),placeholder:"Enter 6-digit code",maxLength:6}),e.jsx(g,{onClick:j,disabled:!l,children:"Verify"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Enter the 6-digit code sent to your phone"})]}),a&&e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(W,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Phone number verified successfully!"})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:r,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:b,disabled:o||!a,children:[e.jsx("span",{children:"Continue to Address"}),e.jsx(O,{className:"h-4 w-4 ml-2"})]})]})]})},Ge=({onNext:t,onPrevious:r})=>{const{verificationData:s,updateAddressConfirmation:o,updatePersonalInfo:d,isLoading:n}=D(),[l,u]=m.useState(!1),[v,N]=m.useState(!1),[a,f]=m.useState({street:"",area:"",city:"",postalCode:""});m.useEffect(()=>{var c;(c=s==null?void 0:s.personal_info)!=null&&c.address&&f(s.personal_info.address)},[s]);const i=async()=>{try{await d({...s==null?void 0:s.personal_info,address:a}),N(!1),h.success("Address updated successfully!")}catch(c){console.error("Failed to update address:",c),h.error("Failed to update address")}},j=(c,p)=>{f(P=>({...P,[c]:p}))},b=async()=>{await o({currentAddress:a,confirmationMethod:"document",isConfirmed:!0,confirmationDate:new Date().toISOString()}),u(!0),h.success("Address confirmed successfully!")},x=()=>{if(!l){h.error("Please confirm your address first");return}t()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Address Confirmation"}),e.jsx("p",{className:"text-muted-foreground",children:"Confirm your residential address details"})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5"}),e.jsx("span",{children:"Residential Address"})]})}),e.jsxs(S,{className:"space-y-4",children:[v?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"edit-street",children:"Street Address"}),e.jsx(E,{id:"edit-street",value:a.street,onChange:c=>j("street",c.target.value),placeholder:"Street address"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"edit-area",children:"Area/Suburb"}),e.jsx(E,{id:"edit-area",value:a.area,onChange:c=>j("area",c.target.value),placeholder:"Area or suburb"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"edit-city",children:"City"}),e.jsx(E,{id:"edit-city",value:a.city,onChange:c=>j("city",c.target.value),placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"edit-postalCode",children:"Postal Code"}),e.jsx(E,{id:"edit-postalCode",value:a.postalCode,onChange:c=>j("postalCode",c.target.value),placeholder:"Postal code"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:i,disabled:n,children:"Save Changes"}),e.jsx(g,{variant:"outline",onClick:()=>{var c;N(!1),f(((c=s==null?void 0:s.personal_info)==null?void 0:c.address)||{street:"",area:"",city:"",postalCode:""})},children:"Cancel"})]})]}):e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Street:"})," ",a.street||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Area:"})," ",a.area||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"City:"})," ",a.city||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Postal Code:"})," ",a.postalCode||"Not provided"]})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>N(!0),children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Edit Address"]})})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsx("p",{children:"Please confirm that the address above is correct. This address will be used for verification purposes and should match your proof of address document."})}),l?e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(y,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Address confirmed successfully!"})]}):e.jsxs(g,{onClick:b,className:"w-full",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Confirm Address"]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:r,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:x,disabled:n||!l,children:[e.jsx("span",{children:"Continue to Review"}),e.jsx(O,{className:"h-4 w-4 ml-2"})]})]})]})},Je=({onNext:t,onPrevious:r})=>{var N,a,f;const{verificationData:s,submitForReview:o,isLoading:d}=D(),[n,l]=m.useState(!1),u=async()=>{try{l(!0),await o(),h.success("Verification submitted for review!"),t()}catch(i){console.error("Failed to submit verification:",i),h.error("Failed to submit verification")}finally{l(!1)}},v=[{title:"Personal Information",completed:!!((N=s==null?void 0:s.personal_info)!=null&&N.fullName),details:((a=s==null?void 0:s.personal_info)==null?void 0:a.fullName)||"Not completed"},{title:"Document Upload",completed:!0,details:"All required documents uploaded"},{title:"Selfie Verification",completed:!0,details:"Selfie photo captured"},{title:"Phone Verification",completed:!0,details:((f=s==null?void 0:s.personal_info)==null?void 0:f.phoneNumber)||"Phone verified"},{title:"Address Confirmation",completed:!0,details:"Address confirmed"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Review & Submit"}),e.jsx("p",{className:"text-muted-foreground",children:"Review your information before submitting for verification"})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsx(T,{children:"Verification Summary"})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-4",children:v.map((i,j)=>e.jsx("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:`h-5 w-5 ${i.completed?"text-green-500":"text-gray-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.details})]})]})},j))})})]}),e.jsx(C,{children:e.jsx(S,{className:"pt-6",children:e.jsxs("div",{className:"text-sm text-muted-foreground space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"What happens next?"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Your verification will be reviewed by our team"}),e.jsx("li",{children:"You'll receive email updates on the status"}),e.jsx("li",{children:"Processing typically takes 1-3 business days"}),e.jsx("li",{children:"You can check progress anytime in your profile"})]})]})})}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:r,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:u,disabled:d||n,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:n?"Submitting...":"Submit for Review"})]})]})]})},Ke=({title:t,description:r,icon:s,status:o,estimatedTime:d})=>{const n=()=>{switch(o){case"completed":return"text-green-600";case"in_progress":return"text-blue-600";default:return"text-gray-400"}},l=()=>{switch(o){case"completed":return e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"Complete"]});case"in_progress":return e.jsxs(U,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),"Processing"]});default:return e.jsx(U,{variant:"outline",children:"Pending"})}};return e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${o==="completed"?"bg-green-100":o==="in_progress"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx("div",{className:n(),children:s})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium",children:t}),l()]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:r}),o==="in_progress"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm text-blue-600",children:"Processing..."})]}),d&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Estimated time: ",d]})]})]})]})},Ze=({onNext:t})=>{const{user:r}=J(),{verificationData:s,refreshData:o}=D(),[d,n]=m.useState(25),[l,u]=m.useState(0),[v,N]=m.useState(!1),a=[{title:"Document Review",description:"Our team is reviewing your uploaded documents for authenticity and completeness",icon:e.jsx(Me,{className:"h-5 w-5"}),estimatedTime:"2-4 hours"},{title:"Identity Verification",description:"Verifying your identity against official databases and cross-referencing documents",icon:e.jsx(Fe,{className:"h-5 w-5"}),estimatedTime:"4-8 hours"},{title:"Address Confirmation",description:"Confirming your residential address and proof of address documents",icon:e.jsx(ae,{className:"h-5 w-5"}),estimatedTime:"1-2 hours"},{title:"Final Approval",description:"Final review and approval of your verification application",icon:e.jsx(H,{className:"h-5 w-5"}),estimatedTime:"30 minutes"}];m.useEffect(()=>{const p=setInterval(()=>{n(P=>{const L=Math.min(P+8,100);return L>=25&&l<1&&u(1),L>=50&&l<2&&u(2),L>=75&&l<3&&u(3),L})},2e3);return()=>clearInterval(p)},[l]),m.useEffect(()=>{if(d>=100){const p=setTimeout(()=>{console.log("[ProcessingStatusStep] Auto-advancing to completion step"),t()},3e3);return()=>clearTimeout(p)}},[d,t]),m.useEffect(()=>{const p=setInterval(()=>{o()},1e4);return()=>clearInterval(p)},[o]);const f=p=>p<l?"completed":p===l?"in_progress":"pending",i=()=>{const p=new Date,P=Math.max(1,Math.ceil((100-d)/10));return new Date(p.getTime()+P*60*60*1e3).toLocaleString("en-BW",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},j=(s==null?void 0:s.overall_status)==="completed",[b]=M.useState(Date.now()),[x,c]=M.useState(!1);return M.useEffect(()=>{const p=setInterval(()=>{Date.now()-b>36e5&&c(!0)},6e4);return()=>clearInterval(p)},[b]),M.useEffect(()=>{if(j){const p=setTimeout(()=>{console.log("[ProcessingStatusStep] Verification already complete, advancing"),t()},1e3);return()=>clearTimeout(p)}},[j,t]),j?e.jsxs("div",{className:"text-center p-8",children:[e.jsx(y,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-700 mb-2",children:"Verification Complete!"}),e.jsx("p",{className:"text-muted-foreground",children:"Redirecting to completion step..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Verification in Progress"}),e.jsx("p",{className:"text-muted-foreground",children:"Your verification is being processed by our team"})]}),x&&e.jsxs("div",{className:"p-4 bg-yellow-100 border border-yellow-300 rounded text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," Verification processing is taking longer than usual. If you have any concerns, please contact our support team with your reference number."]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Overall Progress"}),e.jsxs(U,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),"Processing"]})]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Verification Progress"}),e.jsxs("span",{children:[d,"%"]})]}),e.jsx(ie,{value:d,className:"h-3"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Estimated Completion"}),e.jsx("p",{className:"text-muted-foreground",children:i()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Reference Number"}),e.jsx("p",{className:"text-muted-foreground font-mono",children:s!=null&&s.user_id?`VER-${s.user_id.slice(-8).toUpperCase()}`:"Generating..."})]})]})]})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsx(T,{children:"Processing Stages"})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-4",children:a.map((p,P)=>e.jsx(Ke,{title:p.title,description:p.description,icon:p.icon,status:f(P),estimatedTime:f(P)==="in_progress"?p.estimatedTime:void 0},P))})})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"h-5 w-5"}),e.jsx("span",{children:"Status Updates"})]})}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(y,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-700",children:"Verification Submitted"}),e.jsx("p",{className:"text-sm text-green-600",children:s!=null&&s.created_at?new Date(s.created_at).toLocaleString():"Just now"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(X,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-700",children:"Review in Progress"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Our verification team is currently reviewing your documents"})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(Y,{children:[e.jsx(V,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"What happens next?"})," You'll receive email notifications for any status updates. You can close this page and return anytime to check progress."]})]}),e.jsxs(Y,{children:[e.jsx(V,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"Need help?"})," If you have questions about your verification, contact our support team with your reference number."]})]})]}),!1]})},Qe=({verificationData:t})=>{const r=t!=null&&t.user_id?`VER-${t.user_id.slice(-8).toUpperCase()}`:"Unknown",s=t!=null&&t.completed_at?new Date(t.completed_at).toLocaleDateString():new Date().toLocaleDateString(),o=()=>{navigator.clipboard.writeText(r),h.success("Verification ID copied to clipboard")};return e.jsxs(C,{className:"border-green-200 bg-green-50",children:[e.jsxs(k,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"h-16 w-16 text-green-600 mx-auto"}),e.jsx(y,{className:"h-6 w-6 text-green-600 absolute -bottom-1 -right-1 bg-white rounded-full"})]})}),e.jsx(T,{className:"text-green-700",children:"Verification Complete!"})]}),e.jsx(S,{className:"space-y-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700 mb-4",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"Verified User"]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Verification ID"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("code",{className:"text-green-600 font-mono",children:r}),e.jsx(g,{variant:"ghost",size:"icon",onClick:o,className:"h-6 w-6",children:e.jsx(ge,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Completion Date"}),e.jsx("p",{className:"text-green-600",children:s})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"User Role"}),e.jsx("p",{className:"text-green-600 capitalize",children:(t==null?void 0:t.user_role)||"Renter"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Status"}),e.jsx("p",{className:"text-green-600",children:"Active"})]})]})]})]})})]})},es=({userRole:t})=>{const r=K(),d=t==="host"?[{title:"Add Your First Car",description:"List your vehicle and start earning",icon:e.jsx(se,{className:"h-5 w-5 text-blue-500"}),action:()=>r("/add-car"),buttonText:"Add Car"},{title:"Set Up Hosting Profile",description:"Complete your hosting profile and preferences",icon:e.jsx(ee,{className:"h-5 w-5 text-purple-500"}),action:()=>r("/profile"),buttonText:"Setup Profile"},{title:"View Dashboard",description:"Monitor your bookings and earnings",icon:e.jsx(de,{className:"h-5 w-5 text-orange-500"}),action:()=>r("/dashboard"),buttonText:"Open Dashboard"}]:[{title:"Browse Available Cars",description:"Explore cars available for rent in your area",icon:e.jsx(se,{className:"h-5 w-5 text-blue-500"}),action:()=>r("/"),buttonText:"Browse Cars"},{title:"Complete Your Profile",description:"Add a profile photo and additional details",icon:e.jsx(ee,{className:"h-5 w-5 text-purple-500"}),action:()=>r("/profile"),buttonText:"Edit Profile"},{title:"Make Your First Booking",description:"Find and book your first rental car",icon:e.jsx(Le,{className:"h-5 w-5 text-green-500"}),action:()=>r("/"),buttonText:"Start Booking"}];return e.jsxs(C,{children:[e.jsx(k,{children:e.jsx(T,{children:"What's Next?"})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-4",children:d.map((n,l)=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:n.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium mb-1",children:n.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:n.description}),e.jsxs(g,{onClick:n.action,size:"sm",className:"flex items-center space-x-2",children:[e.jsx("span",{children:n.buttonText}),e.jsx(O,{className:"h-3 w-3"})]})]})]},l))})})]})},ss=()=>{const{verificationData:t}=D(),r=K();if(M.useEffect(()=>{Re();const n=sessionStorage.getItem("verification_return_context");if(n)try{const l=JSON.parse(n);console.log("[CompletionStep] Found return context:",l),sessionStorage.removeItem("verification_return_context"),setTimeout(()=>{if(l.action==="booking"&&l.carData){const u=l.carData.id||l.carData.car_id;r(`/cars/${u}`),h.success("Verification complete! You can now book this car.")}else l.action==="listing"?(r("/add-car"),h.success("Verification complete! You can now list your vehicle.")):r("/")},3e3)}catch(l){console.error("[CompletionStep] Failed to parse return context:",l)}},[r]),!t)return e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No verification data found"})});const s=()=>{t.user_role==="host"?r("/dashboard"):r("/")},o=()=>{h.success("Certificate download started (Feature coming soon)")},d=t.user_role==="host"?"host":"renter";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"mx-auto mb-6",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"animate-bounce",children:e.jsx(y,{className:"h-20 w-20 text-green-500 mx-auto"})})})}),e.jsx("h1",{className:"text-3xl font-bold text-green-700 mb-2",children:"🎉 Verification Complete!"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Welcome to MobiRides! Your identity has been successfully verified."})]}),e.jsx(Qe,{verificationData:t}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"h-5 w-5 text-orange-500"}),e.jsx("span",{children:"Your Verification Benefits"})]})}),e.jsx(S,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Trusted Member Badge"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show other users you're verified"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Full Platform Access"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Book cars and access all features"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Priority Support"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get faster help when needed"})]})]}),t.user_role==="host"&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Host Privileges"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"List cars and start earning"})]})]})]})]})})]}),e.jsx(es,{userRole:d}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(Y,{children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"Email Confirmation:"})," A verification certificate has been sent to your email address. Keep this for your records."]})]}),e.jsxs(Y,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"Security Notice:"})," Your verification is valid indefinitely. Contact support if you need to update any verified information."]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[e.jsxs(g,{onClick:o,variant:"outline",className:"flex items-center space-x-2 flex-1",children:[e.jsx(Oe,{className:"h-4 w-4"}),e.jsx("span",{children:"Download Certificate"})]}),e.jsxs(g,{onClick:s,className:"flex items-center space-x-2 flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx("span",{children:t.user_role==="host"?"Go to Dashboard":"Start Using MobiRides"}),e.jsx(O,{className:"h-4 w-4"})]})]}),!1]})},G={[w.PERSONAL_INFO]:{title:"Personal Information",description:"Provide your basic details",icon:Z,component:Ye},[w.DOCUMENT_UPLOAD]:{title:"Document Upload",description:"Upload required documents",icon:ne,component:ze},[w.SELFIE_VERIFICATION]:{title:"Selfie Verification",description:"Take a verification selfie",icon:le,component:qe},[w.PHONE_VERIFICATION]:{title:"Phone Verification",description:"Verify your phone number",icon:W,component:We},[w.ADDRESS_CONFIRMATION]:{title:"Address Confirmation",description:"Confirm your address",icon:ce,component:Ge},[w.REVIEW_SUBMIT]:{title:"Review & Submit",description:"Review and submit verification",icon:y,component:Je},[w.PROCESSING_STATUS]:{title:"Processing",description:"Verification in progress",icon:X,component:Ze},[w.COMPLETION]:{title:"Completed",description:"Verification complete",icon:H,component:ss}},ts=({currentStep:t,stepStatuses:r,onStepClick:s,canNavigateToStep:o})=>{const d=Object.values(w);return e.jsx("div",{className:"w-full mb-8",children:e.jsx("div",{className:"flex items-center justify-between mb-4",children:d.map((n,l)=>{const u=G[n],v=u.icon,N=r[n],a=n===t,f=N===A.COMPLETED,i=o(n);let j="bg-gray-700",b="text-gray-300",x="",c="bg-white",p="text-gray-700";return f?(j="bg-green-500 hover:bg-green-600",b="text-white",c="bg-white",p="text-green-700"):a&&(j="bg-blue-600",b="text-white",x="ring-2 ring-blue-400 ring-offset-2",c="bg-white",p="text-blue-700"),e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(g,{variant:"outline",size:"icon",className:`
                    relative h-12 w-12 rounded-full mb-2
                    ${j} ${b} ${x}
                    ${!i&&!a&&!f?"opacity-50 cursor-not-allowed":""}
                  `,onClick:()=>i&&s(n),disabled:!i&&!a&&!f,children:[f?e.jsx(y,{className:"h-6 w-6 text-white"}):e.jsx(v,{className:`h-6 w-6 ${b}`}),e.jsx(U,{variant:"secondary",className:`absolute -top-2 -right-2 h-5 w-5 p-0 text-xs ${c} ${p}`,children:l+1})]}),e.jsxs("div",{className:"text-center max-w-[80px]",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-blue-600":f?"text-green-600":"text-gray-400"}`,children:u.title}),e.jsx("p",{className:"text-xs text-muted-foreground hidden sm:block",children:u.description})]})]}),l<d.length-1&&e.jsx("div",{className:`
                  flex-1 h-0.5 mx-2 mb-8
                  ${f?"bg-green-500":a?"bg-blue-600":"bg-gray-700"}
                `})]},n)})})})},rs=()=>{const{user:t}=J(),r=K(),{verificationData:s,isLoading:o,error:d,isInitialized:n,initializeVerification:l,navigateToStep:u,canNavigateToStep:v,getStepProgress:N,resetVerification:a}=D(),[f,i]=m.useState(!1),[j,b]=m.useState(!1);m.useEffect(()=>{if(!(t!=null&&t.id)){console.log("[VerificationHub] No user ID available");return}if(n||o||s)return;(async()=>{var F;try{const R=((F=t.user_metadata)==null?void 0:F.role)||"renter";console.log("[VerificationHub] Initializing verification for user:",t.id,"Role:",R),await l(t.id,R)}catch(R){console.error("[VerificationHub] Failed to initialize verification:",R),h.error("Failed to initialize verification process")}})()},[t==null?void 0:t.id,n,o,s]),M.useEffect(()=>{s.overall_status==="completed"&&s.current_step!=="completion"&&u(w.COMPLETION)},[s.overall_status,s.current_step,u]);const x=_=>{if(!v(_)){h.error("Please complete the previous steps first");return}u(_)},c=()=>{if(!s)return;const _=Object.values(w),F=_.indexOf(s.current_step);if(F<_.length-1){const R=_[F+1];x(R)}},p=()=>{if(!s)return;const _=Object.values(w),F=_.indexOf(s.current_step);if(F>0){const R=_[F-1];u(R)}},P=()=>{h.info("Verification canceled. You can resume anytime from your profile."),r("/")},L=()=>{r("/")},me=()=>{if(!s)return null;const _=G[s.current_step].component;return e.jsx(_,{onNext:c,onPrevious:p})};if(d)return e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",style:{backgroundColor:"#020817"},children:e.jsxs(C,{className:"w-full max-w-md",children:[e.jsxs(k,{className:"text-center",children:[e.jsx(V,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx(T,{className:"text-red-600",children:"Verification Error"})]}),e.jsxs(S,{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:d}),e.jsx(g,{onClick:()=>window.location.reload(),children:"Try Again"})]})]})});if(o||!s)return e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",style:{backgroundColor:"#020817"},children:e.jsx(C,{className:"w-full max-w-md",children:e.jsxs(S,{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Initializing verification..."})]})})});const $=N(),q=G[s.current_step];return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#020817"},children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6 p-4 bg-white/10 rounded-lg border border-white/20",children:[e.jsxs(g,{variant:"outline",onClick:L,className:"flex items-center gap-2 bg-white/90 hover:bg-white text-gray-900",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to Home"}),e.jsx("span",{className:"sm:hidden",children:"Home"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white/80 text-sm",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Secure verification process"}),e.jsx("span",{className:"sm:hidden",children:"Secure process"})]}),e.jsxs(Ce,{open:j,onOpenChange:b,children:[e.jsx(Se,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:"flex items-center gap-2 bg-white/90 hover:bg-white text-gray-900 border-red-200 hover:border-red-300",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Cancel Verification"}),e.jsx("span",{className:"sm:hidden",children:"Cancel"})]})}),e.jsxs(Pe,{children:[e.jsxs(ke,{children:[e.jsx(Te,{children:"Cancel Verification?"}),e.jsx(Ie,{children:"Are you sure you want to cancel the verification process? Your progress will be saved and you can resume later from your profile."})]}),e.jsxs(Ee,{children:[e.jsx(Ae,{children:"Continue Verification"}),e.jsx(_e,{onClick:P,children:"Yes, Cancel"})]})]})]})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Identity Verification"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"Complete your verification to start using MobiRides"}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[$.completed," of ",$.total," steps"]})]}),e.jsx(ie,{value:$.percentage,className:"h-2"})]})]}),e.jsx(ts,{currentStep:s.current_step,stepStatuses:{[w.PERSONAL_INFO]:s.personal_info_completed?A.COMPLETED:A.NOT_STARTED,[w.DOCUMENT_UPLOAD]:s.documents_completed?A.COMPLETED:A.NOT_STARTED,[w.SELFIE_VERIFICATION]:s.selfie_completed?A.COMPLETED:A.NOT_STARTED,[w.PHONE_VERIFICATION]:s.phone_verified?A.COMPLETED:A.NOT_STARTED,[w.ADDRESS_CONFIRMATION]:s.address_confirmed?A.COMPLETED:A.NOT_STARTED,[w.REVIEW_SUBMIT]:A.NOT_STARTED,[w.PROCESSING_STATUS]:A.NOT_STARTED,[w.COMPLETION]:A.NOT_STARTED},onStepClick:x,canNavigateToStep:v}),e.jsxs(C,{className:"mb-8",children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q.icon,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{children:[e.jsx(T,{children:q.title}),e.jsx("p",{className:"text-muted-foreground",children:q.description})]})]})}),e.jsx(S,{children:me()})]}),!1]})})};class as extends m.Component{constructor(){super(...arguments);Q(this,"state",{hasError:!1})}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,o){console.error("Verification error boundary caught an error:",s,o)}render(){var s;return this.state.hasError?e.jsx("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:e.jsxs(C,{className:"border-destructive",children:[e.jsxs(k,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(ve,{className:"h-12 w-12 text-destructive"})}),e.jsx(T,{className:"text-destructive",children:"Verification Error"}),e.jsx(ye,{children:"Something went wrong during the verification process. This has been logged and our team will investigate."})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsx("p",{className:"text-sm font-mono text-muted-foreground",children:((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred"})}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(g,{onClick:()=>this.setState({hasError:!1}),variant:"outline",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsx(g,{onClick:()=>window.location.href="/dashboard",variant:"default",children:"Return to Dashboard"})]})]})]})}):this.props.children}}const Fs=()=>e.jsx(as,{children:e.jsx(be,{children:e.jsx(rs,{})})});export{Fs as default};
