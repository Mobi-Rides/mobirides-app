import{j as e,u as P,a as ke,b as K}from"./query-vendor-BOSMW7hd.js";import{r as v,u as Ne}from"./react-vendor-DmU5vXC9.js";import{c as W,_ as M,ax as Be,E as Me,D as ve,b as ye,d as we,e as _e,f as z,I as J,B as T,s as u,J as L,i as Ve,j as $e,k as Oe,n as g,a2 as be,P as Ae,T as se,a3 as He,a5 as Ke,a6 as ze,a7 as R,a8 as k,aa as Ie,ab as Qe}from"./index-BnOLzhwz.js";import{T as ae,a as te,b as I,c as A,d as re,e as E}from"./table-C-9uVKIY.js";import{C as o,d as m,a as w,b as _}from"./card-CDc_xlrS.js";import{S as D}from"./skeleton-Q0nD2NvZ.js";import{S as Je,a as We,b as Xe,c as Ye,d as Q}from"./select-BMlCfmgX.js";import{C as X}from"./calendar-BNv8_YNk.js";import{S as Ge}from"./star-CW-HfHZw.js";import{M as Ze}from"./mail-CLLeRqkQ.js";import{M as Ce}from"./map-pin-cZ2IpURy.js";import{C as Se}from"./car-CQMiUMTl.js";import{D as Y}from"./dollar-sign-R6wyBvSV.js";import{E as es,T as ss}from"./trending-down-CiOmF5EE.js";import{W as ne}from"./wallet-faTPLuFw.js";import{T as as}from"./trending-up-B6zEQKnc.js";import{U as ts}from"./user-txy-ji6A.js";import{F as rs}from"./file-text-BxtABGWy.js";import{C as ns}from"./circle-check-big-Bkn7QkAB.js";import{C as is}from"./circle-x-BaGiqzw9.js";import{C as ls}from"./clock-C62Gyxh0.js";import{S as ie}from"./switch-DOsSF0bp.js";import{A as le,a as ce,b as de,c as oe,f as me,d as xe,g as he,h as ue}from"./alert-dialog-DWJeJB9T.js";import{S as je}from"./shield-DZyYQXZr.js";import{U as pe}from"./user-check-CdwsGHHb.js";import{C as cs}from"./chevron-left-De0cfg9H.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=W("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=W("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=W("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),De=({className:s,...t})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:M("mx-auto flex w-full justify-center",s),...t});De.displayName="Pagination";const Te=v.forwardRef(({className:s,...t},i)=>e.jsx("ul",{ref:i,className:M("flex flex-row items-center gap-1",s),...t}));Te.displayName="PaginationContent";const O=v.forwardRef(({className:s,...t},i)=>e.jsx("li",{ref:i,className:M("",s),...t}));O.displayName="PaginationItem";const H=({className:s,isActive:t,size:i="icon",...d})=>e.jsx("a",{"aria-current":t?"page":void 0,className:M(Be({variant:t?"outline":"ghost",size:i}),s),...d});H.displayName="PaginationLink";const Le=({className:s,...t})=>e.jsxs(H,{"aria-label":"Go to previous page",size:"default",className:M("gap-1 pl-2.5",s),...t,children:[e.jsx(cs,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});Le.displayName="PaginationPrevious";const Pe=({className:s,...t})=>e.jsxs(H,{"aria-label":"Go to next page",size:"default",className:M("gap-1 pr-2.5",s),...t,children:[e.jsx("span",{children:"Next"}),e.jsx(Me,{className:"h-4 w-4"})]});Pe.displayName="PaginationNext";const qe=({user:s,isOpen:t,onClose:i,onSuccess:d})=>{const[a,r]=v.useState(!1),[n,h]=v.useState(s.full_name||""),[j,p]=v.useState(s.role),[l,c]=v.useState(s.phone_number||""),b=async f=>{f.preventDefault(),r(!0);try{const{error:y}=await u.from("profiles").update({full_name:n.trim()||null,role:j,phone_number:l.trim()||null}).eq("id",s.id);if(y)throw y;d()}catch(y){console.error("Error updating user:",y),L.error("Failed to update user")}finally{r(!1)}};return e.jsx(ve,{open:t,onOpenChange:i,children:e.jsxs(ye,{className:"sm:max-w-[425px]",children:[e.jsx(we,{children:e.jsx(_e,{children:"Edit User"})}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"fullName",children:"Full Name"}),e.jsx(J,{id:"fullName",value:n,onChange:f=>h(f.target.value),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"role",children:"Role"}),e.jsxs(Je,{value:j,onValueChange:f=>p(f),children:[e.jsx(We,{children:e.jsx(Xe,{placeholder:"Select a role"})}),e.jsxs(Ye,{children:[e.jsx(Q,{value:"renter",children:"Renter"}),e.jsx(Q,{value:"host",children:"Host"}),e.jsx(Q,{value:"admin",children:"Admin"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(J,{id:"phoneNumber",value:l,onChange:f=>c(f.target.value),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(T,{type:"button",variant:"outline",onClick:i,disabled:a,children:"Cancel"}),e.jsx(T,{type:"submit",disabled:a,children:a?"Updating...":"Update User"})]})]})]})})},ms=s=>P({queryKey:["user-profile",s],queryFn:async()=>{const{data:t,error:i}=await u.from("profiles").select("*").eq("id",s).single();if(i)throw i;return t}}),xs=s=>P({queryKey:["user-stats",s],queryFn:async()=>{const{data:t,error:i}=await u.from("bookings").select("status").eq("renter_id",s);if(i)throw i;const{data:d,error:a}=await u.from("cars").select("id").eq("owner_id",s);if(a)throw a;const{data:r,error:n}=await u.from("reviews").select("rating").eq("reviewee_id",s);if(n)throw n;const h=(t==null?void 0:t.length)||0,j=(t==null?void 0:t.filter(l=>l.status==="completed").length)||0,p=r!=null&&r.length?r.reduce((l,c)=>l+c.rating,0)/r.length:0;return{totalBookings:h,completedBookings:j,hostedCars:(d==null?void 0:d.length)||0,averageRating:Number(p.toFixed(1)),totalReviews:(r==null?void 0:r.length)||0}}}),hs=({user:s,onUpdate:t})=>{var l;const[i,d]=v.useState(!1),{data:a,isLoading:r}=ms(s.id),{data:n,isLoading:h}=xs(s.id),j=c=>{switch(c){case"admin":return"destructive";case"host":return"default";case"renter":return"secondary";default:return"outline"}},p=()=>{d(!1),t==null||t()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(Ve,{className:"h-20 w-20",children:[e.jsx($e,{src:(a==null?void 0:a.avatar_url)||""}),e.jsx(Oe,{className:"text-lg",children:((l=s.full_name)==null?void 0:l.charAt(0))||"U"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:s.full_name||"Unnamed User"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{variant:j(s.role),children:s.role}),(a==null?void 0:a.is_sharing_location)&&e.jsx(g,{variant:"outline",className:"text-green-600",children:"Location Sharing"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs("span",{children:["Joined ",new Date(s.created_at).toLocaleDateString()]})]}),(n==null?void 0:n.averageRating)>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ge,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsxs("span",{children:[n.averageRating," (",n.totalReviews," reviews)"]})]})]})]})]}),e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>d(!0),children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})]})})}),e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Contact Information"})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.phone_number||"Not provided"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"Email not available"})]}),(a==null?void 0:a.latitude)&&(a==null?void 0:a.longitude)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Location: ",a.latitude.toFixed(4),", ",a.longitude.toFixed(4),a.location_sharing_scope&&e.jsx(g,{variant:"outline",className:"ml-2",children:a.location_sharing_scope})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:h?"...":(n==null?void 0:n.totalBookings)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Bookings"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:h?"...":(n==null?void 0:n.completedBookings)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Completed"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h?"...":(n==null?void 0:n.hostedCars)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Cars Hosted"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:h?"...":(n==null?void 0:n.averageRating)||"0.0"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Rating"})]})})]})]}),i&&e.jsx(qe,{user:s,isOpen:i,onClose:()=>d(!1),onSuccess:p})]})},us=s=>P({queryKey:["user-bookings",s],queryFn:async()=>{const{data:t,error:i}=await u.from("bookings").select(`
          *,
          cars (
            id, brand, model, image_url, owner_id,
            profiles:owner_id (full_name)
          )
        `).eq("renter_id",s).order("created_at",{ascending:!1});if(i)throw i;const{data:d,error:a}=await u.from("bookings").select(`
          *,
          cars!inner (
            id, brand, model, image_url, owner_id
          ),
          profiles:renter_id (full_name)
        `).eq("cars.owner_id",s).order("created_at",{ascending:!1});if(a)throw a;return{asRenter:t||[],asHost:d||[]}}}),js=s=>{switch(s){case"confirmed":return"default";case"completed":return"secondary";case"cancelled":return"destructive";case"pending":return"outline";default:return"outline"}},ps=({userId:s})=>{var h,j,p,l;const t=Ne(),{data:i,isLoading:d,error:a}=us(s),r=c=>{t(`/admin/bookings?booking=${c}`)};if(d)return e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((c,b)=>e.jsx(D,{className:"h-32 w-full"},b))});if(a)return e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsx("p",{className:"text-destructive",children:"Failed to load bookings"})})});const n=[...((h=i==null?void 0:i.asRenter)==null?void 0:h.map(c=>({...c,role:"renter"})))||[],...((j=i==null?void 0:i.asHost)==null?void 0:j.map(c=>({...c,role:"host"})))||[]].sort((c,b)=>new Date(b.created_at).getTime()-new Date(c.created_at).getTime());return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:((p=i==null?void 0:i.asRenter)==null?void 0:p.length)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"As Renter"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((l=i==null?void 0:i.asHost)==null?void 0:l.length)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"As Host"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.filter(c=>c.status==="completed").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Completed"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.filter(c=>c.status==="cancelled").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Cancelled"})]})})]}),e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Recent Bookings"})}),e.jsx(m,{children:n.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No bookings found"}):e.jsx("div",{className:"space-y-4",children:n.slice(0,10).map(c=>{var b,f,y;return e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:(b=c.cars)!=null&&b.image_url?e.jsx("img",{src:c.cars.image_url,alt:"Car",className:"w-full h-full object-cover rounded-lg"}):e.jsx(Se,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("h4",{className:"font-semibold",children:[(f=c.cars)==null?void 0:f.brand," ",(y=c.cars)==null?void 0:y.model]}),e.jsx(g,{variant:js(c.status),children:c.status}),e.jsxs(g,{variant:c.role==="renter"?"default":"secondary",children:["As ",c.role]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs("span",{children:[new Date(c.start_date).toLocaleDateString()," -",new Date(c.end_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsxs("span",{children:["P",c.total_price]})]})]}),c.role==="renter"&&c.cars&&"profiles"in c.cars&&c.cars.profiles&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Host: ",c.cars.profiles.full_name||"Unknown"]}),c.role==="host"&&"profiles"in c&&c.profiles&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Renter: ",c.profiles.full_name||"Unknown"]})]})]}),e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>r(c.id),children:[e.jsx(es,{className:"h-4 w-4 mr-2"}),"View"]})]})},c.id)})})})]})]})},fs=s=>P({queryKey:["user-wallet",s],queryFn:async()=>{const{data:t,error:i}=await u.from("host_wallets").select("*").eq("host_id",s).single(),{data:d,error:a}=await u.from("wallet_transactions").select(`
          *,
          host_wallets!inner (host_id)
        `).eq("host_wallets.host_id",s).order("created_at",{ascending:!1}).limit(20);return{wallet:i?null:t,transactions:a?[]:d||[]}}}),gs=s=>{switch(s){case"topup":case"payment_received":return e.jsx(as,{className:"h-4 w-4 text-green-600"});case"deduction":case"commission":return e.jsx(ss,{className:"h-4 w-4 text-red-600"});default:return e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"})}},Ns=s=>{switch(s){case"topup":case"payment_received":return"default";case"deduction":case"commission":return"destructive";default:return"outline"}},vs=({userId:s})=>{var p;const{data:t,isLoading:i,error:d}=fs(s);if(i)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[...Array(3)].map((l,c)=>e.jsx(D,{className:"h-24 w-full"},c))}),e.jsx(D,{className:"h-64 w-full"})]});if(d)return e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsx("p",{className:"text-destructive",children:"Failed to load wallet data"})})});const{wallet:a,transactions:r}=t||{},n=(r==null?void 0:r.length)||0,h=(r==null?void 0:r.filter(l=>l.transaction_type==="topup").length)||0,j=(r==null?void 0:r.filter(l=>l.transaction_type==="deduction").length)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(ne,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{className:"text-2xl font-bold text-primary",children:["P",((p=a==null?void 0:a.balance)==null?void 0:p.toFixed(2))||"0.00"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Current Balance"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Transactions"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:h}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Top-ups"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:j}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Deductions"})]})})]}),e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Transaction History"})}),e.jsx(m,{children:a?(r==null?void 0:r.length)===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No transactions found"}):e.jsx("div",{className:"space-y-3",children:r==null?void 0:r.map(l=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[gs(l.transaction_type),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:l.description||l.transaction_type}),e.jsx(g,{variant:Ns(l.transaction_type),children:l.transaction_type})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[new Date(l.created_at).toLocaleString(),l.booking_reference&&e.jsxs("span",{className:"ml-2",children:["Booking: ",l.booking_reference]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-bold ${l.transaction_type==="topup"||l.transaction_type==="payment_received"?"text-green-600":"text-red-600"}`,children:[l.transaction_type==="topup"||l.transaction_type==="payment_received"?"+":"-","P",Math.abs(l.amount).toFixed(2)]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Balance: P",l.balance_after.toFixed(2)]})]})]})},l.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ne,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No wallet found for this user"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"User needs to have host role to have a wallet"})]})})]})]})},ys=s=>P({queryKey:["user-verification",s],queryFn:async()=>{const{data:t,error:i}=await u.from("user_verifications").select("*").eq("user_id",s).single(),{data:d,error:a}=await u.from("license_verifications").select("*").eq("user_id",s).single();return{verification:i?null:t,license:a?null:d}}}),ge=s=>s===!0||s==="completed"||s==="verified"?e.jsx(ns,{className:"h-5 w-5 text-green-600"}):s===!1||s==="rejected"?e.jsx(is,{className:"h-5 w-5 text-red-600"}):e.jsx(ls,{className:"h-5 w-5 text-yellow-600"}),B=s=>s===!0||s==="completed"||s==="verified"?e.jsx(g,{variant:"default",children:"Verified"}):s===!1||s==="rejected"?e.jsx(g,{variant:"destructive",children:"Rejected"}):e.jsx(g,{variant:"outline",children:"Pending"}),ws=({userId:s})=>{const{data:t,isLoading:i,error:d}=ys(s);if(i)return e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,h)=>e.jsx(D,{className:"h-32 w-full"},h))});if(d)return e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsx("p",{className:"text-destructive",children:"Failed to load verification data"})})});const{verification:a,license:r}=t||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Verification Status Overview"})}),e.jsx(m,{children:a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[ge(a.overall_status),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Overall Status"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Current step: ",a.current_step]})]})]}),B(a.overall_status)]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ts,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Personal Info"})]}),B(a.personal_info_completed)]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Phone Verified"})]}),B(a.phone_verified)]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Documents"})]}),B(a.documents_completed)]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Address Confirmed"})]}),B(a.address_confirmed)]})]}),a.rejection_reasons&&a.rejection_reasons.length>0&&e.jsxs(o,{className:"border-red-200",children:[e.jsx(w,{children:e.jsx(_,{className:"text-red-600",children:"Rejection Reasons"})}),e.jsx(m,{children:e.jsx("ul",{className:"list-disc list-inside space-y-1",children:a.rejection_reasons.map((n,h)=>e.jsx("li",{className:"text-sm text-red-600",children:n},h))})})]}),a.admin_notes&&e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Admin Notes"})}),e.jsx(m,{children:e.jsx("p",{className:"text-sm",children:a.admin_notes})})]})]}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No verification process started"})})]}),e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Driver's License Verification"})}),e.jsx(m,{children:r?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[ge(r.status),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"License Status"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.license_number?`License: ${r.license_number}`:"No license number"})]})]}),B(r.status)]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"font-medium",children:"Personal Details"}),e.jsxs("div",{className:"text-sm space-y-1",children:[r.date_of_birth&&e.jsxs("p",{children:["Date of Birth: ",new Date(r.date_of_birth).toLocaleDateString()]}),r.country_of_issue&&e.jsxs("p",{children:["Country: ",r.country_of_issue]}),r.expiry_date&&e.jsxs("p",{children:["Expires: ",new Date(r.expiry_date).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"font-medium",children:"Documents"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Front Image"}),e.jsx(g,{variant:r.front_image_path?"default":"outline",children:r.front_image_path?"Uploaded":"Missing"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Back Image"}),e.jsx(g,{variant:r.back_image_path?"default":"outline",children:r.back_image_path?"Uploaded":"Missing"})]})]})]})]}),r.rejection_reason&&e.jsxs(o,{className:"border-red-200",children:[e.jsx(w,{children:e.jsx(_,{className:"text-red-600",children:"Rejection Reason"})}),e.jsx(m,{children:e.jsx("p",{className:"text-sm text-red-600",children:r.rejection_reason})})]})]}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No license verification submitted"})})]}),e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Verification Timeline"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-3",children:[a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-3 p-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Verification Started"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:new Date(a.created_at).toLocaleString()})]})]}),a.last_updated_at!==a.created_at&&e.jsxs("div",{className:"flex items-center space-x-3 p-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Last Updated"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:new Date(a.last_updated_at).toLocaleString()})]})]}),a.completed_at&&e.jsxs("div",{className:"flex items-center space-x-3 p-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Verification Completed"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:new Date(a.completed_at).toLocaleString()})]})]})]}),r&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center space-x-3 p-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"License Submitted"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:new Date(r.created_at).toLocaleString()})]})]})})]})})]})]})},_s=s=>P({queryKey:["admin-status",s],queryFn:async()=>{const{data:t,error:i}=await u.from("admins").select("*").eq("id",s).single();return i?null:t}}),bs=({user:s,onUpdate:t})=>{const i=Ne(),d=ke(),[a,r]=v.useState(!1),[n,h]=v.useState(!1),[j,p]=v.useState(!1),{data:l,isLoading:c}=_s(s.id),b=K({mutationFn:async({isSuperAdmin:N})=>{const{error:S}=await u.from("admins").insert({id:s.id,email:"email@example.com",full_name:s.full_name,is_super_admin:N});if(S)throw S},onSuccess:()=>{d.invalidateQueries({queryKey:["admin-status",s.id]}),d.invalidateQueries({queryKey:["admin-users"]}),L.success("User added as admin successfully"),t==null||t(),h(!1)},onError:N=>{console.error("Error adding admin:",N),L.error("Failed to add user as admin")}}),f=K({mutationFn:async()=>{const{error:N}=await u.from("admins").delete().eq("id",s.id);if(N)throw N},onSuccess:()=>{d.invalidateQueries({queryKey:["admin-status",s.id]}),d.invalidateQueries({queryKey:["admin-users"]}),L.success("Admin access removed successfully"),t==null||t(),r(!1)},onError:N=>{console.error("Error removing admin:",N),L.error("Failed to remove admin access")}}),y=K({mutationFn:async({isSuperAdmin:N})=>{const{error:S}=await u.from("admins").update({is_super_admin:N}).eq("id",s.id);if(S)throw S},onSuccess:()=>{d.invalidateQueries({queryKey:["admin-status",s.id]}),L.success("Admin privileges updated successfully"),t==null||t()},onError:N=>{console.error("Error updating admin:",N),L.error("Failed to update admin privileges")}}),q=()=>{b.mutate({isSuperAdmin:j})},V=()=>{f.mutate()},$=N=>{y.mutate({isSuperAdmin:N})},U=()=>{i(`/admin/management?user=${s.id}`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{children:[e.jsx(w,{children:e.jsxs(_,{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"h-5 w-5"}),e.jsx("span",{children:"Admin Access Status"})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-muted",children:l?e.jsx(pe,{className:"h-5 w-5 text-green-600"}):e.jsx(fe,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Admin Access"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l?"User has admin access":"User does not have admin access"})]})]}),e.jsx(g,{variant:l?"default":"outline",children:l?"Admin":"No Access"})]}),l&&e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-muted",children:e.jsx(os,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Super Admin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Can manage other admins and system settings"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{checked:l.is_super_admin||!1,onCheckedChange:$,disabled:y.isPending}),e.jsx(g,{variant:l.is_super_admin?"destructive":"outline",children:l.is_super_admin?"Super Admin":"Regular Admin"})]})]})]})})]}),l&&e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Admin Details"})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Added:"}),e.jsx("span",{children:new Date(l.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Updated:"}),e.jsx("span",{children:new Date(l.updated_at).toLocaleString()})]}),l.last_sign_in_at&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Sign In:"}),e.jsx("span",{children:new Date(l.last_sign_in_at).toLocaleString()})]})]})]}),e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Admin Actions"})}),e.jsxs(m,{className:"space-y-3",children:[l?e.jsxs(T,{variant:"destructive",onClick:()=>r(!0),disabled:f.isPending,className:"w-full",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),f.isPending?"Removing...":"Remove Admin Access"]}):e.jsxs(T,{onClick:()=>h(!0),disabled:b.isPending,className:"w-full",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),b.isPending?"Adding...":"Add as Admin"]}),e.jsxs(T,{variant:"outline",onClick:U,className:"w-full",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"View in Admin Management"]})]})]}),e.jsx(le,{open:n,onOpenChange:h,children:e.jsxs(ce,{children:[e.jsxs(de,{children:[e.jsx(oe,{children:"Add Admin Access"}),e.jsxs(me,{children:["Are you sure you want to give ",s.full_name||"this user"," admin access to the platform?"]})]}),e.jsx("div",{className:"my-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{id:"super-admin",checked:j,onCheckedChange:p}),e.jsx("label",{htmlFor:"super-admin",className:"text-sm font-medium",children:"Make Super Admin (can manage other admins)"})]})}),e.jsxs(xe,{children:[e.jsx(he,{children:"Cancel"}),e.jsx(ue,{onClick:q,children:"Add Admin"})]})]})}),e.jsx(le,{open:a,onOpenChange:r,children:e.jsxs(ce,{children:[e.jsxs(de,{children:[e.jsx(oe,{children:"Remove Admin Access"}),e.jsxs(me,{children:["Are you sure you want to remove admin access for ",s.full_name||"this user","? This will revoke all admin privileges."]})]}),e.jsxs(xe,{children:[e.jsx(he,{children:"Cancel"}),e.jsx(ue,{onClick:V,className:"bg-destructive text-destructive-foreground",children:"Remove Access"})]})]})})]})},As=s=>P({queryKey:["user-activity",s],queryFn:async()=>{const t=[];try{const{data:i}=await u.from("bookings").select(`
            id, status, created_at, updated_at, total_price,
            cars (brand, model)
          `).or(`renter_id.eq.${s},cars.owner_id.eq.${s}`).order("updated_at",{ascending:!1}).limit(10);i==null||i.forEach(n=>{var h,j;t.push({id:`booking-${n.id}`,type:"booking",title:`Booking ${n.status}`,description:`${(h=n.cars)==null?void 0:h.brand} ${(j=n.cars)==null?void 0:j.model} - P${n.total_price}`,timestamp:n.updated_at,status:n.status,icon:X})});const{data:d}=await u.from("cars").select("id, brand, model, created_at, updated_at, is_available").eq("owner_id",s).order("updated_at",{ascending:!1}).limit(5);d==null||d.forEach(n=>{t.push({id:`car-${n.id}`,type:"car",title:"Car listing updated",description:`${n.brand} ${n.model} - ${n.is_available?"Available":"Unavailable"}`,timestamp:n.updated_at,status:n.is_available?"active":"inactive",icon:Se})});const{data:a}=await u.from("wallet_transactions").select(`
            id, transaction_type, amount, created_at, description,
            host_wallets!inner (host_id)
          `).eq("host_wallets.host_id",s).order("created_at",{ascending:!1}).limit(5);a==null||a.forEach(n=>{t.push({id:`transaction-${n.id}`,type:"transaction",title:`Wallet ${n.transaction_type}`,description:n.description||`P${n.amount}`,timestamp:n.created_at,status:n.transaction_type,icon:Y})});const{data:r}=await u.from("messages").select("id, content, created_at, status").or(`sender_id.eq.${s},receiver_id.eq.${s}`).order("created_at",{ascending:!1}).limit(5);return r==null||r.forEach(n=>{t.push({id:`message-${n.id}`,type:"message",title:"Message activity",description:n.content.substring(0,50)+"...",timestamp:n.created_at,status:n.status,icon:He})}),t.sort((n,h)=>new Date(h.timestamp).getTime()-new Date(n.timestamp).getTime())}catch(i){return console.error("Error fetching user activity:",i),[]}}}),Cs=(s,t)=>{switch(s){case"booking":switch(t){case"confirmed":return"default";case"completed":return"secondary";case"cancelled":return"destructive";default:return"outline"}case"transaction":switch(t){case"topup":return"default";case"deduction":return"destructive";default:return"outline"}case"car":return t==="active"?"default":"outline";default:return"outline"}},Ss=({userId:s})=>{const{data:t,isLoading:i,error:d}=As(s);return i?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((a,r)=>e.jsx(D,{className:"h-20 w-full"},r))}):d?e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-2 text-destructive",children:[e.jsx(se,{className:"h-5 w-5"}),e.jsx("span",{children:"Failed to load activity data"})]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:(t==null?void 0:t.filter(a=>a.type==="booking").length)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Booking Events"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(t==null?void 0:t.filter(a=>a.type==="car").length)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Car Updates"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(t==null?void 0:t.filter(a=>a.type==="transaction").length)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Transactions"})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(t==null?void 0:t.filter(a=>a.type==="message").length)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Messages"})]})})]}),e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"Recent Activity"})}),e.jsx(m,{children:!t||t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ds,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No recent activity found"})]}):e.jsx("div",{className:"space-y-4",children:t.slice(0,20).map(a=>{const r=a.icon;return e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg",children:[e.jsx("div",{className:"p-2 rounded-full bg-muted",children:e.jsx(r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-medium truncate",children:a.title}),e.jsx(g,{variant:Cs(a.type,a.status),children:a.type})]}),e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:new Date(a.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 truncate",children:a.description})]})]},a.id)})})})]}),e.jsxs(o,{children:[e.jsx(w,{children:e.jsx(_,{children:"System Logs"})}),e.jsx(m,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(se,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"System logs integration coming soon"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"This will show error logs, login attempts, and system interactions"})]})})]})]})},Ds=({user:s,isOpen:t,onClose:i,onUserUpdate:d})=>{const[a,r]=v.useState("overview");return s?e.jsx(ve,{open:t,onOpenChange:i,children:e.jsxs(ye,{className:"max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx(we,{children:e.jsxs(_e,{className:"text-xl font-bold",children:[s.full_name||"Unnamed User"," - User Profile"]})}),e.jsxs(Ke,{value:a,onValueChange:r,className:"flex-1 overflow-hidden",children:[e.jsxs(ze,{className:"grid w-full grid-cols-6",children:[e.jsx(R,{value:"overview",children:"Overview"}),e.jsx(R,{value:"bookings",children:"Bookings"}),e.jsx(R,{value:"transactions",children:"Transactions"}),e.jsx(R,{value:"verification",children:"Verification"}),e.jsx(R,{value:"admin",children:"Admin"}),e.jsx(R,{value:"activity",children:"Activity"})]}),e.jsxs("div",{className:"overflow-y-auto max-h-[70vh] mt-4",children:[e.jsx(k,{value:"overview",className:"mt-0",children:e.jsx(hs,{user:s,onUpdate:d})}),e.jsx(k,{value:"bookings",className:"mt-0",children:e.jsx(ps,{userId:s.id})}),e.jsx(k,{value:"transactions",className:"mt-0",children:e.jsx(vs,{userId:s.id})}),e.jsx(k,{value:"verification",className:"mt-0",children:e.jsx(ws,{userId:s.id})}),e.jsx(k,{value:"admin",className:"mt-0",children:e.jsx(bs,{user:s,onUpdate:d})}),e.jsx(k,{value:"activity",className:"mt-0",children:e.jsx(Ss,{userId:s.id})})]})]})]})}):null},Ts=()=>P({queryKey:["admin-users"],queryFn:async()=>{const{data:s,error:t}=await u.from("profiles").select(`
          id, full_name, role, phone_number, created_at, avatar_url
        `).order("created_at",{ascending:!1});if(t)throw t;return s||[]}}),aa=({isPreview:s=!1,maxItems:t=5})=>{const[i,d]=v.useState(""),[a,r]=v.useState(null),[n,h]=v.useState(!1),[j,p]=v.useState(!1),{data:l,isLoading:c,error:b,refetch:f}=Ts(),y=(l==null?void 0:l.filter(x=>{var C,F;return((C=x.full_name)==null?void 0:C.toLowerCase().includes(i.toLowerCase()))||x.role.toLowerCase().includes(i.toLowerCase())||((F=x.phone_number)==null?void 0:F.includes(i))}))||[],[q,V]=v.useState(1),$=10,U=s?y.slice(0,t):y,N=s?U:U.slice((q-1)*$,q*$),S=Math.ceil(U.length/$),Ue=x=>{switch(x){case"admin":return"destructive";case"host":return"default";case"renter":return"secondary";default:return"outline"}},Fe=x=>{switch(x){case"verified":return"default";case"pending":return"secondary";case"rejected":return"destructive";default:return"outline"}},Ee=x=>{r(x),h(!0)},G=x=>{r(x),p(!0)},Z=()=>{f(),h(!1),p(!1),r(null),L.success("User updated successfully")},Re=()=>{p(!1),r(null)},ee=x=>e.jsxs(I,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>G(x),children:[e.jsx(E,{className:"font-medium",children:x.full_name||"No name"}),e.jsx(E,{children:e.jsx(g,{variant:Ue(x.role),children:x.role})}),e.jsx(E,{children:e.jsx(g,{variant:"default",children:"Active"})}),e.jsx(E,{children:e.jsx(g,{variant:Fe("not_started"),children:"not started"})}),e.jsx(E,{children:x.phone_number||"N/A"}),e.jsx(E,{children:new Date(x.created_at).toLocaleDateString()}),e.jsx(E,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{variant:"ghost",size:"sm",onClick:C=>{C.stopPropagation(),G(x)},title:"View User Details",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(T,{variant:"ghost",size:"sm",onClick:C=>{C.stopPropagation(),Ee(x)},title:"Edit User",children:e.jsx(be,{className:"h-4 w-4"})})]})})]},x.id);return b?e.jsx(o,{children:e.jsx(m,{className:"p-6",children:e.jsx("p",{className:"text-destructive",children:"Failed to load users"})})}):s?c?e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((x,C)=>e.jsx(D,{className:"h-16 w-full"},C))}):U.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No users found"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(I,{children:[e.jsx(A,{children:"Name"}),e.jsx(A,{children:"Role"}),e.jsx(A,{children:"Account Status"}),e.jsx(A,{children:"KYC Status"}),e.jsx(A,{children:"Phone"}),e.jsx(A,{children:"Joined"}),e.jsx(A,{children:"Actions"})]})}),e.jsx(re,{children:U.map(x=>ee(x))})]})}),a&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{user:a,isOpen:n,onClose:()=>h(!1),onSuccess:Z}),e.jsx(Ds,{user:a,isOpen:j,onClose:Re,onUserUpdate:()=>{f(),Z()}})]})]}):e.jsxs(o,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs(_,{children:["Users (",y.length,")"]}),e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(Ie,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(J,{placeholder:"Search users...",value:i,onChange:x=>d(x.target.value),className:"pl-8"})]})]})}),e.jsxs(m,{children:[c?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((x,C)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(D,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{className:"h-4 w-[200px]"}),e.jsx(D,{className:"h-4 w-[100px]"})]})]},C))}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(I,{children:[e.jsx(A,{children:"Name"}),e.jsx(A,{children:"Role"}),e.jsx(A,{children:"Account Status"}),e.jsx(A,{children:"KYC Status"}),e.jsx(A,{children:"Phone"}),e.jsx(A,{children:"Joined"}),e.jsx(A,{children:"Actions"})]})}),e.jsx(re,{children:N.map(x=>ee(x))})]})}),!s&&S>1&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(De,{children:e.jsxs(Te,{children:[e.jsx(O,{children:e.jsx(Le,{onClick:()=>V(x=>Math.max(x-1,1)),className:q===1?"pointer-events-none opacity-50":"cursor-pointer"})}),[...Array(Math.min(S,5))].map((x,C)=>{const F=C+1;return e.jsx(O,{children:e.jsx(H,{onClick:()=>V(F),isActive:q===F,className:"cursor-pointer",children:F})},F)}),e.jsx(O,{children:e.jsx(Pe,{onClick:()=>V(x=>Math.min(x+1,S)),className:q===S?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]}),!c&&y.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No users found"})]})]})};export{De as P,aa as U,Te as a,O as b,Le as c,H as d,Pe as e};
