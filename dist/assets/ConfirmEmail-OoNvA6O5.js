import{j as e}from"./query-vendor-C7aRRP05.js";import{h as b,u as j,r}from"./react-vendor-mnpoGfEl.js";import{aA as d}from"./index-CfXH57CA.js";import{C as N}from"./circle-x-C4r5drii.js";import{L as u}from"./loader-circle-_3wlvkqs.js";import{M as v}from"./mail-DKpIUpKb.js";import{C as w}from"./circle-check-big-D5NSr62X.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./date-vendor-Dhms5dOu.js";const I=()=>{const[x]=b(),l=j(),[f,a]=r.useState("loading"),[c,t]=r.useState(""),[i,g]=r.useState(""),[o,m]=r.useState(!1),n=x.get("token");r.useEffect(()=>{if(!n){a("error"),t("Invalid confirmation link. Please check your email and try again.");return}h()},[n]);const h=async()=>{if(n)try{const s=await d.confirmEmail(n);s.success?(a("success"),t("Your email has been confirmed successfully! You can now sign in to your account."),setTimeout(()=>{l("/auth?tab=signin")},3e3)):(a("error"),t(s.error||"Failed to confirm email. Please try again."))}catch(s){console.error("Error confirming email:",s),a("error"),t("An unexpected error occurred. Please try again.")}},p=async()=>{if(!i.trim()){alert("Please enter your email address");return}m(!0);try{const s=await d.resendConfirmation(i);s.success?alert("Confirmation email sent! Please check your inbox."):alert(s.error||"Failed to resend confirmation email.")}catch(s){console.error("Error resending confirmation:",s),alert("An unexpected error occurred. Please try again.")}finally{m(!1)}},y=()=>{switch(f){case"loading":return e.jsxs("div",{className:"text-center",children:[e.jsx(u,{className:"w-16 h-16 text-purple-600 animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Confirming your email..."}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we verify your email address."})]});case"success":return e.jsxs("div",{className:"text-center",children:[e.jsx(w,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Email Confirmed!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:c}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you to sign in..."})]});case"error":return e.jsxs("div",{className:"text-center",children:[e.jsx(N,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Confirmation Failed"}),e.jsx("p",{className:"text-gray-600 mb-6",children:c}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Need help?"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter your email to resend confirmation:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",id:"email",value:i,onChange:s=>g(s.target.value),placeholder:"your@email.com",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),e.jsxs("button",{onClick:p,disabled:o,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[o?e.jsx(u,{className:"w-4 h-4 animate-spin"}):e.jsx(v,{className:"w-4 h-4"}),o?"Sending...":"Resend"]})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx("button",{onClick:()=>l("/auth?tab=signup"),className:"w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Back to Sign Up"})})]})]})]});default:return null}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsx("div",{className:"text-center",children:e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Welcome to ",e.jsx("span",{className:"text-purple-600",children:"MobiRides"})]})}),e.jsx("div",{className:"bg-white shadow-lg rounded-lg p-8",children:y()})]})})};export{I as default};
