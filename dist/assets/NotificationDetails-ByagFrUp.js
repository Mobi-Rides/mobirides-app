import{u as w,j as e}from"./query-vendor-Bsfdn-Hb.js";import{k as v,u as k,R as _,N as d}from"./react-vendor-mnpoGfEl.js";import{a3 as C,L as R,B as c,n as m,s as f}from"./index-P3CM6KeI.js";import{C as B,a as A,b as P,d as D}from"./card-CfBwv9RV.js";import{N as i,n as q}from"./notificationHelpers-DZFPT44-.js";import{C as I}from"./calendar-BKgmIjQf.js";import{U as M}from"./user-BqRr4HZa.js";import{B as x}from"./bell-BXMTfvW8.js";import{C as N}from"./car-BJ1V2yVZ.js";import{M as E}from"./message-square-B-A4He7I.js";import{M as V}from"./map-pin-DPjPx-xp.js";import{W as L}from"./wallet-D-Tke-Q7.js";import{a as T}from"./date-vendor-Dhms5dOu.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";const ee=()=>{const{id:t}=v(),{user:r}=C(),n=k(),{data:s,isLoading:u,error:p}=w({queryKey:["notification",t],queryFn:async()=>{if(!t)throw new Error("Notification ID is required");const a=parseInt(t,10);if(isNaN(a))throw new Error("Invalid notification ID");const{data:o,error:l}=await f.from("notifications").select("*").eq("id",a).single();if(l)throw l;return q(o)},enabled:!!t});if(_.useEffect(()=>{s&&!s.is_read&&(async()=>await f.from("notifications").update({is_read:!0}).eq("id",s.id))()},[s]),!t)return e.jsx(d,{to:"/notifications",replace:!0});if(u)return e.jsx(R,{});if(p||!s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Notification Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The notification you're looking for doesn't exist or you don't have permission to view it."}),e.jsx(c,{onClick:()=>n("/notifications"),children:"Back to Notifications"})]})});if((r==null?void 0:r.id)!==s.user_id)return e.jsx(d,{to:"/notifications",replace:!0});const h=a=>{switch(i.classifyNotification(a)){case"booking":return e.jsx(N,{className:"h-5 w-5"});case"payment":return e.jsx(L,{className:"h-5 w-5"});case"handover":return e.jsx(V,{className:"h-5 w-5"});case"system":return e.jsx(x,{className:"h-5 w-5"});default:return e.jsx(E,{className:"h-5 w-5"})}},j=a=>{switch(i.classifyNotification(a)){case"booking":return"bg-blue-100 text-blue-800";case"payment":return"bg-green-100 text-green-800";case"handover":return"bg-purple-100 text-purple-800";case"system":return"bg-gray-100 text-gray-800";default:return"bg-orange-100 text-orange-800"}},g=a=>T(new Date(a),"PPP p"),b=a=>{a.related_booking_id?n(`/bookings/${a.related_booking_id}`):i.isPaymentNotification(a)?n("/wallet"):i.isActiveRentalNotification(a)&&n("/map")},y=a=>a.related_booking_id||i.isPaymentNotification(a)||i.isActiveRentalNotification(a);return e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-2xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(c,{variant:"outline",onClick:()=>n("/notifications"),className:"mb-4",children:"← Back to Notifications"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Notification Details"})]}),e.jsxs(B,{children:[e.jsx(A,{children:e.jsxs(P,{className:"flex items-center gap-3",children:[h(s),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{children:"Notification"}),e.jsx(m,{className:j(s),children:i.classifyNotification(s)}),!s.is_read&&e.jsx(m,{variant:"secondary",children:"New"})]})})]})}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:s.title}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:s.description})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Created:"}),e.jsx("span",{children:g(s.created_at)})]}),s.is_read&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx("span",{children:"Read"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Type:"}),e.jsx("span",{className:"font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:s.type})]}),s.related_booking_id&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Related Booking:"}),e.jsxs("span",{className:"font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:["#",s.related_booking_id]})]})]}),y(s)&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(c,{onClick:()=>b(s),className:"w-full",children:[s.related_booking_id&&"View Booking Details",!s.related_booking_id&&i.isPaymentNotification(s)&&"View Wallet",!s.related_booking_id&&i.isActiveRentalNotification(s)&&"View on Map"]})})]})]})]})};export{ee as NotificationDetails,ee as default};
