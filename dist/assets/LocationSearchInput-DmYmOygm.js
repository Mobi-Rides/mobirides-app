import{j as e}from"./query-vendor-Bsfdn-Hb.js";import{r as l}from"./react-vendor-mnpoGfEl.js";import{ay as B,R as N,an as M,I as P,B as w,X as A,t as D}from"./index-P3CM6KeI.js";import{M as X}from"./map-pin-DPjPx-xp.js";import{S as b}from"./star-C5u9QfUh.js";import{C as q}from"./clock-BMQl8Y3I.js";const W=({placeholder:S="Search for a location...",onLocationSelect:k,onLocationChange:d,className:g,showRecentSearches:p=!0,showFavorites:y=!0,value:I,disabled:R=!1})=>{const[r,o]=l.useState(I||""),[C,a]=l.useState(!1),[c,E]=l.useState(null),v=l.useRef(null),i=l.useRef(null),{searchResults:m,recentSearches:u,favorites:n,isLoading:j,error:x,search:F,selectLocation:T,addToFavorites:_,removeFromFavorites:z}=B(),L=t=>{const s=t.target.value;o(s),c&&clearTimeout(c);const h=setTimeout(()=>{s.trim()?(F(s),a(!0)):a(!1)},300);E(h)},f=t=>{o(t.name),a(!1),T(t),k(t),d==null||d(t.coordinates,t.full_address)},O=()=>{(r.trim()||p&&u.length>0)&&a(!0)};l.useEffect(()=>{const t=s=>{i.current&&!i.current.contains(s.target)&&a(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),l.useEffect(()=>()=>{c&&clearTimeout(c)},[c]);const V=()=>{var t;o(""),a(!1),(t=v.current)==null||t.focus()};return e.jsxs("div",{ref:i,className:N("relative w-full",g),children:[e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{ref:v,type:"text",placeholder:S,value:r,onChange:L,onFocus:O,disabled:R,className:"pl-10 pr-8"}),r&&e.jsx(w,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",onClick:V,children:e.jsx(A,{className:"h-3 w-3"})})]}),C&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-popover border border-border rounded-md shadow-lg max-h-80",children:e.jsxs(D,{className:"max-h-80",children:[x&&e.jsx("div",{className:"p-3 text-sm text-destructive border-b",children:x}),j&&e.jsx("div",{className:"p-3 text-sm text-muted-foreground",children:"Searching..."}),m.suggestions.length>0&&e.jsxs("div",{className:"border-b",children:[e.jsx("div",{className:"p-2 text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Search Results"}),m.suggestions.map(t=>e.jsxs("button",{onClick:()=>f(t),className:"w-full px-3 py-2 text-left hover:bg-accent hover:text-accent-foreground flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:t.name}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:t.full_address})]}),e.jsx(w,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 flex-shrink-0",onClick:s=>{s.stopPropagation(),n.some(h=>h.id===t.id)?z(t.id):_(t)},children:e.jsx(b,{className:N("h-3 w-3",n.some(s=>s.id===t.id)?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})})]},t.id))]}),p&&u.length>0&&!r.trim()&&e.jsxs("div",{className:"border-b",children:[e.jsx("div",{className:"p-2 text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Recent Searches"}),u.slice(0,3).map(t=>e.jsxs("button",{onClick:()=>f(t),className:"w-full px-3 py-2 text-left hover:bg-accent hover:text-accent-foreground flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:t.name}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:t.full_address})]})]},t.id))]}),y&&n.length>0&&!r.trim()&&e.jsxs("div",{children:[e.jsx("div",{className:"p-2 text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Favorites"}),n.slice(0,3).map(t=>e.jsxs("button",{onClick:()=>f(t),className:"w-full px-3 py-2 text-left hover:bg-accent hover:text-accent-foreground flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-yellow-400 fill-yellow-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:t.name}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:t.full_address})]})]},t.id))]}),r.trim()&&!j&&m.suggestions.length===0&&!x&&e.jsxs("div",{className:"p-3 text-sm text-muted-foreground text-center",children:['No locations found for "',r,'"']})]})})]})};export{W as L};
