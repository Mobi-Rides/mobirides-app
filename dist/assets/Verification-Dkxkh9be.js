var me=Object.defineProperty;var xe=(r,a,s)=>a in r?me(r,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[a]=s;var Q=(r,a,s)=>xe(r,typeof a!="symbol"?a+"":a,s);import{j as e}from"./query-vendor-Bsfdn-Hb.js";import{c as he,aq as F,a7 as ue,B as g,a2 as te,f as E,I as A,ar as pe,J as h,a3 as J,V as y,q as B,n as U,g as Y,h as z,ak as re,as as fe,P as W,r as je,at as ge,U as ee,au as w,X as Ne,av as _,T as be,aw as ve}from"./index-P3CM6KeI.js";import{r as m,R as M,u as K}from"./react-vendor-mnpoGfEl.js";import{C,d as S,a as k,b as T,c as ye}from"./card-CfBwv9RV.js";import{R as we,P as ae}from"./progress-DLtqtrRA.js";import"./separator-BWndGHPr.js";import{A as Ce,a as Se,b as Pe,c as ke,d as Te,e as Ee,f as Ae,g as _e,h as Ve}from"./alert-dialog-mpj_VIRX.js";import{U as Z}from"./user-BqRr4HZa.js";import{A as D}from"./arrow-right--OEAnneY.js";import{F as ie}from"./file-text-KLanAaZO.js";import{U as Ie}from"./upload-CrQst_zZ.js";import{C as I}from"./circle-alert-CnS2w5gW.js";import{C as ne}from"./camera-DadvHD0M.js";import{M as Fe}from"./message-square-B-A4He7I.js";import{M as le}from"./map-pin-DPjPx-xp.js";import{P as Re}from"./pen-line-B93Ng6MB.js";import{C as X}from"./clock-BMQl8Y3I.js";import{M as ce,U as Oe}from"./user-check-DqTRjbbA.js";import{S as H}from"./shield-CXGhqkUx.js";import{t as De}from"./useVerificationStatus-fqM8qHb1.js";import{S as oe}from"./star-C5u9QfUh.js";import{D as Le}from"./download-BNZh9aAc.js";import{C as se}from"./car-BJ1V2yVZ.js";import{C as Ue}from"./calendar-BKgmIjQf.js";import{H as Me}from"./house-CrWAd8rV.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./date-vendor-Dhms5dOu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=he("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),Ye=({onNext:r})=>{const{verificationData:a,updatePersonalInfo:s,isLoading:o,refreshData:d}=F(),[l,c]=m.useState({fullName:"",dateOfBirth:"",nationalIdNumber:"",phoneNumber:"",email:"",address:{street:"",area:"",city:"",postalCode:""}}),[u,b]=m.useState(!1);m.useEffect(()=>{var n,j,v,x;if(a!=null&&a.personal_info){const t=a.personal_info,p={fullName:String((t==null?void 0:t.fullName)||""),dateOfBirth:String((t==null?void 0:t.dateOfBirth)||""),nationalIdNumber:String((t==null?void 0:t.nationalIdNumber)||""),phoneNumber:String((t==null?void 0:t.phoneNumber)||""),email:String((t==null?void 0:t.email)||""),address:{street:String(((n=t==null?void 0:t.address)==null?void 0:n.street)||""),area:String(((j=t==null?void 0:t.address)==null?void 0:j.area)||""),city:String(((v=t==null?void 0:t.address)==null?void 0:v.city)||""),postalCode:String(((x=t==null?void 0:t.address)==null?void 0:x.postalCode)||"")}};c(p);const P=t.fullName||t.phoneNumber||t.email;b(!!P)}},[a]);const N=async n=>{if(n.preventDefault(),!l.fullName||!l.dateOfBirth||!l.nationalIdNumber){h.error("Please fill in all required fields");return}try{await s(l),h.success("Personal information saved successfully!"),r()}catch(j){console.error("Failed to save personal information:",j),h.error("Failed to save personal information")}},i=(n,j)=>{if(n.includes("address.")){const v=n.split(".")[1];c(x=>({...x,address:{...x.address,[v]:j}}))}else c(v=>({...v,[n]:j}))},f=async()=>{if(a!=null&&a.user_id)try{await pe.refreshFromProfile(a.user_id)?(await d(),h.success("Profile data refreshed successfully!")):h.error("Failed to refresh profile data")}catch(n){console.error("Failed to refresh from profile:",n),h.error("Failed to refresh profile data")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Personal Information"}),e.jsx("p",{className:"text-muted-foreground",children:"Please provide your personal details for verification"})]}),u&&e.jsx(C,{className:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950",children:e.jsx(S,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ue,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"Profile Data Imported"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"We've pre-filled some fields from your profile. Please review and update as needed."}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:f,className:"text-blue-700 border-blue-300 hover:bg-blue-100 dark:text-blue-300 dark:border-blue-700 dark:hover:bg-blue-900",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Refresh from Profile"]})]})]})})}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Basic Information"})]})}),e.jsx(S,{children:e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"fullName",children:"Full Name *"}),e.jsx(A,{id:"fullName",value:l.fullName,onChange:n=>i("fullName",n.target.value),placeholder:"Enter your full name",required:!0})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"dateOfBirth",children:"Date of Birth *"}),e.jsx(A,{id:"dateOfBirth",type:"date",value:l.dateOfBirth,onChange:n=>i("dateOfBirth",n.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"nationalIdNumber",children:"National ID Number *"}),e.jsx(A,{id:"nationalIdNumber",value:l.nationalIdNumber,onChange:n=>i("nationalIdNumber",n.target.value),placeholder:"Enter your Omang number",required:!0})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(A,{id:"phoneNumber",type:"tel",value:l.phoneNumber,onChange:n=>i("phoneNumber",n.target.value),placeholder:"+267 XX XXX XXX"})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"email",children:"Email Address"}),e.jsx(A,{id:"email",type:"email",value:l.email,onChange:n=>i("email",n.target.value),placeholder:"your.email@example.com"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Address Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"street",children:"Street Address"}),e.jsx(A,{id:"street",value:l.address.street,onChange:n=>i("address.street",n.target.value),placeholder:"Street address"})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"area",children:"Area/Suburb"}),e.jsx(A,{id:"area",value:l.address.area,onChange:n=>i("address.area",n.target.value),placeholder:"Area or suburb"})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"city",children:"City"}),e.jsx(A,{id:"city",value:l.address.city,onChange:n=>i("address.city",n.target.value),placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"postalCode",children:"Postal Code"}),e.jsx(A,{id:"postalCode",value:l.address.postalCode,onChange:n=>i("address.postalCode",n.target.value),placeholder:"Postal code"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-6",children:e.jsxs(g,{type:"submit",disabled:o,className:"flex items-center space-x-2",children:[e.jsx("span",{children:o?"Saving...":"Continue to Documents"}),e.jsx(D,{className:"h-4 w-4"})]})})]})})]})]})},ze=({onNext:r,onPrevious:a})=>{const{isLoading:s,completeDocumentUpload:o}=F(),{user:d}=J(),[l,c]=m.useState([]),u=[{id:"national_id_front",title:"National ID (Front)",description:"Front side of your Botswana National ID (Omang)"},{id:"national_id_back",title:"National ID (Back)",description:"Back side of your Botswana National ID (Omang)"},{id:"driving_license_front",title:"Driving License (Front)",description:"Front side of your valid driving license"},{id:"proof_of_address",title:"Proof of Address",description:"Utility bill or bank statement (max 3 months old)"}],b=(i,f)=>{setTimeout(()=>{c(n=>[...n,i]),h.success(`${f.name} uploaded successfully`)},1e3)},N=async()=>{if(l.length<u.length){h.error("Please upload all required documents");return}if(!(d!=null&&d.id)){h.error("User not authenticated");return}try{await o(d.id)?(h.success("Documents verified successfully!"),r()):h.error("Failed to complete document upload. Please try again.")}catch(i){console.error("Error completing document upload:",i),h.error("An error occurred. Please try again.")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Document Upload"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload clear photos of your required documents"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map(i=>e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{children:i.title})]}),l.includes(i.id)&&e.jsx(y,{className:"h-5 w-5 text-green-500"})]})}),e.jsxs(S,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:i.description}),l.includes(i.id)?e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(y,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Document uploaded"})]}):e.jsxs("div",{children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:f=>{var j;const n=(j=f.target.files)==null?void 0:j[0];n&&b(i.id,n)},className:"hidden",id:`file-${i.id}`}),e.jsx("label",{htmlFor:`file-${i.id}`,className:"flex items-center justify-center w-full p-4 border-2 border-dashed border-muted-foreground/25 rounded-lg cursor-pointer hover:border-primary/50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ie,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload or drag and drop"})]})})]})]})]},i.id))}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:a,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:N,disabled:s,children:[e.jsx("span",{children:"Continue to Selfie"}),e.jsx(D,{className:"h-4 w-4 ml-2"})]})]})]})},He=({onCapture:r,onRetake:a,isCapturing:s,hasPhoto:o})=>e.jsx("div",{className:"flex justify-center space-x-4 mt-6",children:o?e.jsx("div",{className:"flex space-x-3",children:e.jsxs(g,{variant:"outline",onClick:a,className:"flex items-center space-x-2",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{children:"Retake"})]})}):e.jsxs(g,{onClick:r,disabled:s,size:"lg",className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:s?"Capturing...":"Take Selfie"})]})}),Xe=()=>e.jsxs(C,{className:"mb-6",children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2 text-lg",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Selfie Guidelines"})]})}),e.jsx(S,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-green-600 flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:"Do This"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(re,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Look directly at the camera"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(fe,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Have a neutral expression"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Ensure good lighting on your face"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Remove sunglasses and hats"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Face the camera directly"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-red-600 flex items-center space-x-2",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:"Avoid This"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't cover your face"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't take photos in dark lighting"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't blur the image"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't include other people"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't tilt your head significantly"})]})]})]})]})})]}),$e=({onPhotoCapture:r,photoUrl:a,onRetake:s})=>{const o=m.useRef(null),d=m.useRef(null),[l,c]=m.useState(null),[u,b]=m.useState(!1),[N,i]=m.useState(!1),f=m.useCallback(async()=>{try{c(null);const x=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});o.current&&(o.current.srcObject=x,o.current.onloadedmetadata=()=>{i(!0)})}catch(x){console.error("Camera initialization error:",x),c("Unable to access camera. Please ensure camera permissions are granted.")}},[]),n=m.useCallback(()=>{var x;(x=o.current)!=null&&x.srcObject&&o.current.srcObject.getTracks().forEach(p=>p.stop())},[]),j=m.useCallback(async()=>{if(!(!o.current||!d.current||!N)){b(!0);try{const x=o.current,t=d.current,p=t.getContext("2d");if(!p)return;t.width=x.videoWidth,t.height=x.videoHeight,p.drawImage(x,0,0,t.width,t.height),t.toBlob(P=>{P&&(r(P),h.success("Selfie captured successfully!"))},"image/jpeg",.8)}catch(x){console.error("Photo capture error:",x),h.error("Failed to capture photo")}finally{b(!1)}}},[N,r]),v=m.useCallback(()=>{s(),N||f()},[s,N,f]);return m.useEffect(()=>(a||f(),n),[a,f,n]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden aspect-[4/3] max-w-md mx-auto",children:l?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-red-600 mb-4",children:l}),e.jsx(g,{onClick:f,size:"sm",children:"Try Again"})]})}):a?e.jsx("img",{src:a,alt:"Captured selfie",className:"w-full h-full object-cover"}):e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-48 h-48 border-2 border-white/50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-44 h-44 border border-white/30 rounded-full"})})}),e.jsx("div",{className:"absolute top-4 left-4 right-4",children:e.jsx("div",{className:"bg-black/50 text-white text-center py-2 px-4 rounded",children:e.jsx("p",{className:"text-sm",children:N?"Position your face in the circle":"Loading camera..."})})})]})})]})}),e.jsx("canvas",{ref:d,className:"hidden"}),e.jsx(He,{onCapture:j,onRetake:v,isCapturing:u,hasPhoto:!!a})]})},qe=({onNext:r,onPrevious:a})=>{const{verificationData:s,completeSelfieVerification:o,isLoading:d}=F(),[l,c]=m.useState(null),[u,b]=m.useState(null),[N,i]=m.useState(!1),f=m.useCallback(x=>{c(x);const t=URL.createObjectURL(x);b(t)},[]),n=m.useCallback(()=>{u&&URL.revokeObjectURL(u),c(null),b(null)},[u]),j=async()=>{if(!l){h.error("Please take a selfie first");return}try{i(!0),await o(),h.success("Selfie verification completed!"),setTimeout(()=>{r()},1e3)}catch(x){console.error("Failed to submit selfie:",x),h.error("Failed to submit selfie verification")}finally{i(!1)}};return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Take Your Verification Selfie"}),e.jsx("p",{className:"text-muted-foreground",children:"We need to verify that you're the same person as in your ID documents"})]}),e.jsx(Xe,{}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Capture Your Selfie"}),u&&e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"Photo Captured"]})]})}),e.jsx(S,{children:e.jsx($e,{onPhotoCapture:f,photoUrl:u,onRetake:n})})]}),e.jsxs(Y,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"Privacy Notice:"})," Your selfie is used only for identity verification and is processed securely. We do not use your photo for any other purposes."]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:a,className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]}),e.jsxs(g,{onClick:j,disabled:!u||N||d,className:"flex items-center space-x-2",children:[e.jsx("span",{children:N?"Submitting...":"Continue to Phone Verification"}),e.jsx(D,{className:"h-4 w-4"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Camera Not Supported"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Your browser doesn't support camera access. Please use a modern browser or upload a selfie manually."}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(g,{variant:"outline",onClick:a,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:r,children:["Skip for Now",e.jsx(D,{className:"h-4 w-4 ml-2"})]})]})]})},We=({onNext:r,onPrevious:a})=>{const{updatePhoneVerification:s,isLoading:o}=F(),[d,l]=m.useState(""),[c,u]=m.useState(""),[b,N]=m.useState(!1),[i,f]=m.useState(!1),n=async()=>{if(!d){h.error("Please enter your phone number");return}setTimeout(()=>{N(!0),h.success("Verification code sent to your phone")},1e3)},j=async()=>{if(!c){h.error("Please enter the verification code");return}c==="123456"||c.length===6?(f(!0),await s({phoneNumber:d,countryCode:"+267",verificationCode:c,isVerified:!0}),h.success("Phone number verified successfully!")):h.error("Invalid verification code")},v=()=>{if(!i){h.error("Please verify your phone number first");return}r()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Phone Verification"}),e.jsx("p",{className:"text-muted-foreground",children:"Verify your phone number to secure your account"})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5"}),e.jsx("span",{children:"Phone Number Verification"})]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(A,{id:"phoneNumber",type:"tel",value:d,onChange:x=>l(x.target.value),placeholder:"+267 XX XXX XXX",disabled:b}),e.jsx(g,{onClick:n,disabled:b||!d,variant:"outline",children:b?"Code Sent":"Send Code"})]})]}),b&&!i&&e.jsxs("div",{children:[e.jsxs(E,{htmlFor:"verificationCode",children:[e.jsx(Fe,{className:"h-4 w-4 inline mr-2"}),"Verification Code"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(A,{id:"verificationCode",value:c,onChange:x=>u(x.target.value),placeholder:"Enter 6-digit code",maxLength:6}),e.jsx(g,{onClick:j,disabled:!c,children:"Verify"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Enter the 6-digit code sent to your phone"})]}),i&&e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(W,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Phone number verified successfully!"})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:a,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:v,disabled:o||!i,children:[e.jsx("span",{children:"Continue to Address"}),e.jsx(D,{className:"h-4 w-4 ml-2"})]})]})]})},Ge=({onNext:r,onPrevious:a})=>{const{verificationData:s,updateAddressConfirmation:o,updatePersonalInfo:d,isLoading:l}=F(),[c,u]=m.useState(!1),[b,N]=m.useState(!1),[i,f]=m.useState({street:"",area:"",city:"",postalCode:""});m.useEffect(()=>{var t;(t=s==null?void 0:s.personal_info)!=null&&t.address&&f(s.personal_info.address)},[s]);const n=async()=>{try{await d({...s==null?void 0:s.personal_info,address:i}),N(!1),h.success("Address updated successfully!")}catch(t){console.error("Failed to update address:",t),h.error("Failed to update address")}},j=(t,p)=>{f(P=>({...P,[t]:p}))},v=async()=>{await o({currentAddress:i,confirmationMethod:"document",isConfirmed:!0,confirmationDate:new Date().toISOString()}),u(!0),h.success("Address confirmed successfully!")},x=()=>{if(!c){h.error("Please confirm your address first");return}r()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Address Confirmation"}),e.jsx("p",{className:"text-muted-foreground",children:"Confirm your residential address details"})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-5 w-5"}),e.jsx("span",{children:"Residential Address"})]})}),e.jsxs(S,{className:"space-y-4",children:[b?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"edit-street",children:"Street Address"}),e.jsx(A,{id:"edit-street",value:i.street,onChange:t=>j("street",t.target.value),placeholder:"Street address"})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"edit-area",children:"Area/Suburb"}),e.jsx(A,{id:"edit-area",value:i.area,onChange:t=>j("area",t.target.value),placeholder:"Area or suburb"})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"edit-city",children:"City"}),e.jsx(A,{id:"edit-city",value:i.city,onChange:t=>j("city",t.target.value),placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"edit-postalCode",children:"Postal Code"}),e.jsx(A,{id:"edit-postalCode",value:i.postalCode,onChange:t=>j("postalCode",t.target.value),placeholder:"Postal code"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:n,disabled:l,children:"Save Changes"}),e.jsx(g,{variant:"outline",onClick:()=>{var t;N(!1),f(((t=s==null?void 0:s.personal_info)==null?void 0:t.address)||{street:"",area:"",city:"",postalCode:""})},children:"Cancel"})]})]}):e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Street:"})," ",i.street||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Area:"})," ",i.area||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"City:"})," ",i.city||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Postal Code:"})," ",i.postalCode||"Not provided"]})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>N(!0),children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Edit Address"]})})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsx("p",{children:"Please confirm that the address above is correct. This address will be used for verification purposes and should match your proof of address document."})}),c?e.jsxs("div",{className:"flex items-center justify-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(y,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700",children:"Address confirmed successfully!"})]}):e.jsxs(g,{onClick:v,className:"w-full",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Confirm Address"]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:a,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:x,disabled:l||!c,children:[e.jsx("span",{children:"Continue to Review"}),e.jsx(D,{className:"h-4 w-4 ml-2"})]})]})]})},Je=({onNext:r,onPrevious:a})=>{var N,i,f;const{verificationData:s,submitForReview:o,isLoading:d}=F(),[l,c]=m.useState(!1),u=async()=>{try{c(!0),await o(),h.success("Verification submitted for review!"),r()}catch(n){console.error("Failed to submit verification:",n),h.error("Failed to submit verification")}finally{c(!1)}},b=[{title:"Personal Information",completed:!!((N=s==null?void 0:s.personal_info)!=null&&N.fullName),details:String(((i=s==null?void 0:s.personal_info)==null?void 0:i.fullName)||"Not completed")},{title:"Document Upload",completed:!0,details:"All required documents uploaded"},{title:"Selfie Verification",completed:!0,details:"Selfie photo captured"},{title:"Phone Verification",completed:!0,details:String(((f=s==null?void 0:s.personal_info)==null?void 0:f.phoneNumber)||"Phone verified")},{title:"Address Confirmation",completed:!0,details:"Address confirmed"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Review & Submit"}),e.jsx("p",{className:"text-muted-foreground",children:"Review your information before submitting for verification"})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsx(T,{children:"Verification Summary"})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-4",children:b.map((n,j)=>e.jsx("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:`h-5 w-5 ${n.completed?"text-green-500":"text-gray-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.details})]})]})},j))})})]}),e.jsx(C,{children:e.jsx(S,{className:"pt-6",children:e.jsxs("div",{className:"text-sm text-muted-foreground space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"What happens next?"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Your verification will be reviewed by our team"}),e.jsx("li",{children:"You'll receive email updates on the status"}),e.jsx("li",{children:"Processing typically takes 1-3 business days"}),e.jsx("li",{children:"You can check progress anytime in your profile"})]})]})})}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(g,{variant:"outline",onClick:a,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(g,{onClick:u,disabled:d||l,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:l?"Submitting...":"Submit for Review"})]})]})]})},Ke=({title:r,description:a,icon:s,status:o,estimatedTime:d})=>{const l=()=>{switch(o){case"completed":return"text-green-600";case"in_progress":return"text-blue-600";default:return"text-gray-400"}},c=()=>{switch(o){case"completed":return e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"Complete"]});case"in_progress":return e.jsxs(U,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),"Processing"]});default:return e.jsx(U,{variant:"outline",children:"Pending"})}};return e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${o==="completed"?"bg-green-100":o==="in_progress"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx("div",{className:l(),children:s})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium",children:r}),c()]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a}),o==="in_progress"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm text-blue-600",children:"Processing..."})]}),d&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Estimated time: ",d]})]})]})]})},Ze=({onNext:r})=>{const{user:a}=J(),{verificationData:s,refreshData:o}=F(),[d,l]=m.useState(25),[c,u]=m.useState(0),[b,N]=m.useState(!1),i=[{title:"Document Review",description:"Our team is reviewing your uploaded documents for authenticity and completeness",icon:e.jsx(Be,{className:"h-5 w-5"}),estimatedTime:"2-4 hours"},{title:"Identity Verification",description:"Verifying your identity against official databases and cross-referencing documents",icon:e.jsx(Oe,{className:"h-5 w-5"}),estimatedTime:"4-8 hours"},{title:"Address Confirmation",description:"Confirming your residential address and proof of address documents",icon:e.jsx(re,{className:"h-5 w-5"}),estimatedTime:"1-2 hours"},{title:"Final Approval",description:"Final review and approval of your verification application",icon:e.jsx(H,{className:"h-5 w-5"}),estimatedTime:"30 minutes"}];m.useEffect(()=>{const p=setInterval(()=>{l(P=>{const L=Math.min(P+8,100);return L>=25&&c<1&&u(1),L>=50&&c<2&&u(2),L>=75&&c<3&&u(3),L})},2e3);return()=>clearInterval(p)},[c]),m.useEffect(()=>{if(d>=100){const p=setTimeout(()=>{console.log("[ProcessingStatusStep] Auto-advancing to completion step"),r()},3e3);return()=>clearTimeout(p)}},[d,r]),m.useEffect(()=>{const p=setInterval(()=>{o()},1e4);return()=>clearInterval(p)},[o]);const f=p=>p<c?"completed":p===c?"in_progress":"pending",n=()=>{const p=new Date,P=Math.max(1,Math.ceil((100-d)/10));return new Date(p.getTime()+P*60*60*1e3).toLocaleString("en-BW",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},j=(s==null?void 0:s.overall_status)==="completed",[v]=M.useState(Date.now()),[x,t]=M.useState(!1);return M.useEffect(()=>{const p=setInterval(()=>{Date.now()-v>36e5&&t(!0)},6e4);return()=>clearInterval(p)},[v]),M.useEffect(()=>{if(j){const p=setTimeout(()=>{console.log("[ProcessingStatusStep] Verification already complete, advancing"),r()},1e3);return()=>clearTimeout(p)}},[j,r]),j?e.jsxs("div",{className:"text-center p-8",children:[e.jsx(y,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-700 mb-2",children:"Verification Complete!"}),e.jsx("p",{className:"text-muted-foreground",children:"Redirecting to completion step..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Verification in Progress"}),e.jsx("p",{className:"text-muted-foreground",children:"Your verification is being processed by our team"})]}),x&&e.jsxs("div",{className:"p-4 bg-yellow-100 border border-yellow-300 rounded text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," Verification processing is taking longer than usual. If you have any concerns, please contact our support team with your reference number."]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Overall Progress"}),e.jsxs(U,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),"Processing"]})]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Verification Progress"}),e.jsxs("span",{children:[d,"%"]})]}),e.jsx(ae,{value:d,className:"h-3"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Estimated Completion"}),e.jsx("p",{className:"text-muted-foreground",children:n()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Reference Number"}),e.jsx("p",{className:"text-muted-foreground font-mono",children:s!=null&&s.user_id?`VER-${s.user_id.slice(-8).toUpperCase()}`:"Generating..."})]})]})]})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsx(T,{children:"Processing Stages"})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-4",children:i.map((p,P)=>e.jsx(Ke,{title:p.title,description:p.description,icon:p.icon,status:f(P),estimatedTime:f(P)==="in_progress"?p.estimatedTime:void 0},P))})})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5"}),e.jsx("span",{children:"Status Updates"})]})}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(y,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-700",children:"Verification Submitted"}),e.jsx("p",{className:"text-sm text-green-600",children:s!=null&&s.created_at?new Date(s.created_at).toLocaleString():"Just now"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(X,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-700",children:"Review in Progress"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Our verification team is currently reviewing your documents"})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(Y,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"What happens next?"})," You'll receive email notifications for any status updates. You can close this page and return anytime to check progress."]})]}),e.jsxs(Y,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"Need help?"})," If you have questions about your verification, contact our support team with your reference number."]})]})]}),!1]})},Qe=({verificationData:r})=>{const a=r!=null&&r.user_id?`VER-${r.user_id.slice(-8).toUpperCase()}`:"Unknown",s=r!=null&&r.completed_at?new Date(r.completed_at).toLocaleDateString():new Date().toLocaleDateString(),o=()=>{navigator.clipboard.writeText(a),h.success("Verification ID copied to clipboard")};return e.jsxs(C,{className:"border-green-200 bg-green-50",children:[e.jsxs(k,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"h-16 w-16 text-green-600 mx-auto"}),e.jsx(y,{className:"h-6 w-6 text-green-600 absolute -bottom-1 -right-1 bg-white rounded-full"})]})}),e.jsx(T,{className:"text-green-700",children:"Verification Complete!"})]}),e.jsx(S,{className:"space-y-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs(U,{variant:"secondary",className:"bg-green-100 text-green-700 mb-4",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"Verified User"]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Verification ID"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("code",{className:"text-green-600 font-mono",children:a}),e.jsx(g,{variant:"ghost",size:"icon",onClick:o,className:"h-6 w-6",children:e.jsx(ge,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Completion Date"}),e.jsx("p",{className:"text-green-600",children:s})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"User Role"}),e.jsx("p",{className:"text-green-600 capitalize",children:(r==null?void 0:r.user_role)||"Renter"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Status"}),e.jsx("p",{className:"text-green-600",children:"Active"})]})]})]})]})})]})},es=({userRole:r})=>{const a=K(),d=r==="host"?[{title:"Add Your First Car",description:"List your vehicle and start earning",icon:e.jsx(se,{className:"h-5 w-5 text-blue-500"}),action:()=>a("/add-car"),buttonText:"Add Car"},{title:"Set Up Hosting Profile",description:"Complete your hosting profile and preferences",icon:e.jsx(ee,{className:"h-5 w-5 text-purple-500"}),action:()=>a("/profile"),buttonText:"Setup Profile"},{title:"View Dashboard",description:"Monitor your bookings and earnings",icon:e.jsx(oe,{className:"h-5 w-5 text-orange-500"}),action:()=>a("/dashboard"),buttonText:"Open Dashboard"}]:[{title:"Browse Available Cars",description:"Explore cars available for rent in your area",icon:e.jsx(se,{className:"h-5 w-5 text-blue-500"}),action:()=>a("/"),buttonText:"Browse Cars"},{title:"Complete Your Profile",description:"Add a profile photo and additional details",icon:e.jsx(ee,{className:"h-5 w-5 text-purple-500"}),action:()=>a("/profile"),buttonText:"Edit Profile"},{title:"Make Your First Booking",description:"Find and book your first rental car",icon:e.jsx(Ue,{className:"h-5 w-5 text-green-500"}),action:()=>a("/"),buttonText:"Start Booking"}];return e.jsxs(C,{children:[e.jsx(k,{children:e.jsx(T,{children:"What's Next?"})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-4",children:d.map((l,c)=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:l.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium mb-1",children:l.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:l.description}),e.jsxs(g,{onClick:l.action,size:"sm",className:"flex items-center space-x-2",children:[e.jsx("span",{children:l.buttonText}),e.jsx(D,{className:"h-3 w-3"})]})]})]},c))})})]})},ss=()=>{const{verificationData:r}=F(),a=K();if(M.useEffect(()=>{De();const l=sessionStorage.getItem("verification_return_context");if(l)try{const c=JSON.parse(l);console.log("[CompletionStep] Found return context:",c),sessionStorage.removeItem("verification_return_context"),setTimeout(()=>{if(c.action==="booking"&&c.carData){const u=c.carData.id||c.carData.car_id;a(`/cars/${u}`),h.success("Verification complete! You can now book this car.")}else c.action==="listing"?(a("/add-car"),h.success("Verification complete! You can now list your vehicle.")):a("/")},3e3)}catch(c){console.error("[CompletionStep] Failed to parse return context:",c)}},[a]),!r)return e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No verification data found"})});const s=()=>{r.user_role==="host"?a("/dashboard"):a("/")},o=()=>{h.success("Certificate download started (Feature coming soon)")},d=r.user_role==="host"?"host":"renter";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"mx-auto mb-6",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"animate-bounce",children:e.jsx(y,{className:"h-20 w-20 text-green-500 mx-auto"})})})}),e.jsx("h1",{className:"text-3xl font-bold text-green-700 mb-2",children:"ðŸŽ‰ Verification Complete!"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Welcome to MobiRides! Your identity has been successfully verified."})]}),e.jsx(Qe,{verificationData:r}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"h-5 w-5 text-orange-500"}),e.jsx("span",{children:"Your Verification Benefits"})]})}),e.jsx(S,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Trusted Member Badge"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show other users you're verified"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Full Platform Access"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Book cars and access all features"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Priority Support"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get faster help when needed"})]})]}),r.user_role==="host"&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Host Privileges"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"List cars and start earning"})]})]})]})]})})]}),e.jsx(es,{userRole:d}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(Y,{children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"Email Confirmation:"})," A verification certificate has been sent to your email address. Keep this for your records."]})]}),e.jsxs(Y,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsxs(z,{children:[e.jsx("strong",{children:"Security Notice:"})," Your verification is valid indefinitely. Contact support if you need to update any verified information."]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[e.jsxs(g,{onClick:o,variant:"outline",className:"flex items-center space-x-2 flex-1",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{children:"Download Certificate"})]}),e.jsxs(g,{onClick:s,className:"flex items-center space-x-2 flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx("span",{children:r.user_role==="host"?"Go to Dashboard":"Start Using MobiRides"}),e.jsx(D,{className:"h-4 w-4"})]})]}),!1]})},G={[w.PERSONAL_INFO]:{title:"Personal Information",description:"Provide your basic details",icon:Z,component:Ye},[w.DOCUMENT_UPLOAD]:{title:"Document Upload",description:"Upload required documents",icon:ie,component:ze},[w.SELFIE_VERIFICATION]:{title:"Selfie Verification",description:"Take a verification selfie",icon:ne,component:qe},[w.PHONE_VERIFICATION]:{title:"Phone Verification",description:"Verify your phone number",icon:W,component:We},[w.ADDRESS_CONFIRMATION]:{title:"Address Confirmation",description:"Confirm your address",icon:le,component:Ge},[w.REVIEW_SUBMIT]:{title:"Review & Submit",description:"Review and submit verification",icon:y,component:Je},[w.PROCESSING_STATUS]:{title:"Processing",description:"Verification in progress",icon:X,component:Ze},[w.COMPLETION]:{title:"Completed",description:"Verification complete",icon:H,component:ss}},ts=({currentStep:r,stepStatuses:a,onStepClick:s,canNavigateToStep:o})=>{const d=Object.values(w);return e.jsx("div",{className:"w-full mb-8",children:e.jsx("div",{className:"flex items-center justify-between mb-4",children:d.map((l,c)=>{const u=G[l],b=u.icon,N=a[l],i=l===r,f=N===_.COMPLETED,n=o(l);let j="bg-gray-700",v="text-gray-300",x="",t="bg-white",p="text-gray-700";return f?(j="bg-green-500 hover:bg-green-600",v="text-white",t="bg-white",p="text-green-700"):i&&(j="bg-blue-600",v="text-white",x="ring-2 ring-blue-400 ring-offset-2",t="bg-white",p="text-blue-700"),e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(g,{variant:"outline",size:"icon",className:`
                    relative h-12 w-12 rounded-full mb-2
                    ${j} ${v} ${x}
                    ${!n&&!i&&!f?"opacity-50 cursor-not-allowed":""}
                  `,onClick:()=>n&&s(l),disabled:!n&&!i&&!f,children:[f?e.jsx(y,{className:"h-6 w-6 text-white"}):e.jsx(b,{className:`h-6 w-6 ${v}`}),e.jsx(U,{variant:"secondary",className:`absolute -top-2 -right-2 h-5 w-5 p-0 text-xs ${t} ${p}`,children:c+1})]}),e.jsxs("div",{className:"text-center max-w-[80px]",children:[e.jsx("p",{className:`text-xs font-medium ${i?"text-blue-600":f?"text-green-600":"text-gray-400"}`,children:u.title}),e.jsx("p",{className:"text-xs text-muted-foreground hidden sm:block",children:u.description})]})]}),c<d.length-1&&e.jsx("div",{className:`
                  flex-1 h-0.5 mx-2 mb-8
                  ${f?"bg-green-500":i?"bg-blue-600":"bg-gray-700"}
                `})]},l)})})})},rs=()=>{const{user:r}=J(),a=K(),{verificationData:s,isLoading:o,error:d,isInitialized:l,initializeVerification:c,navigateToStep:u,canNavigateToStep:b,getStepProgress:N,resetVerification:i}=F(),[f,n]=m.useState(!1),[j,v]=m.useState(!1);m.useEffect(()=>{if(!(r!=null&&r.id)){console.log("[VerificationHub] No user ID available");return}if(l||o||s)return;(async()=>{var R;try{const O=((R=r.user_metadata)==null?void 0:R.role)||"renter";console.log("[VerificationHub] Initializing verification for user:",r.id,"Role:",O),await c(r.id,O)}catch(O){console.error("[VerificationHub] Failed to initialize verification:",O),h.error("Failed to initialize verification process")}})()},[r==null?void 0:r.id,l,o,s]),M.useEffect(()=>{s&&s.overall_status==="completed"&&s.current_step!=="completion"&&u(w.COMPLETION)},[s==null?void 0:s.overall_status,s==null?void 0:s.current_step,u]);const x=V=>{if(!b(V)){h.error("Please complete the previous steps first");return}u(V)},t=()=>{if(!s)return;const V=Object.values(w),R=V.indexOf(s.current_step);if(R<V.length-1){const O=V[R+1];x(O)}},p=()=>{if(!s)return;const V=Object.values(w),R=V.indexOf(s.current_step);if(R>0){const O=V[R-1];u(O)}},P=()=>{h.info("Verification canceled. You can resume anytime from your profile."),a("/")},L=()=>{a("/")},de=()=>{if(!s)return null;const V=G[s.current_step].component;return e.jsx(V,{onNext:t,onPrevious:p})};if(d)return e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",style:{backgroundColor:"#020817"},children:e.jsxs(C,{className:"w-full max-w-md",children:[e.jsxs(k,{className:"text-center",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx(T,{className:"text-red-600",children:"Verification Error"})]}),e.jsxs(S,{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:d}),e.jsx(g,{onClick:()=>window.location.reload(),children:"Try Again"})]})]})});if(o||!s)return e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",style:{backgroundColor:"#020817"},children:e.jsx(C,{className:"w-full max-w-md",children:e.jsxs(S,{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Initializing verification..."})]})})});const $=N(),q=G[s==null?void 0:s.current_step];return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#020817"},children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6 p-4 bg-white/10 rounded-lg border border-white/20",children:[e.jsxs(g,{variant:"outline",onClick:L,className:"flex items-center gap-2 bg-white/90 hover:bg-white text-gray-900",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to Home"}),e.jsx("span",{className:"sm:hidden",children:"Home"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white/80 text-sm",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Secure verification process"}),e.jsx("span",{className:"sm:hidden",children:"Secure process"})]}),e.jsxs(Ce,{open:j,onOpenChange:v,children:[e.jsx(Se,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:"flex items-center gap-2 bg-white/90 hover:bg-white text-gray-900 border-red-200 hover:border-red-300",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Cancel Verification"}),e.jsx("span",{className:"sm:hidden",children:"Cancel"})]})}),e.jsxs(Pe,{children:[e.jsxs(ke,{children:[e.jsx(Te,{children:"Cancel Verification?"}),e.jsx(Ee,{children:"Are you sure you want to cancel the verification process? Your progress will be saved and you can resume later from your profile."})]}),e.jsxs(Ae,{children:[e.jsx(_e,{children:"Continue Verification"}),e.jsx(Ve,{onClick:P,children:"Yes, Cancel"})]})]})]})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Identity Verification"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"Complete your verification to start using MobiRides"}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[$.completed," of ",$.total," steps"]})]}),e.jsx(ae,{value:$.percentage,className:"h-2"})]})]}),e.jsx(ts,{currentStep:s==null?void 0:s.current_step,stepStatuses:{[w.PERSONAL_INFO]:s!=null&&s.personal_info_completed?_.COMPLETED:_.NOT_STARTED,[w.DOCUMENT_UPLOAD]:s!=null&&s.documents_completed?_.COMPLETED:_.NOT_STARTED,[w.SELFIE_VERIFICATION]:s!=null&&s.selfie_completed?_.COMPLETED:_.NOT_STARTED,[w.PHONE_VERIFICATION]:s!=null&&s.phone_verified?_.COMPLETED:_.NOT_STARTED,[w.ADDRESS_CONFIRMATION]:s!=null&&s.address_confirmed?_.COMPLETED:_.NOT_STARTED,[w.REVIEW_SUBMIT]:_.NOT_STARTED,[w.PROCESSING_STATUS]:_.NOT_STARTED,[w.COMPLETION]:_.NOT_STARTED},onStepClick:x,canNavigateToStep:b}),e.jsxs(C,{className:"mb-8",children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q.icon,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{children:[e.jsx(T,{children:q.title}),e.jsx("p",{className:"text-muted-foreground",children:q.description})]})]})}),e.jsx(S,{children:de()})]}),!1]})})};class as extends m.Component{constructor(){super(...arguments);Q(this,"state",{hasError:!1})}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,o){console.error("Verification error boundary caught an error:",s,o)}render(){var s;return this.state.hasError?e.jsx("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:e.jsxs(C,{className:"border-destructive",children:[e.jsxs(k,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(be,{className:"h-12 w-12 text-destructive"})}),e.jsx(T,{className:"text-destructive",children:"Verification Error"}),e.jsx(ye,{children:"Something went wrong during the verification process. This has been logged and our team will investigate."})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsx("p",{className:"text-sm font-mono text-muted-foreground",children:((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred"})}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(g,{onClick:()=>this.setState({hasError:!1}),variant:"outline",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsx(g,{onClick:()=>window.location.href="/dashboard",variant:"default",children:"Return to Dashboard"})]})]})]})}):this.props.children}}const Fs=()=>e.jsx(as,{children:e.jsx(ve,{children:e.jsx(rs,{})})});export{Fs as default};
