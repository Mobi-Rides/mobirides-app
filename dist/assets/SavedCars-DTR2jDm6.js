import{u as x,r as u,j as e,B as f,s as l,J as g}from"./index-BAM2AQzj.js";import{a as v}from"./useQuery-BBHzqejZ.js";import{L as h,C as j}from"./CarGrid-CBVDP3JY.js";import{N as y}from"./Navigation-DcFnTla_.js";import{A as N}from"./arrow-left-ZSxCSMqd.js";import"./card-C82ETfr4.js";import"./savedCarService-tYJGOOrr.js";import"./calendar-D1EmOoAD.js";import"./format-BOBWS5Wu.js";import"./addDays-Di48Ycau.js";import"./chevron-right-DpKt2Wag.js";import"./alert-7WYzCt2j.js";import"./useVerificationStatus-B0uRCjL0.js";import"./VerificationRequiredDialog-s2VCs-lA.js";import"./badge-La64XLSg.js";import"./shield-CL09y3a_.js";import"./file-text-CCBm04K0.js";import"./camera-DYAoZQND.js";import"./circle-check-big-CU0Wzt6B.js";import"./arrow-right-CC1csBZ0.js";import"./scroll-area-C8WYL-tw.js";import"./CustomMapbox-DZ6yZBZD.js";import"./OnlineStatusToggle-D0TJLYj4.js";import"./send-CyKCJr7A.js";import"./handoverService-DSRl_wMq.js";import"./skeleton-nH5YszIf.js";import"./circle-alert-CkQrh4MB.js";import"./map-pin-CoQHT-KY.js";import"./separator-BlDr0iOF.js";import"./users-Bgk7JC4M.js";const Z=()=>{const d=x(),m=u.useRef(null),{data:t=[],isLoading:i,error:n}=v({queryKey:["saved-cars-full"],queryFn:async()=>{console.log("Fetching saved cars...");const{data:{session:s}}=await l.auth.getSession();if(!s)return console.log("No active session found when fetching saved cars"),[];console.log("Using user ID for saved cars:",s.user.id);const{data:r,error:a}=await l.from("saved_cars").select(`
          car_id,
          cars:car_id(*)
        `).eq("user_id",s.user.id);if(a)throw console.error("Error fetching saved cars:",a),g.error("Could not load your saved cars. Please try again."),a;if(console.log("Raw saved cars data:",r),!Array.isArray(r)||r.length===0)return console.log("No saved cars found for user"),[];const c=r.filter(o=>o.cars).map(o=>({...o.cars,isSaved:!0}));return console.log("Processed cars:",c),c}}),p=()=>{console.log("Load more triggered in SavedCars")};return e.jsxs("div",{className:"min-h-screen px-4 pb-20",children:[e.jsxs("div",{className:"px-4 py-4 mb-4 flex items-center gap-4",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>d(-1),children:e.jsx(N,{className:"h-4 w-4"})}),e.jsx("h1",{className:"text-xl md:text-2xl text-left font-semibold",children:"Profile"})]}),e.jsx("main",{className:"px-4 py-6",children:i?e.jsx(h,{}):n?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("p",{className:"text-base text-muted-foreground mb-4",children:"Unable to load saved cars"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"text-sm text-primary hover:underline",children:"Try again"})]}):t.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:e.jsx("p",{className:"text-base text-muted-foreground",children:"No saved cars yet"})}):e.jsx(j,{cars:t,isLoading:i,error:n,loadMoreRef:m,onLoadMore:p,isFetchingNextPage:!1,isAuthenticated:!0})}),e.jsx(y,{})]})};export{Z as default};
