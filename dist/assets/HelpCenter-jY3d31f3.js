import{u as p,j as e}from"./query-vendor-C7aRRP05.js";import{s as u,B as c,y as H,ao as $,I as q,U as d,v as B}from"./index-D9LOOiBY.js";import{C as j,b as F,c as R,d as P,a as f}from"./card-0dd-x2VS.js";import{u as Q,k as G,r as N}from"./react-vendor-mnpoGfEl.js";import{S as y}from"./star-BwZJAYBL.js";import{L as v}from"./loader-circle-Dj97fR4z.js";import{B as m}from"./book-open-D8-_fC14.js";import{C as b}from"./car-DvspwSJC.js";import{C as M}from"./clock-CFBaLxjz.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./date-vendor-Dhms5dOu.js";const I=a=>p({queryKey:["guides",a],queryFn:async()=>{const{data:r,error:t}=await u.from("guides").select("id, title, description, section, read_time, is_popular, sort_order").eq("role",a).order("sort_order",{ascending:!0});if(t)throw console.error("Error fetching guides:",t),t;return r||[]},staleTime:5*60*1e3,gcTime:10*60*1e3}),K=()=>p({queryKey:["guides","popular"],queryFn:async()=>{const{data:a,error:r}=await u.from("guides").select("id, title, description, section, read_time, is_popular, sort_order").eq("is_popular",!0).order("sort_order",{ascending:!0}).limit(4);if(r)throw console.error("Error fetching popular guides:",r),r;return a||[]},staleTime:5*60*1e3,gcTime:10*60*1e3}),z=(a,r)=>p({queryKey:["guides","search",a,r],queryFn:async()=>{let t=u.from("guides").select("id, title, description, section, read_time, is_popular, sort_order");r&&(t=t.eq("role",r)),a.trim()&&(t=t.or(`title.ilike.%${a}%,description.ilike.%${a}%`));const{data:o,error:i}=await t.order("sort_order",{ascending:!0});if(i)throw console.error("Error searching guides:",i),i;return o||[]},enabled:a.length>0,staleTime:2*60*1e3}),ae=()=>{const a=Q(),{role:r}=G(),[t,o]=N.useState(""),i=r==="host",h=r==="renter",{data:n,isLoading:C,error:w}=I(r),{data:l,isLoading:k}=K(),{data:_,isLoading:S}=z(t,r),x=s=>({"getting-started":y,verification:d,booking:b,"pickup-return":M,"car-listing":b,bookings:m,earnings:d})[s]||m,L=N.useMemo(()=>n?n.map(s=>({id:s.section,title:s.title,description:s.description,icon:x(s.section),articles:1,readTime:s.read_time,popular:s.is_popular})):[],[n]),T=h?"Renter Help Center":i?"Host Help Center":"Help Center",E=h?"Everything you need to know about renting cars on MobiRides":i?"Complete guide to hosting and managing your car listings":"Find answers to your questions",g=t.trim()?(_||[]).map(s=>({id:s.section,title:s.title,description:s.description,icon:x(s.section),articles:1,readTime:s.read_time,popular:s.is_popular})):L;return e.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[e.jsx("header",{className:"bg-card p-4 sticky top-0 z-10 shadow-sm border-b",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>a("/profile"),className:"p-2",children:e.jsx(H,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold",children:T}),e.jsx("p",{className:"text-sm text-muted-foreground",children:E})]})]})}),e.jsxs("main",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(q,{placeholder:"Search help articles...",value:t,onChange:s=>o(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(c,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",onClick:()=>a(`/help/${r}/getting-started`),children:[e.jsx(y,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Quick Start"})]}),e.jsxs(c,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",onClick:()=>a("/profile"),children:[e.jsx(d,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Contact Support"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:t.trim()?"Search Results":"Browse by Category"}),C||S?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(v,{className:"h-6 w-6 animate-spin"})}):w?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Failed to load help content. Please try again."}):g.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:t.trim()?"No results found.":"No help sections available."}):e.jsx("div",{className:"grid gap-4",children:g.map(s=>e.jsxs(j,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>a(`/help/${r}/${s.id}`),children:[e.jsx(F,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(s.icon,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"text-base",children:s.title}),s.popular&&e.jsx(B,{variant:"secondary",className:"text-xs",children:"Popular"})]}),e.jsx(P,{className:"text-sm",children:s.description})]})]})})}),e.jsx(f,{className:"pt-0",children:e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:[s.articles," articles"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[s.readTime," read"]})]})})]},s.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Popular Articles"}),k?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(v,{className:"h-4 w-4 animate-spin"})}):e.jsxs("div",{className:"space-y-3",children:[(l||[]).map(s=>e.jsx(j,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>a(`/help/${r}/${s.section}`),children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-medium",children:s.title})]})})},s.id)),(!l||l.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No popular articles available."})]})]})]})]})};export{ae as default};
