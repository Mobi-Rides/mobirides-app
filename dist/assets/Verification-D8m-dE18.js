import{c as ve,r as p,o as Mt,j as e,J as j,V as Lt,aO as ns,f as pa,O as fa,Z as _t,aP as xa,C as ga,$ as mt,as as ya,T as va,D as ja,d as is,P as Na,R as ba,b as he,ag as os,u as wt,U as Ye,L as H,I as ee,t as Fe,aq as Ft,B as O,ar as Oe,X as Zt,aC as ht,_ as Ut,a0 as _a,ae as wa,af as Ca,aQ as cs,aw as Sa,a8 as ka,aR as Ta,aS as Ea}from"./index-BAM2AQzj.js";import{V as Q,a as G,t as Et,b as re,D as Pe,B as Xt}from"./useVerificationStatus-B0uRCjL0.js";import{C as Z,a as $,b as z,d as U}from"./card-C82ETfr4.js";import{P as pt}from"./progress-DBm_9X_r.js";import{B as X}from"./badge-La64XLSg.js";import{g as Dt,s as St,b as Da,u as Ra}from"./index.esm-oWjCzTq2.js";import{A as q,a as J}from"./alert-7WYzCt2j.js";import{C as I}from"./circle-alert-CkQrh4MB.js";import{C as ls}from"./calendar-m5gla_Sa.js";import{C as ds}from"./credit-card-C7ZeWo_M.js";import{C as F}from"./circle-check-big-CU0Wzt6B.js";import{M as He}from"./map-pin-CoQHT-KY.js";import{U as Rt}from"./users-Bgk7JC4M.js";import{A as xe}from"./arrow-left-ZSxCSMqd.js";import{A as ge}from"./arrow-right-CC1csBZ0.js";import{F as oe}from"./file-text-CCBm04K0.js";import{U as us}from"./upload-By4W3N6G.js";import{C as ft}from"./camera-DYAoZQND.js";import{M as Yt}from"./message-circle-BHBqJZi2.js";import{R as Aa}from"./refresh-cw-BBM-5y6n.js";import{C as qe}from"./clock-DcRTzakL.js";import{C as Ht}from"./checkbox-FalUXy2g.js";import{S as ze}from"./shield-CL09y3a_.js";import{S as Ia}from"./send-CyKCJr7A.js";import{S as ms}from"./star-gaaEOnOW.js";import{C as qt}from"./car-BcLi7tRD.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=ve("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=ve("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=ve("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=ve("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=ve("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=ve("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=ve("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=ve("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=ve("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),hs=p.createContext(void 0),ps={verificationData:null,isLoading:!1,error:null,isInitialized:!1};function za(a,t){switch(t.type){case"INITIALIZE_VERIFICATION":return{...a,isLoading:!0,error:null};case"LOAD_VERIFICATION_DATA":return{...a,verificationData:t.payload,isLoading:!1,isInitialized:!0,error:null};case"UPDATE_CURRENT_STEP":return a.verificationData?{...a,verificationData:{...a.verificationData,currentStep:t.payload}}:a;case"UPDATE_PERSONAL_INFO":return a.verificationData?{...a,verificationData:{...a.verificationData,personalInfo:{...a.verificationData.personalInfo,...t.payload}}}:a;case"UPDATE_DOCUMENT":{if(!a.verificationData)return a;const s=a.verificationData.documents.findIndex(n=>n.type===t.payload.type);let r;return s>=0?(r=[...a.verificationData.documents],r[s]=t.payload):r=[...a.verificationData.documents,t.payload],{...a,verificationData:{...a.verificationData,documents:r}}}case"UPDATE_PHONE_VERIFICATION":return a.verificationData?{...a,verificationData:{...a.verificationData,phoneVerification:{...a.verificationData.phoneVerification,...t.payload}}}:a;case"UPDATE_ADDRESS_CONFIRMATION":return a.verificationData?{...a,verificationData:{...a.verificationData,addressConfirmation:{...a.verificationData.addressConfirmation,...t.payload}}}:a;case"SET_LOADING":return{...a,isLoading:t.payload};case"SET_ERROR":return{...a,error:t.payload,isLoading:!1};case"RESET_VERIFICATION":return{...ps};default:return a}}function Ba({children:a}){const[t,s]=p.useReducer(za,ps),{user:r}=Mt();p.useEffect(()=>{let m=!0;return(async()=>{var x;if(!(r!=null&&r.id)){console.log("[VerificationContext] No user ID available, user:",r),m&&s({type:"SET_LOADING",payload:!1});return}if(((x=t.verificationData)==null?void 0:x.userId)===r.id&&t.isInitialized){console.log("[VerificationContext] Data already loaded for user:",r.id);return}try{m&&s({type:"SET_LOADING",payload:!0}),console.log("[VerificationContext] Starting to load verification data for user:",r.id,"User object:",r);const C=new Promise((L,Y)=>setTimeout(()=>Y(new Error("Verification data loading timeout")),1e4)),S=Q.loadVerificationData(r.id),M=await Promise.race([S,C]);m&&M?(s({type:"LOAD_VERIFICATION_DATA",payload:M}),console.log("[VerificationContext] Loaded existing verification data"),M.overallStatus===G.COMPLETED&&Et()):m&&(s({type:"SET_LOADING",payload:!1}),console.log("[VerificationContext] No existing verification data found"))}catch(C){m&&(console.error("[VerificationContext] Failed to load verification data:",C),s({type:"SET_ERROR",payload:C instanceof Error?C.message:"Failed to load verification data"}),s({type:"SET_LOADING",payload:!1}))}})(),()=>{m=!1}},[r==null?void 0:r.id,t.isInitialized]);const n=async(m,b)=>{try{s({type:"INITIALIZE_VERIFICATION",payload:{userId:m,userRole:b}});const x=await Q.initializeVerification(m,b);s({type:"LOAD_VERIFICATION_DATA",payload:x}),j.success("Verification process started"),console.log("[VerificationContext] Verification initialized for user:",m)}catch(x){console.error("[VerificationContext] Failed to initialize verification:",x),s({type:"SET_ERROR",payload:"Failed to initialize verification"}),j.error("Failed to start verification process")}},i=async m=>{if(!(r!=null&&r.id)){j.error("User not authenticated");return}try{s({type:"SET_LOADING",payload:!0}),s({type:"UPDATE_PERSONAL_INFO",payload:m}),await Q.updatePersonalInfo(r.id,m);const b=await Q.loadVerificationData(r.id);b&&s({type:"LOAD_VERIFICATION_DATA",payload:b}),j.success("Personal information saved"),console.log("[VerificationContext] Personal info updated:",m)}catch(b){console.error("[VerificationContext] Failed to update personal info:",b),s({type:"SET_ERROR",payload:"Failed to save personal information"}),j.error("Failed to save personal information")}finally{s({type:"SET_LOADING",payload:!1})}},o=async m=>{if(!(r!=null&&r.id)){console.error("[VerificationContext] User not authenticated, user:",r),j.error("User not authenticated");return}try{s({type:"SET_LOADING",payload:!0}),console.log("[VerificationContext] Updating document for user:",r.id,"Document type:",m.type),s({type:"UPDATE_DOCUMENT",payload:{...m,status:"completed"}}),await Q.updateDocument(r.id,m);const b=await Q.loadVerificationData(r.id);b&&s({type:"LOAD_VERIFICATION_DATA",payload:b});const x=m.type.replace(/_/g," ").replace(/\b\w/g,C=>C.toUpperCase());j.success(`${x} uploaded successfully`),console.log("[VerificationContext] Document updated:",m.type)}catch(b){console.error("[VerificationContext] Failed to update document:",b instanceof Error?b.message:JSON.stringify(b,null,2)),s({type:"SET_ERROR",payload:"Failed to save document"}),j.error("Failed to upload document")}finally{s({type:"SET_LOADING",payload:!1})}},c=async m=>{if(!(r!=null&&r.id)){j.error("User not authenticated");return}console.log("[VerificationContext] Starting phone verification update:",m);try{s({type:"SET_LOADING",payload:!0}),s({type:"UPDATE_PHONE_VERIFICATION",payload:m}),console.log("[VerificationContext] Calling VerificationService.updatePhoneVerification"),await Q.updatePhoneVerification(r.id,m),console.log("[VerificationContext] VerificationService call completed"),console.log("[VerificationContext] Reloading verification data");const b=await Q.loadVerificationData(r.id);b&&(s({type:"LOAD_VERIFICATION_DATA",payload:b}),console.log("[VerificationContext] Verification data reloaded successfully")),m.isVerified&&j.success("Phone number verified successfully"),console.log("[VerificationContext] Phone verification updated successfully:",m)}catch(b){console.error("[VerificationContext] Failed to update phone verification:",b),s({type:"SET_ERROR",payload:b instanceof Error?b.message:"Failed to update phone verification"}),j.error("Failed to update phone verification")}finally{console.log("[VerificationContext] Setting loading to false"),s({type:"SET_LOADING",payload:!1})}},u=async m=>{if(!(r!=null&&r.id)){j.error("User not authenticated");return}try{s({type:"SET_LOADING",payload:!0}),s({type:"UPDATE_ADDRESS_CONFIRMATION",payload:m}),await Q.updateAddressConfirmation(r.id,m);const b=await Q.loadVerificationData(r.id);b&&s({type:"LOAD_VERIFICATION_DATA",payload:b}),m.isConfirmed&&j.success("Address confirmed successfully"),console.log("[VerificationContext] Address confirmation updated:",m)}catch(b){console.error("[VerificationContext] Failed to update address confirmation:",b),s({type:"SET_ERROR",payload:"Failed to update address confirmation"}),j.error("Failed to update address confirmation")}finally{s({type:"SET_LOADING",payload:!1})}},d=async()=>{if(!(r!=null&&r.id)){j.error("User not authenticated");return}try{s({type:"SET_LOADING",payload:!0}),await Q.completeSelfieVerification(r.id);const m=await Q.loadVerificationData(r.id);m&&s({type:"LOAD_VERIFICATION_DATA",payload:m}),j.success("Selfie verification completed"),console.log("[VerificationContext] Selfie verification completed")}catch(m){console.error("[VerificationContext] Failed to complete selfie verification:",m),s({type:"SET_ERROR",payload:"Failed to complete selfie verification"}),j.error("Failed to complete selfie verification")}finally{s({type:"SET_LOADING",payload:!1})}},l=async()=>{if(!(r!=null&&r.id)){j.error("User not authenticated");return}try{s({type:"SET_LOADING",payload:!0}),await Q.submitForReview(r.id);const m=await Q.loadVerificationData(r.id);m&&(s({type:"LOAD_VERIFICATION_DATA",payload:m}),m.overallStatus===G.COMPLETED&&Et()),j.success("Verification submitted for review"),console.log("[VerificationContext] Verification submitted for review")}catch(m){console.error("[VerificationContext] Failed to submit verification:",m),console.error("[VerificationContext] Error details:",{message:m instanceof Error?m.message:String(m),stack:m instanceof Error?m.stack:void 0,type:typeof m,error:m});const b=m instanceof Error?m.message:"Failed to submit verification";s({type:"SET_ERROR",payload:b}),j.error(`Failed to submit verification: ${b}`)}finally{s({type:"SET_LOADING",payload:!1})}},h=m=>{if(!R(m)){j.error("Please complete previous steps first");return}s({type:"UPDATE_CURRENT_STEP",payload:m}),console.log("[VerificationContext] Navigated to step:",m)},R=m=>{if(!t.verificationData)return!1;const b=Object.values(re),x=b.indexOf(t.verificationData.currentStep),C=b.indexOf(m);if(C<=x)return!0;for(let S=0;S<C;S++)if(t.verificationData.stepStatuses[b[S]]!==G.COMPLETED)return!1;return!0},w={...t,initializeVerification:n,updatePersonalInfo:i,updateDocument:o,updatePhoneVerification:c,updateAddressConfirmation:u,completeSelfieVerification:d,submitForReview:l,navigateToStep:h,canNavigateToStep:R,getStepProgress:()=>{if(!t.verificationData)return{completed:0,total:8,percentage:0};const m=Object.values(re),b=m.filter(x=>t.verificationData.stepStatuses[x]===G.COMPLETED);return{completed:b.length,total:m.length,percentage:b.length/m.length*100}},resetVerification:()=>{try{s({type:"RESET_VERIFICATION"}),j.success("Verification data reset"),console.log("[VerificationContext] Verification data reset")}catch(m){console.error("[VerificationContext] Failed to reset verification:",m),j.error("Failed to reset verification data")}},refreshData:async()=>{if(r!=null&&r.id)try{const m=await Q.loadVerificationData(r.id);m&&(s({type:"LOAD_VERIFICATION_DATA",payload:m}),console.log("[VerificationContext] Data refreshed"))}catch(m){console.error("[VerificationContext] Failed to refresh data:",m instanceof Error?m.message:JSON.stringify(m,null,2)),s({type:"SET_ERROR",payload:"Failed to refresh data"})}}};return e.jsx(hs.Provider,{value:w,children:a})}function pe(){const a=p.useContext(hs);if(a===void 0)throw new Error("useVerification must be used within a VerificationProvider");return a}var fs="AlertDialog",[Ga,fi]=Lt(fs,[ns]),je=ns(),xs=a=>{const{__scopeAlertDialog:t,...s}=a,r=je(t);return e.jsx(ba,{...r,...s,modal:!0})};xs.displayName=fs;var Wa="AlertDialogTrigger",gs=p.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=je(s);return e.jsx(pa,{...n,...r,ref:t})});gs.displayName=Wa;var Xa="AlertDialogPortal",ys=a=>{const{__scopeAlertDialog:t,...s}=a,r=je(t);return e.jsx(Na,{...r,...s})};ys.displayName=Xa;var Ya="AlertDialogOverlay",vs=p.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=je(s);return e.jsx(fa,{...n,...r,ref:t})});vs.displayName=Ya;var Me="AlertDialogContent",[Ha,qa]=Ga(Me),js=p.forwardRef((a,t)=>{const{__scopeAlertDialog:s,children:r,...n}=a,i=je(s),o=p.useRef(null),c=_t(t,o),u=p.useRef(null);return e.jsx(xa,{contentName:Me,titleName:Ns,docsSlug:"alert-dialog",children:e.jsx(Ha,{scope:s,cancelRef:u,children:e.jsxs(ga,{role:"alertdialog",...i,...n,ref:c,onOpenAutoFocus:mt(n.onOpenAutoFocus,d=>{var l;d.preventDefault(),(l=u.current)==null||l.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[e.jsx(ya,{children:r}),e.jsx(Ka,{contentRef:o})]})})})});js.displayName=Me;var Ns="AlertDialogTitle",bs=p.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=je(s);return e.jsx(va,{...n,...r,ref:t})});bs.displayName=Ns;var _s="AlertDialogDescription",ws=p.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=je(s);return e.jsx(ja,{...n,...r,ref:t})});ws.displayName=_s;var Ja="AlertDialogAction",Cs=p.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=je(s);return e.jsx(is,{...n,...r,ref:t})});Cs.displayName=Ja;var Ss="AlertDialogCancel",ks=p.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,{cancelRef:n}=qa(Ss,s),i=je(s),o=_t(t,n);return e.jsx(is,{...i,...r,ref:o})});ks.displayName=Ss;var Ka=({contentRef:a})=>{const t=`\`${Me}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Me}\` by passing a \`${_s}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Me}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=a.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,a]),null},Qa=xs,er=gs,tr=ys,Ts=vs,Es=js,Ds=Cs,Rs=ks,As=bs,Is=ws;const sr=Qa,ar=er,rr=tr,Os=p.forwardRef(({className:a,...t},s)=>e.jsx(Ts,{className:he("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t,ref:s}));Os.displayName=Ts.displayName;const Ps=p.forwardRef(({className:a,...t},s)=>e.jsxs(rr,{children:[e.jsx(Os,{}),e.jsx(Es,{ref:s,className:he("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...t})]}));Ps.displayName=Es.displayName;const Vs=({className:a,...t})=>e.jsx("div",{className:he("flex flex-col space-y-2 text-center sm:text-left",a),...t});Vs.displayName="AlertDialogHeader";const Ms=({className:a,...t})=>e.jsx("div",{className:he("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});Ms.displayName="AlertDialogFooter";const Ls=p.forwardRef(({className:a,...t},s)=>e.jsx(As,{ref:s,className:he("text-lg font-semibold",a),...t}));Ls.displayName=As.displayName;const Fs=p.forwardRef(({className:a,...t},s)=>e.jsx(Is,{ref:s,className:he("text-sm text-muted-foreground",a),...t}));Fs.displayName=Is.displayName;const Zs=p.forwardRef(({className:a,...t},s)=>e.jsx(Ds,{ref:s,className:he(os(),a),...t}));Zs.displayName=Ds.displayName;const Us=p.forwardRef(({className:a,...t},s)=>e.jsx(Rs,{ref:s,className:he(os({variant:"outline"}),"mt-2 sm:mt-0",a),...t}));Us.displayName=Rs.displayName;const Jt=(a,t,s)=>{if(a&&"reportValidity"in a){const r=Dt(s,t);a.setCustomValidity(r&&r.message||""),a.reportValidity()}},$s=(a,t)=>{for(const s in t.fields){const r=t.fields[s];r&&r.ref&&"reportValidity"in r.ref?Jt(r.ref,s,a):r.refs&&r.refs.forEach(n=>Jt(n,s,a))}},nr=(a,t)=>{t.shouldUseNativeValidation&&$s(a,t);const s={};for(const r in a){const n=Dt(t.fields,r),i=Object.assign(a[r]||{},{ref:n&&n.ref});if(ir(t.names||Object.keys(a),r)){const o=Object.assign({},Dt(s,r));St(o,"root",i),St(s,r,o)}else St(s,r,i)}return s},ir=(a,t)=>a.some(s=>s.startsWith(t+"."));var or=function(a,t){for(var s={};a.length;){var r=a[0],n=r.code,i=r.message,o=r.path.join(".");if(!s[o])if("unionErrors"in r){var c=r.unionErrors[0].errors[0];s[o]={message:c.message,type:c.code}}else s[o]={message:i,type:n};if("unionErrors"in r&&r.unionErrors.forEach(function(l){return l.errors.forEach(function(h){return a.push(h)})}),t){var u=s[o].types,d=u&&u[r.code];s[o]=Da(o,t,s,n,d?[].concat(d,r.message):r.message)}a.shift()}return s},cr=function(a,t,s){return s===void 0&&(s={}),function(r,n,i){try{return Promise.resolve(function(o,c){try{var u=Promise.resolve(a[s.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(d){return i.shouldUseNativeValidation&&$s({},i),{errors:{},values:s.raw?r:d}})}catch(d){return c(d)}return u&&u.then?u.then(void 0,c):u}(0,function(o){if(function(c){return Array.isArray(c==null?void 0:c.errors)}(o))return{values:{},errors:nr(or(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}},V;(function(a){a.assertEqual=n=>n;function t(n){}a.assertIs=t;function s(n){throw new Error}a.assertNever=s,a.arrayToEnum=n=>{const i={};for(const o of n)i[o]=o;return i},a.getValidEnumValues=n=>{const i=a.objectKeys(n).filter(c=>typeof n[n[c]]!="number"),o={};for(const c of i)o[c]=n[c];return a.objectValues(o)},a.objectValues=n=>a.objectKeys(n).map(function(i){return n[i]}),a.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.push(o);return i},a.find=(n,i)=>{for(const o of n)if(i(o))return o},a.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function r(n,i=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}a.joinValues=r,a.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(V||(V={}));var At;(function(a){a.mergeShapes=(t,s)=>({...t,...s})})(At||(At={}));const y=V.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),be=a=>{switch(typeof a){case"undefined":return y.undefined;case"string":return y.string;case"number":return isNaN(a)?y.nan:y.number;case"boolean":return y.boolean;case"function":return y.function;case"bigint":return y.bigint;case"symbol":return y.symbol;case"object":return Array.isArray(a)?y.array:a===null?y.null:a.then&&typeof a.then=="function"&&a.catch&&typeof a.catch=="function"?y.promise:typeof Map<"u"&&a instanceof Map?y.map:typeof Set<"u"&&a instanceof Set?y.set:typeof Date<"u"&&a instanceof Date?y.date:y.object;default:return y.unknown}},f=V.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),lr=a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:");class ne extends Error{constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const s=t||function(i){return i.message},r={_errors:[]},n=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)r._errors.push(s(o));else{let c=r,u=0;for(;u<o.path.length;){const d=o.path[u];u===o.path.length-1?(c[d]=c[d]||{_errors:[]},c[d]._errors.push(s(o))):c[d]=c[d]||{_errors:[]},c=c[d],u++}}};return n(this),r}static assert(t){if(!(t instanceof ne))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,V.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=s=>s.message){const s={},r=[];for(const n of this.issues)n.path.length>0?(s[n.path[0]]=s[n.path[0]]||[],s[n.path[0]].push(t(n))):r.push(t(n));return{formErrors:r,fieldErrors:s}}get formErrors(){return this.flatten()}}ne.create=a=>new ne(a);const Ze=(a,t)=>{let s;switch(a.code){case f.invalid_type:a.received===y.undefined?s="Required":s=`Expected ${a.expected}, received ${a.received}`;break;case f.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(a.expected,V.jsonStringifyReplacer)}`;break;case f.unrecognized_keys:s=`Unrecognized key(s) in object: ${V.joinValues(a.keys,", ")}`;break;case f.invalid_union:s="Invalid input";break;case f.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${V.joinValues(a.options)}`;break;case f.invalid_enum_value:s=`Invalid enum value. Expected ${V.joinValues(a.options)}, received '${a.received}'`;break;case f.invalid_arguments:s="Invalid function arguments";break;case f.invalid_return_type:s="Invalid function return type";break;case f.invalid_date:s="Invalid date";break;case f.invalid_string:typeof a.validation=="object"?"includes"in a.validation?(s=`Invalid input: must include "${a.validation.includes}"`,typeof a.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?s=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?s=`Invalid input: must end with "${a.validation.endsWith}"`:V.assertNever(a.validation):a.validation!=="regex"?s=`Invalid ${a.validation}`:s="Invalid";break;case f.too_small:a.type==="array"?s=`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:a.type==="string"?s=`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:a.type==="number"?s=`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:a.type==="date"?s=`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:s="Invalid input";break;case f.too_big:a.type==="array"?s=`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:a.type==="string"?s=`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:a.type==="number"?s=`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="bigint"?s=`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="date"?s=`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:s="Invalid input";break;case f.custom:s="Invalid input";break;case f.invalid_intersection_types:s="Intersection results could not be merged";break;case f.not_multiple_of:s=`Number must be a multiple of ${a.multipleOf}`;break;case f.not_finite:s="Number must be finite";break;default:s=t.defaultError,V.assertNever(a)}return{message:s}};let zs=Ze;function dr(a){zs=a}function xt(){return zs}const gt=a=>{const{data:t,path:s,errorMaps:r,issueData:n}=a,i=[...s,...n.path||[]],o={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let c="";const u=r.filter(d=>!!d).slice().reverse();for(const d of u)c=d(o,{data:t,defaultError:c}).message;return{...n,path:i,message:c}},ur=[];function g(a,t){const s=xt(),r=gt({issueData:t,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,s,s===Ze?void 0:Ze].filter(n=>!!n)});a.common.issues.push(r)}class K{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,s){const r=[];for(const n of s){if(n.status==="aborted")return E;n.status==="dirty"&&t.dirty(),r.push(n.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,s){const r=[];for(const n of s){const i=await n.key,o=await n.value;r.push({key:i,value:o})}return K.mergeObjectSync(t,r)}static mergeObjectSync(t,s){const r={};for(const n of s){const{key:i,value:o}=n;if(i.status==="aborted"||o.status==="aborted")return E;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(r[i.value]=o.value)}return{status:t.value,value:r}}}const E=Object.freeze({status:"aborted"}),Ve=a=>({status:"dirty",value:a}),te=a=>({status:"valid",value:a}),It=a=>a.status==="aborted",Ot=a=>a.status==="dirty",Je=a=>a.status==="valid",Ke=a=>typeof Promise<"u"&&a instanceof Promise;function yt(a,t,s,r){if(typeof t=="function"?a!==t||!r:!t.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(a)}function Bs(a,t,s,r,n){if(typeof t=="function"?a!==t||!n:!t.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(a,s),s}var _;(function(a){a.errToObj=t=>typeof t=="string"?{message:t}:t||{},a.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(_||(_={}));var We,Xe;class ue{constructor(t,s,r,n){this._cachedPath=[],this.parent=t,this.data=s,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Kt=(a,t)=>{if(Je(t))return{success:!0,data:t.value};if(!a.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new ne(a.common.issues);return this._error=s,this._error}}};function D(a){if(!a)return{};const{errorMap:t,invalid_type_error:s,required_error:r,description:n}=a;if(t&&(s||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(o,c)=>{var u,d;const{message:l}=a;return o.code==="invalid_enum_value"?{message:l??c.defaultError}:typeof c.data>"u"?{message:(u=l??r)!==null&&u!==void 0?u:c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:(d=l??s)!==null&&d!==void 0?d:c.defaultError}},description:n}}class A{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return be(t.data)}_getOrReturnCtx(t,s){return s||{common:t.parent.common,data:t.data,parsedType:be(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new K,ctx:{common:t.parent.common,data:t.data,parsedType:be(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const s=this._parse(t);if(Ke(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(t){const s=this._parse(t);return Promise.resolve(s)}parse(t,s){const r=this.safeParse(t,s);if(r.success)return r.data;throw r.error}safeParse(t,s){var r;const n={common:{issues:[],async:(r=s==null?void 0:s.async)!==null&&r!==void 0?r:!1,contextualErrorMap:s==null?void 0:s.errorMap},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:be(t)},i=this._parseSync({data:t,path:n.path,parent:n});return Kt(n,i)}async parseAsync(t,s){const r=await this.safeParseAsync(t,s);if(r.success)return r.data;throw r.error}async safeParseAsync(t,s){const r={common:{issues:[],contextualErrorMap:s==null?void 0:s.errorMap,async:!0},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:be(t)},n=this._parse({data:t,path:r.path,parent:r}),i=await(Ke(n)?n:Promise.resolve(n));return Kt(r,i)}refine(t,s){const r=n=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(n):s;return this._refinement((n,i)=>{const o=t(n),c=()=>i.addIssue({code:f.custom,...r(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(t,s){return this._refinement((r,n)=>t(r)?!0:(n.addIssue(typeof s=="function"?s(r,n):s),!1))}_refinement(t){return new le({schema:this,typeName:k.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return de.create(this,this._def)}nullable(){return Se.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ce.create(this,this._def)}promise(){return $e.create(this,this._def)}or(t){return st.create([this,t],this._def)}and(t){return at.create(this,t,this._def)}transform(t){return new le({...D(this._def),schema:this,typeName:k.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const s=typeof t=="function"?t:()=>t;return new ct({...D(this._def),innerType:this,defaultValue:s,typeName:k.ZodDefault})}brand(){return new $t({typeName:k.ZodBranded,type:this,...D(this._def)})}catch(t){const s=typeof t=="function"?t:()=>t;return new lt({...D(this._def),innerType:this,catchValue:s,typeName:k.ZodCatch})}describe(t){const s=this.constructor;return new s({...this._def,description:t})}pipe(t){return ut.create(this,t)}readonly(){return dt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const mr=/^c[^\s-]{8,}$/i,hr=/^[0-9a-z]+$/,pr=/^[0-9A-HJKMNP-TV-Z]{26}$/,fr=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xr=/^[a-z0-9_-]{21}$/i,gr=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,yr=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,vr="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let kt;const jr=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Nr=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,br=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Gs="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",_r=new RegExp(`^${Gs}$`);function Ws(a){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return a.precision?t=`${t}\\.\\d{${a.precision}}`:a.precision==null&&(t=`${t}(\\.\\d+)?`),t}function wr(a){return new RegExp(`^${Ws(a)}$`)}function Xs(a){let t=`${Gs}T${Ws(a)}`;const s=[];return s.push(a.local?"Z?":"Z"),a.offset&&s.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${s.join("|")})`,new RegExp(`^${t}$`)}function Cr(a,t){return!!((t==="v4"||!t)&&jr.test(a)||(t==="v6"||!t)&&Nr.test(a))}class ie extends A{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==y.string){const i=this._getOrReturnCtx(t);return g(i,{code:f.invalid_type,expected:y.string,received:i.parsedType}),E}const r=new K;let n;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(n=this._getOrReturnCtx(t,n),g(n,{code:f.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(n=this._getOrReturnCtx(t,n),g(n,{code:f.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,c=t.data.length<i.value;(o||c)&&(n=this._getOrReturnCtx(t,n),o?g(n,{code:f.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&g(n,{code:f.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")yr.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"email",code:f.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")kt||(kt=new RegExp(vr,"u")),kt.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"emoji",code:f.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")fr.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"uuid",code:f.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")xr.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"nanoid",code:f.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")mr.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"cuid",code:f.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")hr.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"cuid2",code:f.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")pr.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"ulid",code:f.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),g(n,{validation:"url",code:f.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"regex",code:f.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(t,n),g(n,{code:f.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(n=this._getOrReturnCtx(t,n),g(n,{code:f.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(n=this._getOrReturnCtx(t,n),g(n,{code:f.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Xs(i).test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{code:f.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?_r.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{code:f.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?wr(i).test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{code:f.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?gr.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"duration",code:f.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Cr(t.data,i.version)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"ip",code:f.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?br.test(t.data)||(n=this._getOrReturnCtx(t,n),g(n,{validation:"base64",code:f.invalid_string,message:i.message}),r.dirty()):V.assertNever(i);return{status:r.value,value:t.data}}_regex(t,s,r){return this.refinement(n=>t.test(n),{validation:s,code:f.invalid_string,..._.errToObj(r)})}_addCheck(t){return new ie({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",..._.errToObj(t)})}url(t){return this._addCheck({kind:"url",..._.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",..._.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",..._.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",..._.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",..._.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",..._.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",..._.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",..._.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",..._.errToObj(t)})}datetime(t){var s,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(s=t==null?void 0:t.offset)!==null&&s!==void 0?s:!1,local:(r=t==null?void 0:t.local)!==null&&r!==void 0?r:!1,..._.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,..._.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",..._.errToObj(t)})}regex(t,s){return this._addCheck({kind:"regex",regex:t,..._.errToObj(s)})}includes(t,s){return this._addCheck({kind:"includes",value:t,position:s==null?void 0:s.position,..._.errToObj(s==null?void 0:s.message)})}startsWith(t,s){return this._addCheck({kind:"startsWith",value:t,..._.errToObj(s)})}endsWith(t,s){return this._addCheck({kind:"endsWith",value:t,..._.errToObj(s)})}min(t,s){return this._addCheck({kind:"min",value:t,..._.errToObj(s)})}max(t,s){return this._addCheck({kind:"max",value:t,..._.errToObj(s)})}length(t,s){return this._addCheck({kind:"length",value:t,..._.errToObj(s)})}nonempty(t){return this.min(1,_.errToObj(t))}trim(){return new ie({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ie({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ie({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxLength(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}}ie.create=a=>{var t;return new ie({checks:[],typeName:k.ZodString,coerce:(t=a==null?void 0:a.coerce)!==null&&t!==void 0?t:!1,...D(a)})};function Sr(a,t){const s=(a.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,n=s>r?s:r,i=parseInt(a.toFixed(n).replace(".","")),o=parseInt(t.toFixed(n).replace(".",""));return i%o/Math.pow(10,n)}class _e extends A{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==y.number){const i=this._getOrReturnCtx(t);return g(i,{code:f.invalid_type,expected:y.number,received:i.parsedType}),E}let r;const n=new K;for(const i of this._def.checks)i.kind==="int"?V.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),g(r,{code:f.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),g(r,{code:f.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),g(r,{code:f.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?Sr(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),g(r,{code:f.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),g(r,{code:f.not_finite,message:i.message}),n.dirty()):V.assertNever(i);return{status:n.value,value:t.data}}gte(t,s){return this.setLimit("min",t,!0,_.toString(s))}gt(t,s){return this.setLimit("min",t,!1,_.toString(s))}lte(t,s){return this.setLimit("max",t,!0,_.toString(s))}lt(t,s){return this.setLimit("max",t,!1,_.toString(s))}setLimit(t,s,r,n){return new _e({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:r,message:_.toString(n)}]})}_addCheck(t){return new _e({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:_.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:_.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:_.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:_.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:_.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:_.toString(s)})}finite(t){return this._addCheck({kind:"finite",message:_.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:_.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:_.toString(t)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&V.isInteger(t.value))}get isFinite(){let t=null,s=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(s===null||r.value>s)&&(s=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(s)&&Number.isFinite(t)}}_e.create=a=>new _e({checks:[],typeName:k.ZodNumber,coerce:(a==null?void 0:a.coerce)||!1,...D(a)});class we extends A{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==y.bigint){const i=this._getOrReturnCtx(t);return g(i,{code:f.invalid_type,expected:y.bigint,received:i.parsedType}),E}let r;const n=new K;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),g(r,{code:f.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),g(r,{code:f.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),g(r,{code:f.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):V.assertNever(i);return{status:n.value,value:t.data}}gte(t,s){return this.setLimit("min",t,!0,_.toString(s))}gt(t,s){return this.setLimit("min",t,!1,_.toString(s))}lte(t,s){return this.setLimit("max",t,!0,_.toString(s))}lt(t,s){return this.setLimit("max",t,!1,_.toString(s))}setLimit(t,s,r,n){return new we({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:r,message:_.toString(n)}]})}_addCheck(t){return new we({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:_.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:_.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:_.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:_.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:_.toString(s)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}}we.create=a=>{var t;return new we({checks:[],typeName:k.ZodBigInt,coerce:(t=a==null?void 0:a.coerce)!==null&&t!==void 0?t:!1,...D(a)})};class Qe extends A{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==y.boolean){const r=this._getOrReturnCtx(t);return g(r,{code:f.invalid_type,expected:y.boolean,received:r.parsedType}),E}return te(t.data)}}Qe.create=a=>new Qe({typeName:k.ZodBoolean,coerce:(a==null?void 0:a.coerce)||!1,...D(a)});class Ee extends A{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==y.date){const i=this._getOrReturnCtx(t);return g(i,{code:f.invalid_type,expected:y.date,received:i.parsedType}),E}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return g(i,{code:f.invalid_date}),E}const r=new K;let n;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(n=this._getOrReturnCtx(t,n),g(n,{code:f.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(n=this._getOrReturnCtx(t,n),g(n,{code:f.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):V.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Ee({...this._def,checks:[...this._def.checks,t]})}min(t,s){return this._addCheck({kind:"min",value:t.getTime(),message:_.toString(s)})}max(t,s){return this._addCheck({kind:"max",value:t.getTime(),message:_.toString(s)})}get minDate(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t!=null?new Date(t):null}}Ee.create=a=>new Ee({checks:[],coerce:(a==null?void 0:a.coerce)||!1,typeName:k.ZodDate,...D(a)});class vt extends A{_parse(t){if(this._getType(t)!==y.symbol){const r=this._getOrReturnCtx(t);return g(r,{code:f.invalid_type,expected:y.symbol,received:r.parsedType}),E}return te(t.data)}}vt.create=a=>new vt({typeName:k.ZodSymbol,...D(a)});class et extends A{_parse(t){if(this._getType(t)!==y.undefined){const r=this._getOrReturnCtx(t);return g(r,{code:f.invalid_type,expected:y.undefined,received:r.parsedType}),E}return te(t.data)}}et.create=a=>new et({typeName:k.ZodUndefined,...D(a)});class tt extends A{_parse(t){if(this._getType(t)!==y.null){const r=this._getOrReturnCtx(t);return g(r,{code:f.invalid_type,expected:y.null,received:r.parsedType}),E}return te(t.data)}}tt.create=a=>new tt({typeName:k.ZodNull,...D(a)});class Ue extends A{constructor(){super(...arguments),this._any=!0}_parse(t){return te(t.data)}}Ue.create=a=>new Ue({typeName:k.ZodAny,...D(a)});class Te extends A{constructor(){super(...arguments),this._unknown=!0}_parse(t){return te(t.data)}}Te.create=a=>new Te({typeName:k.ZodUnknown,...D(a)});class ye extends A{_parse(t){const s=this._getOrReturnCtx(t);return g(s,{code:f.invalid_type,expected:y.never,received:s.parsedType}),E}}ye.create=a=>new ye({typeName:k.ZodNever,...D(a)});class jt extends A{_parse(t){if(this._getType(t)!==y.undefined){const r=this._getOrReturnCtx(t);return g(r,{code:f.invalid_type,expected:y.void,received:r.parsedType}),E}return te(t.data)}}jt.create=a=>new jt({typeName:k.ZodVoid,...D(a)});class ce extends A{_parse(t){const{ctx:s,status:r}=this._processInputParams(t),n=this._def;if(s.parsedType!==y.array)return g(s,{code:f.invalid_type,expected:y.array,received:s.parsedType}),E;if(n.exactLength!==null){const o=s.data.length>n.exactLength.value,c=s.data.length<n.exactLength.value;(o||c)&&(g(s,{code:o?f.too_big:f.too_small,minimum:c?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(n.minLength!==null&&s.data.length<n.minLength.value&&(g(s,{code:f.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),n.maxLength!==null&&s.data.length>n.maxLength.value&&(g(s,{code:f.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),s.common.async)return Promise.all([...s.data].map((o,c)=>n.type._parseAsync(new ue(s,o,s.path,c)))).then(o=>K.mergeArray(r,o));const i=[...s.data].map((o,c)=>n.type._parseSync(new ue(s,o,s.path,c)));return K.mergeArray(r,i)}get element(){return this._def.type}min(t,s){return new ce({...this._def,minLength:{value:t,message:_.toString(s)}})}max(t,s){return new ce({...this._def,maxLength:{value:t,message:_.toString(s)}})}length(t,s){return new ce({...this._def,exactLength:{value:t,message:_.toString(s)}})}nonempty(t){return this.min(1,t)}}ce.create=(a,t)=>new ce({type:a,minLength:null,maxLength:null,exactLength:null,typeName:k.ZodArray,...D(t)});function Ie(a){if(a instanceof B){const t={};for(const s in a.shape){const r=a.shape[s];t[s]=de.create(Ie(r))}return new B({...a._def,shape:()=>t})}else return a instanceof ce?new ce({...a._def,type:Ie(a.element)}):a instanceof de?de.create(Ie(a.unwrap())):a instanceof Se?Se.create(Ie(a.unwrap())):a instanceof me?me.create(a.items.map(t=>Ie(t))):a}class B extends A{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),s=V.objectKeys(t);return this._cached={shape:t,keys:s}}_parse(t){if(this._getType(t)!==y.object){const d=this._getOrReturnCtx(t);return g(d,{code:f.invalid_type,expected:y.object,received:d.parsedType}),E}const{status:r,ctx:n}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof ye&&this._def.unknownKeys==="strip"))for(const d in n.data)o.includes(d)||c.push(d);const u=[];for(const d of o){const l=i[d],h=n.data[d];u.push({key:{status:"valid",value:d},value:l._parse(new ue(n,h,n.path,d)),alwaysSet:d in n.data})}if(this._def.catchall instanceof ye){const d=this._def.unknownKeys;if(d==="passthrough")for(const l of c)u.push({key:{status:"valid",value:l},value:{status:"valid",value:n.data[l]}});else if(d==="strict")c.length>0&&(g(n,{code:f.unrecognized_keys,keys:c}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const l of c){const h=n.data[l];u.push({key:{status:"valid",value:l},value:d._parse(new ue(n,h,n.path,l)),alwaysSet:l in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const d=[];for(const l of u){const h=await l.key,R=await l.value;d.push({key:h,value:R,alwaysSet:l.alwaysSet})}return d}).then(d=>K.mergeObjectSync(r,d)):K.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(t){return _.errToObj,new B({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(s,r)=>{var n,i,o,c;const u=(o=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,s,r).message)!==null&&o!==void 0?o:r.defaultError;return s.code==="unrecognized_keys"?{message:(c=_.errToObj(t).message)!==null&&c!==void 0?c:u}:{message:u}}}:{}})}strip(){return new B({...this._def,unknownKeys:"strip"})}passthrough(){return new B({...this._def,unknownKeys:"passthrough"})}extend(t){return new B({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new B({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:k.ZodObject})}setKey(t,s){return this.augment({[t]:s})}catchall(t){return new B({...this._def,catchall:t})}pick(t){const s={};return V.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(s[r]=this.shape[r])}),new B({...this._def,shape:()=>s})}omit(t){const s={};return V.objectKeys(this.shape).forEach(r=>{t[r]||(s[r]=this.shape[r])}),new B({...this._def,shape:()=>s})}deepPartial(){return Ie(this)}partial(t){const s={};return V.objectKeys(this.shape).forEach(r=>{const n=this.shape[r];t&&!t[r]?s[r]=n:s[r]=n.optional()}),new B({...this._def,shape:()=>s})}required(t){const s={};return V.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])s[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof de;)i=i._def.innerType;s[r]=i}}),new B({...this._def,shape:()=>s})}keyof(){return Ys(V.objectKeys(this.shape))}}B.create=(a,t)=>new B({shape:()=>a,unknownKeys:"strip",catchall:ye.create(),typeName:k.ZodObject,...D(t)});B.strictCreate=(a,t)=>new B({shape:()=>a,unknownKeys:"strict",catchall:ye.create(),typeName:k.ZodObject,...D(t)});B.lazycreate=(a,t)=>new B({shape:a,unknownKeys:"strip",catchall:ye.create(),typeName:k.ZodObject,...D(t)});class st extends A{_parse(t){const{ctx:s}=this._processInputParams(t),r=this._def.options;function n(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return s.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new ne(c.ctx.common.issues));return g(s,{code:f.invalid_union,unionErrors:o}),E}if(s.common.async)return Promise.all(r.map(async i=>{const o={...s,common:{...s.common,issues:[]},parent:null};return{result:await i._parseAsync({data:s.data,path:s.path,parent:o}),ctx:o}})).then(n);{let i;const o=[];for(const u of r){const d={...s,common:{...s.common,issues:[]},parent:null},l=u._parseSync({data:s.data,path:s.path,parent:d});if(l.status==="valid")return l;l.status==="dirty"&&!i&&(i={result:l,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return s.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(u=>new ne(u));return g(s,{code:f.invalid_union,unionErrors:c}),E}}get options(){return this._def.options}}st.create=(a,t)=>new st({options:a,typeName:k.ZodUnion,...D(t)});const fe=a=>a instanceof nt?fe(a.schema):a instanceof le?fe(a.innerType()):a instanceof it?[a.value]:a instanceof Ce?a.options:a instanceof ot?V.objectValues(a.enum):a instanceof ct?fe(a._def.innerType):a instanceof et?[void 0]:a instanceof tt?[null]:a instanceof de?[void 0,...fe(a.unwrap())]:a instanceof Se?[null,...fe(a.unwrap())]:a instanceof $t||a instanceof dt?fe(a.unwrap()):a instanceof lt?fe(a._def.innerType):[];class Ct extends A{_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==y.object)return g(s,{code:f.invalid_type,expected:y.object,received:s.parsedType}),E;const r=this.discriminator,n=s.data[r],i=this.optionsMap.get(n);return i?s.common.async?i._parseAsync({data:s.data,path:s.path,parent:s}):i._parseSync({data:s.data,path:s.path,parent:s}):(g(s,{code:f.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),E)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,s,r){const n=new Map;for(const i of s){const o=fe(i.shape[t]);if(!o.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const c of o){if(n.has(c))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(c)}`);n.set(c,i)}}return new Ct({typeName:k.ZodDiscriminatedUnion,discriminator:t,options:s,optionsMap:n,...D(r)})}}function Pt(a,t){const s=be(a),r=be(t);if(a===t)return{valid:!0,data:a};if(s===y.object&&r===y.object){const n=V.objectKeys(t),i=V.objectKeys(a).filter(c=>n.indexOf(c)!==-1),o={...a,...t};for(const c of i){const u=Pt(a[c],t[c]);if(!u.valid)return{valid:!1};o[c]=u.data}return{valid:!0,data:o}}else if(s===y.array&&r===y.array){if(a.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<a.length;i++){const o=a[i],c=t[i],u=Pt(o,c);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return s===y.date&&r===y.date&&+a==+t?{valid:!0,data:a}:{valid:!1}}class at extends A{_parse(t){const{status:s,ctx:r}=this._processInputParams(t),n=(i,o)=>{if(It(i)||It(o))return E;const c=Pt(i.value,o.value);return c.valid?((Ot(i)||Ot(o))&&s.dirty(),{status:s.value,value:c.data}):(g(r,{code:f.invalid_intersection_types}),E)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>n(i,o)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}at.create=(a,t,s)=>new at({left:a,right:t,typeName:k.ZodIntersection,...D(s)});class me extends A{_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.parsedType!==y.array)return g(r,{code:f.invalid_type,expected:y.array,received:r.parsedType}),E;if(r.data.length<this._def.items.length)return g(r,{code:f.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),E;!this._def.rest&&r.data.length>this._def.items.length&&(g(r,{code:f.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const i=[...r.data].map((o,c)=>{const u=this._def.items[c]||this._def.rest;return u?u._parse(new ue(r,o,r.path,c)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>K.mergeArray(s,o)):K.mergeArray(s,i)}get items(){return this._def.items}rest(t){return new me({...this._def,rest:t})}}me.create=(a,t)=>{if(!Array.isArray(a))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new me({items:a,typeName:k.ZodTuple,rest:null,...D(t)})};class rt extends A{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.parsedType!==y.object)return g(r,{code:f.invalid_type,expected:y.object,received:r.parsedType}),E;const n=[],i=this._def.keyType,o=this._def.valueType;for(const c in r.data)n.push({key:i._parse(new ue(r,c,r.path,c)),value:o._parse(new ue(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?K.mergeObjectAsync(s,n):K.mergeObjectSync(s,n)}get element(){return this._def.valueType}static create(t,s,r){return s instanceof A?new rt({keyType:t,valueType:s,typeName:k.ZodRecord,...D(r)}):new rt({keyType:ie.create(),valueType:t,typeName:k.ZodRecord,...D(s)})}}class Nt extends A{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.parsedType!==y.map)return g(r,{code:f.invalid_type,expected:y.map,received:r.parsedType}),E;const n=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([c,u],d)=>({key:n._parse(new ue(r,c,r.path,[d,"key"])),value:i._parse(new ue(r,u,r.path,[d,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const u of o){const d=await u.key,l=await u.value;if(d.status==="aborted"||l.status==="aborted")return E;(d.status==="dirty"||l.status==="dirty")&&s.dirty(),c.set(d.value,l.value)}return{status:s.value,value:c}})}else{const c=new Map;for(const u of o){const d=u.key,l=u.value;if(d.status==="aborted"||l.status==="aborted")return E;(d.status==="dirty"||l.status==="dirty")&&s.dirty(),c.set(d.value,l.value)}return{status:s.value,value:c}}}}Nt.create=(a,t,s)=>new Nt({valueType:t,keyType:a,typeName:k.ZodMap,...D(s)});class De extends A{_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.parsedType!==y.set)return g(r,{code:f.invalid_type,expected:y.set,received:r.parsedType}),E;const n=this._def;n.minSize!==null&&r.data.size<n.minSize.value&&(g(r,{code:f.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),s.dirty()),n.maxSize!==null&&r.data.size>n.maxSize.value&&(g(r,{code:f.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),s.dirty());const i=this._def.valueType;function o(u){const d=new Set;for(const l of u){if(l.status==="aborted")return E;l.status==="dirty"&&s.dirty(),d.add(l.value)}return{status:s.value,value:d}}const c=[...r.data.values()].map((u,d)=>i._parse(new ue(r,u,r.path,d)));return r.common.async?Promise.all(c).then(u=>o(u)):o(c)}min(t,s){return new De({...this._def,minSize:{value:t,message:_.toString(s)}})}max(t,s){return new De({...this._def,maxSize:{value:t,message:_.toString(s)}})}size(t,s){return this.min(t,s).max(t,s)}nonempty(t){return this.min(1,t)}}De.create=(a,t)=>new De({valueType:a,minSize:null,maxSize:null,typeName:k.ZodSet,...D(t)});class Le extends A{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==y.function)return g(s,{code:f.invalid_type,expected:y.function,received:s.parsedType}),E;function r(c,u){return gt({data:c,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,xt(),Ze].filter(d=>!!d),issueData:{code:f.invalid_arguments,argumentsError:u}})}function n(c,u){return gt({data:c,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,xt(),Ze].filter(d=>!!d),issueData:{code:f.invalid_return_type,returnTypeError:u}})}const i={errorMap:s.common.contextualErrorMap},o=s.data;if(this._def.returns instanceof $e){const c=this;return te(async function(...u){const d=new ne([]),l=await c._def.args.parseAsync(u,i).catch(v=>{throw d.addIssue(r(u,v)),d}),h=await Reflect.apply(o,this,l);return await c._def.returns._def.type.parseAsync(h,i).catch(v=>{throw d.addIssue(n(h,v)),d})})}else{const c=this;return te(function(...u){const d=c._def.args.safeParse(u,i);if(!d.success)throw new ne([r(u,d.error)]);const l=Reflect.apply(o,this,d.data),h=c._def.returns.safeParse(l,i);if(!h.success)throw new ne([n(l,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Le({...this._def,args:me.create(t).rest(Te.create())})}returns(t){return new Le({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,s,r){return new Le({args:t||me.create([]).rest(Te.create()),returns:s||Te.create(),typeName:k.ZodFunction,...D(r)})}}class nt extends A{get schema(){return this._def.getter()}_parse(t){const{ctx:s}=this._processInputParams(t);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}nt.create=(a,t)=>new nt({getter:a,typeName:k.ZodLazy,...D(t)});class it extends A{_parse(t){if(t.data!==this._def.value){const s=this._getOrReturnCtx(t);return g(s,{received:s.data,code:f.invalid_literal,expected:this._def.value}),E}return{status:"valid",value:t.data}}get value(){return this._def.value}}it.create=(a,t)=>new it({value:a,typeName:k.ZodLiteral,...D(t)});function Ys(a,t){return new Ce({values:a,typeName:k.ZodEnum,...D(t)})}class Ce extends A{constructor(){super(...arguments),We.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const s=this._getOrReturnCtx(t),r=this._def.values;return g(s,{expected:V.joinValues(r),received:s.parsedType,code:f.invalid_type}),E}if(yt(this,We)||Bs(this,We,new Set(this._def.values)),!yt(this,We).has(t.data)){const s=this._getOrReturnCtx(t),r=this._def.values;return g(s,{received:s.data,code:f.invalid_enum_value,options:r}),E}return te(t.data)}get options(){return this._def.values}get enum(){const t={};for(const s of this._def.values)t[s]=s;return t}get Values(){const t={};for(const s of this._def.values)t[s]=s;return t}get Enum(){const t={};for(const s of this._def.values)t[s]=s;return t}extract(t,s=this._def){return Ce.create(t,{...this._def,...s})}exclude(t,s=this._def){return Ce.create(this.options.filter(r=>!t.includes(r)),{...this._def,...s})}}We=new WeakMap;Ce.create=Ys;class ot extends A{constructor(){super(...arguments),Xe.set(this,void 0)}_parse(t){const s=V.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==y.string&&r.parsedType!==y.number){const n=V.objectValues(s);return g(r,{expected:V.joinValues(n),received:r.parsedType,code:f.invalid_type}),E}if(yt(this,Xe)||Bs(this,Xe,new Set(V.getValidEnumValues(this._def.values))),!yt(this,Xe).has(t.data)){const n=V.objectValues(s);return g(r,{received:r.data,code:f.invalid_enum_value,options:n}),E}return te(t.data)}get enum(){return this._def.values}}Xe=new WeakMap;ot.create=(a,t)=>new ot({values:a,typeName:k.ZodNativeEnum,...D(t)});class $e extends A{unwrap(){return this._def.type}_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==y.promise&&s.common.async===!1)return g(s,{code:f.invalid_type,expected:y.promise,received:s.parsedType}),E;const r=s.parsedType===y.promise?s.data:Promise.resolve(s.data);return te(r.then(n=>this._def.type.parseAsync(n,{path:s.path,errorMap:s.common.contextualErrorMap})))}}$e.create=(a,t)=>new $e({type:a,typeName:k.ZodPromise,...D(t)});class le extends A{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===k.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:s,ctx:r}=this._processInputParams(t),n=this._def.effect||null,i={addIssue:o=>{g(r,o),o.fatal?s.abort():s.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const o=n.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async c=>{if(s.value==="aborted")return E;const u=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return u.status==="aborted"?E:u.status==="dirty"||s.value==="dirty"?Ve(u.value):u});{if(s.value==="aborted")return E;const c=this._def.schema._parseSync({data:o,path:r.path,parent:r});return c.status==="aborted"?E:c.status==="dirty"||s.value==="dirty"?Ve(c.value):c}}if(n.type==="refinement"){const o=c=>{const u=n.refinement(c,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?E:(c.status==="dirty"&&s.dirty(),o(c.value),{status:s.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?E:(c.status==="dirty"&&s.dirty(),o(c.value).then(()=>({status:s.value,value:c.value}))))}if(n.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Je(o))return o;const c=n.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Je(o)?Promise.resolve(n.transform(o.value,i)).then(c=>({status:s.value,value:c})):o);V.assertNever(n)}}le.create=(a,t,s)=>new le({schema:a,typeName:k.ZodEffects,effect:t,...D(s)});le.createWithPreprocess=(a,t,s)=>new le({schema:t,effect:{type:"preprocess",transform:a},typeName:k.ZodEffects,...D(s)});class de extends A{_parse(t){return this._getType(t)===y.undefined?te(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}de.create=(a,t)=>new de({innerType:a,typeName:k.ZodOptional,...D(t)});class Se extends A{_parse(t){return this._getType(t)===y.null?te(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Se.create=(a,t)=>new Se({innerType:a,typeName:k.ZodNullable,...D(t)});class ct extends A{_parse(t){const{ctx:s}=this._processInputParams(t);let r=s.data;return s.parsedType===y.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}ct.create=(a,t)=>new ct({innerType:a,typeName:k.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...D(t)});class lt extends A{_parse(t){const{ctx:s}=this._processInputParams(t),r={...s,common:{...s.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Ke(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ne(r.common.issues)},input:r.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ne(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}lt.create=(a,t)=>new lt({innerType:a,typeName:k.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...D(t)});class bt extends A{_parse(t){if(this._getType(t)!==y.nan){const r=this._getOrReturnCtx(t);return g(r,{code:f.invalid_type,expected:y.nan,received:r.parsedType}),E}return{status:"valid",value:t.data}}}bt.create=a=>new bt({typeName:k.ZodNaN,...D(a)});const kr=Symbol("zod_brand");class $t extends A{_parse(t){const{ctx:s}=this._processInputParams(t),r=s.data;return this._def.type._parse({data:r,path:s.path,parent:s})}unwrap(){return this._def.type}}class ut extends A{_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?E:i.status==="dirty"?(s.dirty(),Ve(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const n=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?E:n.status==="dirty"?(s.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:r.path,parent:r})}}static create(t,s){return new ut({in:t,out:s,typeName:k.ZodPipeline})}}class dt extends A{_parse(t){const s=this._def.innerType._parse(t),r=n=>(Je(n)&&(n.value=Object.freeze(n.value)),n);return Ke(s)?s.then(n=>r(n)):r(s)}unwrap(){return this._def.innerType}}dt.create=(a,t)=>new dt({innerType:a,typeName:k.ZodReadonly,...D(t)});function Hs(a,t={},s){return a?Ue.create().superRefine((r,n)=>{var i,o;if(!a(r)){const c=typeof t=="function"?t(r):typeof t=="string"?{message:t}:t,u=(o=(i=c.fatal)!==null&&i!==void 0?i:s)!==null&&o!==void 0?o:!0,d=typeof c=="string"?{message:c}:c;n.addIssue({code:"custom",...d,fatal:u})}}):Ue.create()}const Tr={object:B.lazycreate};var k;(function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"})(k||(k={}));const Er=(a,t={message:`Input not instance of ${a.name}`})=>Hs(s=>s instanceof a,t),qs=ie.create,Js=_e.create,Dr=bt.create,Rr=we.create,Ks=Qe.create,Ar=Ee.create,Ir=vt.create,Or=et.create,Pr=tt.create,Vr=Ue.create,Mr=Te.create,Lr=ye.create,Fr=jt.create,Zr=ce.create,Ur=B.create,$r=B.strictCreate,zr=st.create,Br=Ct.create,Gr=at.create,Wr=me.create,Xr=rt.create,Yr=Nt.create,Hr=De.create,qr=Le.create,Jr=nt.create,Kr=it.create,Qr=Ce.create,en=ot.create,tn=$e.create,Qt=le.create,sn=de.create,an=Se.create,rn=le.createWithPreprocess,nn=ut.create,on=()=>qs().optional(),cn=()=>Js().optional(),ln=()=>Ks().optional(),dn={string:a=>ie.create({...a,coerce:!0}),number:a=>_e.create({...a,coerce:!0}),boolean:a=>Qe.create({...a,coerce:!0}),bigint:a=>we.create({...a,coerce:!0}),date:a=>Ee.create({...a,coerce:!0})},un=E;var P=Object.freeze({__proto__:null,defaultErrorMap:Ze,setErrorMap:dr,getErrorMap:xt,makeIssue:gt,EMPTY_PATH:ur,addIssueToContext:g,ParseStatus:K,INVALID:E,DIRTY:Ve,OK:te,isAborted:It,isDirty:Ot,isValid:Je,isAsync:Ke,get util(){return V},get objectUtil(){return At},ZodParsedType:y,getParsedType:be,ZodType:A,datetimeRegex:Xs,ZodString:ie,ZodNumber:_e,ZodBigInt:we,ZodBoolean:Qe,ZodDate:Ee,ZodSymbol:vt,ZodUndefined:et,ZodNull:tt,ZodAny:Ue,ZodUnknown:Te,ZodNever:ye,ZodVoid:jt,ZodArray:ce,ZodObject:B,ZodUnion:st,ZodDiscriminatedUnion:Ct,ZodIntersection:at,ZodTuple:me,ZodRecord:rt,ZodMap:Nt,ZodSet:De,ZodFunction:Le,ZodLazy:nt,ZodLiteral:it,ZodEnum:Ce,ZodNativeEnum:ot,ZodPromise:$e,ZodEffects:le,ZodTransformer:le,ZodOptional:de,ZodNullable:Se,ZodDefault:ct,ZodCatch:lt,ZodNaN:bt,BRAND:kr,ZodBranded:$t,ZodPipeline:ut,ZodReadonly:dt,custom:Hs,Schema:A,ZodSchema:A,late:Tr,get ZodFirstPartyTypeKind(){return k},coerce:dn,any:Vr,array:Zr,bigint:Rr,boolean:Ks,date:Ar,discriminatedUnion:Br,effect:Qt,enum:Qr,function:qr,instanceof:Er,intersection:Gr,lazy:Jr,literal:Kr,map:Yr,nan:Dr,nativeEnum:en,never:Lr,null:Pr,nullable:an,number:Js,object:Ur,oboolean:ln,onumber:cn,optional:sn,ostring:on,pipeline:nn,preprocess:rn,promise:tn,record:Xr,set:Hr,strictObject:$r,string:qs,symbol:Ir,transformer:Qt,tuple:Wr,undefined:Or,union:zr,unknown:Mr,void:Fr,NEVER:un,ZodIssueCode:f,quotelessJson:lr,ZodError:ne});const zt=P.object({fullName:P.string().min(2,"Full name must be at least 2 characters").max(100,"Full name must not exceed 100 characters").regex(/^[a-zA-Z\s]+$/,"Full name can only contain letters and spaces").refine(a=>a.trim().split(" ").length>=2,"Please provide at least first and last name"),dateOfBirth:P.string().refine(a=>{const t=new Date(a),r=new Date().getFullYear()-t.getFullYear();return r>=18&&r<=100},"You must be between 18 and 100 years old").refine(a=>new Date(a)<=new Date,"Date of birth cannot be in the future"),nationalIdNumber:P.string().length(9,"Botswana National ID (Omang) must be exactly 9 digits").regex(/^\d{9}$/,"National ID must contain only numbers"),phoneNumber:P.string().regex(/^\+267\d{8}$/,"Phone number must be in format +267XXXXXXXX (Botswana)").refine(a=>{const t=a.substring(4,6);return["71","72","73","74","75","76","77"].includes(t)},"Please provide a valid Botswana mobile number"),email:P.string().email("Please provide a valid email address").max(255,"Email address is too long"),address:P.object({street:P.string().min(5,"Street address must be at least 5 characters").max(200,"Street address is too long"),area:P.string().min(2,"Area/Suburb must be at least 2 characters").max(100,"Area/Suburb name is too long"),city:P.string().min(2,"City must be at least 2 characters").max(100,"City name is too long").refine(a=>["gaborone","francistown","maun","kasane","serowe","molepolole","kanye","mahalapye","palapye","lobatse","jwaneng","orapa","selebi-phikwe","letlhakane","mochudi","ramotswa","tlokweng"].includes(a.toLowerCase())||a.toLowerCase().includes("gaborone"),"Please provide a valid Botswana city/town"),postalCode:P.string().optional().refine(a=>!a||/^\d{5}$/.test(a),"Postal code must be 5 digits if provided")}),emergencyContact:P.object({name:P.string().min(2,"Emergency contact name must be at least 2 characters").max(100,"Emergency contact name is too long").regex(/^[a-zA-Z\s]+$/,"Name can only contain letters and spaces"),relationship:P.string().min(2,"Relationship must be specified").max(50,"Relationship description is too long"),phoneNumber:P.string().regex(/^\+267\d{8}$/,"Emergency contact phone must be in format +267XXXXXXXX")})});P.object({phoneNumber:P.string().regex(/^\+267\d{8}$/,"Phone number must be in Botswana format (+267XXXXXXXX)"),countryCode:P.string().refine(a=>a==="+267","Only Botswana phone numbers are supported"),verificationCode:P.string().length(6,"Verification code must be exactly 6 digits").regex(/^\d{6}$/,"Verification code must contain only numbers")});P.object({type:P.nativeEnum(Pe,{errorMap:()=>({message:"Invalid document type"})}),file:P.instanceof(File,{message:"A valid file must be selected"}).refine(a=>a.size<=5*1024*1024,"File size must be less than 5MB").refine(a=>["image/jpeg","image/png","application/pdf"].includes(a.type),"File must be a JPEG, PNG, or PDF"),fileName:P.string().min(1,"File name is required").max(255,"File name is too long"),documentNumber:P.string().optional().refine(a=>a?a.length>=3&&a.length<=20:!0,"Document number must be between 3 and 20 characters"),expiryDate:P.string().optional().refine(a=>a?new Date(a)>new Date:!0,"Document must not be expired")});P.object({currentAddress:zt.shape.address,confirmationMethod:P.enum(["document","utility_bill","bank_statement"],{errorMap:()=>({message:"Please select a valid confirmation method"})}),isConfirmed:P.boolean().refine(a=>a===!0,"Address must be confirmed to proceed")});P.object({personalInfo:zt,documentsCompleted:P.boolean().refine(a=>a===!0,"All required documents must be uploaded"),phoneVerified:P.boolean().refine(a=>a===!0,"Phone number must be verified"),addressConfirmed:P.boolean().refine(a=>a===!0,"Address must be confirmed"),selfieCompleted:P.boolean().refine(a=>a===!0,"Selfie verification must be completed"),termsAccepted:P.boolean().refine(a=>a===!0,"You must accept the terms and conditions"),dataConsent:P.boolean().refine(a=>a===!0,"You must consent to data processing")});function es(a){const t=a.replace(/[\s-]/g,"");return/^\d{9}$/.test(t)?{isValid:!0}:{isValid:!1,error:"Omang must be exactly 9 digits"}}function mn(a,t){return a.size>5*1024*1024?{isValid:!1,error:"File size must be less than 5MB"}:["image/jpeg","image/png","application/pdf"].includes(a.type)?a.name.length>255?{isValid:!1,error:"File name is too long"}:[".exe",".bat",".com",".scr",".pif"].some(i=>a.name.toLowerCase().endsWith(i))?{isValid:!1,error:"File type not allowed for security reasons"}:{isValid:!0}:{isValid:!1,error:"Only JPEG, PNG, and PDF files are allowed"}}const hn=({onNext:a})=>{var m,b,x,C,S,M,L,Y,ke,Re,Ne,W,se,ae;const t=wt(),{verificationData:s,updatePersonalInfo:r,isLoading:n}=pe(),[i,o]=p.useState(null),c=()=>{t("/")},{register:u,handleSubmit:d,formState:{errors:l,isValid:h},watch:R,setValue:v,getValues:T}=Ra({resolver:cr(zt),defaultValues:(s==null?void 0:s.personalInfo)||{},mode:"onChange"}),N=R("nationalIdNumber");p.useEffect(()=>{if(s!=null&&s.personalInfo){const Be=s.personalInfo;Object.entries(Be).forEach(([Ae,Wt])=>{Wt!==void 0&&v(Ae,Wt)})}},[s==null?void 0:s.personalInfo,v]),p.useEffect(()=>{if(N&&N.length===9){const Be=es(N);o(Be)}else o(null)},[N]);const w=async Be=>{try{if(N){const Ae=es(N);if(!Ae.isValid){j.error(Ae.error||"Invalid National ID number");return}}await r(Be),j.success("Personal information saved successfully"),setTimeout(()=>{a()},1e3)}catch(Ae){console.error("Failed to save personal information:",Ae),j.error("Failed to save personal information")}};return e.jsxs("form",{onSubmit:d(w),className:"space-y-6",children:[e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Ye,{className:"h-5 w-5"}),e.jsx("span",{children:"Personal Details"})]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"fullName",className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Full Name"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"fullName",placeholder:"Enter your full name as it appears on your ID",...u("fullName"),className:l.fullName?"border-red-500":""}),l.fullName&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.fullName.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"dateOfBirth",className:"flex items-center space-x-1",children:[e.jsx(ls,{className:"h-4 w-4"}),e.jsx("span",{children:"Date of Birth"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"dateOfBirth",type:"date",...u("dateOfBirth"),className:l.dateOfBirth?"border-red-500":""}),l.dateOfBirth&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.dateOfBirth.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"nationalIdNumber",className:"flex items-center space-x-1",children:[e.jsx(ds,{className:"h-4 w-4"}),e.jsx("span",{children:"National ID (Omang) Number"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"nationalIdNumber",placeholder:"Enter your 9-digit Omang number",maxLength:9,...u("nationalIdNumber"),className:l.nationalIdNumber||i&&!i.isValid?"border-red-500":i!=null&&i.isValid?"border-green-500":""}),i&&e.jsxs("div",{className:`text-sm flex items-center space-x-1 ${i.isValid?"text-green-600":"text-red-500"}`,children:[i.isValid?e.jsx(F,{className:"h-4 w-4"}):e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:i.isValid?"Valid Omang number":i.error})]}),l.nationalIdNumber&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.nationalIdNumber.message})]})]})]})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),e.jsx("span",{children:"Contact Information"})]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"phoneNumber",className:"flex items-center space-x-1",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{children:"Phone Number"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm",children:"+267"}),e.jsx(ee,{id:"phoneNumber",placeholder:"Enter your Botswana mobile number",className:`rounded-l-none ${l.phoneNumber?"border-red-500":""}`,...u("phoneNumber")})]}),l.phoneNumber&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.phoneNumber.message})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: +267XXXXXXXX (Botswana mobile number)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"email",className:"flex items-center space-x-1",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx("span",{children:"Email Address"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"email",type:"email",placeholder:"Enter your email address",...u("email"),className:l.email?"border-red-500":""}),l.email&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.email.message})]})]})]})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(He,{className:"h-5 w-5"}),e.jsx("span",{children:"Address Information"})]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"address.street",className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Street Address"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"address.street",placeholder:"Enter your street address",...u("address.street"),className:(m=l.address)!=null&&m.street?"border-red-500":""}),((b=l.address)==null?void 0:b.street)&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.address.street.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"address.area",className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Area/Suburb"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"address.area",placeholder:"Enter your area or suburb",...u("address.area"),className:(x=l.address)!=null&&x.area?"border-red-500":""}),((C=l.address)==null?void 0:C.area)&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.address.area.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"address.city",className:"flex items-center space-x-1",children:[e.jsx("span",{children:"City"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"address.city",placeholder:"e.g., Gaborone",...u("address.city"),className:(S=l.address)!=null&&S.city?"border-red-500":""}),((M=l.address)==null?void 0:M.city)&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.address.city.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"address.postalCode",children:"Postal Code (Optional)"}),e.jsx(ee,{id:"address.postalCode",placeholder:"e.g., 00267",...u("address.postalCode"),className:(L=l.address)!=null&&L.postalCode?"border-red-500":""}),((Y=l.address)==null?void 0:Y.postalCode)&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.address.postalCode.message})]})]})]})]})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Rt,{className:"h-5 w-5"}),e.jsx("span",{children:"Emergency Contact"})]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"emergencyContact.name",className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Contact Name"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"emergencyContact.name",placeholder:"Enter emergency contact's full name",...u("emergencyContact.name"),className:(ke=l.emergencyContact)!=null&&ke.name?"border-red-500":""}),((Re=l.emergencyContact)==null?void 0:Re.name)&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.emergencyContact.name.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"emergencyContact.relationship",className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Relationship"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{id:"emergencyContact.relationship",placeholder:"e.g., Spouse, Parent, Sibling",...u("emergencyContact.relationship"),className:(Ne=l.emergencyContact)!=null&&Ne.relationship?"border-red-500":""}),((W=l.emergencyContact)==null?void 0:W.relationship)&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.emergencyContact.relationship.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(H,{htmlFor:"emergencyContact.phoneNumber",className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Phone Number"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm",children:"+267"}),e.jsx(ee,{id:"emergencyContact.phoneNumber",placeholder:"Emergency contact number",className:`rounded-l-none ${(se=l.emergencyContact)!=null&&se.phoneNumber?"border-red-500":""}`,...u("emergencyContact.phoneNumber")})]}),((ae=l.emergencyContact)==null?void 0:ae.phoneNumber)&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:l.emergencyContact.phoneNumber.message})]})]})]})]})]}),e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(J,{children:"All information provided must match your official documents. Any discrepancies may result in verification delays or rejection."})]}),e.jsxs("div",{className:"flex justify-between space-x-4 pt-6",children:[e.jsxs(O,{type:"button",variant:"outline",onClick:c,className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Back to Home"})]}),e.jsxs(O,{type:"submit",disabled:!h||n,className:"flex items-center space-x-2",children:[e.jsx("span",{children:n?"Saving...":"Save & Continue"}),e.jsx(ge,{className:"h-4 w-4"})]})]})]})},ts=({document:a,onRemove:t})=>{var o;const[s,r]=p.useState(null);Oe.useEffect(()=>{if(a.file&&a.file instanceof File){const c=URL.createObjectURL(a.file);return r(c),()=>{URL.revokeObjectURL(c)}}else r(null)},[a.file]);const n=c=>{if(c===0)return"0 Bytes";const u=1024,d=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(c)/Math.log(u));return parseFloat((c/Math.pow(u,l)).toFixed(2))+" "+d[l]},i=c=>c.replace(/_/g," ").replace(/\b\w/g,u=>u.toUpperCase());return e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:e.jsx(oe,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:i(a.type)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.fileName," • ",n(a.fileSize)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{variant:a.status===G.COMPLETED?"secondary":"outline",className:a.status===G.COMPLETED?"bg-green-100 text-green-700":"",children:a.status===G.COMPLETED?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"Uploaded"]}):"Pending"}),e.jsx(O,{variant:"ghost",size:"icon",onClick:t,className:"h-6 w-6",children:e.jsx(Zt,{className:"h-3 w-3"})})]})]}),s&&e.jsx("div",{className:"mt-3",children:(o=a.file)!=null&&o.type.startsWith("image/")?e.jsx("img",{src:s,alt:`Preview of ${a.type}`,className:"w-full h-32 object-cover rounded border"}):e.jsx("div",{className:"flex items-center justify-center h-32 border rounded bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx(oe,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"PDF Document"})]})})}),a.documentNumber&&e.jsxs("div",{className:"mt-3 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Document Number:"})," ",a.documentNumber]}),a.expiryDate&&e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Expires:"})," ",new Date(a.expiryDate).toLocaleDateString()]})]})},ss=({onFileSelect:a,accept:t,disabled:s=!1})=>{const[r,n]=p.useState(!1),i=p.useRef(null),o=p.useCallback(l=>{l.preventDefault(),s||n(!0)},[s]),c=p.useCallback(l=>{l.preventDefault(),n(!1)},[]),u=p.useCallback(l=>{if(l.preventDefault(),n(!1),s)return;const h=l.dataTransfer.files;h.length>0&&a(h[0])},[a,s]),d=l=>{const h=l.target.files;h&&h.length>0&&a(h[0])};return e.jsxs("div",{className:`
        border-2 border-dashed rounded-lg p-6 text-center transition-colors
        ${r?"border-blue-400 bg-blue-50":"border-gray-300"}
        ${s?"opacity-50 cursor-not-allowed":"cursor-pointer hover:border-blue-400 hover:bg-blue-50"}
      `,onDragOver:o,onDragLeave:c,onDrop:u,onClick:()=>{var l;return!s&&((l=i.current)==null?void 0:l.click())},children:[e.jsx(us,{className:"h-8 w-8 text-muted-foreground mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Drop your file here"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"or click to browse your files"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supported formats: JPEG, PNG, PDF • Max size: 5MB"}),e.jsx("input",{ref:i,type:"file",accept:t,onChange:d,className:"hidden",disabled:s,title:"Select a file to upload",placeholder:"Choose a file"})]})},pn=({onNext:a,onPrevious:t})=>{const{verificationData:s,updateDocument:r,isLoading:n}=pe(),[i,o]=p.useState(null),c=()=>s?Xt.filter(x=>s.userRole==="renter"?x.required&&x.type!==Pe.VEHICLE_REGISTRATION&&x.type!==Pe.VEHICLE_OWNERSHIP:x.required):[],u=()=>s?Xt.filter(x=>s.userRole==="renter"?!x.required&&x.type!==Pe.VEHICLE_REGISTRATION&&x.type!==Pe.VEHICLE_OWNERSHIP:!x.required):[],d=c(),l=u(),h=(s==null?void 0:s.documents)||[],R=async(x,C)=>{try{o(C);const S=mn(x,C);if(!S.isValid){j.error(S.error);return}const M={type:C,file:x,fileName:x.name,fileSize:x.size,uploadedAt:new Date().toISOString(),status:G.COMPLETED};await r(M)}catch(S){console.error("Failed to upload document:",S),j.error("Failed to upload document")}finally{o(null)}},v=x=>{h.filter(S=>S.type!==x);const C={type:x,file:null,fileName:"",fileSize:0,uploadedAt:new Date().toISOString(),status:G.NOT_STARTED};r(C),j.success("Document removed")},T=()=>d.every(x=>h.some(C=>C.type===x.type&&C.status===G.COMPLETED)),N=()=>{const x=d.length,C=h.filter(S=>S.status===G.COMPLETED&&d.some(M=>M.type===S.type)).length;return{uploaded:C,total:x,percentage:x>0?C/x*100:0}},w=()=>{const x=l.length,C=h.filter(S=>S.status===G.COMPLETED&&l.some(M=>M.type===S.type)).length;return{uploaded:C,total:x,percentage:x>0?C/x*100:0}},m=N(),b=w();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Document Upload Progress"}),e.jsxs(X,{variant:"outline",children:[m.uploaded," of ",m.total," required documents"]})]})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Required Documents"}),e.jsxs("span",{children:[Math.round(m.percentage),"%"]})]}),e.jsx(pt,{value:m.percentage,className:"h-2"})]}),l.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Optional Documents (",b.uploaded," of"," ",b.total," uploaded)"]}),e.jsxs("span",{children:[Math.round(b.percentage),"%"]})]}),e.jsx(pt,{value:b.percentage,className:"h-2 opacity-60"})]})]})})]}),e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(J,{children:"Please upload clear, high-quality images or scans of your documents. Ensure all text is readable and the entire document is visible. Documents must be current and not expired."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(I,{className:"h-5 w-5 text-red-500"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Required Documents"}),e.jsx(X,{variant:"destructive",children:"Must Complete"})]}),d.map(x=>{const C=h.find(L=>L.type===x.type),S=(C==null?void 0:C.status)===G.COMPLETED,M=i===x.type;return e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-full ${S?"bg-green-100":"bg-gray-100"}`,children:S?e.jsx(F,{className:"h-5 w-5 text-green-600"}):e.jsx(oe,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:x.description}),x.botswanaSpecific&&e.jsx(X,{variant:"secondary",className:"mt-1",children:"Botswana Required"})]})]}),e.jsx(X,{variant:"destructive",children:"Required"})]})}),e.jsxs(U,{children:[S&&C?e.jsx(ts,{document:C,onRemove:()=>v(x.type)}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(ss,{onFileSelect:L=>R(L,x.type),accept:x.allowedFormats.join(","),disabled:M}),M&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploading..."})]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[e.jsx("p",{children:e.jsx("strong",{children:"Requirements:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsxs("li",{children:["Maximum file size: ",x.maxSizeMB,"MB"]}),e.jsxs("li",{children:["Formats:"," ",x.allowedFormats.map(L=>L.split("/")[1].toUpperCase()).join(", ")]}),e.jsx("li",{children:"Document must be clear and readable"}),x.type.includes("license")&&e.jsx("li",{children:"License must be valid and not expired"}),x.type.includes("proof_of_address")&&e.jsx("li",{children:"Document must be dated within the last 3 months"})]})]})]})]},x.type)})]}),l.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(oe,{className:"h-5 w-5 text-blue-500"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Optional Documents"}),e.jsx(X,{variant:"outline",children:"Helps with verification"})]}),e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(J,{children:"These documents are optional but can help speed up your verification process. You can upload them now or skip and continue to the next step."})]}),l.map(x=>{const C=h.find(L=>L.type===x.type),S=(C==null?void 0:C.status)===G.COMPLETED,M=i===x.type;return e.jsxs(Z,{className:"border-blue-200",children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-full ${S?"bg-blue-100":"bg-gray-100"}`,children:S?e.jsx(F,{className:"h-5 w-5 text-blue-600"}):e.jsx(oe,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:x.description}),x.botswanaSpecific&&e.jsx(X,{variant:"secondary",className:"mt-1",children:"Botswana Required"})]})]}),e.jsx(X,{variant:"outline",className:"text-blue-600 border-blue-200",children:"Optional"})]})}),e.jsxs(U,{children:[S&&C?e.jsx(ts,{document:C,onRemove:()=>v(x.type)}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(ss,{onFileSelect:L=>R(L,x.type),accept:x.allowedFormats.join(","),disabled:M}),M&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploading..."})]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[e.jsx("p",{children:e.jsx("strong",{children:"Requirements:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsxs("li",{children:["Maximum file size: ",x.maxSizeMB,"MB"]}),e.jsxs("li",{children:["Formats:"," ",x.allowedFormats.map(L=>L.split("/")[1].toUpperCase()).join(", ")]}),e.jsx("li",{children:"Document must be clear and readable"}),x.type.includes("license")&&e.jsx("li",{children:"License must be valid and not expired"}),x.type.includes("proof_of_address")&&e.jsx("li",{children:"Document must be dated within the last 3 months"})]})]})]})]},x.type)})]}),(s==null?void 0:s.userRole)==="host"&&e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"For car owners:"})," Vehicle registration and ownership documents are required to list cars on the platform. These documents help verify your legal right to rent out the vehicle."]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(O,{variant:"outline",onClick:t,className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[!T()&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Complete ",m.total-m.uploaded," more required document",m.total-m.uploaded===1?"":"s"," to continue"]}),e.jsxs(O,{onClick:a,disabled:!T()||n,className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Continue to Selfie Verification"}),e.jsx(ge,{className:"h-4 w-4"})]}),T()&&l.length>0&&e.jsx("p",{className:"text-xs text-muted-foreground text-right max-w-64",children:"You can continue now or upload optional documents above to help speed up verification"})]})]})]})},fn=({onCapture:a,onRetake:t,isCapturing:s,hasPhoto:r})=>e.jsx("div",{className:"flex justify-center space-x-4 mt-6",children:r?e.jsx("div",{className:"flex space-x-3",children:e.jsxs(O,{variant:"outline",onClick:t,className:"flex items-center space-x-2",children:[e.jsx(Fa,{className:"h-4 w-4"}),e.jsx("span",{children:"Retake"})]})}):e.jsxs(O,{onClick:a,disabled:s,size:"lg",className:"flex items-center space-x-2",children:[e.jsx(ft,{className:"h-5 w-5"}),e.jsx("span",{children:s?"Capturing...":"Take Selfie"})]})}),xn=()=>e.jsxs(Z,{className:"mb-6",children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2 text-lg",children:[e.jsx(Ye,{className:"h-5 w-5"}),e.jsx("span",{children:"Selfie Guidelines"})]})}),e.jsx(U,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-green-600 flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:"Do This"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(ht,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Look directly at the camera"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(Za,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Have a neutral expression"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Ensure good lighting on your face"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Remove sunglasses and hats"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Face the camera directly"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-red-600 flex items-center space-x-2",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:"Avoid This"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't cover your face"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't take photos in dark lighting"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't blur the image"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't include other people"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Don't tilt your head significantly"})]})]})]})]})})]}),gn=({onPhotoCapture:a,photoUrl:t,onRetake:s})=>{const r=p.useRef(null),n=p.useRef(null),[i,o]=p.useState(null),[c,u]=p.useState(!1),[d,l]=p.useState(!1),h=p.useCallback(async()=>{try{o(null);const N=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});r.current&&(r.current.srcObject=N,r.current.onloadedmetadata=()=>{l(!0)})}catch(N){console.error("Camera initialization error:",N),o("Unable to access camera. Please ensure camera permissions are granted.")}},[]),R=p.useCallback(()=>{var N;(N=r.current)!=null&&N.srcObject&&r.current.srcObject.getTracks().forEach(m=>m.stop())},[]),v=p.useCallback(async()=>{if(!(!r.current||!n.current||!d)){u(!0);try{const N=r.current,w=n.current,m=w.getContext("2d");if(!m)return;w.width=N.videoWidth,w.height=N.videoHeight,m.drawImage(N,0,0,w.width,w.height),w.toBlob(b=>{b&&(a(b),j.success("Selfie captured successfully!"))},"image/jpeg",.8)}catch(N){console.error("Photo capture error:",N),j.error("Failed to capture photo")}finally{u(!1)}}},[d,a]),T=p.useCallback(()=>{s(),d||h()},[s,d,h]);return p.useEffect(()=>(t||h(),R),[t,h,R]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden aspect-[4/3] max-w-md mx-auto",children:i?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-red-600 mb-4",children:i}),e.jsx(O,{onClick:h,size:"sm",children:"Try Again"})]})}):t?e.jsx("img",{src:t,alt:"Captured selfie",className:"w-full h-full object-cover"}):e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-48 h-48 border-2 border-white/50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-44 h-44 border border-white/30 rounded-full"})})}),e.jsx("div",{className:"absolute top-4 left-4 right-4",children:e.jsx("div",{className:"bg-black/50 text-white text-center py-2 px-4 rounded",children:e.jsx("p",{className:"text-sm",children:d?"Position your face in the circle":"Loading camera..."})})})]})})]})}),e.jsx("canvas",{ref:n,className:"hidden"}),e.jsx(fn,{onCapture:v,onRetake:T,isCapturing:c,hasPhoto:!!t})]})},yn=({onNext:a,onPrevious:t})=>{const{verificationData:s,completeSelfieVerification:r,isLoading:n}=pe(),[i,o]=p.useState(null),[c,u]=p.useState(null),[d,l]=p.useState(!1),h=p.useCallback(N=>{o(N);const w=URL.createObjectURL(N);u(w)},[]),R=p.useCallback(()=>{c&&URL.revokeObjectURL(c),o(null),u(null)},[c]),v=async()=>{if(!i){j.error("Please take a selfie first");return}try{l(!0),await r(),j.success("Selfie verification completed!"),setTimeout(()=>{a()},1e3)}catch(N){console.error("Failed to submit selfie:",N),j.error("Failed to submit selfie verification")}finally{l(!1)}};return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Take Your Verification Selfie"}),e.jsx("p",{className:"text-muted-foreground",children:"We need to verify that you're the same person as in your ID documents"})]}),e.jsx(xn,{}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Capture Your Selfie"}),c&&e.jsxs(X,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"Photo Captured"]})]})}),e.jsx(U,{children:e.jsx(gn,{onPhotoCapture:h,photoUrl:c,onRetake:R})})]}),e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"Privacy Notice:"})," Your selfie is used only for identity verification and is processed securely. We do not use your photo for any other purposes."]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(O,{variant:"outline",onClick:t,className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]}),e.jsxs(O,{onClick:v,disabled:!c||d||n,className:"flex items-center space-x-2",children:[e.jsx("span",{children:d?"Submitting...":"Continue to Phone Verification"}),e.jsx(ge,{className:"h-4 w-4"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Camera Not Supported"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Your browser doesn't support camera access. Please use a modern browser or upload a selfie manually."}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(O,{variant:"outline",onClick:t,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(O,{onClick:a,children:["Skip for Now",e.jsx(ge,{className:"h-4 w-4 ml-2"})]})]})]})},vn=({value:a,onChange:t,disabled:s=!1})=>{const r=p.useRef([]),[n,i]=p.useState(0),o=(d,l)=>{const h=l.replace(/\D/g,"").slice(-1),R=a.split("");R[d]=h;const v=R.join("");t(v),h&&d<5&&i(d+1)},c=(d,l)=>{if(l.key==="Backspace"){l.preventDefault();const h=a.split("");h[d]="",t(h.join("")),d>0&&!a[d]&&i(d-1)}else l.key==="ArrowLeft"&&d>0?i(d-1):l.key==="ArrowRight"&&d<5&&i(d+1)},u=d=>{d.preventDefault();const h=d.clipboardData.getData("text").replace(/\D/g,"").slice(0,6).split("");for(;h.length<6;)h.push("");t(h.join("")),i(Math.min(h.length,5))};return p.useEffect(()=>{var d;r.current[n]&&((d=r.current[n])==null||d.focus())},[n]),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6},(d,l)=>e.jsx(ee,{ref:h=>{r.current[l]=h},type:"text",inputMode:"numeric",maxLength:1,value:a[l]||"",onChange:h=>o(l,h.target.value),onKeyDown:h=>c(l,h),onPaste:u,onFocus:()=>i(l),disabled:s,className:`
            w-12 h-12 text-center text-lg font-medium
            ${a[l]?"border-green-500 bg-green-50":""}
            ${n===l?"ring-2 ring-primary":""}
          `},l))})},as=({initialSeconds:a,onComplete:t,isActive:s})=>{const[r,n]=p.useState(a);p.useEffect(()=>{if(s)if(r>0){const o=setTimeout(()=>n(r-1),1e3);return()=>clearTimeout(o)}else t()},[r,s,t]),p.useEffect(()=>{n(a)},[a]);const i=o=>{const c=Math.floor(o/60),u=o%60;return`${c}:${u.toString().padStart(2,"0")}`};return e.jsxs("span",{className:"flex items-center space-x-1 text-sm text-muted-foreground",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:i(r)})]})},jn=({onNext:a,onPrevious:t})=>{var Ne;const{verificationData:s,updatePhoneVerification:r,isLoading:n}=pe(),[i,o]=p.useState(""),[c,u]=p.useState(""),[d,l]=p.useState(!1),[h,R]=p.useState(!1),[v,T]=p.useState(!1),[N,w]=p.useState(0),[m,b]=p.useState(!1),[x,C]=p.useState(!1);p.useEffect(()=>{console.log("[PhoneVerificationStep] isOtpSent state changed:",d)},[d]),p.useEffect(()=>{if(n){const W=setTimeout(()=>{console.warn("[PhoneVerificationStep] Verification context loading timeout"),n&&j.warning("Database update taking longer than expected, continuing with verification")},1e4);return()=>clearTimeout(W)}},[n]),p.useEffect(()=>{var W;if(s!=null&&s.phoneVerification){const se=s.phoneVerification;se.phoneNumber&&o(se.phoneNumber),se.isVerified&&!d&&(console.log("[PhoneVerificationStep] Setting isOtpSent to true from verification data"),l(!0)),w(se.attemptCount||0)}(W=s==null?void 0:s.personalInfo)!=null&&W.phoneNumber&&!i&&o(s.personalInfo.phoneNumber)},[s]);const S=async()=>{if(!i){j.error("Please enter a valid phone number");return}console.log("[PhoneVerificationStep] Starting OTP send process for:",i);try{T(!0),await new Promise(ae=>setTimeout(ae,2e3));const W=Math.floor(1e5+Math.random()*9e5).toString();console.log(`[Development] OTP for ${i}: ${W}`),sessionStorage.setItem("dev_otp",W);const se={phoneNumber:i,countryCode:"+267",attemptCount:N+1,isVerified:!1};console.log("[PhoneVerificationStep] About to set isOtpSent to true"),l(!0),w(ae=>ae+1),b(!1),C(!1),console.log("[PhoneVerificationStep] State updated, now calling updatePhoneVerification with:",se);try{await r(se),console.log("[PhoneVerificationStep] updatePhoneVerification completed successfully")}catch(ae){console.warn("[PhoneVerificationStep] Database update failed, but continuing with OTP flow:",ae)}console.log("[PhoneVerificationStep] OTP flow completed, isOtpSent should be:",!0),j.success("Verification code sent to your phone")}catch(W){console.error("Failed to send OTP:",W),j.error("Failed to send verification code")}finally{T(!1)}},M=async()=>{if(c.length!==6){j.error("Please enter the complete 6-digit code");return}try{R(!0),await new Promise(ae=>setTimeout(ae,1500));const W=sessionStorage.getItem("dev_otp");c===W?(await r({phoneNumber:i,countryCode:"+267",verificationCode:c,isVerified:!0,attemptCount:N}),j.success("Phone number verified successfully!"),sessionStorage.removeItem("dev_otp"),setTimeout(()=>{a()},1e3)):(j.error("Invalid verification code. Please try again."),u(""))}catch(W){console.error("Failed to verify OTP:",W),j.error("Failed to verify code")}finally{R(!1)}},L=()=>{C(!0),b(!0),j.error("Verification code expired. Please request a new one.")},Y=()=>{b(!0)},ke=()=>{u(""),C(!1),S()};return((Ne=s==null?void 0:s.phoneVerification)==null?void 0:Ne.isVerified)?e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(F,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-700 mb-2",children:"Phone Verified!"}),e.jsxs("p",{className:"text-muted-foreground",children:["Your phone number ",s.phoneVerification.phoneNumber," ","has been verified."]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(O,{variant:"outline",onClick:t,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(O,{onClick:a,children:["Continue to Address Confirmation",e.jsx(ge,{className:"h-4 w-4 ml-2"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Verify Your Phone Number"}),e.jsx("p",{className:"text-muted-foreground",children:"We'll send a verification code to confirm your phone number"})]}),!d&&e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),e.jsx("span",{children:"Phone Number"})]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"phoneNumber",children:"Botswana Mobile Number"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm",children:"+267"}),e.jsx(ee,{id:"phoneNumber",type:"tel",placeholder:"Enter your mobile number",value:i.replace("+267",""),onChange:W=>o(`+267${W.target.value.replace(/\D/g,"")}`),className:"rounded-l-none",maxLength:8})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: +267XXXXXXXX (8 digits after country code)"})]}),e.jsxs(O,{onClick:S,disabled:!i||i.length!==12||v,className:"w-full flex items-center space-x-2",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx("span",{children:v?"Sending...":"Send Verification Code"})]}),!1]})]}),d&&e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Yt,{className:"h-5 w-5"}),e.jsx("span",{children:"Enter Verification Code"})]}),N>0&&e.jsxs(X,{variant:"outline",children:["Attempt ",N]})]})}),e.jsxs(U,{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["We sent a 6-digit code to ",e.jsx("strong",{children:i})]}),e.jsx(vn,{value:c,onChange:u,disabled:h||x})]}),e.jsxs("div",{className:"text-center space-y-3",children:[!x&&e.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Code expires in:"}),e.jsx(as,{initialSeconds:300,onComplete:L,isActive:d&&!x})]}),x&&e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(J,{children:"Verification code expired. Please request a new one."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(O,{onClick:M,disabled:c.length!==6||h||x,className:"w-full flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:h?"Verifying...":"Verify Code"})]}),e.jsx("div",{className:"text-center",children:m?e.jsxs(O,{variant:"ghost",onClick:ke,disabled:v,className:"text-sm",children:[e.jsx(Aa,{className:"h-4 w-4 mr-2"}),v?"Sending...":"Resend Code"]}):e.jsxs("div",{className:"flex justify-center items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:"Resend available in:"}),e.jsx(as,{initialSeconds:60,onComplete:Y,isActive:!m})]})})]})]})]}),!1,e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(J,{children:"We'll only use your phone number for verification and important account notifications. Standard SMS rates may apply."})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(O,{variant:"outline",onClick:t,className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]}),!1]})]})};var Bt="Radio",[Nn,Qs]=Lt(Bt),[bn,_n]=Nn(Bt),ea=p.forwardRef((a,t)=>{const{__scopeRadio:s,name:r,checked:n=!1,required:i,disabled:o,value:c="on",onCheck:u,form:d,...l}=a,[h,R]=p.useState(null),v=_t(t,w=>R(w)),T=p.useRef(!1),N=h?d||!!h.closest("form"):!0;return e.jsxs(bn,{scope:s,checked:n,disabled:o,children:[e.jsx(Ut.button,{type:"button",role:"radio","aria-checked":n,"data-state":aa(n),"data-disabled":o?"":void 0,disabled:o,value:c,...l,ref:v,onClick:mt(a.onClick,w=>{n||u==null||u(),N&&(T.current=w.isPropagationStopped(),T.current||w.stopPropagation())})}),N&&e.jsx(wn,{control:h,bubbles:!T.current,name:r,value:c,checked:n,required:i,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});ea.displayName=Bt;var ta="RadioIndicator",sa=p.forwardRef((a,t)=>{const{__scopeRadio:s,forceMount:r,...n}=a,i=_n(ta,s);return e.jsx(_a,{present:r||i.checked,children:e.jsx(Ut.span,{"data-state":aa(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:t})})});sa.displayName=ta;var wn=a=>{const{control:t,checked:s,bubbles:r=!0,...n}=a,i=p.useRef(null),o=wa(s),c=Ca(t);return p.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(o!==s&&h){const R=new Event("click",{bubbles:r});h.call(u,s),u.dispatchEvent(R)}},[o,s,r]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:i,style:{...a.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function aa(a){return a?"checked":"unchecked"}var Cn=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Gt="RadioGroup",[Sn,xi]=Lt(Gt,[cs,Qs]),ra=cs(),na=Qs(),[kn,Tn]=Sn(Gt),ia=p.forwardRef((a,t)=>{const{__scopeRadioGroup:s,name:r,defaultValue:n,value:i,required:o=!1,disabled:c=!1,orientation:u,dir:d,loop:l=!0,onValueChange:h,...R}=a,v=ra(s),T=Sa(d),[N,w]=ka({prop:i,defaultProp:n,onChange:h});return e.jsx(kn,{scope:s,name:r,required:o,disabled:c,value:N,onValueChange:w,children:e.jsx(Ta,{asChild:!0,...v,orientation:u,dir:T,loop:l,children:e.jsx(Ut.div,{role:"radiogroup","aria-required":o,"aria-orientation":u,"data-disabled":c?"":void 0,dir:T,...R,ref:t})})})});ia.displayName=Gt;var oa="RadioGroupItem",ca=p.forwardRef((a,t)=>{const{__scopeRadioGroup:s,disabled:r,...n}=a,i=Tn(oa,s),o=i.disabled||r,c=ra(s),u=na(s),d=p.useRef(null),l=_t(t,d),h=i.value===n.value,R=p.useRef(!1);return p.useEffect(()=>{const v=N=>{Cn.includes(N.key)&&(R.current=!0)},T=()=>R.current=!1;return document.addEventListener("keydown",v),document.addEventListener("keyup",T),()=>{document.removeEventListener("keydown",v),document.removeEventListener("keyup",T)}},[]),e.jsx(Ea,{asChild:!0,...c,focusable:!o,active:h,children:e.jsx(ea,{disabled:o,required:i.required,checked:h,...u,...n,name:i.name,ref:l,onCheck:()=>i.onValueChange(n.value),onKeyDown:mt(v=>{v.key==="Enter"&&v.preventDefault()}),onFocus:mt(n.onFocus,()=>{var v;R.current&&((v=d.current)==null||v.click())})})})});ca.displayName=oa;var En="RadioGroupIndicator",la=p.forwardRef((a,t)=>{const{__scopeRadioGroup:s,...r}=a,n=na(s);return e.jsx(sa,{...n,...r,ref:t})});la.displayName=En;var da=ia,ua=ca,Dn=la;const ma=p.forwardRef(({className:a,...t},s)=>e.jsx(da,{className:he("grid gap-2",a),...t,ref:s}));ma.displayName=da.displayName;const ha=p.forwardRef(({className:a,...t},s)=>e.jsx(ua,{ref:s,className:he("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...t,children:e.jsx(Dn,{className:"flex items-center justify-center",children:e.jsx(Oa,{className:"h-2.5 w-2.5 fill-current text-current"})})}));ha.displayName=ua.displayName;const rs=({address:a,title:t})=>a?e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:t}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{children:a.street}),e.jsx("p",{children:a.area}),e.jsxs("p",{children:[a.city,a.postalCode?`, ${a.postalCode}`:""]}),e.jsx("p",{className:"text-muted-foreground",children:"Botswana"})]})]}):null,Tt=({value:a,label:t,description:s,icon:r,isAvailable:n,isSelected:i,onSelect:o})=>{const c=()=>{n&&o(a)};return e.jsx("div",{className:`
      relative border rounded-lg p-4 transition-all
      ${i?"border-primary bg-primary/5":"border-gray-200"}
      ${n?"cursor-pointer hover:border-primary/50":"opacity-50 cursor-not-allowed"}
    `,onClick:c,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ha,{value:a,disabled:!n}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[r,e.jsx("h4",{className:"font-medium",children:t}),!n&&e.jsx(X,{variant:"outline",className:"text-xs",children:"Not Available"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})]})})},Rn=()=>{const{updateDocument:a}=pe(),t=p.useRef(null),[s,r]=p.useState(null),[n,i]=p.useState(!1),o=d=>{var h;const l=(h=d.target.files)==null?void 0:h[0];l&&r(l)},c=async()=>{if(!s)return;const d=10*1024*1024,l=["image/jpeg","image/png","image/jpg","application/pdf"];if(s.size>d){j.error("File size must be less than 10MB");return}if(!l.includes(s.type)){j.error("File must be a JPEG, PNG, or PDF");return}try{i(!0);const h={type:Pe.PROOF_OF_ADDRESS,file:s,fileName:s.name,fileSize:s.size,uploadedAt:new Date().toISOString(),status:G.PENDING_REVIEW};await a(h),j.success("Proof of address uploaded successfully!"),r(null),t.current&&(t.current.value="")}catch(h){console.error("Failed to upload document:",h),j.error("Failed to upload document")}finally{i(!1)}},u=()=>{r(null),t.current&&(t.current.value="")};return e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"h-5 w-5"}),e.jsx("span",{children:"Upload Proof of Address"})]})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(H,{htmlFor:"proof-address-upload",className:"text-sm font-medium",children:"Select Document"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Upload a utility bill, bank statement, or other proof of address (JPEG, PNG, PDF)"}),e.jsx(ee,{id:"proof-address-upload",ref:t,type:"file",accept:".jpg,.jpeg,.png,.pdf",onChange:o,className:"cursor-pointer"})]}),s&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:s.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",(s.size/1024/1024).toFixed(1)," MB)"]})]}),e.jsx(O,{variant:"ghost",size:"sm",onClick:u,disabled:n,children:e.jsx(Zt,{className:"h-4 w-4"})})]}),e.jsx(O,{onClick:c,disabled:!s||n,className:"w-full",children:n?"Uploading...":"Upload Document"})]})})]})},An=({onNext:a,onPrevious:t})=>{var v,T;const{verificationData:s,updateAddressConfirmation:r,isLoading:n}=pe(),[i,o]=p.useState(""),[c,u]=p.useState(!1);p.useEffect(()=>{if(s!=null&&s.addressConfirmation){const N=s.addressConfirmation;N.confirmationMethod&&o(N.confirmationMethod)}},[s==null?void 0:s.addressConfirmation]);const l=(()=>{if(!(s!=null&&s.documents))return{document:!1,utility_bill:!1,bank_statement:!1};const w=s.documents.some(m=>m.type==="proof_of_address"&&(m.status==="completed"||m.status==="pending_review"||m.status==="in_progress"));return{document:w,utility_bill:w,bank_statement:w}})(),h=async()=>{var N;if(!i){j.error("Please select a confirmation method");return}if(!((N=s==null?void 0:s.personalInfo)!=null&&N.address)){j.error("No address information found");return}try{u(!0),await new Promise(m=>setTimeout(m,2e3));const w={currentAddress:s.personalInfo.address,confirmationMethod:i,isConfirmed:!0,confirmationDate:new Date().toISOString()};await r(w),j.success("Address confirmed successfully!"),setTimeout(()=>{a()},1e3)}catch(w){console.error("Failed to confirm address:",w),j.error("Failed to confirm address")}finally{u(!1)}};return((v=s==null?void 0:s.addressConfirmation)==null?void 0:v.isConfirmed)?e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(F,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-700 mb-2",children:"Address Confirmed!"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Your residential address has been verified."}),e.jsx(rs,{address:s.addressConfirmation.currentAddress,title:"Confirmed Address"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(O,{variant:"outline",onClick:t,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Previous"]}),e.jsxs(O,{onClick:a,children:["Continue to Review",e.jsx(ge,{className:"h-4 w-4 ml-2"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Confirm Your Address"}),e.jsx("p",{className:"text-muted-foreground",children:"We need to verify your residential address matches your documents"})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(He,{className:"h-5 w-5"}),e.jsx("span",{children:"Address to Confirm"})]})}),e.jsx(U,{children:(T=s==null?void 0:s.personalInfo)!=null&&T.address?e.jsx(rs,{address:s.personalInfo.address,title:"Personal Information Address"}):e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(J,{children:"No address information found. Please complete the personal information step first."})]})})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsx(z,{children:"Select Confirmation Method"})}),e.jsxs(U,{children:[e.jsx(ma,{value:i,onValueChange:N=>o(N),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Tt,{value:"utility_bill",label:"Utility Bill Verification",description:"Confirm address using uploaded utility bill (electricity, water, internet)",icon:e.jsx($a,{className:"h-5 w-5 text-blue-500"}),isAvailable:l.utility_bill,isSelected:i==="utility_bill",onSelect:o}),e.jsx(Tt,{value:"bank_statement",label:"Bank Statement Verification",description:"Confirm address using uploaded bank statement",icon:e.jsx(ds,{className:"h-5 w-5 text-green-500"}),isAvailable:l.bank_statement,isSelected:i==="bank_statement",onSelect:o}),e.jsx(Tt,{value:"document",label:"Document-Based Verification",description:"Confirm address using other uploaded proof of address documents",icon:e.jsx(oe,{className:"h-5 w-5 text-purple-500"}),isAvailable:l.document,isSelected:i==="document",onSelect:o})]})}),!Object.values(l).some(Boolean)&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(J,{children:"No proof of address document found. Please upload a valid proof of address document below or return to the previous step."})]}),e.jsx(Rn,{})]})]})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsx(z,{children:"Verification Requirements"})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(F,{className:"h-5 w-5 text-green-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Document Date"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Proof of address must be dated within the last 3 months"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(F,{className:"h-5 w-5 text-green-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Address Match"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Address on document must exactly match your provided address"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(F,{className:"h-5 w-5 text-green-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Document Validity"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Document must be from a recognized Botswana utility company or bank"})]})]})]})})]}),e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"Privacy Notice:"})," Your address information is used only for verification and account security purposes. We do not share your address with third parties."]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(O,{variant:"outline",onClick:t,className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]}),e.jsxs(O,{onClick:h,disabled:!i||c||n||!Object.values(l).some(Boolean),className:"flex items-center space-x-2",children:[e.jsx("span",{children:c?"Confirming...":"Confirm Address"}),e.jsx(ge,{className:"h-4 w-4"})]})]})]})},Ge=({title:a,icon:t,isCompleted:s,children:r})=>e.jsxs(Z,{className:`${s?"border-green-200 bg-green-50":"border-orange-200 bg-orange-50"}`,children:[e.jsx($,{className:"pb-3",children:e.jsxs(z,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[t,e.jsx("span",{className:s?"text-gray-900":"",children:a})]}),e.jsx(X,{variant:s?"secondary":"destructive",className:s?"bg-green-100 text-green-700":"",children:s?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"Complete"]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),"Incomplete"]})})]})}),e.jsx(U,{className:`pt-0 ${s?"text-gray-900":""}`,children:r})]}),In=({personalInfo:a})=>a?e.jsxs("div",{className:"space-y-2 text-sm text-gray-900",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Full Name"}),e.jsx("p",{children:a.fullName||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Date of Birth"}),e.jsx("p",{children:a.dateOfBirth?new Date(a.dateOfBirth).toLocaleDateString():"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"National ID"}),e.jsx("p",{children:a.nationalIdNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Phone Number"}),e.jsx("p",{children:a.phoneNumber||"Not provided"})]})]}),a.address&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"font-medium",children:"Address"}),e.jsxs("p",{children:[a.address.street,", ",a.address.area,","," ",a.address.city,a.address.postalCode&&`, ${a.address.postalCode}`]})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No personal information provided"}),On=({documents:a})=>{const t=r=>r.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),s=a.filter(r=>r.status===G.COMPLETED);return s.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No documents uploaded"}):e.jsx("div",{className:"space-y-2 text-gray-900",children:s.map((r,n)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-b-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm",children:t(r.type)})]}),e.jsxs(X,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"Uploaded"]})]},n))})},Pn=({onNext:a,onPrevious:t})=>{var N;const{verificationData:s,submitForReview:r,isLoading:n,navigateToStep:i}=pe(),[o,c]=p.useState(!1),[u,d]=p.useState(!1),[l,h]=p.useState(!1);if(!s)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No verification data found"})]});const v=(()=>{var S,M,L,Y,ke,Re,Ne,W,se,ae;const w=!!((S=s.personalInfo)!=null&&S.fullName&&((M=s.personalInfo)!=null&&M.dateOfBirth)&&((L=s.personalInfo)!=null&&L.nationalIdNumber)&&((Y=s.personalInfo)!=null&&Y.phoneNumber)&&((ke=s.personalInfo)!=null&&ke.email)&&((Re=s.personalInfo)!=null&&Re.address)),m=((Ne=s.stepStatuses)==null?void 0:Ne.document_upload)===G.COMPLETED,b=((W=s.stepStatuses)==null?void 0:W.selfie_verification)===G.COMPLETED,x=((se=s.stepStatuses)==null?void 0:se.phone_verification)===G.COMPLETED,C=((ae=s.stepStatuses)==null?void 0:ae.address_confirmation)===G.COMPLETED;return{personalInfoComplete:w,documentsComplete:m,selfieComplete:b,phoneComplete:x,addressComplete:C,allComplete:w&&m&&b&&x&&C}})(),T=async()=>{if(!o||!u){j.error("Please accept the terms and conditions and data consent");return}if(!v.allComplete){j.error("Please complete all verification steps before submitting");return}try{h(!0),console.log("[ReviewSubmitStep] Submitting verification for review..."),await r(),console.log("[ReviewSubmitStep] Verification submitted successfully"),j.success("Verification submitted successfully!"),await new Promise(w=>setTimeout(w,1e3)),console.log("[ReviewSubmitStep] Navigating to processing status...");try{i(re.PROCESSING_STATUS),a()}catch(w){console.warn("[ReviewSubmitStep] Navigation failed, using fallback:",w),a()}}catch(w){console.error("[ReviewSubmitStep] Failed to submit verification:",w),j.error("Failed to submit verification. Please try again.")}finally{h(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Review & Submit"}),e.jsx("p",{className:"text-muted-foreground",children:"Please review all your information before final submission"})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Verification Summary"}),e.jsx(X,{variant:v.allComplete?"secondary":"destructive",className:v.allComplete?"bg-green-100 text-green-700":"",children:v.allComplete?"Ready to Submit":"Incomplete"})]})}),e.jsx(U,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-center",children:[e.jsxs("div",{className:`p-3 rounded-lg ${v.personalInfoComplete?"bg-green-100":"bg-gray-100"}`,children:[e.jsx(Ye,{className:`h-6 w-6 mx-auto mb-1 ${v.personalInfoComplete?"text-green-600":"text-gray-400"}`}),e.jsx("p",{className:"text-xs font-medium",children:"Personal Info"})]}),e.jsxs("div",{className:`p-3 rounded-lg ${v.documentsComplete?"bg-green-100":"bg-gray-100"}`,children:[e.jsx(oe,{className:`h-6 w-6 mx-auto mb-1 ${v.documentsComplete?"text-green-600":"text-gray-400"}`}),e.jsx("p",{className:"text-xs font-medium",children:"Documents"})]}),e.jsxs("div",{className:`p-3 rounded-lg ${v.selfieComplete?"bg-green-100":"bg-gray-100"}`,children:[e.jsx(ft,{className:`h-6 w-6 mx-auto mb-1 ${v.selfieComplete?"text-green-600":"text-gray-400"}`}),e.jsx("p",{className:"text-xs font-medium",children:"Selfie"})]}),e.jsxs("div",{className:`p-3 rounded-lg ${v.phoneComplete?"bg-green-100":"bg-gray-100"}`,children:[e.jsx(Fe,{className:`h-6 w-6 mx-auto mb-1 ${v.phoneComplete?"text-green-600":"text-gray-400"}`}),e.jsx("p",{className:"text-xs font-medium",children:"Phone"})]}),e.jsxs("div",{className:`p-3 rounded-lg ${v.addressComplete?"bg-green-100":"bg-gray-100"}`,children:[e.jsx(He,{className:`h-6 w-6 mx-auto mb-1 ${v.addressComplete?"text-green-600":"text-gray-400"}`}),e.jsx("p",{className:"text-xs font-medium",children:"Address"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ge,{title:"Personal Information",icon:e.jsx(Ye,{className:"h-5 w-5"}),isCompleted:v.personalInfoComplete,children:e.jsx(In,{personalInfo:s.personalInfo})}),e.jsx(Ge,{title:"Document Uploads",icon:e.jsx(oe,{className:"h-5 w-5"}),isCompleted:v.documentsComplete,children:e.jsx(On,{documents:s.documents||[]})}),e.jsx(Ge,{title:"Selfie Verification",icon:e.jsx(ft,{className:"h-5 w-5"}),isCompleted:v.selfieComplete,children:e.jsx("p",{className:"text-sm text-muted-foreground",children:v.selfieComplete?"Selfie verification completed successfully":"Selfie verification not completed"})}),e.jsx(Ge,{title:"Phone Verification",icon:e.jsx(Fe,{className:"h-5 w-5"}),isCompleted:v.phoneComplete,children:e.jsx("p",{className:"text-sm",children:(N=s.phoneVerification)!=null&&N.phoneNumber?`Verified: ${s.phoneVerification.phoneNumber}`:"Phone number not verified"})}),e.jsx(Ge,{title:"Address Confirmation",icon:e.jsx(He,{className:"h-5 w-5"}),isCompleted:v.addressComplete,children:e.jsx("p",{className:"text-sm text-muted-foreground",children:v.addressComplete?"Address confirmed and verified":"Address confirmation not completed"})})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(ze,{className:"h-5 w-5"}),e.jsx("span",{children:"Terms & Consent"})]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ht,{id:"terms",checked:o,onCheckedChange:w=>c(w===!0)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(H,{htmlFor:"terms",className:"text-sm font-medium cursor-pointer",children:"I accept the Terms and Conditions"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["By checking this box, you agree to MobiRides' Terms of Service and User Agreement.",e.jsxs(O,{variant:"link",className:"h-auto p-0 text-xs ml-1",children:[e.jsx(ht,{className:"h-3 w-3 mr-1"}),"Read Terms"]})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ht,{id:"consent",checked:u,onCheckedChange:w=>d(w===!0)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(H,{htmlFor:"consent",className:"text-sm font-medium cursor-pointer",children:"I consent to data processing for verification"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["You consent to the processing of your personal data for identity verification purposes.",e.jsxs(O,{variant:"link",className:"h-auto p-0 text-xs ml-1",children:[e.jsx(ht,{className:"h-3 w-3 mr-1"}),"Privacy Policy"]})]})]})]})]})]}),!v.allComplete&&e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"Incomplete Verification:"})," Please complete all verification steps before submitting. Use the navigation above to go back to incomplete sections."]})]}),e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"Final Submission:"})," Once submitted, your verification will be reviewed by our team. This process typically takes 1-3 business days. You'll receive email notifications about the status."]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsxs(O,{variant:"outline",onClick:t,className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]}),e.jsxs(O,{onClick:T,disabled:!v.allComplete||!o||!u||l||n,className:"flex items-center space-x-2 bg-green-600 hover:bg-green-700",children:[e.jsx(Ia,{className:"h-4 w-4"}),e.jsx("span",{children:l?"Submitting...":"Submit for Review"})]})]})]})},Vn=({title:a,description:t,icon:s,status:r,estimatedTime:n})=>{const i=()=>{switch(r){case"completed":return"text-green-600";case"in_progress":return"text-blue-600";default:return"text-gray-400"}},o=()=>{switch(r){case"completed":return e.jsxs(X,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"Complete"]});case"in_progress":return e.jsxs(X,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(qe,{className:"h-3 w-3 mr-1"}),"Processing"]});default:return e.jsx(X,{variant:"outline",children:"Pending"})}};return e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${r==="completed"?"bg-green-100":r==="in_progress"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx("div",{className:i(),children:s})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium",children:a}),o()]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:t}),r==="in_progress"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm text-blue-600",children:"Processing..."})]}),n&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Estimated time: ",n]})]})]})]})},Mn=({onNext:a})=>{Mt();const{verificationData:t,refreshData:s}=pe(),[r,n]=p.useState(25),[i,o]=p.useState(0);p.useState(!1);const c=[{title:"Document Review",description:"Our team is reviewing your uploaded documents for authenticity and completeness",icon:e.jsx(Ma,{className:"h-5 w-5"}),estimatedTime:"2-4 hours"},{title:"Identity Verification",description:"Verifying your identity against official databases and cross-referencing documents",icon:e.jsx(Ua,{className:"h-5 w-5"}),estimatedTime:"4-8 hours"},{title:"Address Confirmation",description:"Confirming your residential address and proof of address documents",icon:e.jsx(ht,{className:"h-5 w-5"}),estimatedTime:"1-2 hours"},{title:"Final Approval",description:"Final review and approval of your verification application",icon:e.jsx(ze,{className:"h-5 w-5"}),estimatedTime:"30 minutes"}];p.useEffect(()=>{const T=setInterval(()=>{n(N=>{const w=Math.min(N+8,100);return w>=25&&i<1&&o(1),w>=50&&i<2&&o(2),w>=75&&i<3&&o(3),w})},2e3);return()=>clearInterval(T)},[i]),p.useEffect(()=>{if(r>=100){const T=setTimeout(()=>{console.log("[ProcessingStatusStep] Auto-advancing to completion step"),a()},3e3);return()=>clearTimeout(T)}},[r,a]),p.useEffect(()=>{const T=setInterval(()=>{s()},1e4);return()=>clearInterval(T)},[s]);const u=T=>T<i?"completed":T===i?"in_progress":"pending",d=()=>{const T=new Date,N=Math.max(1,Math.ceil((100-r)/10));return new Date(T.getTime()+N*60*60*1e3).toLocaleString("en-BW",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},l=(t==null?void 0:t.overallStatus)===G.COMPLETED,[h]=Oe.useState(Date.now()),[R,v]=Oe.useState(!1);return Oe.useEffect(()=>{const T=setInterval(()=>{Date.now()-h>36e5&&v(!0)},6e4);return()=>clearInterval(T)},[h]),l?(Oe.useEffect(()=>{const T=setTimeout(()=>{console.log("[ProcessingStatusStep] Verification already complete, advancing"),a()},1e3);return()=>clearTimeout(T)},[a]),e.jsxs("div",{className:"text-center p-8",children:[e.jsx(F,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-700 mb-2",children:"Verification Complete!"}),e.jsx("p",{className:"text-muted-foreground",children:"Redirecting to completion step..."})]})):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Verification in Progress"}),e.jsx("p",{className:"text-muted-foreground",children:"Your verification is being processed by our team"})]}),R&&e.jsxs("div",{className:"p-4 bg-yellow-100 border border-yellow-300 rounded text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," Verification processing is taking longer than usual. If you have any concerns, please contact our support team with your reference number."]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Overall Progress"}),e.jsxs(X,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(qe,{className:"h-3 w-3 mr-1"}),"Processing"]})]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Verification Progress"}),e.jsxs("span",{children:[r,"%"]})]}),e.jsx(pt,{value:r,className:"h-3"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Estimated Completion"}),e.jsx("p",{className:"text-muted-foreground",children:d()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Reference Number"}),e.jsx("p",{className:"text-muted-foreground font-mono",children:t!=null&&t.userId?`VER-${t.userId.slice(-8).toUpperCase()}`:"Generating..."})]})]})]})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsx(z,{children:"Processing Stages"})}),e.jsx(U,{children:e.jsx("div",{className:"space-y-4",children:c.map((T,N)=>e.jsx(Vn,{title:T.title,description:T.description,icon:T.icon,status:u(N),estimatedTime:u(N)==="in_progress"?T.estimatedTime:void 0},N))})})]}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(Ft,{className:"h-5 w-5"}),e.jsx("span",{children:"Status Updates"})]})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(F,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-700",children:"Verification Submitted"}),e.jsx("p",{className:"text-sm text-green-600",children:t!=null&&t.startedAt?new Date(t.startedAt).toLocaleString():"Just now"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(qe,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-700",children:"Review in Progress"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Our verification team is currently reviewing your documents"})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"What happens next?"})," You'll receive email notifications for any status updates. You can close this page and return anytime to check progress."]})]}),e.jsxs(q,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"Need help?"})," If you have questions about your verification, contact our support team with your reference number."]})]})]}),!1]})},Ln=({verificationData:a})=>{const t=a!=null&&a.userId?`VER-${a.userId.slice(-8).toUpperCase()}`:"Unknown",s=a!=null&&a.completedAt?new Date(a.completedAt).toLocaleDateString():new Date().toLocaleDateString(),r=()=>{navigator.clipboard.writeText(t),j.success("Verification ID copied to clipboard")};return e.jsxs(Z,{className:"border-green-200 bg-green-50",children:[e.jsxs($,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"h-16 w-16 text-green-600 mx-auto"}),e.jsx(F,{className:"h-6 w-6 text-green-600 absolute -bottom-1 -right-1 bg-white rounded-full"})]})}),e.jsx(z,{className:"text-green-700",children:"Verification Complete!"})]}),e.jsx(U,{className:"space-y-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs(X,{variant:"secondary",className:"bg-green-100 text-green-700 mb-4",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"Verified User"]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Verification ID"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("code",{className:"text-green-600 font-mono",children:t}),e.jsx(O,{variant:"ghost",size:"icon",onClick:r,className:"h-6 w-6",children:e.jsx(Pa,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Completion Date"}),e.jsx("p",{className:"text-green-600",children:s})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"User Role"}),e.jsx("p",{className:"text-green-600 capitalize",children:(a==null?void 0:a.userRole)||"Renter"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-600",children:"Status"}),e.jsx("p",{className:"text-green-600",children:"Active"})]})]})]})]})})]})},Fn=({userRole:a})=>{const t=wt(),n=a==="host"?[{title:"Add Your First Car",description:"List your vehicle and start earning",icon:e.jsx(qt,{className:"h-5 w-5 text-blue-500"}),action:()=>t("/add-car"),buttonText:"Add Car"},{title:"Set Up Hosting Profile",description:"Complete your hosting profile and preferences",icon:e.jsx(Rt,{className:"h-5 w-5 text-purple-500"}),action:()=>t("/profile"),buttonText:"Setup Profile"},{title:"View Dashboard",description:"Monitor your bookings and earnings",icon:e.jsx(ms,{className:"h-5 w-5 text-orange-500"}),action:()=>t("/dashboard"),buttonText:"Open Dashboard"}]:[{title:"Browse Available Cars",description:"Explore cars available for rent in your area",icon:e.jsx(qt,{className:"h-5 w-5 text-blue-500"}),action:()=>t("/"),buttonText:"Browse Cars"},{title:"Complete Your Profile",description:"Add a profile photo and additional details",icon:e.jsx(Rt,{className:"h-5 w-5 text-purple-500"}),action:()=>t("/profile"),buttonText:"Edit Profile"},{title:"Make Your First Booking",description:"Find and book your first rental car",icon:e.jsx(ls,{className:"h-5 w-5 text-green-500"}),action:()=>t("/"),buttonText:"Start Booking"}];return e.jsxs(Z,{children:[e.jsx($,{children:e.jsx(z,{children:"What's Next?"})}),e.jsx(U,{children:e.jsx("div",{className:"space-y-4",children:n.map((i,o)=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:i.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium mb-1",children:i.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:i.description}),e.jsxs(O,{onClick:i.action,size:"sm",className:"flex items-center space-x-2",children:[e.jsx("span",{children:i.buttonText}),e.jsx(ge,{className:"h-3 w-3"})]})]})]},o))})})]})},Zn=()=>{const{verificationData:a}=pe(),t=wt();if(Oe.useEffect(()=>{Et();const n=sessionStorage.getItem("verification_return_context");if(n)try{const i=JSON.parse(n);console.log("[CompletionStep] Found return context:",i),sessionStorage.removeItem("verification_return_context"),setTimeout(()=>{if(i.action==="booking"&&i.carData){const o=i.carData.id||i.carData.car_id;t(`/cars/${o}`),j.success("Verification complete! You can now book this car.")}else i.action==="listing"?(t("/add-car"),j.success("Verification complete! You can now list your vehicle.")):t("/")},3e3)}catch(i){console.error("[CompletionStep] Failed to parse return context:",i)}},[t]),!a)return e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No verification data found"})});const s=()=>{a.userRole==="host"?t("/dashboard"):t("/")},r=()=>{j.success("Certificate download started (Feature coming soon)")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"mx-auto mb-6",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"animate-bounce",children:e.jsx(F,{className:"h-20 w-20 text-green-500 mx-auto"})})})}),e.jsx("h1",{className:"text-3xl font-bold text-green-700 mb-2",children:"🎉 Verification Complete!"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Welcome to MobiRides! Your identity has been successfully verified."})]}),e.jsx(Ln,{verificationData:a}),e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(ms,{className:"h-5 w-5 text-orange-500"}),e.jsx("span",{children:"Your Verification Benefits"})]})}),e.jsx(U,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Trusted Member Badge"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show other users you're verified"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Full Platform Access"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Book cars and access all features"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Priority Support"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get faster help when needed"})]})]}),a.userRole==="host"&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Host Privileges"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"List cars and start earning"})]})]})]})]})})]}),e.jsx(Fn,{userRole:a.userRole}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(q,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"Email Confirmation:"})," A verification certificate has been sent to your email address. Keep this for your records."]})]}),e.jsxs(q,{children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsx("strong",{children:"Security Notice:"})," Your verification is valid indefinitely. Contact support if you need to update any verified information."]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[e.jsxs(O,{onClick:r,variant:"outline",className:"flex items-center space-x-2 flex-1",children:[e.jsx(Va,{className:"h-4 w-4"}),e.jsx("span",{children:"Download Certificate"})]}),e.jsxs(O,{onClick:s,className:"flex items-center space-x-2 flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx("span",{children:a.userRole==="host"?"Go to Dashboard":"Start Using MobiRides"}),e.jsx(ge,{className:"h-4 w-4"})]})]}),!1]})},Vt={[re.PERSONAL_INFO]:{title:"Personal Information",description:"Provide your basic details",icon:Ye,component:hn},[re.DOCUMENT_UPLOAD]:{title:"Document Upload",description:"Upload required documents",icon:oe,component:pn},[re.SELFIE_VERIFICATION]:{title:"Selfie Verification",description:"Take a verification selfie",icon:ft,component:yn},[re.PHONE_VERIFICATION]:{title:"Phone Verification",description:"Verify your phone number",icon:Fe,component:jn},[re.ADDRESS_CONFIRMATION]:{title:"Address Confirmation",description:"Confirm your address",icon:He,component:An},[re.REVIEW_SUBMIT]:{title:"Review & Submit",description:"Review and submit verification",icon:F,component:Pn},[re.PROCESSING_STATUS]:{title:"Processing",description:"Verification in progress",icon:qe,component:Mn},[re.COMPLETION]:{title:"Completed",description:"Verification complete",icon:ze,component:Zn}},Un=({currentStep:a,stepStatuses:t,onStepClick:s,canNavigateToStep:r})=>{const n=Object.values(re);return e.jsx("div",{className:"w-full mb-8",children:e.jsx("div",{className:"flex items-center justify-between mb-4",children:n.map((i,o)=>{const c=Vt[i],u=c.icon,d=t[i],l=i===a,h=d===G.COMPLETED,R=r(i);return e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(O,{variant:l?"default":h?"secondary":"outline",size:"icon",className:`
                    relative h-12 w-12 rounded-full mb-2
                    ${l?"ring-2 ring-primary ring-offset-2":""}
                    ${h?"bg-green-500 hover:bg-green-600":""}
                    ${!R&&!l&&!h?"opacity-50 cursor-not-allowed":""}
                  `,onClick:()=>R&&s(i),disabled:!R&&!l&&!h,children:[h?e.jsx(F,{className:"h-6 w-6 text-white"}):e.jsx(u,{className:`h-6 w-6 ${l?"text-white":""}`}),e.jsx(X,{variant:"secondary",className:"absolute -top-2 -right-2 h-5 w-5 p-0 text-xs",children:o+1})]}),e.jsxs("div",{className:"text-center max-w-[80px]",children:[e.jsx("p",{className:`text-xs font-medium ${l?"text-primary":"text-muted-foreground"}`,children:c.title}),e.jsx("p",{className:"text-xs text-muted-foreground hidden sm:block",children:c.description})]})]}),o<n.length-1&&e.jsx("div",{className:`
                  flex-1 h-0.5 mx-2 mb-8
                  ${h?"bg-green-500":"bg-muted"}
                `})]},i)})})})},$n=()=>{const{user:a}=Mt(),t=wt(),{verificationData:s,isLoading:r,error:n,isInitialized:i,initializeVerification:o,navigateToStep:c,canNavigateToStep:u,getStepProgress:d,resetVerification:l}=pe();p.useState(!1);const[h,R]=p.useState(!1);p.useEffect(()=>{if(!(a!=null&&a.id)){console.log("[VerificationHub] No user ID available, user:",a);return}console.log("[VerificationHub] User available:",a.id,"Metadata:",a.user_metadata);const S=setTimeout(()=>{var L;if(r&&!i&&!s){console.warn("[VerificationHub] Verification loading timeout, attempting manual initialization");const Y=((L=a.user_metadata)==null?void 0:L.role)||"renter";o(a.id,Y).catch(console.error)}},5e3);if(i||r||s){clearTimeout(S);return}return(async()=>{var L;try{const Y=((L=a.user_metadata)==null?void 0:L.role)||"renter";console.log("[VerificationHub] Initializing verification for user:",a.id,"Role:",Y),await o(a.id,Y)}catch(Y){console.error("[VerificationHub] Failed to initialize verification:",Y),j.error("Failed to initialize verification process")}})(),()=>clearTimeout(S)},[a==null?void 0:a.id,i,r,s,o]);const v=S=>{if(!u(S)){j.error("Please complete the previous steps first");return}c(S)},T=()=>{if(!s)return;const S=Object.values(re),M=S.indexOf(s.currentStep);if(M<S.length-1){const L=S[M+1];v(L)}},N=()=>{if(!s)return;const S=Object.values(re),M=S.indexOf(s.currentStep);if(M>0){const L=S[M-1];c(L)}},w=()=>{j.info("Verification canceled. You can resume anytime from your profile."),t("/")},m=()=>{t("/")},b=()=>{if(!s)return null;const S=Vt[s.currentStep].component;return e.jsx(S,{onNext:T,onPrevious:N})};if(n)return e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",style:{backgroundColor:"#020817"},children:e.jsxs(Z,{className:"w-full max-w-md",children:[e.jsxs($,{className:"text-center",children:[e.jsx(I,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx(z,{className:"text-red-600",children:"Verification Error"})]}),e.jsxs(U,{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:n}),e.jsx(O,{onClick:()=>window.location.reload(),children:"Try Again"})]})]})});if(r||!s)return e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",style:{backgroundColor:"#020817"},children:e.jsx(Z,{className:"w-full max-w-md",children:e.jsxs(U,{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Initializing verification..."})]})})});const x=d(),C=Vt[s.currentStep];return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#020817"},children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6 p-4 bg-white/10 rounded-lg border border-white/20",children:[e.jsxs(O,{variant:"outline",onClick:m,className:"flex items-center gap-2 bg-white/90 hover:bg-white text-gray-900",children:[e.jsx(La,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to Home"}),e.jsx("span",{className:"sm:hidden",children:"Home"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white/80 text-sm",children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Secure verification process"}),e.jsx("span",{className:"sm:hidden",children:"Secure process"})]}),e.jsxs(sr,{open:h,onOpenChange:R,children:[e.jsx(ar,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"flex items-center gap-2 bg-white/90 hover:bg-white text-gray-900 border-red-200 hover:border-red-300",children:[e.jsx(Zt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Cancel Verification"}),e.jsx("span",{className:"sm:hidden",children:"Cancel"})]})}),e.jsxs(Ps,{children:[e.jsxs(Vs,{children:[e.jsx(Ls,{children:"Cancel Verification?"}),e.jsx(Fs,{children:"Are you sure you want to cancel the verification process? Your progress will be saved and you can resume later from your profile."})]}),e.jsxs(Ms,{children:[e.jsx(Us,{children:"Continue Verification"}),e.jsx(Zs,{onClick:w,children:"Yes, Cancel"})]})]})]})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white-900 mb-2",children:"Identity Verification"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"Complete your verification to start using MobiRides"}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[x.completed," of ",x.total," steps"]})]}),e.jsx(pt,{value:x.percentage,className:"h-2"})]})]}),e.jsx(Un,{currentStep:s.currentStep,stepStatuses:s.stepStatuses,onStepClick:v,canNavigateToStep:u}),e.jsxs(Z,{className:"mb-8",children:[e.jsx($,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(C.icon,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{children:[e.jsx(z,{children:C.title}),e.jsx("p",{className:"text-muted-foreground",children:C.description})]})]})}),e.jsx(U,{children:b()})]})]})})},gi=()=>e.jsx(Ba,{children:e.jsx($n,{})});export{gi as default};
