import{u as x,j as e}from"./query-vendor-BOSMW7hd.js";import{u,r as f}from"./react-vendor-DmU5vXC9.js";import{B as g,q as v,L as h,s as l,J as j}from"./index-ahmQo-Zq.js";import{C as y}from"./CarGrid-CTeRxuqY.js";import{N}from"./Navigation-DgaHbxsQ.js";import"./supabase-vendor-B3A6ooRR.js";import"./mapbox-vendor-ueN8uhVJ.js";import"./date-vendor-Dhms5dOu.js";import"./card-D4VTtfVn.js";import"./savedCarService-DiYcklUS.js";import"./calendar-D_cFmEe6.js";import"./chevron-left-Dh8Ads5x.js";import"./availabilityService-D7WpCdEl.js";import"./useVerificationStatus-5lh3U-on.js";import"./VerificationRequiredDialog-DSKmhISw.js";import"./shield-DYICiwOR.js";import"./file-text-Cdr2LMFF.js";import"./camera-D85mMN_S.js";import"./circle-check-big-uJiWdFVJ.js";import"./arrow-right-B6hAkUh0.js";/* empty css                  */import"./skeleton-DFMY7FuM.js";import"./LocationSearchInput-CT6ABk2G.js";import"./map-pin-BTmNqwoj.js";import"./star-Cl6daLIe.js";import"./clock-gtBamCUv.js";import"./calendar-CpXOYIBo.js";import"./circle-alert-C0uJq2nf.js";import"./separator-DIiRVttn.js";import"./bell-D3eElkfC.js";import"./user-7MMf2PMh.js";const $=()=>{const d=u(),m=f.useRef(null),{data:t=[],isLoading:i,error:n}=x({queryKey:["saved-cars-full"],queryFn:async()=>{console.log("Fetching saved cars...");const{data:{session:s}}=await l.auth.getSession();if(!s)return console.log("No active session found when fetching saved cars"),[];console.log("Using user ID for saved cars:",s.user.id);const{data:r,error:a}=await l.from("saved_cars").select(`
          car_id,
          cars:car_id(*)
        `).eq("user_id",s.user.id);if(a)throw console.error("Error fetching saved cars:",a),j.error("Could not load your saved cars. Please try again."),a;if(console.log("Raw saved cars data:",r),!Array.isArray(r)||r.length===0)return console.log("No saved cars found for user"),[];const c=r.filter(o=>o.cars).map(o=>({...o.cars,isSaved:!0}));return console.log("Processed cars:",c),c}}),p=()=>{console.log("Load more triggered in SavedCars")};return e.jsxs("div",{className:"min-h-screen px-4 pb-20",children:[e.jsxs("div",{className:"px-4 py-4 mb-4 flex items-center gap-4",children:[e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>d(-1),children:e.jsx(v,{className:"h-4 w-4"})}),e.jsx("h1",{className:"text-xl md:text-2xl text-left font-semibold",children:"Profile"})]}),e.jsx("main",{className:"px-4 py-6",children:i?e.jsx(h,{}):n?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("p",{className:"text-base text-muted-foreground mb-4",children:"Unable to load saved cars"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"text-sm text-primary hover:underline",children:"Try again"})]}):t.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:e.jsx("p",{className:"text-base text-muted-foreground",children:"No saved cars yet"})}):e.jsx(y,{cars:t,isLoading:i,error:n,loadMoreRef:m,onLoadMore:p,isFetchingNextPage:!1,isAuthenticated:!0})}),e.jsx(N,{})]})};export{$ as default};
