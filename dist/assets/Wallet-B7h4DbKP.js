import{c as y,r as _,n as h,j as e,B as N,s as p,k,aI as T}from"./index-B1v-fdDy.js";import{C as d,a as m,b as x,d as u}from"./card-BByP0N-G.js";import{w as v,T as C}from"./TopUpModal-CVHIYnlR.js";import{S as c}from"./skeleton-B5zSXtNC.js";import{W as w}from"./wallet-BkmUqWq1.js";import{P as q}from"./plus-CDk_XeRs.js";import{B as M}from"./badge-CMWgFMV2.js";import{A as b}from"./arrow-up-down-DHkmFeax.js";import{T as W}from"./trending-up-CAdh-xwz.js";import{f as B}from"./format-BOBWS5Wu.js";import{A as F}from"./arrow-left-C5bMyyle.js";import"./select-DXEtncUe.js";import"./index-BdQq_4o_.js";import"./check-BnE2eJB3.js";import"./credit-card-1cqTaL7m.js";import"./circle-alert-B4G_r9SV.js";import"./circle-check-big-BC5npB6H.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=y("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=y("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=y("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),P=()=>{const[n,a]=_.useState(!1),{data:t}=h({queryKey:["current-user"],queryFn:async()=>{const{data:s}=await p.auth.getUser();return s==null?void 0:s.user}}),{data:r,isLoading:l,refetch:g}=h({queryKey:["wallet-balance",t==null?void 0:t.id],queryFn:async()=>t!=null&&t.id?await v.getWalletBalance(t.id):null,enabled:!!(t!=null&&t.id)}),f=()=>{g(),a(!1)};if(l)return e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),"Wallet Balance"]})}),e.jsxs(u,{children:[e.jsx(c,{className:"h-8 w-24 mb-2"}),e.jsx(c,{className:"h-9 w-32"})]})]});const o=(r==null?void 0:r.balance)||0,i=o<50;return e.jsxs(e.Fragment,{children:[e.jsxs(d,{className:i?"border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950":"",children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),"Wallet Balance"]})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-2xl font-bold",children:["P",o.toFixed(2)]}),i&&e.jsx("span",{className:"text-sm text-amber-600 dark:text-amber-400 font-medium",children:"Low Balance"})]}),e.jsxs(N,{onClick:()=>a(!0),size:"sm",className:"w-full",variant:i?"default":"outline",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Top Up Wallet"]})]})})]}),e.jsx(C,{isOpen:n,onClose:()=>a(!1),onSuccess:f,currentBalance:o})]})},R=()=>{const n=k(),{data:a}=h({queryKey:["current-user"],queryFn:async()=>{const{data:s}=await p.auth.getUser();return s==null?void 0:s.user}}),{data:t,isLoading:r}=h({queryKey:["wallet-transactions",a==null?void 0:a.id],queryFn:async()=>a!=null&&a.id?await v.getTransactionHistory(a.id,20):[],enabled:!!(a!=null&&a.id)}),l=s=>{switch(s){case"top_up":return e.jsx(W,{className:"h-4 w-4 text-green-500"});case"fee_deduction":case"commission_deduction":return e.jsx(E,{className:"h-4 w-4 text-red-500"});case"refund":return e.jsx(T,{className:"h-4 w-4 text-blue-500"});case"withdrawal":return e.jsx(S,{className:"h-4 w-4 text-orange-500"});default:return e.jsx(b,{className:"h-4 w-4 text-gray-500"})}},g=s=>{switch(s){case"top_up":return"Wallet Top Up";case"fee_deduction":return"Platform Fee";case"commission_deduction":return"Commission Charge";case"refund":return"Refund";case"withdrawal":return"Withdrawal";default:return s.replace("_"," ").replace(/\b\w/g,j=>j.toUpperCase())}},f=s=>{switch(s){case"completed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},o=s=>{(s.transaction_type==="commission_deduction"||s.transaction_type==="fee_deduction")&&s.booking_id&&n(`/booking-request/${s.booking_id}`)},i=s=>(s.transaction_type==="commission_deduction"||s.transaction_type==="fee_deduction")&&s.booking_id;return r?e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(x,{children:"Recent Transactions"})}),e.jsx(u,{className:"space-y-3",children:[...Array(5)].map((s,j)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{className:"h-8 w-8 rounded"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{className:"h-4 w-24"}),e.jsx(c,{className:"h-3 w-32"})]})]}),e.jsx(c,{className:"h-4 w-16"})]},j))})]}):!t||t.length===0?e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(x,{children:"Recent Transactions"})}),e.jsx(u,{children:e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(b,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No transactions yet"}),e.jsx("p",{className:"text-sm",children:"Your transaction history will appear here"})]})})]}):e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(x,{children:"Recent Transactions"})}),e.jsx(u,{className:"space-y-3",children:t.map(s=>e.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-lg transition-colors ${i(s)?"cursor-pointer hover:bg-muted/50 hover:border-primary/50":"hover:bg-muted/30"}`,onClick:()=>s.booking_id&&o(s),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"p-2 rounded-full bg-muted",children:l(s.transaction_type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium",children:g(s.transaction_type)}),e.jsx(M,{variant:"secondary",className:f(s.status),children:s.status}),i(s)&&e.jsx(L,{className:"h-3 w-3 text-muted-foreground"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsx("p",{className:"text-xs text-muted-foreground",children:B(new Date(s.created_at),"MMM dd, yyyy 'at' h:mm a")})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-semibold ${s.amount>0?"text-green-600":"text-red-600"}`,children:[s.amount>0?"+":"","P",Math.abs(s.amount).toFixed(2)]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Balance: P",s.balance_after.toFixed(2)]})]})]},s.id))})]})},se=()=>{const n=k(),{data:a}=h({queryKey:["profile"],queryFn:async()=>{const{data:{user:t}}=await p.auth.getUser();if(!t)throw new Error("No user found");const{data:r,error:l}=await p.from("profiles").select("role").eq("id",t.id).single();if(l)throw l;return r}});return a&&a.role!=="host"?(n("/profile"),null):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>n("/profile"),className:"p-2",children:e.jsx(F,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Wallet & Earnings"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your wallet balance and view transaction history"})]})]}),e.jsxs("div",{className:"grid gap-8 md:grid-cols-2",children:[e.jsx(P,{}),e.jsx(R,{})]})]})})};export{se as default};
