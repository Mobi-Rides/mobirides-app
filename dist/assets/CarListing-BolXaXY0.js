import{j as s}from"./query-vendor-BOSMW7hd.js";import{r,h as L}from"./react-vendor-DmU5vXC9.js";import{B as _,s as M,J as P}from"./index-ahmQo-Zq.js";import{C as B}from"./CarGrid-CTeRxuqY.js";import{S as T}from"./SearchFilters-BchMcGLO.js";import{S as o}from"./skeleton-DFMY7FuM.js";import"./supabase-vendor-B3A6ooRR.js";import"./mapbox-vendor-ueN8uhVJ.js";import"./date-vendor-Dhms5dOu.js";import"./card-D4VTtfVn.js";import"./savedCarService-DiYcklUS.js";import"./calendar-D_cFmEe6.js";import"./chevron-left-Dh8Ads5x.js";import"./availabilityService-D7WpCdEl.js";import"./useVerificationStatus-5lh3U-on.js";import"./VerificationRequiredDialog-DSKmhISw.js";import"./shield-DYICiwOR.js";import"./file-text-Cdr2LMFF.js";import"./camera-D85mMN_S.js";import"./circle-check-big-uJiWdFVJ.js";import"./arrow-right-B6hAkUh0.js";/* empty css                  */import"./LocationSearchInput-CT6ABk2G.js";import"./map-pin-BTmNqwoj.js";import"./star-Cl6daLIe.js";import"./clock-gtBamCUv.js";import"./calendar-CpXOYIBo.js";import"./circle-alert-C0uJq2nf.js";import"./separator-DIiRVttn.js";import"./popover-D6QS4X_r.js";import"./select-BGtNurN5.js";import"./index-CEVvJeOa.js";import"./chevron-down-BDcPfNun.js";import"./arrow-up-down-Cz4wxQrw.js";const n=12,xs=()=>{const[i,p]=r.useState([]),[l,d]=r.useState(!0),[c,h]=r.useState(1),[b,y]=r.useState(0),[g,k]=L(),[a,x]=r.useState({startDate:void 0,endDate:void 0,vehicleType:void 0,location:"",sortBy:"price",sortOrder:"asc"}),[u,N]=r.useState(!0);r.useEffect(()=>{const e=g.get("location")||"";x(t=>({...t,location:e}))},[g]),r.useEffect(()=>{(async()=>{d(!0);try{let t=M.from("cars").select("*",{count:"exact"}).range((c-1)*n,c*n-1);a.location&&(t=t.ilike("location",`%${a.location}%`)),a.vehicleType&&(t=t.eq("vehicle_type",a.vehicleType));const w=a.sortBy==="price"?"rental_price":"created_at";t=t.order(w,{ascending:a.sortOrder==="asc"});const{data:m,error:j,count:E}=await t;if(j)throw j;p(F=>c===1?m:[...F,...m]),y(E||0),N(m.length===n)}catch(t){console.error("Error fetching cars:",t),P.error("Failed to fetch cars.")}finally{d(!1)}})()},[a,c]);const v=e=>{p([]),h(1),x(e)},C=()=>{h(e=>e+1)},S=l&&i.length===0,f=l&&i.length>0;return s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx("h1",{className:"text-3xl font-semibold mb-4",children:"Car Listings"}),s.jsx(T,{onFiltersChange:v}),S?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(8)].map((e,t)=>s.jsxs("div",{className:"space-y-3",children:[s.jsx(o,{className:"h-[150px] w-full rounded-md"}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(o,{className:"h-4 w-3/4"}),s.jsx(o,{className:"h-4 w-1/2"})]})]},t))}):s.jsxs(s.Fragment,{children:[s.jsx(B,{cars:i,hasMoreItems:u}),f&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(4)].map((e,t)=>s.jsxs("div",{className:"space-y-3",children:[s.jsx(o,{className:"h-[150px] w-full rounded-md"}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(o,{className:"h-4 w-3/4"}),s.jsx(o,{className:"h-4 w-1/2"})]})]},t))}),u&&!f&&s.jsx(_,{onClick:C,className:"w-full mt-4",children:"Load More"}),i.length===0&&!l&&s.jsx("div",{className:"text-center mt-4",children:"No cars found."})]})]})};export{xs as default};
