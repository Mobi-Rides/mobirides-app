import{c as N,a9 as b,a4 as v,a5 as w,a6 as y,B as C,ap as k,a7 as _,J as l,s as D}from"./index-CV3rVyoS.js";import{u as T,j as e}from"./query-vendor-C7aRRP05.js";import{C as m,a as g,b as h,d as u}from"./card-BYz0HUlZ.js";import{u as O}from"./react-vendor-mnpoGfEl.js";import{S as U}from"./star-D66U8PNt.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=N("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),M=({ownerName:t,avatarUrl:n,ownerId:s})=>{var c;const p=O(),{isAuthenticated:i,user:r}=b(),f=()=>{if(console.log("Contact button clicked! Owner ID:",s,"Owner Name:",t),console.log("Current user authenticated:",i,"User ID:",r==null?void 0:r.id),!i){console.log("User not authenticated, showing toast"),l.error("Please sign in to message the car owner");return}if((r==null?void 0:r.id)===s){console.log("User trying to message themselves"),l.error("You cannot message yourself");return}if(!s){console.error("No owner ID provided"),l.error("Unable to contact car owner");return}console.log("Navigating to messages with recipient data"),p("/messages",{state:{recipientId:s,recipientName:t}})},{data:a,isLoading:o,error:j}=T({queryKey:["user-stats",s],queryFn:async()=>{console.log("Fetching user stats for owner ID:",s);const{data:d,error:x}=await D.rpc("get_user_review_stats",{user_uuid:s});return x?(console.error("Error fetching user stats:",x),null):(console.log("User stats response:",d),d)},enabled:!!s});return console.log("User stats state:",{userStats:a,statsLoading:o,statsError:j}),e.jsx(e.Fragment,{children:e.jsxs(m,{className:"dark:bg-gray-800 dark:border-gray-700 border-border shadow-sm overflow-hidden",children:[e.jsx(g,{className:"pb-2 bg-muted/30",children:e.jsx(h,{className:"text-base text-left text-muted-foreground dark:text-white font-medium",children:"Host"})}),e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:n||"/placeholder.svg",alt:t||"Car Owner",className:"w-8 h-8 rounded-full object-cover bg-muted"}),e.jsxs("div",{className:"flex flex-col gap-0.5 items-start",children:[e.jsx("p",{className:"text-sm md:text-base text-gray-700 dark:text-white ",children:t||"Car Owner"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground",children:"Vehicle Host"}),o&&e.jsx("span",{className:"text-xs text-blue-500",children:"Loading rating..."}),a&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-white",children:((c=a.overall_rating)==null?void 0:c.toFixed(1))||"0.0"}),a.total_reviews>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a.total_reviews," review",a.total_reviews!==1?"s":"",")"]})]}),!a&&!o&&e.jsx("span",{className:"text-xs text-gray-500",children:"No rating yet"})]})]})]}),e.jsx(v,{children:e.jsxs(w,{children:[e.jsx(y,{asChild:!0,children:e.jsxs(C,{className:"gap-2",onClick:f,children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Contact"})]})}),e.jsx(_,{children:e.jsx("p",{children:"Message the vehicle owner"})})]})})]})})]})})},R=({description:t})=>t?e.jsxs(m,{className:"dark:bg-gray-800 dark:border-gray-700 border-border shadow-sm overflow-hidden",children:[e.jsx(g,{className:"pb-2 bg-muted/30",children:e.jsx(h,{className:"text-base text-left text-muted-foreground dark:text-white font-medium",children:"Description"})}),e.jsx(u,{className:"p-4",children:e.jsx("p",{className:"text-sm md:text-base text-muted-foreground leading-relaxed text-left",children:t})})]}):null;export{R as C,H as K,M as a};
