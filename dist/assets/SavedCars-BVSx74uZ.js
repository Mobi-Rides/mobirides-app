import{u,j as e}from"./query-vendor-C7aRRP05.js";import{u as f,r as p}from"./react-vendor-mnpoGfEl.js";import{B as g,y as v,L as h,s as l,J as y}from"./index-CV3rVyoS.js";import{C as j}from"./CarGrid-BCL3bsC5.js";import{N}from"./Navigation-NsQjHjAL.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./date-vendor-Dhms5dOu.js";import"./card-BYz0HUlZ.js";import"./savedCarService-BoCCFqPs.js";import"./separator-BbjXUszL.js";import"./star-D66U8PNt.js";import"./map-pin-DSTFqCgm.js";import"./bell-Dr02D-Bx.js";import"./user-BnZM330N.js";const J=()=>{const d=f(),m=p.useRef(null),{data:t=[],isLoading:i,error:n}=u({queryKey:["saved-cars-full"],queryFn:async()=>{console.log("Fetching saved cars...");const{data:{session:r}}=await l.auth.getSession();if(!r)return console.log("No active session found when fetching saved cars"),[];console.log("Using user ID for saved cars:",r.user.id);const{data:s,error:a}=await l.from("saved_cars").select(`
          car_id,
          cars:car_id(*)
        `).eq("user_id",r.user.id);if(a)throw console.error("Error fetching saved cars:",a),y.error("Could not load your saved cars. Please try again."),a;if(console.log("Raw saved cars data:",s),!Array.isArray(s)||s.length===0)return console.log("No saved cars found for user"),[];const c=s.filter(o=>o.cars).map(o=>({...o.cars,isSaved:!0}));return console.log("Processed cars:",c),c}}),x=()=>{console.log("Load more triggered in SavedCars")};return e.jsxs("div",{className:"min-h-screen px-4 pb-20",children:[e.jsxs("div",{className:"px-4 py-4 mb-4 flex items-center gap-4",children:[e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>d(-1),children:e.jsx(v,{className:"h-4 w-4"})}),e.jsx("h1",{className:"text-xl md:text-2xl text-left font-semibold",children:"Profile"})]}),e.jsx("main",{className:"px-4 py-6",children:i?e.jsx(h,{}):n?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("p",{className:"text-base text-muted-foreground mb-4",children:"Unable to load saved cars"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"text-sm text-primary hover:underline",children:"Try again"})]}):t.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:e.jsx("p",{className:"text-base text-muted-foreground",children:"No saved cars yet"})}):e.jsx(j,{cars:t,isLoading:i,error:n,loadMoreRef:m,onLoadMore:x,isFetchingNextPage:!1,isAuthenticated:!0})}),e.jsx(N,{})]})};export{J as default};
