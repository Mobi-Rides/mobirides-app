const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Index-ONyn82mb.js","assets/query-vendor-C7aRRP05.js","assets/react-vendor-mnpoGfEl.js","assets/useHandoverPrompts-CS_zxaM7.js","assets/sheet-BkOikKbX.js","assets/SearchFilters-BwX1K3iJ.js","assets/calendar-9_4Z8lJD.js","assets/date-vendor-Dhms5dOu.js","assets/chevron-left-BX29jxlz.js","assets/popover-Cue3incf.js","assets/LocationSearchInput-BFFY5A21.js","assets/map-pin-BHt1iARb.js","assets/star-B5qnmJNw.js","assets/clock-COZh9gHT.js","assets/calendar-I50EbTE7.js","assets/arrow-up-down-Bi3KeoUh.js","assets/useVerificationStatus-kXBa74RZ.js","assets/circle-check-big-D5NSr62X.js","assets/circle-alert-Co0W9q0l.js","assets/shield-BSI-WFEA.js","assets/navigation-DAVR4g03.js","assets/useAuthStatus-DmQ3dk6Q.js","assets/supabase-vendor-BOn0LdFJ.js","assets/Navigation-BJhO5yqx.js","assets/bell-vK77m_ng.js","assets/user-FiBtLMcV.js","assets/CarGrid-eHasC-K_.js","assets/card-CZf4UH4z.js","assets/savedCarService-DtdDHPmw.js","assets/separator-DiGfKIlq.js","assets/car-LgBAYQxH.js","assets/mapbox-vendor-fnXFVHMy.js","assets/Login-B81YrFw7.js","assets/signup-oaSe6_1k.js","assets/Profile-Dxm2dXg6.js","assets/switch-CP7ZR25t.js","assets/wallet-C-Ira5uL.js","assets/settings-w-uBCcuh.js","assets/sun-NlVkuI6f.js","assets/book-open-B4ALRTsg.js","assets/circle-help-DkWo2E9S.js","assets/message-square-DvGxS8d9.js","assets/log-out-BVJJ4wMR.js","assets/upload-B183zddE.js","assets/form-CFMZu19Z.js","assets/form-vendor-95UsJkpA.js","assets/trending-up-CsRimzHZ.js","assets/loader-circle-_3wlvkqs.js","assets/OnlineStatusToggle-CgeahQqS.js","assets/index-DE7TNQN2.js","assets/Map-DZ5C1Akv.js","assets/mapbox-gl-B3wRs1Fd.js","assets/mapbox-gl-B9eh9OLo.css","assets/arrow-right-Br4Tllr2.js","assets/progress-C1wysPei.js","assets/camera-DuKbQ9IT.js","assets/checkbox-brHXFofW.js","assets/rotate-ccw-DqW3uhsY.js","assets/flag-DRGjbCVJ.js","assets/dollar-sign-DJxtlNw-.js","assets/house-D8AFO-WR.js","assets/More-OIQr9KKL.js","assets/CarDetails-4MzY_KIz.js","assets/skeleton-CMwq_CyE.js","assets/VerificationRequiredDialog-BlMmp2Bh.js","assets/file-text-D6lyPcDg.js","assets/circle-check-Dbby2nzi.js","assets/index-DqZI11Hc.js","assets/CarDescription-DYkk2YiS.js","assets/AddCar-D3lYIgON.js","assets/CarForm-B25KXTb7.js","assets/ImageUpload-inBo7kpH.js","assets/DriverLicense-B5kAe8Dh.js","assets/EditCar-BlbnfRSs.js","assets/SavedCars-Cl9DxnYB.js","assets/BookingDetails-CyiVOgMV.js","assets/NotificationDetails-CL6xGiq_.js","assets/notificationHelpers-DZFPT44-.js","assets/HelpCenter-C2qHhzjF.js","assets/HelpSection-mwQm4CD0.js","assets/BookingRequestDetails-Bz8q3ycA.js","assets/WalletBalanceIndicator-4xQIijFK.js","assets/TopUpModal-B1Zs_4wo.js","assets/notificationService-BbEAqefx.js","assets/credit-card-C3Wl-UQ1.js","assets/circle-x-C4r5drii.js","assets/Dashboard-CRpOfZYt.js","assets/useIsAdmin-B2ZRdPBS.js","assets/car-front-CDXtBDiz.js","assets/AdminStats-CMIl5UN2.js","assets/NotificationsRefactored-Bm3Z1gr7.js","assets/Messages-DERxFkyq.js","assets/RentalReview-CGqSzBnH.js","assets/RentalDetailsRefactored-ClTUT8lr.js","assets/pen-line-DL1X8j1f.js","assets/receipt-Bpt_517F.js","assets/ResetPassword-CcQypAA-.js","assets/ConfirmEmail-OoNvA6O5.js","assets/mail-DKpIUpKb.js","assets/Wallet-Bu1SG6VP.js","assets/trending-down-0J5S9aoj.js","assets/Verification-B0nLgyuD.js","assets/alert-dialog-CNRx4vpv.js","assets/user-check-C73_YLQQ.js","assets/download-GBlS0uFG.js","assets/NotificationPreferencesPage-BXnSpjoF.js","assets/CreateCar-DmxdFASK.js","assets/EditProfile-CZOtZOAk.js","assets/CarListing-aRUvFKso.js","assets/ResendTestPage-CkBfFt1_.js","assets/AdminDashboard-CbM4TBzb.js","assets/table-C_qMYt3j.js","assets/UserManagementTable-SPfE7V-M.js","assets/AdminUsers-CbQSeNn7.js","assets/AdminCars-uzE1njMx.js","assets/AdminBookings-CUYBZKP2.js","assets/AdminTransactions-DQ80SIEo.js","assets/AdminVerifications-DYXmL3MU.js","assets/AdminMessages-0AYgaSGS.js","assets/AdminManagement-DAjfNNES.js","assets/HostBookings-CryibwOT.js","assets/RenterBookings-DzQnDl_P.js","assets/RoleAwareBookingsRedirect-Bg4RubNX.js"])))=>i.map(i=>d[i]);
var wu=Object.defineProperty;var bu=(t,e,n)=>e in t?wu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var H=(t,e,n)=>bu(t,typeof e!="symbol"?e+"":e,n);import{j as l,u as pi,a as Ca,b as vs,Q as Su,c as _u}from"./query-vendor-C7aRRP05.js";import{b as Nn,R as O,d as Ta,r as d,e as Eu,a as Cu,u as ka,f as Tu,h as ku,B as Au,i as Nu,j as X}from"./react-vendor-mnpoGfEl.js";import{c as ju,_ as ee}from"./supabase-vendor-BOn0LdFJ.js";import{m as Et}from"./mapbox-vendor-fnXFVHMy.js";import{f as Aa,a as Na,i as xs}from"./date-vendor-Dhms5dOu.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var ja,ys=Nn;ja=ys.createRoot,ys.hydrateRoot;const Ru="https://putjowciegpzdheideaf.supabase.co",Mu="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB1dGpvd2NpZWdwemRoZWlkZWFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ5NTQ5MTQsImV4cCI6MjA1MDUzMDkxNH0.p3UPDQc4Y9r1BbMB4cPssPKNvoj5fbf9b9M40x6724o",I=ju(Ru,Mu);class Xt{static storePendingAction(e){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}static getPendingAction(){const e=localStorage.getItem(this.STORAGE_KEY);if(!e)return null;try{return JSON.parse(e)}catch{return null}}static clearPendingAction(){localStorage.removeItem(this.STORAGE_KEY)}static getSessionTracker(){const e=localStorage.getItem(this.SESSION_TRACKER_KEY);if(!e)return null;try{return JSON.parse(e)}catch{return null}}static setSessionTracker(e,n){localStorage.setItem(this.SESSION_TRACKER_KEY,JSON.stringify({sessionId:e,executedAt:n,lastExecutionTime:Date.now()}))}static clearSessionTracker(){localStorage.removeItem(this.SESSION_TRACKER_KEY)}static hasExecutedForSession(e){const n=this.getSessionTracker();return(n==null?void 0:n.sessionId)===e}static canExecuteNow(){const e=this.getSessionTracker();return e?Date.now()-e.lastExecutionTime>=this.MIN_EXECUTION_INTERVAL:!0}static async executePendingAction(e){const n=this.getPendingAction();return n?e&&this.hasExecutedForSession(e)?(console.log("Pending action already executed for this session, skipping"),!1):this.canExecuteNow()?(console.log("Executing pending action:",n),this.executionTimeout&&(clearTimeout(this.executionTimeout),this.executionTimeout=null),new Promise(r=>{this.executionTimeout=window.setTimeout(async()=>{try{switch(n.type){case"booking":console.log("Dispatching execute-booking event:",n.payload),window.dispatchEvent(new CustomEvent("execute-booking",{detail:n.payload}));break;case"save_car":console.log("Dispatching execute-save-car event:",n.payload),window.dispatchEvent(new CustomEvent("execute-save-car",{detail:n.payload}));break;case"contact_host":console.log("Dispatching execute-contact-host event:",n.payload),window.dispatchEvent(new CustomEvent("execute-contact-host",{detail:n.payload}));break}e&&this.setSessionTracker(e,Date.now()),this.clearPendingAction(),r(!0)}catch(o){console.error("Failed to execute pending action:",o),this.clearPendingAction(),r(!1)}},300)})):(console.log("Rate limit protection: too soon since last execution"),!1):!1}}H(Xt,"STORAGE_KEY","pending_auth_action"),H(Xt,"SESSION_TRACKER_KEY","auth_session_tracker"),H(Xt,"MIN_EXECUTION_INTERVAL",5e3),H(Xt,"executionTimeout",null);var Pu=t=>{switch(t){case"success":return Lu;case"info":return zu;case"warning":return Du;case"error":return Fu;default:return null}},Iu=Array(12).fill(0),Ou=({visible:t})=>O.createElement("div",{className:"sonner-loading-wrapper","data-visible":t},O.createElement("div",{className:"sonner-spinner"},Iu.map((e,n)=>O.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Lu=O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},O.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Du=O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},O.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),zu=O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},O.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Fu=O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},O.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),$u=()=>{let[t,e]=O.useState(document.hidden);return O.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},To=1,Uu=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:n,...r}=t,o=typeof(t==null?void 0:t.id)=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:To++,i=this.toasts.find(a=>a.id===o),s=t.dismissible===void 0?!0:t.dismissible;return i?this.toasts=this.toasts.map(a=>a.id===o?(this.publish({...a,...t,id:o,title:n}),{...a,...t,id:o,dismissible:s,title:n}):a):this.addToast({title:n,...r,dismissible:s,id:o}),o},this.dismiss=t=>(t||this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=t instanceof Promise?t:t(),o=n!==void 0;return r.then(async i=>{if(Bu(i)&&!i.ok){o=!1;let s=typeof e.error=="function"?await e.error(`HTTP error! status: ${i.status}`):e.error,a=typeof e.description=="function"?await e.description(`HTTP error! status: ${i.status}`):e.description;this.create({id:n,type:"error",message:s,description:a})}else if(e.success!==void 0){o=!1;let s=typeof e.success=="function"?await e.success(i):e.success,a=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"success",message:s,description:a})}}).catch(async i=>{if(e.error!==void 0){o=!1;let s=typeof e.error=="function"?await e.error(i):e.error,a=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"error",message:s,description:a})}}).finally(()=>{var i;o&&(this.dismiss(n),n=void 0),(i=e.finally)==null||i.call(e)}),n},this.custom=(t,e)=>{let n=(e==null?void 0:e.id)||To++;return this.create({jsx:t(n),id:n,...e}),n},this.subscribers=[],this.toasts=[]}},je=new Uu,Hu=(t,e)=>{let n=(e==null?void 0:e.id)||To++;return je.addToast({title:t,...e,id:n}),n},Bu=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Vu=Hu,qu=()=>je.toasts,te=Object.assign(Vu,{success:je.success,info:je.info,warning:je.warning,error:je.error,custom:je.custom,message:je.message,promise:je.promise,dismiss:je.dismiss,loading:je.loading},{getHistory:qu});function Gu(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}Gu(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Un(t){return t.label!==void 0}var Wu=3,Ku="32px",Yu=4e3,Xu=356,Qu=14,Ju=20,Zu=200;function ef(...t){return t.filter(Boolean).join(" ")}var tf=t=>{var e,n,r,o,i,s,a,c,p,f;let{invert:m,toast:u,unstyled:h,interacting:x,setHeights:g,visibleToasts:v,heights:y,index:w,toasts:b,expanded:S,removeToast:_,defaultRichColors:A,closeButton:E,style:T,cancelButtonStyle:C,actionButtonStyle:k,className:R="",descriptionClassName:P="",duration:F,position:$,gap:G,loadingIcon:N,expandByDefault:L,classNames:M,icons:j,closeButtonAriaLabel:W="Close toast",pauseWhenPageIsHidden:z,cn:q}=t,[K,ie]=O.useState(!1),[ge,se]=O.useState(!1),[U,oe]=O.useState(!1),[ae,ne]=O.useState(!1),[de,ce]=O.useState(0),[_e,Ne]=O.useState(0),ct=O.useRef(null),Ie=O.useRef(null),_t=w===0,Yr=w+1<=v,ye=u.type,Ut=u.dismissible!==!1,fu=u.className||"",mu=u.descriptionClassName||"",Fn=O.useMemo(()=>y.findIndex(J=>J.toastId===u.id)||0,[y,u.id]),hu=O.useMemo(()=>{var J;return(J=u.closeButton)!=null?J:E},[u.closeButton,E]),us=O.useMemo(()=>u.duration||F||Yu,[u.duration,F]),Xr=O.useRef(0),Ht=O.useRef(0),fs=O.useRef(0),Bt=O.useRef(null),[ms,gu]=$.split("-"),hs=O.useMemo(()=>y.reduce((J,me,ue)=>ue>=Fn?J:J+me.height,0),[y,Fn]),gs=$u(),vu=u.invert||m,Qr=ye==="loading";Ht.current=O.useMemo(()=>Fn*G+hs,[Fn,hs]),O.useEffect(()=>{ie(!0)},[]),O.useLayoutEffect(()=>{if(!K)return;let J=Ie.current,me=J.style.height;J.style.height="auto";let ue=J.getBoundingClientRect().height;J.style.height=me,Ne(ue),g(Ge=>Ge.find(We=>We.toastId===u.id)?Ge.map(We=>We.toastId===u.id?{...We,height:ue}:We):[{toastId:u.id,height:ue,position:u.position},...Ge])},[K,u.title,u.description,g,u.id]);let lt=O.useCallback(()=>{se(!0),ce(Ht.current),g(J=>J.filter(me=>me.toastId!==u.id)),setTimeout(()=>{_(u)},Zu)},[u,_,g,Ht]);O.useEffect(()=>{if(u.promise&&ye==="loading"||u.duration===1/0||u.type==="loading")return;let J,me=us;return S||x||z&&gs?(()=>{if(fs.current<Xr.current){let ue=new Date().getTime()-Xr.current;me=me-ue}fs.current=new Date().getTime()})():me!==1/0&&(Xr.current=new Date().getTime(),J=setTimeout(()=>{var ue;(ue=u.onAutoClose)==null||ue.call(u,u),lt()},me)),()=>clearTimeout(J)},[S,x,L,u,us,lt,u.promise,ye,z,gs]),O.useEffect(()=>{let J=Ie.current;if(J){let me=J.getBoundingClientRect().height;return Ne(me),g(ue=>[{toastId:u.id,height:me,position:u.position},...ue]),()=>g(ue=>ue.filter(Ge=>Ge.toastId!==u.id))}},[g,u.id]),O.useEffect(()=>{u.delete&&lt()},[lt,u.delete]);function xu(){return j!=null&&j.loading?O.createElement("div",{className:"sonner-loader","data-visible":ye==="loading"},j.loading):N?O.createElement("div",{className:"sonner-loader","data-visible":ye==="loading"},N):O.createElement(Ou,{visible:ye==="loading"})}return O.createElement("li",{"aria-live":u.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Ie,className:q(R,fu,M==null?void 0:M.toast,(e=u==null?void 0:u.classNames)==null?void 0:e.toast,M==null?void 0:M.default,M==null?void 0:M[ye],(n=u==null?void 0:u.classNames)==null?void 0:n[ye]),"data-sonner-toast":"","data-rich-colors":(r=u.richColors)!=null?r:A,"data-styled":!(u.jsx||u.unstyled||h),"data-mounted":K,"data-promise":!!u.promise,"data-removed":ge,"data-visible":Yr,"data-y-position":ms,"data-x-position":gu,"data-index":w,"data-front":_t,"data-swiping":U,"data-dismissible":Ut,"data-type":ye,"data-invert":vu,"data-swipe-out":ae,"data-expanded":!!(S||L&&K),style:{"--index":w,"--toasts-before":w,"--z-index":b.length-w,"--offset":`${ge?de:Ht.current}px`,"--initial-height":L?"auto":`${_e}px`,...T,...u.style},onPointerDown:J=>{Qr||!Ut||(ct.current=new Date,ce(Ht.current),J.target.setPointerCapture(J.pointerId),J.target.tagName!=="BUTTON"&&(oe(!0),Bt.current={x:J.clientX,y:J.clientY}))},onPointerUp:()=>{var J,me,ue,Ge;if(ae||!Ut)return;Bt.current=null;let We=Number(((J=Ie.current)==null?void 0:J.style.getPropertyValue("--swipe-amount").replace("px",""))||0),$n=new Date().getTime()-((me=ct.current)==null?void 0:me.getTime()),yu=Math.abs(We)/$n;if(Math.abs(We)>=Ju||yu>.11){ce(Ht.current),(ue=u.onDismiss)==null||ue.call(u,u),lt(),ne(!0);return}(Ge=Ie.current)==null||Ge.style.setProperty("--swipe-amount","0px"),oe(!1)},onPointerMove:J=>{var me;if(!Bt.current||!Ut)return;let ue=J.clientY-Bt.current.y,Ge=J.clientX-Bt.current.x,We=(ms==="top"?Math.min:Math.max)(0,ue),$n=J.pointerType==="touch"?10:2;Math.abs(We)>$n?(me=Ie.current)==null||me.style.setProperty("--swipe-amount",`${ue}px`):Math.abs(Ge)>$n&&(Bt.current=null)}},hu&&!u.jsx?O.createElement("button",{"aria-label":W,"data-disabled":Qr,"data-close-button":!0,onClick:Qr||!Ut?()=>{}:()=>{var J;lt(),(J=u.onDismiss)==null||J.call(u,u)},className:q(M==null?void 0:M.closeButton,(o=u==null?void 0:u.classNames)==null?void 0:o.closeButton)},O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},O.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),O.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,u.jsx||O.isValidElement(u.title)?u.jsx||u.title:O.createElement(O.Fragment,null,ye||u.icon||u.promise?O.createElement("div",{"data-icon":"",className:q(M==null?void 0:M.icon,(i=u==null?void 0:u.classNames)==null?void 0:i.icon)},u.promise||u.type==="loading"&&!u.icon?u.icon||xu():null,u.type!=="loading"?u.icon||(j==null?void 0:j[ye])||Pu(ye):null):null,O.createElement("div",{"data-content":"",className:q(M==null?void 0:M.content,(s=u==null?void 0:u.classNames)==null?void 0:s.content)},O.createElement("div",{"data-title":"",className:q(M==null?void 0:M.title,(a=u==null?void 0:u.classNames)==null?void 0:a.title)},u.title),u.description?O.createElement("div",{"data-description":"",className:q(P,mu,M==null?void 0:M.description,(c=u==null?void 0:u.classNames)==null?void 0:c.description)},u.description):null),O.isValidElement(u.cancel)?u.cancel:u.cancel&&Un(u.cancel)?O.createElement("button",{"data-button":!0,"data-cancel":!0,style:u.cancelButtonStyle||C,onClick:J=>{var me,ue;Un(u.cancel)&&Ut&&((ue=(me=u.cancel).onClick)==null||ue.call(me,J),lt())},className:q(M==null?void 0:M.cancelButton,(p=u==null?void 0:u.classNames)==null?void 0:p.cancelButton)},u.cancel.label):null,O.isValidElement(u.action)?u.action:u.action&&Un(u.action)?O.createElement("button",{"data-button":!0,"data-action":!0,style:u.actionButtonStyle||k,onClick:J=>{var me,ue;Un(u.action)&&(J.defaultPrevented||((ue=(me=u.action).onClick)==null||ue.call(me,J),lt()))},className:q(M==null?void 0:M.actionButton,(f=u==null?void 0:u.classNames)==null?void 0:f.actionButton)},u.action.label):null))};function ws(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}var nf=t=>{let{invert:e,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:o,closeButton:i,className:s,offset:a,theme:c="light",richColors:p,duration:f,style:m,visibleToasts:u=Wu,toastOptions:h,dir:x=ws(),gap:g=Qu,loadingIcon:v,icons:y,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:b,cn:S=ef}=t,[_,A]=O.useState([]),E=O.useMemo(()=>Array.from(new Set([n].concat(_.filter(z=>z.position).map(z=>z.position)))),[_,n]),[T,C]=O.useState([]),[k,R]=O.useState(!1),[P,F]=O.useState(!1),[$,G]=O.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),N=O.useRef(null),L=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),M=O.useRef(null),j=O.useRef(!1),W=O.useCallback(z=>{var q;(q=_.find(K=>K.id===z.id))!=null&&q.delete||je.dismiss(z.id),A(K=>K.filter(({id:ie})=>ie!==z.id))},[_]);return O.useEffect(()=>je.subscribe(z=>{if(z.dismiss){A(q=>q.map(K=>K.id===z.id?{...K,delete:!0}:K));return}setTimeout(()=>{Ta.flushSync(()=>{A(q=>{let K=q.findIndex(ie=>ie.id===z.id);return K!==-1?[...q.slice(0,K),{...q[K],...z},...q.slice(K+1)]:[z,...q]})})})}),[]),O.useEffect(()=>{if(c!=="system"){G(c);return}c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?G("dark"):G("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:z})=>{G(z?"dark":"light")})},[c]),O.useEffect(()=>{_.length<=1&&R(!1)},[_]),O.useEffect(()=>{let z=q=>{var K,ie;r.every(ge=>q[ge]||q.code===ge)&&(R(!0),(K=N.current)==null||K.focus()),q.code==="Escape"&&(document.activeElement===N.current||(ie=N.current)!=null&&ie.contains(document.activeElement))&&R(!1)};return document.addEventListener("keydown",z),()=>document.removeEventListener("keydown",z)},[r]),O.useEffect(()=>{if(N.current)return()=>{M.current&&(M.current.focus({preventScroll:!0}),M.current=null,j.current=!1)}},[N.current]),_.length?O.createElement("section",{"aria-label":`${w} ${L}`,tabIndex:-1},E.map((z,q)=>{var K;let[ie,ge]=z.split("-");return O.createElement("ol",{key:z,dir:x==="auto"?ws():x,tabIndex:-1,ref:N,className:s,"data-sonner-toaster":!0,"data-theme":$,"data-y-position":ie,"data-x-position":ge,style:{"--front-toast-height":`${((K=T[0])==null?void 0:K.height)||0}px`,"--offset":typeof a=="number"?`${a}px`:a||Ku,"--width":`${Xu}px`,"--gap":`${g}px`,...m},onBlur:se=>{j.current&&!se.currentTarget.contains(se.relatedTarget)&&(j.current=!1,M.current&&(M.current.focus({preventScroll:!0}),M.current=null))},onFocus:se=>{se.target instanceof HTMLElement&&se.target.dataset.dismissible==="false"||j.current||(j.current=!0,M.current=se.relatedTarget)},onMouseEnter:()=>R(!0),onMouseMove:()=>R(!0),onMouseLeave:()=>{P||R(!1)},onPointerDown:se=>{se.target instanceof HTMLElement&&se.target.dataset.dismissible==="false"||F(!0)},onPointerUp:()=>F(!1)},_.filter(se=>!se.position&&q===0||se.position===z).map((se,U)=>{var oe,ae;return O.createElement(tf,{key:se.id,icons:y,index:U,toast:se,defaultRichColors:p,duration:(oe=h==null?void 0:h.duration)!=null?oe:f,className:h==null?void 0:h.className,descriptionClassName:h==null?void 0:h.descriptionClassName,invert:e,visibleToasts:u,closeButton:(ae=h==null?void 0:h.closeButton)!=null?ae:i,interacting:P,position:z,style:h==null?void 0:h.style,unstyled:h==null?void 0:h.unstyled,classNames:h==null?void 0:h.classNames,cancelButtonStyle:h==null?void 0:h.cancelButtonStyle,actionButtonStyle:h==null?void 0:h.actionButtonStyle,removeToast:W,toasts:_.filter(ne=>ne.position==se.position),heights:T.filter(ne=>ne.position==se.position),setHeights:C,expandByDefault:o,gap:g,loadingIcon:v,expanded:k,pauseWhenPageIsHidden:b,cn:S})}))})):null};const Ra=d.createContext({user:null,session:null,isAuthenticated:!1,isLoading:!0,signOut:async()=>{}}),rf=({children:t})=>{const[e,n]=d.useState(null),[r,o]=d.useState(null),[i,s]=d.useState(!0);d.useEffect(()=>{const{data:{subscription:c}}=I.auth.onAuthStateChange((p,f)=>{console.log("Auth state change event:",p,!!f),o(f),n((f==null?void 0:f.user)??null),s(!1),f!=null&&f.user&&p==="SIGNED_IN"&&(console.log("Sign-in detected, executing pending actions with session ID:",f.access_token.substring(0,10)),Xt.executePendingAction(f.access_token)),p==="SIGNED_OUT"&&(console.log("Sign-out detected, clearing session tracker"),Xt.clearSessionTracker())});return I.auth.getSession().then(({data:{session:p}})=>{o(p),n((p==null?void 0:p.user)??null),s(!1)}),()=>c.unsubscribe()},[]);const a=async()=>{try{console.log("[AuthProvider] Starting sign out process..."),s(!0);const{error:c}=await I.auth.signOut();if(c)throw console.error("[AuthProvider] Sign out error:",c),te.error("Failed to sign out. Please try again."),c;console.log("[AuthProvider] Sign out successful"),te.success("Signed out successfully"),n(null),o(null)}catch(c){throw console.error("[AuthProvider] Sign out failed:",c),te.error("An error occurred while signing out"),c}finally{s(!1)}};return l.jsx(Ra.Provider,{value:{user:e,session:r,isAuthenticated:!!e,isLoading:i,signOut:a},children:t})},of=()=>d.useContext(Ra);function D(t,e,{checkForDefaultPrevented:n=!0}={}){return function(o){if(t==null||t(o),n===!1||!o.defaultPrevented)return e==null?void 0:e(o)}}function sf(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function yr(...t){return e=>t.forEach(n=>sf(n,e))}function re(...t){return d.useCallback(yr(...t),t)}function af(t,e){const n=d.createContext(e),r=i=>{const{children:s,...a}=i,c=d.useMemo(()=>a,Object.values(a));return l.jsx(n.Provider,{value:c,children:s})};r.displayName=t+"Provider";function o(i){const s=d.useContext(n);if(s)return s;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,o]}function wt(t,e=[]){let n=[];function r(i,s){const a=d.createContext(s),c=n.length;n=[...n,s];const p=m=>{var y;const{scope:u,children:h,...x}=m,g=((y=u==null?void 0:u[t])==null?void 0:y[c])||a,v=d.useMemo(()=>x,Object.values(x));return l.jsx(g.Provider,{value:v,children:h})};p.displayName=i+"Provider";function f(m,u){var g;const h=((g=u==null?void 0:u[t])==null?void 0:g[c])||a,x=d.useContext(h);if(x)return x;if(s!==void 0)return s;throw new Error(`\`${m}\` must be used within \`${i}\``)}return[p,f]}const o=()=>{const i=n.map(s=>d.createContext(s));return function(a){const c=(a==null?void 0:a[t])||i;return d.useMemo(()=>({[`__scope${t}`]:{...a,[t]:c}}),[a,c])}};return o.scopeName=t,[r,cf(o,...e)]}function cf(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const s=r.reduce((a,{useScope:c,scopeName:p})=>{const m=c(i)[`__scope${p}`];return{...a,...m}},{});return d.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}var xe=globalThis!=null&&globalThis.document?d.useLayoutEffect:()=>{},lf=Eu.useId||(()=>{}),df=0;function He(t){const[e,n]=d.useState(lf());return xe(()=>{n(r=>r??String(df++))},[t]),e?`radix-${e}`:""}function ve(t){const e=d.useRef(t);return d.useEffect(()=>{e.current=t}),d.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Ot({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,o]=pf({defaultProp:e,onChange:n}),i=t!==void 0,s=i?t:r,a=ve(n),c=d.useCallback(p=>{if(i){const m=typeof p=="function"?p(t):p;m!==t&&a(m)}else o(p)},[i,t,o,a]);return[s,c]}function pf({defaultProp:t,onChange:e}){const n=d.useState(t),[r]=n,o=d.useRef(r),i=ve(e);return d.useEffect(()=>{o.current!==r&&(i(r),o.current=r)},[r,o,i]),n}var ht=d.forwardRef((t,e)=>{const{children:n,...r}=t,o=d.Children.toArray(n),i=o.find(uf);if(i){const s=i.props.children,a=o.map(c=>c===i?d.Children.count(s)>1?d.Children.only(null):d.isValidElement(s)?s.props.children:null:c);return l.jsx(ko,{...r,ref:e,children:d.isValidElement(s)?d.cloneElement(s,void 0,a):null})}return l.jsx(ko,{...r,ref:e,children:n})});ht.displayName="Slot";var ko=d.forwardRef((t,e)=>{const{children:n,...r}=t;if(d.isValidElement(n)){const o=mf(n);return d.cloneElement(n,{...ff(r,n.props),ref:e?yr(e,o):o})}return d.Children.count(n)>1?d.Children.only(null):null});ko.displayName="SlotClone";var Ma=({children:t})=>l.jsx(l.Fragment,{children:t});function uf(t){return d.isValidElement(t)&&t.type===Ma}function ff(t,e){const n={...e};for(const r in e){const o=t[r],i=e[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...a)=>{i(...a),o(...a)}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...t,...n}}function mf(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var hf=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Y=hf.reduce((t,e)=>{const n=d.forwardRef((r,o)=>{const{asChild:i,...s}=r,a=i?ht:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(a,{...s,ref:o})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Pa(t,e){t&&Nn.flushSync(()=>t.dispatchEvent(e))}function gf(t,e=globalThis==null?void 0:globalThis.document){const n=ve(t);d.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var vf="DismissableLayer",Ao="dismissableLayer.update",xf="dismissableLayer.pointerDownOutside",yf="dismissableLayer.focusOutside",bs,Ia=d.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),jn=d.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:s,onDismiss:a,...c}=t,p=d.useContext(Ia),[f,m]=d.useState(null),u=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=d.useState({}),x=re(e,E=>m(E)),g=Array.from(p.layers),[v]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(v),w=f?g.indexOf(f):-1,b=p.layersWithOutsidePointerEventsDisabled.size>0,S=w>=y,_=Sf(E=>{const T=E.target,C=[...p.branches].some(k=>k.contains(T));!S||C||(o==null||o(E),s==null||s(E),E.defaultPrevented||a==null||a())},u),A=_f(E=>{const T=E.target;[...p.branches].some(k=>k.contains(T))||(i==null||i(E),s==null||s(E),E.defaultPrevented||a==null||a())},u);return gf(E=>{w===p.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&a&&(E.preventDefault(),a()))},u),d.useEffect(()=>{if(f)return n&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(bs=u.body.style.pointerEvents,u.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(f)),p.layers.add(f),Ss(),()=>{n&&p.layersWithOutsidePointerEventsDisabled.size===1&&(u.body.style.pointerEvents=bs)}},[f,u,n,p]),d.useEffect(()=>()=>{f&&(p.layers.delete(f),p.layersWithOutsidePointerEventsDisabled.delete(f),Ss())},[f,p]),d.useEffect(()=>{const E=()=>h({});return document.addEventListener(Ao,E),()=>document.removeEventListener(Ao,E)},[]),l.jsx(Y.div,{...c,ref:x,style:{pointerEvents:b?S?"auto":"none":void 0,...t.style},onFocusCapture:D(t.onFocusCapture,A.onFocusCapture),onBlurCapture:D(t.onBlurCapture,A.onBlurCapture),onPointerDownCapture:D(t.onPointerDownCapture,_.onPointerDownCapture)})});jn.displayName=vf;var wf="DismissableLayerBranch",bf=d.forwardRef((t,e)=>{const n=d.useContext(Ia),r=d.useRef(null),o=re(e,r);return d.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),l.jsx(Y.div,{...t,ref:o})});bf.displayName=wf;function Sf(t,e=globalThis==null?void 0:globalThis.document){const n=ve(t),r=d.useRef(!1),o=d.useRef(()=>{});return d.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let c=function(){Oa(xf,n,p,{discrete:!0})};const p={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=c,e.addEventListener("click",o.current,{once:!0})):c()}else e.removeEventListener("click",o.current);r.current=!1},s=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(s),e.removeEventListener("pointerdown",i),e.removeEventListener("click",o.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function _f(t,e=globalThis==null?void 0:globalThis.document){const n=ve(t),r=d.useRef(!1);return d.useEffect(()=>{const o=i=>{i.target&&!r.current&&Oa(yf,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Ss(){const t=new CustomEvent(Ao);document.dispatchEvent(t)}function Oa(t,e,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?Pa(o,i):o.dispatchEvent(i)}var Jr="focusScope.autoFocusOnMount",Zr="focusScope.autoFocusOnUnmount",_s={bubbles:!1,cancelable:!0},Ef="FocusScope",wr=d.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...s}=t,[a,c]=d.useState(null),p=ve(o),f=ve(i),m=d.useRef(null),u=re(e,g=>c(g)),h=d.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;d.useEffect(()=>{if(r){let g=function(b){if(h.paused||!a)return;const S=b.target;a.contains(S)?m.current=S:ut(m.current,{select:!0})},v=function(b){if(h.paused||!a)return;const S=b.relatedTarget;S!==null&&(a.contains(S)||ut(m.current,{select:!0}))},y=function(b){if(document.activeElement===document.body)for(const _ of b)_.removedNodes.length>0&&ut(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",v);const w=new MutationObserver(y);return a&&w.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",v),w.disconnect()}}},[r,a,h.paused]),d.useEffect(()=>{if(a){Cs.add(h);const g=document.activeElement;if(!a.contains(g)){const y=new CustomEvent(Jr,_s);a.addEventListener(Jr,p),a.dispatchEvent(y),y.defaultPrevented||(Cf(jf(La(a)),{select:!0}),document.activeElement===g&&ut(a))}return()=>{a.removeEventListener(Jr,p),setTimeout(()=>{const y=new CustomEvent(Zr,_s);a.addEventListener(Zr,f),a.dispatchEvent(y),y.defaultPrevented||ut(g??document.body,{select:!0}),a.removeEventListener(Zr,f),Cs.remove(h)},0)}}},[a,p,f,h]);const x=d.useCallback(g=>{if(!n&&!r||h.paused)return;const v=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(v&&y){const w=g.currentTarget,[b,S]=Tf(w);b&&S?!g.shiftKey&&y===S?(g.preventDefault(),n&&ut(b,{select:!0})):g.shiftKey&&y===b&&(g.preventDefault(),n&&ut(S,{select:!0})):y===w&&g.preventDefault()}},[n,r,h.paused]);return l.jsx(Y.div,{tabIndex:-1,...s,ref:u,onKeyDown:x})});wr.displayName=Ef;function Cf(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(ut(r,{select:e}),document.activeElement!==n)return}function Tf(t){const e=La(t),n=Es(e,t),r=Es(e.reverse(),t);return[n,r]}function La(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Es(t,e){for(const n of t)if(!kf(n,{upTo:e}))return n}function kf(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Af(t){return t instanceof HTMLInputElement&&"select"in t}function ut(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Af(t)&&e&&t.select()}}var Cs=Nf();function Nf(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Ts(t,e),t.unshift(e)},remove(e){var n;t=Ts(t,e),(n=t[0])==null||n.resume()}}}function Ts(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function jf(t){return t.filter(e=>e.tagName!=="A")}var Rf="Portal",br=d.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[o,i]=d.useState(!1);xe(()=>i(!0),[]);const s=n||o&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return s?Ta.createPortal(l.jsx(Y.div,{...r,ref:e}),s):null});br.displayName=Rf;function Mf(t,e){return d.useReducer((n,r)=>e[n][r]??n,t)}var ke=t=>{const{present:e,children:n}=t,r=Pf(e),o=typeof n=="function"?n({present:r.isPresent}):d.Children.only(n),i=re(r.ref,If(o));return typeof n=="function"||r.isPresent?d.cloneElement(o,{ref:i}):null};ke.displayName="Presence";function Pf(t){const[e,n]=d.useState(),r=d.useRef({}),o=d.useRef(t),i=d.useRef("none"),s=t?"mounted":"unmounted",[a,c]=Mf(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return d.useEffect(()=>{const p=Hn(r.current);i.current=a==="mounted"?p:"none"},[a]),xe(()=>{const p=r.current,f=o.current;if(f!==t){const u=i.current,h=Hn(p);t?c("MOUNT"):h==="none"||(p==null?void 0:p.display)==="none"?c("UNMOUNT"):c(f&&u!==h?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,c]),xe(()=>{if(e){let p;const f=e.ownerDocument.defaultView??window,m=h=>{const g=Hn(r.current).includes(h.animationName);if(h.target===e&&g&&(c("ANIMATION_END"),!o.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",p=f.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},u=h=>{h.target===e&&(i.current=Hn(r.current))};return e.addEventListener("animationstart",u),e.addEventListener("animationcancel",m),e.addEventListener("animationend",m),()=>{f.clearTimeout(p),e.removeEventListener("animationstart",u),e.removeEventListener("animationcancel",m),e.removeEventListener("animationend",m)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:d.useCallback(p=>{p&&(r.current=getComputedStyle(p)),n(p)},[])}}function Hn(t){return(t==null?void 0:t.animationName)||"none"}function If(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var eo=0;function ui(){d.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??ks()),document.body.insertAdjacentElement("beforeend",t[1]??ks()),eo++,()=>{eo===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),eo--}},[])}function ks(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Ye=function(){return Ye=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ye.apply(this,arguments)};function Da(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function Of(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,i;r<o;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Xn="right-scroll-bar-position",Qn="width-before-scroll-bar",Lf="with-scroll-bars-hidden",Df="--removed-body-scroll-bar-size";function to(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function zf(t,e){var n=d.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=e,n.facade}var Ff=typeof window<"u"?d.useLayoutEffect:d.useEffect,As=new WeakMap;function $f(t,e){var n=zf(null,function(r){return t.forEach(function(o){return to(o,r)})});return Ff(function(){var r=As.get(n);if(r){var o=new Set(r),i=new Set(t),s=n.current;o.forEach(function(a){i.has(a)||to(a,null)}),i.forEach(function(a){o.has(a)||to(a,s)})}As.set(n,t)},[t]),n}function Uf(t){return t}function Hf(t,e){e===void 0&&(e=Uf);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var s=e(i,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(i){for(r=!0;n.length;){var s=n;n=[],s.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(i),s=n}var c=function(){var f=s;s=[],f.forEach(i)},p=function(){return Promise.resolve().then(c)};p(),n={push:function(f){s.push(f),p()},filter:function(f){return s=s.filter(f),n}}}};return o}function Bf(t){t===void 0&&(t={});var e=Hf(null);return e.options=Ye({async:!0,ssr:!1},t),e}var za=function(t){var e=t.sideCar,n=Da(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return d.createElement(r,Ye({},n))};za.isSideCarExport=!0;function Vf(t,e){return t.useMedium(e),za}var Fa=Bf(),no=function(){},Sr=d.forwardRef(function(t,e){var n=d.useRef(null),r=d.useState({onScrollCapture:no,onWheelCapture:no,onTouchMoveCapture:no}),o=r[0],i=r[1],s=t.forwardProps,a=t.children,c=t.className,p=t.removeScrollBar,f=t.enabled,m=t.shards,u=t.sideCar,h=t.noIsolation,x=t.inert,g=t.allowPinchZoom,v=t.as,y=v===void 0?"div":v,w=t.gapMode,b=Da(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=u,_=$f([n,e]),A=Ye(Ye({},b),o);return d.createElement(d.Fragment,null,f&&d.createElement(S,{sideCar:Fa,removeScrollBar:p,shards:m,noIsolation:h,inert:x,setCallbacks:i,allowPinchZoom:!!g,lockRef:n,gapMode:w}),s?d.cloneElement(d.Children.only(a),Ye(Ye({},A),{ref:_})):d.createElement(y,Ye({},A,{className:c,ref:_}),a))});Sr.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Sr.classNames={fullWidth:Qn,zeroRight:Xn};var qf=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Gf(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=qf();return e&&t.setAttribute("nonce",e),t}function Wf(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Kf(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Yf=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Gf())&&(Wf(e,n),Kf(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Xf=function(){var t=Yf();return function(e,n){d.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},$a=function(){var t=Xf(),e=function(n){var r=n.styles,o=n.dynamic;return t(r,o),null};return e},Qf={left:0,top:0,right:0,gap:0},ro=function(t){return parseInt(t||"",10)||0},Jf=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],o=e[t==="padding"?"paddingRight":"marginRight"];return[ro(n),ro(r),ro(o)]},Zf=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Qf;var e=Jf(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},em=$a(),Qt="data-scroll-locked",tm=function(t,e,n,r){var o=t.left,i=t.top,s=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Lf,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Qt,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Xn,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Qn,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Xn," .").concat(Xn,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Qn," .").concat(Qn,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Qt,`] {
    `).concat(Df,": ").concat(a,`px;
  }
`)},Ns=function(){var t=parseInt(document.body.getAttribute(Qt)||"0",10);return isFinite(t)?t:0},nm=function(){d.useEffect(function(){return document.body.setAttribute(Qt,(Ns()+1).toString()),function(){var t=Ns()-1;t<=0?document.body.removeAttribute(Qt):document.body.setAttribute(Qt,t.toString())}},[])},rm=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,o=r===void 0?"margin":r;nm();var i=d.useMemo(function(){return Zf(o)},[o]);return d.createElement(em,{styles:tm(i,!e,o,n?"":"!important")})},No=!1;if(typeof window<"u")try{var Bn=Object.defineProperty({},"passive",{get:function(){return No=!0,!0}});window.addEventListener("test",Bn,Bn),window.removeEventListener("test",Bn,Bn)}catch{No=!1}var Vt=No?{passive:!1}:!1,om=function(t){return t.tagName==="TEXTAREA"},Ua=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!om(t)&&n[e]==="visible")},im=function(t){return Ua(t,"overflowY")},sm=function(t){return Ua(t,"overflowX")},js=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=Ha(t,r);if(o){var i=Ba(t,r),s=i[1],a=i[2];if(s>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},am=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},cm=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},Ha=function(t,e){return t==="v"?im(e):sm(e)},Ba=function(t,e){return t==="v"?am(e):cm(e)},lm=function(t,e){return t==="h"&&e==="rtl"?-1:1},dm=function(t,e,n,r,o){var i=lm(t,window.getComputedStyle(e).direction),s=i*r,a=n.target,c=e.contains(a),p=!1,f=s>0,m=0,u=0;do{var h=Ba(t,a),x=h[0],g=h[1],v=h[2],y=g-v-i*x;(x||y)&&Ha(t,a)&&(m+=y,u+=x),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!c&&a!==document.body||c&&(e.contains(a)||e===a));return(f&&Math.abs(m)<1||!f&&Math.abs(u)<1)&&(p=!0),p},Vn=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Rs=function(t){return[t.deltaX,t.deltaY]},Ms=function(t){return t&&"current"in t?t.current:t},pm=function(t,e){return t[0]===e[0]&&t[1]===e[1]},um=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},fm=0,qt=[];function mm(t){var e=d.useRef([]),n=d.useRef([0,0]),r=d.useRef(),o=d.useState(fm++)[0],i=d.useState($a)[0],s=d.useRef(t);d.useEffect(function(){s.current=t},[t]),d.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(o));var g=Of([t.lockRef.current],(t.shards||[]).map(Ms),!0).filter(Boolean);return g.forEach(function(v){return v.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),g.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(o))})}}},[t.inert,t.lockRef.current,t.shards]);var a=d.useCallback(function(g,v){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!s.current.allowPinchZoom;var y=Vn(g),w=n.current,b="deltaX"in g?g.deltaX:w[0]-y[0],S="deltaY"in g?g.deltaY:w[1]-y[1],_,A=g.target,E=Math.abs(b)>Math.abs(S)?"h":"v";if("touches"in g&&E==="h"&&A.type==="range")return!1;var T=js(E,A);if(!T)return!0;if(T?_=E:(_=E==="v"?"h":"v",T=js(E,A)),!T)return!1;if(!r.current&&"changedTouches"in g&&(b||S)&&(r.current=_),!_)return!0;var C=r.current||_;return dm(C,v,g,C==="h"?b:S)},[]),c=d.useCallback(function(g){var v=g;if(!(!qt.length||qt[qt.length-1]!==i)){var y="deltaY"in v?Rs(v):Vn(v),w=e.current.filter(function(_){return _.name===v.type&&(_.target===v.target||v.target===_.shadowParent)&&pm(_.delta,y)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var b=(s.current.shards||[]).map(Ms).filter(Boolean).filter(function(_){return _.contains(v.target)}),S=b.length>0?a(v,b[0]):!s.current.noIsolation;S&&v.cancelable&&v.preventDefault()}}},[]),p=d.useCallback(function(g,v,y,w){var b={name:g,delta:v,target:y,should:w,shadowParent:hm(y)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(S){return S!==b})},1)},[]),f=d.useCallback(function(g){n.current=Vn(g),r.current=void 0},[]),m=d.useCallback(function(g){p(g.type,Rs(g),g.target,a(g,t.lockRef.current))},[]),u=d.useCallback(function(g){p(g.type,Vn(g),g.target,a(g,t.lockRef.current))},[]);d.useEffect(function(){return qt.push(i),t.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:u}),document.addEventListener("wheel",c,Vt),document.addEventListener("touchmove",c,Vt),document.addEventListener("touchstart",f,Vt),function(){qt=qt.filter(function(g){return g!==i}),document.removeEventListener("wheel",c,Vt),document.removeEventListener("touchmove",c,Vt),document.removeEventListener("touchstart",f,Vt)}},[]);var h=t.removeScrollBar,x=t.inert;return d.createElement(d.Fragment,null,x?d.createElement(i,{styles:um(o)}):null,h?d.createElement(rm,{gapMode:t.gapMode}):null)}function hm(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const gm=Vf(Fa,mm);var _r=d.forwardRef(function(t,e){return d.createElement(Sr,Ye({},t,{ref:e,sideCar:gm}))});_r.classNames=Sr.classNames;var vm=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Gt=new WeakMap,qn=new WeakMap,Gn={},oo=0,Va=function(t){return t&&(t.host||Va(t.parentNode))},xm=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=Va(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},ym=function(t,e,n,r){var o=xm(e,Array.isArray(t)?t:[t]);Gn[n]||(Gn[n]=new WeakMap);var i=Gn[n],s=[],a=new Set,c=new Set(o),p=function(m){!m||a.has(m)||(a.add(m),p(m.parentNode))};o.forEach(p);var f=function(m){!m||c.has(m)||Array.prototype.forEach.call(m.children,function(u){if(a.has(u))f(u);else try{var h=u.getAttribute(r),x=h!==null&&h!=="false",g=(Gt.get(u)||0)+1,v=(i.get(u)||0)+1;Gt.set(u,g),i.set(u,v),s.push(u),g===1&&x&&qn.set(u,!0),v===1&&u.setAttribute(n,"true"),x||u.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",u,y)}})};return f(e),a.clear(),oo++,function(){s.forEach(function(m){var u=Gt.get(m)-1,h=i.get(m)-1;Gt.set(m,u),i.set(m,h),u||(qn.has(m)||m.removeAttribute(r),qn.delete(m)),h||m.removeAttribute(n)}),oo--,oo||(Gt=new WeakMap,Gt=new WeakMap,qn=new WeakMap,Gn={})}},fi=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),o=vm(t);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),ym(r,o,n,"aria-hidden")):function(){return null}},mi="Dialog",[qa,CC]=wt(mi),[wm,qe]=qa(mi),Ga=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:o,onOpenChange:i,modal:s=!0}=t,a=d.useRef(null),c=d.useRef(null),[p=!1,f]=Ot({prop:r,defaultProp:o,onChange:i});return l.jsx(wm,{scope:e,triggerRef:a,contentRef:c,contentId:He(),titleId:He(),descriptionId:He(),open:p,onOpenChange:f,onOpenToggle:d.useCallback(()=>f(m=>!m),[f]),modal:s,children:n})};Ga.displayName=mi;var Wa="DialogTrigger",Ka=d.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=qe(Wa,n),i=re(e,o.triggerRef);return l.jsx(Y.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":vi(o.open),...r,ref:i,onClick:D(t.onClick,o.onOpenToggle)})});Ka.displayName=Wa;var hi="DialogPortal",[bm,Ya]=qa(hi,{forceMount:void 0}),Xa=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:o}=t,i=qe(hi,e);return l.jsx(bm,{scope:e,forceMount:n,children:d.Children.map(r,s=>l.jsx(ke,{present:n||i.open,children:l.jsx(br,{asChild:!0,container:o,children:s})}))})};Xa.displayName=hi;var ir="DialogOverlay",Qa=d.forwardRef((t,e)=>{const n=Ya(ir,t.__scopeDialog),{forceMount:r=n.forceMount,...o}=t,i=qe(ir,t.__scopeDialog);return i.modal?l.jsx(ke,{present:r||i.open,children:l.jsx(Sm,{...o,ref:e})}):null});Qa.displayName=ir;var Sm=d.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=qe(ir,n);return l.jsx(_r,{as:ht,allowPinchZoom:!0,shards:[o.contentRef],children:l.jsx(Y.div,{"data-state":vi(o.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Lt="DialogContent",Ja=d.forwardRef((t,e)=>{const n=Ya(Lt,t.__scopeDialog),{forceMount:r=n.forceMount,...o}=t,i=qe(Lt,t.__scopeDialog);return l.jsx(ke,{present:r||i.open,children:i.modal?l.jsx(_m,{...o,ref:e}):l.jsx(Em,{...o,ref:e})})});Ja.displayName=Lt;var _m=d.forwardRef((t,e)=>{const n=qe(Lt,t.__scopeDialog),r=d.useRef(null),o=re(e,n.contentRef,r);return d.useEffect(()=>{const i=r.current;if(i)return fi(i)},[]),l.jsx(Za,{...t,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:D(t.onCloseAutoFocus,i=>{var s;i.preventDefault(),(s=n.triggerRef.current)==null||s.focus()}),onPointerDownOutside:D(t.onPointerDownOutside,i=>{const s=i.detail.originalEvent,a=s.button===0&&s.ctrlKey===!0;(s.button===2||a)&&i.preventDefault()}),onFocusOutside:D(t.onFocusOutside,i=>i.preventDefault())})}),Em=d.forwardRef((t,e)=>{const n=qe(Lt,t.__scopeDialog),r=d.useRef(!1),o=d.useRef(!1);return l.jsx(Za,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var s,a;(s=t.onCloseAutoFocus)==null||s.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:i=>{var c,p;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const s=i.target;((p=n.triggerRef.current)==null?void 0:p.contains(s))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&o.current&&i.preventDefault()}})}),Za=d.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:i,...s}=t,a=qe(Lt,n),c=d.useRef(null),p=re(e,c);return ui(),l.jsxs(l.Fragment,{children:[l.jsx(wr,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:i,children:l.jsx(jn,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":vi(a.open),...s,ref:p,onDismiss:()=>a.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(Cm,{titleId:a.titleId}),l.jsx(km,{contentRef:c,descriptionId:a.descriptionId})]})]})}),gi="DialogTitle",ec=d.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=qe(gi,n);return l.jsx(Y.h2,{id:o.titleId,...r,ref:e})});ec.displayName=gi;var tc="DialogDescription",nc=d.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=qe(tc,n);return l.jsx(Y.p,{id:o.descriptionId,...r,ref:e})});nc.displayName=tc;var rc="DialogClose",oc=d.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=qe(rc,n);return l.jsx(Y.button,{type:"button",...r,ref:e,onClick:D(t.onClick,()=>o.onOpenChange(!1))})});oc.displayName=rc;function vi(t){return t?"open":"closed"}var ic="DialogTitleWarning",[TC,sc]=af(ic,{contentName:Lt,titleName:gi,docsSlug:"dialog"}),Cm=({titleId:t})=>{const e=sc(ic),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return d.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},Tm="DialogDescriptionWarning",km=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${sc(Tm).contentName}}.`;return d.useEffect(()=>{var i;const o=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&o&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},Am=Ga,Nm=Ka,jm=Xa,ac=Qa,cc=Ja,lc=ec,dc=nc,Rm=oc;/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pc=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Pm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=d.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:s,...a},c)=>d.createElement("svg",{ref:c,...Pm,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:pc("lucide",o),...a},[...s.map(([p,f])=>d.createElement(p,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=(t,e)=>{const n=d.forwardRef(({className:r,...o},i)=>d.createElement(Im,{ref:i,iconNode:e,className:pc(`lucide-${Mm(t)}`,r),...o}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uc=le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=le("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=le("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=le("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=le("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=le("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=le("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $m=le("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=le("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=le("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=le("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bm=le("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=le("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=le("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=le("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=le("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=le("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=le("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=le("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=le("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=le("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=le("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nh=le("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function mc(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=mc(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function hc(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=mc(t))&&(r&&(r+=" "),r+=e);return r}const Si="-",rh=t=>{const e=ih(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:s=>{const a=s.split(Si);return a[0]===""&&a.length!==1&&a.shift(),gc(a,e)||oh(s)},getConflictingClassGroupIds:(s,a)=>{const c=n[s]||[];return a&&r[s]?[...c,...r[s]]:c}}},gc=(t,e)=>{var s;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),o=r?gc(t.slice(1),r):void 0;if(o)return o;if(e.validators.length===0)return;const i=t.join(Si);return(s=e.validators.find(({validator:a})=>a(i)))==null?void 0:s.classGroupId},Is=/^\[(.+)\]$/,oh=t=>{if(Is.test(t)){const e=Is.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},ih=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return ah(Object.entries(t.classGroups),n).forEach(([i,s])=>{Po(s,r,i,e)}),r},Po=(t,e,n,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?e:Os(e,o);i.classGroupId=n;return}if(typeof o=="function"){if(sh(o)){Po(o(r),e,n,r);return}e.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,s])=>{Po(s,Os(e,i),n,r)})})},Os=(t,e)=>{let n=t;return e.split(Si).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},sh=t=>t.isThemeGetter,ah=(t,e)=>e?t.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([s,a])=>[e+s,a])):i);return[n,o]}):t,ch=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const o=(i,s)=>{n.set(i,s),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let s=n.get(i);if(s!==void 0)return s;if((s=r.get(i))!==void 0)return o(i,s),s},set(i,s){n.has(i)?n.set(i,s):o(i,s)}}},vc="!",lh=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,o=e[0],i=e.length,s=a=>{const c=[];let p=0,f=0,m;for(let v=0;v<a.length;v++){let y=a[v];if(p===0){if(y===o&&(r||a.slice(v,v+i)===e)){c.push(a.slice(f,v)),f=v+i;continue}if(y==="/"){m=v;continue}}y==="["?p++:y==="]"&&p--}const u=c.length===0?a:a.substring(f),h=u.startsWith(vc),x=h?u.substring(1):u,g=m&&m>f?m-f:void 0;return{modifiers:c,hasImportantModifier:h,baseClassName:x,maybePostfixModifierPosition:g}};return n?a=>n({className:a,parseClassName:s}):s},dh=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},ph=t=>({cache:ch(t.cacheSize),parseClassName:lh(t),...rh(t)}),uh=/\s+/,fh=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=e,i=[],s=t.trim().split(uh);let a="";for(let c=s.length-1;c>=0;c-=1){const p=s[c],{modifiers:f,hasImportantModifier:m,baseClassName:u,maybePostfixModifierPosition:h}=n(p);let x=!!h,g=r(x?u.substring(0,h):u);if(!g){if(!x){a=p+(a.length>0?" "+a:a);continue}if(g=r(u),!g){a=p+(a.length>0?" "+a:a);continue}x=!1}const v=dh(f).join(":"),y=m?v+vc:v,w=y+g;if(i.includes(w))continue;i.push(w);const b=o(g,x);for(let S=0;S<b.length;++S){const _=b[S];i.push(y+_)}a=p+(a.length>0?" "+a:a)}return a};function mh(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=xc(e))&&(r&&(r+=" "),r+=n);return r}const xc=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=xc(t[r]))&&(n&&(n+=" "),n+=e);return n};function hh(t,...e){let n,r,o,i=s;function s(c){const p=e.reduce((f,m)=>m(f),t());return n=ph(p),r=n.cache.get,o=n.cache.set,i=a,a(c)}function a(c){const p=r(c);if(p)return p;const f=fh(c,n);return o(c,f),f}return function(){return i(mh.apply(null,arguments))}}const he=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},yc=/^\[(?:([a-z-]+):)?(.+)\]$/i,gh=/^\d+\/\d+$/,vh=new Set(["px","full","screen"]),xh=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,yh=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,wh=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,bh=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Sh=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,rt=t=>Jt(t)||vh.has(t)||gh.test(t),dt=t=>on(t,"length",jh),Jt=t=>!!t&&!Number.isNaN(Number(t)),io=t=>on(t,"number",Jt),dn=t=>!!t&&Number.isInteger(Number(t)),_h=t=>t.endsWith("%")&&Jt(t.slice(0,-1)),Z=t=>yc.test(t),pt=t=>xh.test(t),Eh=new Set(["length","size","percentage"]),Ch=t=>on(t,Eh,wc),Th=t=>on(t,"position",wc),kh=new Set(["image","url"]),Ah=t=>on(t,kh,Mh),Nh=t=>on(t,"",Rh),pn=()=>!0,on=(t,e,n)=>{const r=yc.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},jh=t=>yh.test(t)&&!wh.test(t),wc=()=>!1,Rh=t=>bh.test(t),Mh=t=>Sh.test(t),Ph=()=>{const t=he("colors"),e=he("spacing"),n=he("blur"),r=he("brightness"),o=he("borderColor"),i=he("borderRadius"),s=he("borderSpacing"),a=he("borderWidth"),c=he("contrast"),p=he("grayscale"),f=he("hueRotate"),m=he("invert"),u=he("gap"),h=he("gradientColorStops"),x=he("gradientColorStopPositions"),g=he("inset"),v=he("margin"),y=he("opacity"),w=he("padding"),b=he("saturate"),S=he("scale"),_=he("sepia"),A=he("skew"),E=he("space"),T=he("translate"),C=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto",Z,e],P=()=>[Z,e],F=()=>["",rt,dt],$=()=>["auto",Jt,Z],G=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],N=()=>["solid","dashed","dotted","double","none"],L=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],M=()=>["start","end","center","between","around","evenly","stretch"],j=()=>["","0",Z],W=()=>["auto","avoid","all","avoid-page","page","left","right","column"],z=()=>[Jt,Z];return{cacheSize:500,separator:":",theme:{colors:[pn],spacing:[rt,dt],blur:["none","",pt,Z],brightness:z(),borderColor:[t],borderRadius:["none","","full",pt,Z],borderSpacing:P(),borderWidth:F(),contrast:z(),grayscale:j(),hueRotate:z(),invert:j(),gap:P(),gradientColorStops:[t],gradientColorStopPositions:[_h,dt],inset:R(),margin:R(),opacity:z(),padding:P(),saturate:z(),scale:z(),sepia:j(),skew:z(),space:P(),translate:P()},classGroups:{aspect:[{aspect:["auto","square","video",Z]}],container:["container"],columns:[{columns:[pt]}],"break-after":[{"break-after":W()}],"break-before":[{"break-before":W()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...G(),Z]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",dn,Z]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Z]}],grow:[{grow:j()}],shrink:[{shrink:j()}],order:[{order:["first","last","none",dn,Z]}],"grid-cols":[{"grid-cols":[pn]}],"col-start-end":[{col:["auto",{span:["full",dn,Z]},Z]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[pn]}],"row-start-end":[{row:["auto",{span:[dn,Z]},Z]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Z]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Z]}],gap:[{gap:[u]}],"gap-x":[{"gap-x":[u]}],"gap-y":[{"gap-y":[u]}],"justify-content":[{justify:["normal",...M()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...M(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...M(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Z,e]}],"min-w":[{"min-w":[Z,e,"min","max","fit"]}],"max-w":[{"max-w":[Z,e,"none","full","min","max","fit","prose",{screen:[pt]},pt]}],h:[{h:[Z,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Z,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Z,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Z,e,"auto","min","max","fit"]}],"font-size":[{text:["base",pt,dt]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",io]}],"font-family":[{font:[pn]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Z]}],"line-clamp":[{"line-clamp":["none",Jt,io]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",rt,Z]}],"list-image":[{"list-image":["none",Z]}],"list-style-type":[{list:["none","disc","decimal",Z]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...N(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",rt,dt]}],"underline-offset":[{"underline-offset":["auto",rt,Z]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Z]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Z]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...G(),Th]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Ch]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Ah]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...N(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:N()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...N()]}],"outline-offset":[{"outline-offset":[rt,Z]}],"outline-w":[{outline:[rt,dt]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:F()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[rt,dt]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",pt,Nh]}],"shadow-color":[{shadow:[pn]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...L(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":L()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",pt,Z]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[m]}],saturate:[{saturate:[b]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Z]}],duration:[{duration:z()}],ease:[{ease:["linear","in","out","in-out",Z]}],delay:[{delay:z()}],animate:[{animate:["none","spin","ping","pulse","bounce",Z]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[dn,Z]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Z]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Z]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Z]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[rt,dt,io]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Ih=hh(Ph);function B(...t){return Ih(hc(t))}const bc=Am,kC=Nm,Oh=jm,Sc=d.forwardRef(({className:t,...e},n)=>l.jsx(ac,{ref:n,className:B("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));Sc.displayName=ac.displayName;const _i=d.forwardRef(({className:t,children:e,...n},r)=>l.jsxs(Oh,{children:[l.jsx(Sc,{}),l.jsxs(cc,{ref:r,className:B("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,l.jsxs(Rm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[l.jsx(bi,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));_i.displayName=cc.displayName;const Ei=({className:t,...e})=>l.jsx("div",{className:B("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Ei.displayName="DialogHeader";const Lh=({className:t,...e})=>l.jsx("div",{className:B("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Lh.displayName="DialogFooter";const Ci=d.forwardRef(({className:t,...e},n)=>l.jsx(lc,{ref:n,className:B("text-lg font-semibold leading-none tracking-tight",t),...e}));Ci.displayName=lc.displayName;const Ti=d.forwardRef(({className:t,...e},n)=>l.jsx(dc,{ref:n,className:B("text-sm text-muted-foreground",t),...e}));Ti.displayName=dc.displayName;function Dh(t,e=[]){let n=[];function r(i,s){const a=d.createContext(s),c=n.length;n=[...n,s];function p(m){const{scope:u,children:h,...x}=m,g=(u==null?void 0:u[t][c])||a,v=d.useMemo(()=>x,Object.values(x));return l.jsx(g.Provider,{value:v,children:h})}function f(m,u){const h=(u==null?void 0:u[t][c])||a,x=d.useContext(h);if(x)return x;if(s!==void 0)return s;throw new Error(`\`${m}\` must be used within \`${i}\``)}return p.displayName=i+"Provider",[p,f]}const o=()=>{const i=n.map(s=>d.createContext(s));return function(a){const c=(a==null?void 0:a[t])||i;return d.useMemo(()=>({[`__scope${t}`]:{...a,[t]:c}}),[a,c])}};return o.scopeName=t,[r,zh(o,...e)]}function zh(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const s=r.reduce((a,{useScope:c,scopeName:p})=>{const m=c(i)[`__scope${p}`];return{...a,...m}},{});return d.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}function ki(t){const e=t+"CollectionProvider",[n,r]=Dh(e),[o,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),s=h=>{const{scope:x,children:g}=h,v=O.useRef(null),y=O.useRef(new Map).current;return l.jsx(o,{scope:x,itemMap:y,collectionRef:v,children:g})};s.displayName=e;const a=t+"CollectionSlot",c=O.forwardRef((h,x)=>{const{scope:g,children:v}=h,y=i(a,g),w=re(x,y.collectionRef);return l.jsx(ht,{ref:w,children:v})});c.displayName=a;const p=t+"CollectionItemSlot",f="data-radix-collection-item",m=O.forwardRef((h,x)=>{const{scope:g,children:v,...y}=h,w=O.useRef(null),b=re(x,w),S=i(p,g);return O.useEffect(()=>(S.itemMap.set(w,{ref:w,...y}),()=>void S.itemMap.delete(w))),l.jsx(ht,{[f]:"",ref:b,children:v})});m.displayName=p;function u(h){const x=i(t+"CollectionConsumer",h);return O.useCallback(()=>{const v=x.collectionRef.current;if(!v)return[];const y=Array.from(v.querySelectorAll(`[${f}]`));return Array.from(x.itemMap.values()).sort((S,_)=>y.indexOf(S.ref.current)-y.indexOf(_.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:s,Slot:c,ItemSlot:m},u,r]}function Fh(t,e=[]){let n=[];function r(i,s){const a=d.createContext(s),c=n.length;n=[...n,s];function p(m){const{scope:u,children:h,...x}=m,g=(u==null?void 0:u[t][c])||a,v=d.useMemo(()=>x,Object.values(x));return l.jsx(g.Provider,{value:v,children:h})}function f(m,u){const h=(u==null?void 0:u[t][c])||a,x=d.useContext(h);if(x)return x;if(s!==void 0)return s;throw new Error(`\`${m}\` must be used within \`${i}\``)}return p.displayName=i+"Provider",[p,f]}const o=()=>{const i=n.map(s=>d.createContext(s));return function(a){const c=(a==null?void 0:a[t])||i;return d.useMemo(()=>({[`__scope${t}`]:{...a,[t]:c}}),[a,c])}};return o.scopeName=t,[r,$h(o,...e)]}function $h(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const s=r.reduce((a,{useScope:c,scopeName:p})=>{const m=c(i)[`__scope${p}`];return{...a,...m}},{});return d.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}var Uh=d.createContext(void 0);function Rn(t){const e=d.useContext(Uh);return t||e||"ltr"}var so="rovingFocusGroup.onEntryFocus",Hh={bubbles:!1,cancelable:!0},Er="RovingFocusGroup",[Io,_c,Bh]=ki(Er),[Vh,Cr]=Fh(Er,[Bh]),[qh,Gh]=Vh(Er),Ec=d.forwardRef((t,e)=>l.jsx(Io.Provider,{scope:t.__scopeRovingFocusGroup,children:l.jsx(Io.Slot,{scope:t.__scopeRovingFocusGroup,children:l.jsx(Wh,{...t,ref:e})})}));Ec.displayName=Er;var Wh=d.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:i,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:c,onEntryFocus:p,preventScrollOnEntryFocus:f=!1,...m}=t,u=d.useRef(null),h=re(e,u),x=Rn(i),[g=null,v]=Ot({prop:s,defaultProp:a,onChange:c}),[y,w]=d.useState(!1),b=ve(p),S=_c(n),_=d.useRef(!1),[A,E]=d.useState(0);return d.useEffect(()=>{const T=u.current;if(T)return T.addEventListener(so,b),()=>T.removeEventListener(so,b)},[b]),l.jsx(qh,{scope:n,orientation:r,dir:x,loop:o,currentTabStopId:g,onItemFocus:d.useCallback(T=>v(T),[v]),onItemShiftTab:d.useCallback(()=>w(!0),[]),onFocusableItemAdd:d.useCallback(()=>E(T=>T+1),[]),onFocusableItemRemove:d.useCallback(()=>E(T=>T-1),[]),children:l.jsx(Y.div,{tabIndex:y||A===0?-1:0,"data-orientation":r,...m,ref:h,style:{outline:"none",...t.style},onMouseDown:D(t.onMouseDown,()=>{_.current=!0}),onFocus:D(t.onFocus,T=>{const C=!_.current;if(T.target===T.currentTarget&&C&&!y){const k=new CustomEvent(so,Hh);if(T.currentTarget.dispatchEvent(k),!k.defaultPrevented){const R=S().filter(N=>N.focusable),P=R.find(N=>N.active),F=R.find(N=>N.id===g),G=[P,F,...R].filter(Boolean).map(N=>N.ref.current);kc(G,f)}}_.current=!1}),onBlur:D(t.onBlur,()=>w(!1))})})}),Cc="RovingFocusGroupItem",Tc=d.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:i,...s}=t,a=He(),c=i||a,p=Gh(Cc,n),f=p.currentTabStopId===c,m=_c(n),{onFocusableItemAdd:u,onFocusableItemRemove:h}=p;return d.useEffect(()=>{if(r)return u(),()=>h()},[r,u,h]),l.jsx(Io.ItemSlot,{scope:n,id:c,focusable:r,active:o,children:l.jsx(Y.span,{tabIndex:f?0:-1,"data-orientation":p.orientation,...s,ref:e,onMouseDown:D(t.onMouseDown,x=>{r?p.onItemFocus(c):x.preventDefault()}),onFocus:D(t.onFocus,()=>p.onItemFocus(c)),onKeyDown:D(t.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){p.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const g=Xh(x,p.orientation,p.dir);if(g!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let y=m().filter(w=>w.focusable).map(w=>w.ref.current);if(g==="last")y.reverse();else if(g==="prev"||g==="next"){g==="prev"&&y.reverse();const w=y.indexOf(x.currentTarget);y=p.loop?Qh(y,w+1):y.slice(w+1)}setTimeout(()=>kc(y))}})})})});Tc.displayName=Cc;var Kh={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Yh(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Xh(t,e,n){const r=Yh(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Kh[r]}function kc(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function Qh(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var Ac=Ec,Nc=Tc,Ai="Tabs",[Jh,AC]=wt(Ai,[Cr]),jc=Cr(),[Zh,Ni]=Jh(Ai),Rc=d.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:o,defaultValue:i,orientation:s="horizontal",dir:a,activationMode:c="automatic",...p}=t,f=Rn(a),[m,u]=Ot({prop:r,onChange:o,defaultProp:i});return l.jsx(Zh,{scope:n,baseId:He(),value:m,onValueChange:u,orientation:s,dir:f,activationMode:c,children:l.jsx(Y.div,{dir:f,"data-orientation":s,...p,ref:e})})});Rc.displayName=Ai;var Mc="TabsList",Pc=d.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...o}=t,i=Ni(Mc,n),s=jc(n);return l.jsx(Ac,{asChild:!0,...s,orientation:i.orientation,dir:i.dir,loop:r,children:l.jsx(Y.div,{role:"tablist","aria-orientation":i.orientation,...o,ref:e})})});Pc.displayName=Mc;var Ic="TabsTrigger",Oc=d.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:o=!1,...i}=t,s=Ni(Ic,n),a=jc(n),c=zc(s.baseId,r),p=Fc(s.baseId,r),f=r===s.value;return l.jsx(Nc,{asChild:!0,...a,focusable:!o,active:f,children:l.jsx(Y.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":p,"data-state":f?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:c,...i,ref:e,onMouseDown:D(t.onMouseDown,m=>{!o&&m.button===0&&m.ctrlKey===!1?s.onValueChange(r):m.preventDefault()}),onKeyDown:D(t.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&s.onValueChange(r)}),onFocus:D(t.onFocus,()=>{const m=s.activationMode!=="manual";!f&&!o&&m&&s.onValueChange(r)})})})});Oc.displayName=Ic;var Lc="TabsContent",Dc=d.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:o,children:i,...s}=t,a=Ni(Lc,n),c=zc(a.baseId,r),p=Fc(a.baseId,r),f=r===a.value,m=d.useRef(f);return d.useEffect(()=>{const u=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(u)},[]),l.jsx(ke,{present:o||f,children:({present:u})=>l.jsx(Y.div,{"data-state":f?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":c,hidden:!u,id:p,tabIndex:0,...s,ref:e,style:{...t.style,animationDuration:m.current?"0s":void 0},children:u&&i})})});Dc.displayName=Lc;function zc(t,e){return`${t}-trigger-${e}`}function Fc(t,e){return`${t}-content-${e}`}var eg=Rc,$c=Pc,Uc=Oc,Hc=Dc;const tg=eg,Bc=d.forwardRef(({className:t,...e},n)=>l.jsx($c,{ref:n,className:B("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));Bc.displayName=$c.displayName;const Oo=d.forwardRef(({className:t,...e},n)=>l.jsx(Uc,{ref:n,className:B("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));Oo.displayName=Uc.displayName;const Lo=d.forwardRef(({className:t,...e},n)=>l.jsx(Hc,{ref:n,className:B("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Lo.displayName=Hc.displayName;const Ls=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Ds=hc,Tr=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return Ds(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:i}=e,s=Object.keys(o).map(p=>{const f=n==null?void 0:n[p],m=i==null?void 0:i[p];if(f===null)return null;const u=Ls(f)||Ls(m);return o[p][u]}),a=n&&Object.entries(n).reduce((p,f)=>{let[m,u]=f;return u===void 0||(p[m]=u),p},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((p,f)=>{let{class:m,className:u,...h}=f;return Object.entries(h).every(x=>{let[g,v]=x;return Array.isArray(v)?v.includes({...i,...a}[g]):{...i,...a}[g]===v})?[...p,m,u]:p},[]);return Ds(t,s,c,n==null?void 0:n.class,n==null?void 0:n.className)},ng=Tr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm"},size:{default:"h-11 px-6 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-md px-8",icon:"h-11 w-11"}},defaultVariants:{variant:"default",size:"default"}}),pe=d.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...o},i)=>{const s=r?ht:"button";return l.jsx(s,{className:B(ng({variant:e,size:n,className:t})),ref:i,...o})});pe.displayName="Button";const Xe=d.forwardRef(({className:t,type:e,...n},r)=>l.jsx("input",{type:e,className:B("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));Xe.displayName="Input";var rg="Label",Vc=d.forwardRef((t,e)=>l.jsx(Y.label,{...t,ref:e,onMouseDown:n=>{var o;n.target.closest("button, input, select, textarea")||((o=t.onMouseDown)==null||o.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Vc.displayName=rg;var qc=Vc;const og=Tr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),mt=d.forwardRef(({className:t,...e},n)=>l.jsx(qc,{ref:n,className:B(og(),t),...e}));mt.displayName=qc.displayName;const ig=Tr("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),kr=d.forwardRef(({className:t,variant:e,...n},r)=>l.jsx("div",{ref:r,role:"alert",className:B(ig({variant:e}),t),...n}));kr.displayName="Alert";const sg=d.forwardRef(({className:t,...e},n)=>l.jsx("h5",{ref:n,className:B("mb-1 font-medium leading-none tracking-tight",t),...e}));sg.displayName="AlertTitle";const Ar=d.forwardRef(({className:t,...e},n)=>l.jsx("div",{ref:n,className:B("text-sm [&_p]:leading-relaxed",t),...e}));Ar.displayName="AlertDescription";function Do(t,[e,n]){return Math.min(n,Math.max(e,t))}const ag=["top","right","bottom","left"],gt=Math.min,Me=Math.max,sr=Math.round,Wn=Math.floor,vt=t=>({x:t,y:t}),cg={left:"right",right:"left",bottom:"top",top:"bottom"},lg={start:"end",end:"start"};function zo(t,e,n){return Me(t,gt(e,n))}function st(t,e){return typeof t=="function"?t(e):t}function at(t){return t.split("-")[0]}function sn(t){return t.split("-")[1]}function ji(t){return t==="x"?"y":"x"}function Ri(t){return t==="y"?"height":"width"}function xt(t){return["top","bottom"].includes(at(t))?"y":"x"}function Mi(t){return ji(xt(t))}function dg(t,e,n){n===void 0&&(n=!1);const r=sn(t),o=Mi(t),i=Ri(o);let s=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(s=ar(s)),[s,ar(s)]}function pg(t){const e=ar(t);return[Fo(t),e,Fo(e)]}function Fo(t){return t.replace(/start|end/g,e=>lg[e])}function ug(t,e,n){const r=["left","right"],o=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?o:r:e?r:o;case"left":case"right":return e?i:s;default:return[]}}function fg(t,e,n,r){const o=sn(t);let i=ug(at(t),n==="start",r);return o&&(i=i.map(s=>s+"-"+o),e&&(i=i.concat(i.map(Fo)))),i}function ar(t){return t.replace(/left|right|bottom|top/g,e=>cg[e])}function mg(t){return{top:0,right:0,bottom:0,left:0,...t}}function Gc(t){return typeof t!="number"?mg(t):{top:t,right:t,bottom:t,left:t}}function cr(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function zs(t,e,n){let{reference:r,floating:o}=t;const i=xt(e),s=Mi(e),a=Ri(s),c=at(e),p=i==="y",f=r.x+r.width/2-o.width/2,m=r.y+r.height/2-o.height/2,u=r[a]/2-o[a]/2;let h;switch(c){case"top":h={x:f,y:r.y-o.height};break;case"bottom":h={x:f,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:m};break;case"left":h={x:r.x-o.width,y:m};break;default:h={x:r.x,y:r.y}}switch(sn(e)){case"start":h[s]-=u*(n&&p?-1:1);break;case"end":h[s]+=u*(n&&p?-1:1);break}return h}const hg=async(t,e,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:s}=n,a=i.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(e));let p=await s.getElementRects({reference:t,floating:e,strategy:o}),{x:f,y:m}=zs(p,r,c),u=r,h={},x=0;for(let g=0;g<a.length;g++){const{name:v,fn:y}=a[g],{x:w,y:b,data:S,reset:_}=await y({x:f,y:m,initialPlacement:r,placement:u,strategy:o,middlewareData:h,rects:p,platform:s,elements:{reference:t,floating:e}});f=w??f,m=b??m,h={...h,[v]:{...h[v],...S}},_&&x<=50&&(x++,typeof _=="object"&&(_.placement&&(u=_.placement),_.rects&&(p=_.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:o}):_.rects),{x:f,y:m}=zs(p,u,c)),g=-1)}return{x:f,y:m,placement:u,strategy:o,middlewareData:h}};async function _n(t,e){var n;e===void 0&&(e={});const{x:r,y:o,platform:i,rects:s,elements:a,strategy:c}=t,{boundary:p="clippingAncestors",rootBoundary:f="viewport",elementContext:m="floating",altBoundary:u=!1,padding:h=0}=st(e,t),x=Gc(h),v=a[u?m==="floating"?"reference":"floating":m],y=cr(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:p,rootBoundary:f,strategy:c})),w=m==="floating"?{x:r,y:o,width:s.floating.width,height:s.floating.height}:s.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),S=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},_=cr(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:w,offsetParent:b,strategy:c}):w);return{top:(y.top-_.top+x.top)/S.y,bottom:(_.bottom-y.bottom+x.bottom)/S.y,left:(y.left-_.left+x.left)/S.x,right:(_.right-y.right+x.right)/S.x}}const gg=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:o,rects:i,platform:s,elements:a,middlewareData:c}=e,{element:p,padding:f=0}=st(t,e)||{};if(p==null)return{};const m=Gc(f),u={x:n,y:r},h=Mi(o),x=Ri(h),g=await s.getDimensions(p),v=h==="y",y=v?"top":"left",w=v?"bottom":"right",b=v?"clientHeight":"clientWidth",S=i.reference[x]+i.reference[h]-u[h]-i.floating[x],_=u[h]-i.reference[h],A=await(s.getOffsetParent==null?void 0:s.getOffsetParent(p));let E=A?A[b]:0;(!E||!await(s.isElement==null?void 0:s.isElement(A)))&&(E=a.floating[b]||i.floating[x]);const T=S/2-_/2,C=E/2-g[x]/2-1,k=gt(m[y],C),R=gt(m[w],C),P=k,F=E-g[x]-R,$=E/2-g[x]/2+T,G=zo(P,$,F),N=!c.arrow&&sn(o)!=null&&$!==G&&i.reference[x]/2-($<P?k:R)-g[x]/2<0,L=N?$<P?$-P:$-F:0;return{[h]:u[h]+L,data:{[h]:G,centerOffset:$-G-L,...N&&{alignmentOffset:L}},reset:N}}}),vg=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:o,middlewareData:i,rects:s,initialPlacement:a,platform:c,elements:p}=e,{mainAxis:f=!0,crossAxis:m=!0,fallbackPlacements:u,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:g=!0,...v}=st(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const y=at(o),w=xt(a),b=at(a)===a,S=await(c.isRTL==null?void 0:c.isRTL(p.floating)),_=u||(b||!g?[ar(a)]:pg(a)),A=x!=="none";!u&&A&&_.push(...fg(a,g,x,S));const E=[a,..._],T=await _n(e,v),C=[];let k=((r=i.flip)==null?void 0:r.overflows)||[];if(f&&C.push(T[y]),m){const $=dg(o,s,S);C.push(T[$[0]],T[$[1]])}if(k=[...k,{placement:o,overflows:C}],!C.every($=>$<=0)){var R,P;const $=(((R=i.flip)==null?void 0:R.index)||0)+1,G=E[$];if(G)return{data:{index:$,overflows:k},reset:{placement:G}};let N=(P=k.filter(L=>L.overflows[0]<=0).sort((L,M)=>L.overflows[1]-M.overflows[1])[0])==null?void 0:P.placement;if(!N)switch(h){case"bestFit":{var F;const L=(F=k.filter(M=>{if(A){const j=xt(M.placement);return j===w||j==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(j=>j>0).reduce((j,W)=>j+W,0)]).sort((M,j)=>M[1]-j[1])[0])==null?void 0:F[0];L&&(N=L);break}case"initialPlacement":N=a;break}if(o!==N)return{reset:{placement:N}}}return{}}}};function Fs(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function $s(t){return ag.some(e=>t[e]>=0)}const xg=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...o}=st(t,e);switch(r){case"referenceHidden":{const i=await _n(e,{...o,elementContext:"reference"}),s=Fs(i,n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:$s(s)}}}case"escaped":{const i=await _n(e,{...o,altBoundary:!0}),s=Fs(i,n.floating);return{data:{escapedOffsets:s,escaped:$s(s)}}}default:return{}}}}};async function yg(t,e){const{placement:n,platform:r,elements:o}=t,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),s=at(n),a=sn(n),c=xt(n)==="y",p=["left","top"].includes(s)?-1:1,f=i&&c?-1:1,m=st(e,t);let{mainAxis:u,crossAxis:h,alignmentAxis:x}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return a&&typeof x=="number"&&(h=a==="end"?x*-1:x),c?{x:h*f,y:u*p}:{x:u*p,y:h*f}}const wg=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:o,y:i,placement:s,middlewareData:a}=e,c=await yg(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:o+c.x,y:i+c.y,data:{...c,placement:s}}}}},bg=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:o}=e,{mainAxis:i=!0,crossAxis:s=!1,limiter:a={fn:v=>{let{x:y,y:w}=v;return{x:y,y:w}}},...c}=st(t,e),p={x:n,y:r},f=await _n(e,c),m=xt(at(o)),u=ji(m);let h=p[u],x=p[m];if(i){const v=u==="y"?"top":"left",y=u==="y"?"bottom":"right",w=h+f[v],b=h-f[y];h=zo(w,h,b)}if(s){const v=m==="y"?"top":"left",y=m==="y"?"bottom":"right",w=x+f[v],b=x-f[y];x=zo(w,x,b)}const g=a.fn({...e,[u]:h,[m]:x});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[u]:i,[m]:s}}}}}},Sg=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:o,rects:i,middlewareData:s}=e,{offset:a=0,mainAxis:c=!0,crossAxis:p=!0}=st(t,e),f={x:n,y:r},m=xt(o),u=ji(m);let h=f[u],x=f[m];const g=st(a,e),v=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const b=u==="y"?"height":"width",S=i.reference[u]-i.floating[b]+v.mainAxis,_=i.reference[u]+i.reference[b]-v.mainAxis;h<S?h=S:h>_&&(h=_)}if(p){var y,w;const b=u==="y"?"width":"height",S=["top","left"].includes(at(o)),_=i.reference[m]-i.floating[b]+(S&&((y=s.offset)==null?void 0:y[m])||0)+(S?0:v.crossAxis),A=i.reference[m]+i.reference[b]+(S?0:((w=s.offset)==null?void 0:w[m])||0)-(S?v.crossAxis:0);x<_?x=_:x>A&&(x=A)}return{[u]:h,[m]:x}}}},_g=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:o,rects:i,platform:s,elements:a}=e,{apply:c=()=>{},...p}=st(t,e),f=await _n(e,p),m=at(o),u=sn(o),h=xt(o)==="y",{width:x,height:g}=i.floating;let v,y;m==="top"||m==="bottom"?(v=m,y=u===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(y=m,v=u==="end"?"top":"bottom");const w=g-f.top-f.bottom,b=x-f.left-f.right,S=gt(g-f[v],w),_=gt(x-f[y],b),A=!e.middlewareData.shift;let E=S,T=_;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(T=b),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=w),A&&!u){const k=Me(f.left,0),R=Me(f.right,0),P=Me(f.top,0),F=Me(f.bottom,0);h?T=x-2*(k!==0||R!==0?k+R:Me(f.left,f.right)):E=g-2*(P!==0||F!==0?P+F:Me(f.top,f.bottom))}await c({...e,availableWidth:T,availableHeight:E});const C=await s.getDimensions(a.floating);return x!==C.width||g!==C.height?{reset:{rects:!0}}:{}}}};function Nr(){return typeof window<"u"}function an(t){return Wc(t)?(t.nodeName||"").toLowerCase():"#document"}function Pe(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function et(t){var e;return(e=(Wc(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Wc(t){return Nr()?t instanceof Node||t instanceof Pe(t).Node:!1}function Be(t){return Nr()?t instanceof Element||t instanceof Pe(t).Element:!1}function Ze(t){return Nr()?t instanceof HTMLElement||t instanceof Pe(t).HTMLElement:!1}function Us(t){return!Nr()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Pe(t).ShadowRoot}function Mn(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=Ve(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(o)}function Eg(t){return["table","td","th"].includes(an(t))}function jr(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Pi(t){const e=Ii(),n=Be(t)?Ve(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Cg(t){let e=yt(t);for(;Ze(e)&&!tn(e);){if(Pi(e))return e;if(jr(e))return null;e=yt(e)}return null}function Ii(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function tn(t){return["html","body","#document"].includes(an(t))}function Ve(t){return Pe(t).getComputedStyle(t)}function Rr(t){return Be(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function yt(t){if(an(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Us(t)&&t.host||et(t);return Us(e)?e.host:e}function Kc(t){const e=yt(t);return tn(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ze(e)&&Mn(e)?e:Kc(e)}function En(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=Kc(t),i=o===((r=t.ownerDocument)==null?void 0:r.body),s=Pe(o);if(i){const a=$o(s);return e.concat(s,s.visualViewport||[],Mn(o)?o:[],a&&n?En(a):[])}return e.concat(o,En(o,[],n))}function $o(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Yc(t){const e=Ve(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=Ze(t),i=o?t.offsetWidth:n,s=o?t.offsetHeight:r,a=sr(n)!==i||sr(r)!==s;return a&&(n=i,r=s),{width:n,height:r,$:a}}function Oi(t){return Be(t)?t:t.contextElement}function Zt(t){const e=Oi(t);if(!Ze(e))return vt(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:i}=Yc(e);let s=(i?sr(n.width):n.width)/r,a=(i?sr(n.height):n.height)/o;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const Tg=vt(0);function Xc(t){const e=Pe(t);return!Ii()||!e.visualViewport?Tg:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function kg(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Pe(t)?!1:e}function Dt(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const o=t.getBoundingClientRect(),i=Oi(t);let s=vt(1);e&&(r?Be(r)&&(s=Zt(r)):s=Zt(t));const a=kg(i,n,r)?Xc(i):vt(0);let c=(o.left+a.x)/s.x,p=(o.top+a.y)/s.y,f=o.width/s.x,m=o.height/s.y;if(i){const u=Pe(i),h=r&&Be(r)?Pe(r):r;let x=u,g=$o(x);for(;g&&r&&h!==x;){const v=Zt(g),y=g.getBoundingClientRect(),w=Ve(g),b=y.left+(g.clientLeft+parseFloat(w.paddingLeft))*v.x,S=y.top+(g.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,p*=v.y,f*=v.x,m*=v.y,c+=b,p+=S,x=Pe(g),g=$o(x)}}return cr({width:f,height:m,x:c,y:p})}function Ag(t){let{elements:e,rect:n,offsetParent:r,strategy:o}=t;const i=o==="fixed",s=et(r),a=e?jr(e.floating):!1;if(r===s||a&&i)return n;let c={scrollLeft:0,scrollTop:0},p=vt(1);const f=vt(0),m=Ze(r);if((m||!m&&!i)&&((an(r)!=="body"||Mn(s))&&(c=Rr(r)),Ze(r))){const u=Dt(r);p=Zt(r),f.x=u.x+r.clientLeft,f.y=u.y+r.clientTop}return{width:n.width*p.x,height:n.height*p.y,x:n.x*p.x-c.scrollLeft*p.x+f.x,y:n.y*p.y-c.scrollTop*p.y+f.y}}function Ng(t){return Array.from(t.getClientRects())}function Uo(t,e){const n=Rr(t).scrollLeft;return e?e.left+n:Dt(et(t)).left+n}function jg(t){const e=et(t),n=Rr(t),r=t.ownerDocument.body,o=Me(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Me(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+Uo(t);const a=-n.scrollTop;return Ve(r).direction==="rtl"&&(s+=Me(e.clientWidth,r.clientWidth)-o),{width:o,height:i,x:s,y:a}}function Rg(t,e){const n=Pe(t),r=et(t),o=n.visualViewport;let i=r.clientWidth,s=r.clientHeight,a=0,c=0;if(o){i=o.width,s=o.height;const p=Ii();(!p||p&&e==="fixed")&&(a=o.offsetLeft,c=o.offsetTop)}return{width:i,height:s,x:a,y:c}}function Mg(t,e){const n=Dt(t,!0,e==="fixed"),r=n.top+t.clientTop,o=n.left+t.clientLeft,i=Ze(t)?Zt(t):vt(1),s=t.clientWidth*i.x,a=t.clientHeight*i.y,c=o*i.x,p=r*i.y;return{width:s,height:a,x:c,y:p}}function Hs(t,e,n){let r;if(e==="viewport")r=Rg(t,n);else if(e==="document")r=jg(et(t));else if(Be(e))r=Mg(e,n);else{const o=Xc(t);r={...e,x:e.x-o.x,y:e.y-o.y}}return cr(r)}function Qc(t,e){const n=yt(t);return n===e||!Be(n)||tn(n)?!1:Ve(n).position==="fixed"||Qc(n,e)}function Pg(t,e){const n=e.get(t);if(n)return n;let r=En(t,[],!1).filter(a=>Be(a)&&an(a)!=="body"),o=null;const i=Ve(t).position==="fixed";let s=i?yt(t):t;for(;Be(s)&&!tn(s);){const a=Ve(s),c=Pi(s);!c&&a.position==="fixed"&&(o=null),(i?!c&&!o:!c&&a.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||Mn(s)&&!c&&Qc(t,s))?r=r.filter(f=>f!==s):o=a,s=yt(s)}return e.set(t,r),r}function Ig(t){let{element:e,boundary:n,rootBoundary:r,strategy:o}=t;const s=[...n==="clippingAncestors"?jr(e)?[]:Pg(e,this._c):[].concat(n),r],a=s[0],c=s.reduce((p,f)=>{const m=Hs(e,f,o);return p.top=Me(m.top,p.top),p.right=gt(m.right,p.right),p.bottom=gt(m.bottom,p.bottom),p.left=Me(m.left,p.left),p},Hs(e,a,o));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Og(t){const{width:e,height:n}=Yc(t);return{width:e,height:n}}function Lg(t,e,n){const r=Ze(e),o=et(e),i=n==="fixed",s=Dt(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const c=vt(0);if(r||!r&&!i)if((an(e)!=="body"||Mn(o))&&(a=Rr(e)),r){const h=Dt(e,!0,i,e);c.x=h.x+e.clientLeft,c.y=h.y+e.clientTop}else o&&(c.x=Uo(o));let p=0,f=0;if(o&&!r&&!i){const h=o.getBoundingClientRect();f=h.top+a.scrollTop,p=h.left+a.scrollLeft-Uo(o,h)}const m=s.left+a.scrollLeft-c.x-p,u=s.top+a.scrollTop-c.y-f;return{x:m,y:u,width:s.width,height:s.height}}function ao(t){return Ve(t).position==="static"}function Bs(t,e){if(!Ze(t)||Ve(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return et(t)===n&&(n=n.ownerDocument.body),n}function Jc(t,e){const n=Pe(t);if(jr(t))return n;if(!Ze(t)){let o=yt(t);for(;o&&!tn(o);){if(Be(o)&&!ao(o))return o;o=yt(o)}return n}let r=Bs(t,e);for(;r&&Eg(r)&&ao(r);)r=Bs(r,e);return r&&tn(r)&&ao(r)&&!Pi(r)?n:r||Cg(t)||n}const Dg=async function(t){const e=this.getOffsetParent||Jc,n=this.getDimensions,r=await n(t.floating);return{reference:Lg(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function zg(t){return Ve(t).direction==="rtl"}const Fg={convertOffsetParentRelativeRectToViewportRelativeRect:Ag,getDocumentElement:et,getClippingRect:Ig,getOffsetParent:Jc,getElementRects:Dg,getClientRects:Ng,getDimensions:Og,getScale:Zt,isElement:Be,isRTL:zg};function $g(t,e){let n=null,r;const o=et(t);function i(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function s(a,c){a===void 0&&(a=!1),c===void 0&&(c=1),i();const{left:p,top:f,width:m,height:u}=t.getBoundingClientRect();if(a||e(),!m||!u)return;const h=Wn(f),x=Wn(o.clientWidth-(p+m)),g=Wn(o.clientHeight-(f+u)),v=Wn(p),w={rootMargin:-h+"px "+-x+"px "+-g+"px "+-v+"px",threshold:Me(0,gt(1,c))||1};let b=!0;function S(_){const A=_[0].intersectionRatio;if(A!==c){if(!b)return s();A?s(!1,A):r=setTimeout(()=>{s(!1,1e-7)},1e3)}b=!1}try{n=new IntersectionObserver(S,{...w,root:o.ownerDocument})}catch{n=new IntersectionObserver(S,w)}n.observe(t)}return s(!0),i}function Ug(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,p=Oi(t),f=o||i?[...p?En(p):[],...En(e)]:[];f.forEach(y=>{o&&y.addEventListener("scroll",n,{passive:!0}),i&&y.addEventListener("resize",n)});const m=p&&a?$g(p,n):null;let u=-1,h=null;s&&(h=new ResizeObserver(y=>{let[w]=y;w&&w.target===p&&h&&(h.unobserve(e),cancelAnimationFrame(u),u=requestAnimationFrame(()=>{var b;(b=h)==null||b.observe(e)})),n()}),p&&!c&&h.observe(p),h.observe(e));let x,g=c?Dt(t):null;c&&v();function v(){const y=Dt(t);g&&(y.x!==g.x||y.y!==g.y||y.width!==g.width||y.height!==g.height)&&n(),g=y,x=requestAnimationFrame(v)}return n(),()=>{var y;f.forEach(w=>{o&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),m==null||m(),(y=h)==null||y.disconnect(),h=null,c&&cancelAnimationFrame(x)}}const Hg=wg,Bg=bg,Vg=vg,qg=_g,Gg=xg,Vs=gg,Wg=Sg,Kg=(t,e,n)=>{const r=new Map,o={platform:Fg,...n},i={...o.platform,_c:r};return hg(t,e,{...o,platform:i})};var Jn=typeof document<"u"?d.useLayoutEffect:d.useEffect;function lr(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,o;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!lr(t[r],e[r]))return!1;return!0}if(o=Object.keys(t),n=o.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&t.$$typeof)&&!lr(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function Zc(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function qs(t,e){const n=Zc(t);return Math.round(e*n)/n}function co(t){const e=d.useRef(t);return Jn(()=>{e.current=t}),e}function Yg(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:i,floating:s}={},transform:a=!0,whileElementsMounted:c,open:p}=t,[f,m]=d.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[u,h]=d.useState(r);lr(u,r)||h(r);const[x,g]=d.useState(null),[v,y]=d.useState(null),w=d.useCallback(M=>{M!==A.current&&(A.current=M,g(M))},[]),b=d.useCallback(M=>{M!==E.current&&(E.current=M,y(M))},[]),S=i||x,_=s||v,A=d.useRef(null),E=d.useRef(null),T=d.useRef(f),C=c!=null,k=co(c),R=co(o),P=co(p),F=d.useCallback(()=>{if(!A.current||!E.current)return;const M={placement:e,strategy:n,middleware:u};R.current&&(M.platform=R.current),Kg(A.current,E.current,M).then(j=>{const W={...j,isPositioned:P.current!==!1};$.current&&!lr(T.current,W)&&(T.current=W,Nn.flushSync(()=>{m(W)}))})},[u,e,n,R,P]);Jn(()=>{p===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,m(M=>({...M,isPositioned:!1})))},[p]);const $=d.useRef(!1);Jn(()=>($.current=!0,()=>{$.current=!1}),[]),Jn(()=>{if(S&&(A.current=S),_&&(E.current=_),S&&_){if(k.current)return k.current(S,_,F);F()}},[S,_,F,k,C]);const G=d.useMemo(()=>({reference:A,floating:E,setReference:w,setFloating:b}),[w,b]),N=d.useMemo(()=>({reference:S,floating:_}),[S,_]),L=d.useMemo(()=>{const M={position:n,left:0,top:0};if(!N.floating)return M;const j=qs(N.floating,f.x),W=qs(N.floating,f.y);return a?{...M,transform:"translate("+j+"px, "+W+"px)",...Zc(N.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:j,top:W}},[n,a,N.floating,f.x,f.y]);return d.useMemo(()=>({...f,update:F,refs:G,elements:N,floatingStyles:L}),[f,F,G,N,L])}const Xg=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:o}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?Vs({element:r.current,padding:o}).fn(n):{}:r?Vs({element:r,padding:o}).fn(n):{}}}},Qg=(t,e)=>({...Hg(t),options:[t,e]}),Jg=(t,e)=>({...Bg(t),options:[t,e]}),Zg=(t,e)=>({...Wg(t),options:[t,e]}),ev=(t,e)=>({...Vg(t),options:[t,e]}),tv=(t,e)=>({...qg(t),options:[t,e]}),nv=(t,e)=>({...Gg(t),options:[t,e]}),rv=(t,e)=>({...Xg(t),options:[t,e]});var ov="Arrow",el=d.forwardRef((t,e)=>{const{children:n,width:r=10,height:o=5,...i}=t;return l.jsx(Y.svg,{...i,ref:e,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:l.jsx("polygon",{points:"0,0 30,0 15,10"})})});el.displayName=ov;var iv=el;function sv(t,e=[]){let n=[];function r(i,s){const a=d.createContext(s),c=n.length;n=[...n,s];function p(m){const{scope:u,children:h,...x}=m,g=(u==null?void 0:u[t][c])||a,v=d.useMemo(()=>x,Object.values(x));return l.jsx(g.Provider,{value:v,children:h})}function f(m,u){const h=(u==null?void 0:u[t][c])||a,x=d.useContext(h);if(x)return x;if(s!==void 0)return s;throw new Error(`\`${m}\` must be used within \`${i}\``)}return p.displayName=i+"Provider",[p,f]}const o=()=>{const i=n.map(s=>d.createContext(s));return function(a){const c=(a==null?void 0:a[t])||i;return d.useMemo(()=>({[`__scope${t}`]:{...a,[t]:c}}),[a,c])}};return o.scopeName=t,[r,av(o,...e)]}function av(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const s=r.reduce((a,{useScope:c,scopeName:p})=>{const m=c(i)[`__scope${p}`];return{...a,...m}},{});return d.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}function cv(t){const[e,n]=d.useState(void 0);return xe(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let s,a;if("borderBoxSize"in i){const c=i.borderBoxSize,p=Array.isArray(c)?c[0]:c;s=p.inlineSize,a=p.blockSize}else s=t.offsetWidth,a=t.offsetHeight;n({width:s,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var Li="Popper",[tl,cn]=sv(Li),[lv,nl]=tl(Li),rl=t=>{const{__scopePopper:e,children:n}=t,[r,o]=d.useState(null);return l.jsx(lv,{scope:e,anchor:r,onAnchorChange:o,children:n})};rl.displayName=Li;var ol="PopperAnchor",il=d.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...o}=t,i=nl(ol,n),s=d.useRef(null),a=re(e,s);return d.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:l.jsx(Y.div,{...o,ref:a})});il.displayName=ol;var Di="PopperContent",[dv,pv]=tl(Di),sl=d.forwardRef((t,e)=>{var U,oe,ae,ne,de,ce;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:i="center",alignOffset:s=0,arrowPadding:a=0,avoidCollisions:c=!0,collisionBoundary:p=[],collisionPadding:f=0,sticky:m="partial",hideWhenDetached:u=!1,updatePositionStrategy:h="optimized",onPlaced:x,...g}=t,v=nl(Di,n),[y,w]=d.useState(null),b=re(e,_e=>w(_e)),[S,_]=d.useState(null),A=cv(S),E=(A==null?void 0:A.width)??0,T=(A==null?void 0:A.height)??0,C=r+(i!=="center"?"-"+i:""),k=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},R=Array.isArray(p)?p:[p],P=R.length>0,F={padding:k,boundary:R.filter(fv),altBoundary:P},{refs:$,floatingStyles:G,placement:N,isPositioned:L,middlewareData:M}=Yg({strategy:"fixed",placement:C,whileElementsMounted:(..._e)=>Ug(..._e,{animationFrame:h==="always"}),elements:{reference:v.anchor},middleware:[Qg({mainAxis:o+T,alignmentAxis:s}),c&&Jg({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?Zg():void 0,...F}),c&&ev({...F}),tv({...F,apply:({elements:_e,rects:Ne,availableWidth:ct,availableHeight:Ie})=>{const{width:_t,height:Yr}=Ne.reference,ye=_e.floating.style;ye.setProperty("--radix-popper-available-width",`${ct}px`),ye.setProperty("--radix-popper-available-height",`${Ie}px`),ye.setProperty("--radix-popper-anchor-width",`${_t}px`),ye.setProperty("--radix-popper-anchor-height",`${Yr}px`)}}),S&&rv({element:S,padding:a}),mv({arrowWidth:E,arrowHeight:T}),u&&nv({strategy:"referenceHidden",...F})]}),[j,W]=ll(N),z=ve(x);xe(()=>{L&&(z==null||z())},[L,z]);const q=(U=M.arrow)==null?void 0:U.x,K=(oe=M.arrow)==null?void 0:oe.y,ie=((ae=M.arrow)==null?void 0:ae.centerOffset)!==0,[ge,se]=d.useState();return xe(()=>{y&&se(window.getComputedStyle(y).zIndex)},[y]),l.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:L?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ge,"--radix-popper-transform-origin":[(ne=M.transformOrigin)==null?void 0:ne.x,(de=M.transformOrigin)==null?void 0:de.y].join(" "),...((ce=M.hide)==null?void 0:ce.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:l.jsx(dv,{scope:n,placedSide:j,onArrowChange:_,arrowX:q,arrowY:K,shouldHideArrow:ie,children:l.jsx(Y.div,{"data-side":j,"data-align":W,...g,ref:b,style:{...g.style,animation:L?void 0:"none"}})})})});sl.displayName=Di;var al="PopperArrow",uv={top:"bottom",right:"left",bottom:"top",left:"right"},cl=d.forwardRef(function(e,n){const{__scopePopper:r,...o}=e,i=pv(al,r),s=uv[i.placedSide];return l.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:l.jsx(iv,{...o,ref:n,style:{...o.style,display:"block"}})})});cl.displayName=al;function fv(t){return t!==null}var mv=t=>({name:"transformOrigin",options:t,fn(e){var v,y,w;const{placement:n,rects:r,middlewareData:o}=e,s=((v=o.arrow)==null?void 0:v.centerOffset)!==0,a=s?0:t.arrowWidth,c=s?0:t.arrowHeight,[p,f]=ll(n),m={start:"0%",center:"50%",end:"100%"}[f],u=(((y=o.arrow)==null?void 0:y.x)??0)+a/2,h=(((w=o.arrow)==null?void 0:w.y)??0)+c/2;let x="",g="";return p==="bottom"?(x=s?m:`${u}px`,g=`${-c}px`):p==="top"?(x=s?m:`${u}px`,g=`${r.floating.height+c}px`):p==="right"?(x=`${-c}px`,g=s?m:`${h}px`):p==="left"&&(x=`${r.floating.width+c}px`,g=s?m:`${h}px`),{data:{x,y:g}}}});function ll(t){const[e,n="center"]=t.split("-");return[e,n]}var zi=rl,Fi=il,$i=sl,Ui=cl;function hv(t){const e=d.useRef({value:t,previous:t});return d.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var gv="VisuallyHidden",Hi=d.forwardRef((t,e)=>l.jsx(Y.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));Hi.displayName=gv;var vv=Hi,xv=[" ","Enter","ArrowUp","ArrowDown"],yv=[" ","Enter"],Pn="Select",[Mr,Pr,wv]=ki(Pn),[ln,NC]=wt(Pn,[wv,cn]),Ir=cn(),[bv,bt]=ln(Pn),[Sv,_v]=ln(Pn),dl=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:o,onOpenChange:i,value:s,defaultValue:a,onValueChange:c,dir:p,name:f,autoComplete:m,disabled:u,required:h,form:x}=t,g=Ir(e),[v,y]=d.useState(null),[w,b]=d.useState(null),[S,_]=d.useState(!1),A=Rn(p),[E=!1,T]=Ot({prop:r,defaultProp:o,onChange:i}),[C,k]=Ot({prop:s,defaultProp:a,onChange:c}),R=d.useRef(null),P=v?x||!!v.closest("form"):!0,[F,$]=d.useState(new Set),G=Array.from(F).map(N=>N.props.value).join(";");return l.jsx(zi,{...g,children:l.jsxs(bv,{required:h,scope:e,trigger:v,onTriggerChange:y,valueNode:w,onValueNodeChange:b,valueNodeHasChildren:S,onValueNodeHasChildrenChange:_,contentId:He(),value:C,onValueChange:k,open:E,onOpenChange:T,dir:A,triggerPointerDownPosRef:R,disabled:u,children:[l.jsx(Mr.Provider,{scope:e,children:l.jsx(Sv,{scope:t.__scopeSelect,onNativeOptionAdd:d.useCallback(N=>{$(L=>new Set(L).add(N))},[]),onNativeOptionRemove:d.useCallback(N=>{$(L=>{const M=new Set(L);return M.delete(N),M})},[]),children:n})}),P?l.jsxs(Ol,{"aria-hidden":!0,required:h,tabIndex:-1,name:f,autoComplete:m,value:C,onChange:N=>k(N.target.value),disabled:u,form:x,children:[C===void 0?l.jsx("option",{value:""}):null,Array.from(F)]},G):null]})})};dl.displayName=Pn;var pl="SelectTrigger",ul=d.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...o}=t,i=Ir(n),s=bt(pl,n),a=s.disabled||r,c=re(e,s.onTriggerChange),p=Pr(n),f=d.useRef("touch"),[m,u,h]=Ll(g=>{const v=p().filter(b=>!b.disabled),y=v.find(b=>b.value===s.value),w=Dl(v,g,y);w!==void 0&&s.onValueChange(w.value)}),x=g=>{a||(s.onOpenChange(!0),h()),g&&(s.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return l.jsx(Fi,{asChild:!0,...i,children:l.jsx(Y.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":Il(s.value)?"":void 0,...o,ref:c,onClick:D(o.onClick,g=>{g.currentTarget.focus(),f.current!=="mouse"&&x(g)}),onPointerDown:D(o.onPointerDown,g=>{f.current=g.pointerType;const v=g.target;v.hasPointerCapture(g.pointerId)&&v.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(x(g),g.preventDefault())}),onKeyDown:D(o.onKeyDown,g=>{const v=m.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&u(g.key),!(v&&g.key===" ")&&xv.includes(g.key)&&(x(),g.preventDefault())})})})});ul.displayName=pl;var fl="SelectValue",ml=d.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:o,children:i,placeholder:s="",...a}=t,c=bt(fl,n),{onValueNodeHasChildrenChange:p}=c,f=i!==void 0,m=re(e,c.onValueNodeChange);return xe(()=>{p(f)},[p,f]),l.jsx(Y.span,{...a,ref:m,style:{pointerEvents:"none"},children:Il(c.value)?l.jsx(l.Fragment,{children:s}):i})});ml.displayName=fl;var Ev="SelectIcon",hl=d.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...o}=t;return l.jsx(Y.span,{"aria-hidden":!0,...o,ref:e,children:r||"▼"})});hl.displayName=Ev;var Cv="SelectPortal",gl=t=>l.jsx(br,{asChild:!0,...t});gl.displayName=Cv;var zt="SelectContent",vl=d.forwardRef((t,e)=>{const n=bt(zt,t.__scopeSelect),[r,o]=d.useState();if(xe(()=>{o(new DocumentFragment)},[]),!n.open){const i=r;return i?Nn.createPortal(l.jsx(xl,{scope:t.__scopeSelect,children:l.jsx(Mr.Slot,{scope:t.__scopeSelect,children:l.jsx("div",{children:t.children})})}),i):null}return l.jsx(yl,{...t,ref:e})});vl.displayName=zt;var $e=10,[xl,St]=ln(zt),Tv="SelectContentImpl",yl=d.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:i,onPointerDownOutside:s,side:a,sideOffset:c,align:p,alignOffset:f,arrowPadding:m,collisionBoundary:u,collisionPadding:h,sticky:x,hideWhenDetached:g,avoidCollisions:v,...y}=t,w=bt(zt,n),[b,S]=d.useState(null),[_,A]=d.useState(null),E=re(e,U=>S(U)),[T,C]=d.useState(null),[k,R]=d.useState(null),P=Pr(n),[F,$]=d.useState(!1),G=d.useRef(!1);d.useEffect(()=>{if(b)return fi(b)},[b]),ui();const N=d.useCallback(U=>{const[oe,...ae]=P().map(ce=>ce.ref.current),[ne]=ae.slice(-1),de=document.activeElement;for(const ce of U)if(ce===de||(ce==null||ce.scrollIntoView({block:"nearest"}),ce===oe&&_&&(_.scrollTop=0),ce===ne&&_&&(_.scrollTop=_.scrollHeight),ce==null||ce.focus(),document.activeElement!==de))return},[P,_]),L=d.useCallback(()=>N([T,b]),[N,T,b]);d.useEffect(()=>{F&&L()},[F,L]);const{onOpenChange:M,triggerPointerDownPosRef:j}=w;d.useEffect(()=>{if(b){let U={x:0,y:0};const oe=ne=>{var de,ce;U={x:Math.abs(Math.round(ne.pageX)-(((de=j.current)==null?void 0:de.x)??0)),y:Math.abs(Math.round(ne.pageY)-(((ce=j.current)==null?void 0:ce.y)??0))}},ae=ne=>{U.x<=10&&U.y<=10?ne.preventDefault():b.contains(ne.target)||M(!1),document.removeEventListener("pointermove",oe),j.current=null};return j.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",ae,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",ae,{capture:!0})}}},[b,M,j]),d.useEffect(()=>{const U=()=>M(!1);return window.addEventListener("blur",U),window.addEventListener("resize",U),()=>{window.removeEventListener("blur",U),window.removeEventListener("resize",U)}},[M]);const[W,z]=Ll(U=>{const oe=P().filter(de=>!de.disabled),ae=oe.find(de=>de.ref.current===document.activeElement),ne=Dl(oe,U,ae);ne&&setTimeout(()=>ne.ref.current.focus())}),q=d.useCallback((U,oe,ae)=>{const ne=!G.current&&!ae;(w.value!==void 0&&w.value===oe||ne)&&(C(U),ne&&(G.current=!0))},[w.value]),K=d.useCallback(()=>b==null?void 0:b.focus(),[b]),ie=d.useCallback((U,oe,ae)=>{const ne=!G.current&&!ae;(w.value!==void 0&&w.value===oe||ne)&&R(U)},[w.value]),ge=r==="popper"?Ho:wl,se=ge===Ho?{side:a,sideOffset:c,align:p,alignOffset:f,arrowPadding:m,collisionBoundary:u,collisionPadding:h,sticky:x,hideWhenDetached:g,avoidCollisions:v}:{};return l.jsx(xl,{scope:n,content:b,viewport:_,onViewportChange:A,itemRefCallback:q,selectedItem:T,onItemLeave:K,itemTextRefCallback:ie,focusSelectedItem:L,selectedItemText:k,position:r,isPositioned:F,searchRef:W,children:l.jsx(_r,{as:ht,allowPinchZoom:!0,children:l.jsx(wr,{asChild:!0,trapped:w.open,onMountAutoFocus:U=>{U.preventDefault()},onUnmountAutoFocus:D(o,U=>{var oe;(oe=w.trigger)==null||oe.focus({preventScroll:!0}),U.preventDefault()}),children:l.jsx(jn,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:U=>U.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:l.jsx(ge,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:U=>U.preventDefault(),...y,...se,onPlaced:()=>$(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:D(y.onKeyDown,U=>{const oe=U.ctrlKey||U.altKey||U.metaKey;if(U.key==="Tab"&&U.preventDefault(),!oe&&U.key.length===1&&z(U.key),["ArrowUp","ArrowDown","Home","End"].includes(U.key)){let ne=P().filter(de=>!de.disabled).map(de=>de.ref.current);if(["ArrowUp","End"].includes(U.key)&&(ne=ne.slice().reverse()),["ArrowUp","ArrowDown"].includes(U.key)){const de=U.target,ce=ne.indexOf(de);ne=ne.slice(ce+1)}setTimeout(()=>N(ne)),U.preventDefault()}})})})})})})});yl.displayName=Tv;var kv="SelectItemAlignedPosition",wl=d.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...o}=t,i=bt(zt,n),s=St(zt,n),[a,c]=d.useState(null),[p,f]=d.useState(null),m=re(e,E=>f(E)),u=Pr(n),h=d.useRef(!1),x=d.useRef(!0),{viewport:g,selectedItem:v,selectedItemText:y,focusSelectedItem:w}=s,b=d.useCallback(()=>{if(i.trigger&&i.valueNode&&a&&p&&g&&v&&y){const E=i.trigger.getBoundingClientRect(),T=p.getBoundingClientRect(),C=i.valueNode.getBoundingClientRect(),k=y.getBoundingClientRect();if(i.dir!=="rtl"){const de=k.left-T.left,ce=C.left-de,_e=E.left-ce,Ne=E.width+_e,ct=Math.max(Ne,T.width),Ie=window.innerWidth-$e,_t=Do(ce,[$e,Math.max($e,Ie-ct)]);a.style.minWidth=Ne+"px",a.style.left=_t+"px"}else{const de=T.right-k.right,ce=window.innerWidth-C.right-de,_e=window.innerWidth-E.right-ce,Ne=E.width+_e,ct=Math.max(Ne,T.width),Ie=window.innerWidth-$e,_t=Do(ce,[$e,Math.max($e,Ie-ct)]);a.style.minWidth=Ne+"px",a.style.right=_t+"px"}const R=u(),P=window.innerHeight-$e*2,F=g.scrollHeight,$=window.getComputedStyle(p),G=parseInt($.borderTopWidth,10),N=parseInt($.paddingTop,10),L=parseInt($.borderBottomWidth,10),M=parseInt($.paddingBottom,10),j=G+N+F+M+L,W=Math.min(v.offsetHeight*5,j),z=window.getComputedStyle(g),q=parseInt(z.paddingTop,10),K=parseInt(z.paddingBottom,10),ie=E.top+E.height/2-$e,ge=P-ie,se=v.offsetHeight/2,U=v.offsetTop+se,oe=G+N+U,ae=j-oe;if(oe<=ie){const de=R.length>0&&v===R[R.length-1].ref.current;a.style.bottom="0px";const ce=p.clientHeight-g.offsetTop-g.offsetHeight,_e=Math.max(ge,se+(de?K:0)+ce+L),Ne=oe+_e;a.style.height=Ne+"px"}else{const de=R.length>0&&v===R[0].ref.current;a.style.top="0px";const _e=Math.max(ie,G+g.offsetTop+(de?q:0)+se)+ae;a.style.height=_e+"px",g.scrollTop=oe-ie+g.offsetTop}a.style.margin=`${$e}px 0`,a.style.minHeight=W+"px",a.style.maxHeight=P+"px",r==null||r(),requestAnimationFrame(()=>h.current=!0)}},[u,i.trigger,i.valueNode,a,p,g,v,y,i.dir,r]);xe(()=>b(),[b]);const[S,_]=d.useState();xe(()=>{p&&_(window.getComputedStyle(p).zIndex)},[p]);const A=d.useCallback(E=>{E&&x.current===!0&&(b(),w==null||w(),x.current=!1)},[b,w]);return l.jsx(Nv,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:h,onScrollButtonChange:A,children:l.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:l.jsx(Y.div,{...o,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});wl.displayName=kv;var Av="SelectPopperPosition",Ho=d.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:o=$e,...i}=t,s=Ir(n);return l.jsx($i,{...s,...i,ref:e,align:r,collisionPadding:o,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Ho.displayName=Av;var[Nv,Bi]=ln(zt,{}),Bo="SelectViewport",bl=d.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...o}=t,i=St(Bo,n),s=Bi(Bo,n),a=re(e,i.onViewportChange),c=d.useRef(0);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),l.jsx(Mr.Slot,{scope:n,children:l.jsx(Y.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:D(o.onScroll,p=>{const f=p.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:u}=s;if(u!=null&&u.current&&m){const h=Math.abs(c.current-f.scrollTop);if(h>0){const x=window.innerHeight-$e*2,g=parseFloat(m.style.minHeight),v=parseFloat(m.style.height),y=Math.max(g,v);if(y<x){const w=y+h,b=Math.min(x,w),S=w-b;m.style.height=b+"px",m.style.bottom==="0px"&&(f.scrollTop=S>0?S:0,m.style.justifyContent="flex-end")}}}c.current=f.scrollTop})})})]})});bl.displayName=Bo;var Sl="SelectGroup",[jv,Rv]=ln(Sl),Mv=d.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,o=He();return l.jsx(jv,{scope:n,id:o,children:l.jsx(Y.div,{role:"group","aria-labelledby":o,...r,ref:e})})});Mv.displayName=Sl;var _l="SelectLabel",El=d.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,o=Rv(_l,n);return l.jsx(Y.div,{id:o.id,...r,ref:e})});El.displayName=_l;var dr="SelectItem",[Pv,Cl]=ln(dr),Tl=d.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:o=!1,textValue:i,...s}=t,a=bt(dr,n),c=St(dr,n),p=a.value===r,[f,m]=d.useState(i??""),[u,h]=d.useState(!1),x=re(e,w=>{var b;return(b=c.itemRefCallback)==null?void 0:b.call(c,w,r,o)}),g=He(),v=d.useRef("touch"),y=()=>{o||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return l.jsx(Pv,{scope:n,value:r,disabled:o,textId:g,isSelected:p,onItemTextChange:d.useCallback(w=>{m(b=>b||((w==null?void 0:w.textContent)??"").trim())},[]),children:l.jsx(Mr.ItemSlot,{scope:n,value:r,disabled:o,textValue:f,children:l.jsx(Y.div,{role:"option","aria-labelledby":g,"data-highlighted":u?"":void 0,"aria-selected":p&&u,"data-state":p?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...s,ref:x,onFocus:D(s.onFocus,()=>h(!0)),onBlur:D(s.onBlur,()=>h(!1)),onClick:D(s.onClick,()=>{v.current!=="mouse"&&y()}),onPointerUp:D(s.onPointerUp,()=>{v.current==="mouse"&&y()}),onPointerDown:D(s.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:D(s.onPointerMove,w=>{var b;v.current=w.pointerType,o?(b=c.onItemLeave)==null||b.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:D(s.onPointerLeave,w=>{var b;w.currentTarget===document.activeElement&&((b=c.onItemLeave)==null||b.call(c))}),onKeyDown:D(s.onKeyDown,w=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&w.key===" "||(yv.includes(w.key)&&y(),w.key===" "&&w.preventDefault())})})})})});Tl.displayName=dr;var gn="SelectItemText",kl=d.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:o,...i}=t,s=bt(gn,n),a=St(gn,n),c=Cl(gn,n),p=_v(gn,n),[f,m]=d.useState(null),u=re(e,y=>m(y),c.onItemTextChange,y=>{var w;return(w=a.itemTextRefCallback)==null?void 0:w.call(a,y,c.value,c.disabled)}),h=f==null?void 0:f.textContent,x=d.useMemo(()=>l.jsx("option",{value:c.value,disabled:c.disabled,children:h},c.value),[c.disabled,c.value,h]),{onNativeOptionAdd:g,onNativeOptionRemove:v}=p;return xe(()=>(g(x),()=>v(x)),[g,v,x]),l.jsxs(l.Fragment,{children:[l.jsx(Y.span,{id:c.textId,...i,ref:u}),c.isSelected&&s.valueNode&&!s.valueNodeHasChildren?Nn.createPortal(i.children,s.valueNode):null]})});kl.displayName=gn;var Al="SelectItemIndicator",Nl=d.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return Cl(Al,n).isSelected?l.jsx(Y.span,{"aria-hidden":!0,...r,ref:e}):null});Nl.displayName=Al;var Vo="SelectScrollUpButton",jl=d.forwardRef((t,e)=>{const n=St(Vo,t.__scopeSelect),r=Bi(Vo,t.__scopeSelect),[o,i]=d.useState(!1),s=re(e,r.onScrollButtonChange);return xe(()=>{if(n.viewport&&n.isPositioned){let a=function(){const p=c.scrollTop>0;i(p)};const c=n.viewport;return a(),c.addEventListener("scroll",a),()=>c.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),o?l.jsx(Ml,{...t,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:c}=n;a&&c&&(a.scrollTop=a.scrollTop-c.offsetHeight)}}):null});jl.displayName=Vo;var qo="SelectScrollDownButton",Rl=d.forwardRef((t,e)=>{const n=St(qo,t.__scopeSelect),r=Bi(qo,t.__scopeSelect),[o,i]=d.useState(!1),s=re(e,r.onScrollButtonChange);return xe(()=>{if(n.viewport&&n.isPositioned){let a=function(){const p=c.scrollHeight-c.clientHeight,f=Math.ceil(c.scrollTop)<p;i(f)};const c=n.viewport;return a(),c.addEventListener("scroll",a),()=>c.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),o?l.jsx(Ml,{...t,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:c}=n;a&&c&&(a.scrollTop=a.scrollTop+c.offsetHeight)}}):null});Rl.displayName=qo;var Ml=d.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...o}=t,i=St("SelectScrollButton",n),s=d.useRef(null),a=Pr(n),c=d.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return d.useEffect(()=>()=>c(),[c]),xe(()=>{var f;const p=a().find(m=>m.ref.current===document.activeElement);(f=p==null?void 0:p.ref.current)==null||f.scrollIntoView({block:"nearest"})},[a]),l.jsx(Y.div,{"aria-hidden":!0,...o,ref:e,style:{flexShrink:0,...o.style},onPointerDown:D(o.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(r,50))}),onPointerMove:D(o.onPointerMove,()=>{var p;(p=i.onItemLeave)==null||p.call(i),s.current===null&&(s.current=window.setInterval(r,50))}),onPointerLeave:D(o.onPointerLeave,()=>{c()})})}),Iv="SelectSeparator",Pl=d.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return l.jsx(Y.div,{"aria-hidden":!0,...r,ref:e})});Pl.displayName=Iv;var Go="SelectArrow",Ov=d.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,o=Ir(n),i=bt(Go,n),s=St(Go,n);return i.open&&s.position==="popper"?l.jsx(Ui,{...o,...r,ref:e}):null});Ov.displayName=Go;function Il(t){return t===""||t===void 0}var Ol=d.forwardRef((t,e)=>{const{value:n,...r}=t,o=d.useRef(null),i=re(e,o),s=hv(n);return d.useEffect(()=>{const a=o.current,c=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(c,"value").set;if(s!==n&&f){const m=new Event("change",{bubbles:!0});f.call(a,n),a.dispatchEvent(m)}},[s,n]),l.jsx(Hi,{asChild:!0,children:l.jsx("select",{...r,ref:i,defaultValue:n})})});Ol.displayName="BubbleSelect";function Ll(t){const e=ve(t),n=d.useRef(""),r=d.useRef(0),o=d.useCallback(s=>{const a=n.current+s;e(a),function c(p){n.current=p,window.clearTimeout(r.current),p!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(a)},[e]),i=d.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return d.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,o,i]}function Dl(t,e,n){const o=e.length>1&&Array.from(e).every(p=>p===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let s=Lv(t,Math.max(i,0));o.length===1&&(s=s.filter(p=>p!==n));const c=s.find(p=>p.textValue.toLowerCase().startsWith(o.toLowerCase()));return c!==n?c:void 0}function Lv(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var Dv=dl,zl=ul,zv=ml,Fv=hl,$v=gl,Fl=vl,Uv=bl,$l=El,Ul=Tl,Hv=kl,Bv=Nl,Hl=jl,Bl=Rl,Vl=Pl;const Vv=Dv,qv=zv,ql=d.forwardRef(({className:t,children:e,...n},r)=>l.jsxs(zl,{ref:r,className:B("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,l.jsx(Fv,{asChild:!0,children:l.jsx(fc,{className:"h-4 w-4 opacity-50"})})]}));ql.displayName=zl.displayName;const Gl=d.forwardRef(({className:t,...e},n)=>l.jsx(Hl,{ref:n,className:B("flex cursor-default items-center justify-center py-1",t),...e,children:l.jsx(Lm,{className:"h-4 w-4"})}));Gl.displayName=Hl.displayName;const Wl=d.forwardRef(({className:t,...e},n)=>l.jsx(Bl,{ref:n,className:B("flex cursor-default items-center justify-center py-1",t),...e,children:l.jsx(fc,{className:"h-4 w-4"})}));Wl.displayName=Bl.displayName;const Kl=d.forwardRef(({className:t,children:e,position:n="popper",...r},o)=>l.jsx($v,{children:l.jsxs(Fl,{ref:o,className:B("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[l.jsx(Gl,{}),l.jsx(Uv,{className:B("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),l.jsx(Wl,{})]})}));Kl.displayName=Fl.displayName;const Gv=d.forwardRef(({className:t,...e},n)=>l.jsx($l,{ref:n,className:B("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));Gv.displayName=$l.displayName;const Yl=d.forwardRef(({className:t,children:e,...n},r)=>l.jsxs(Ul,{ref:r,className:B("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(Bv,{children:l.jsx(xi,{className:"h-4 w-4"})})}),l.jsx(Hv,{children:e})]}));Yl.displayName=Ul.displayName;const Wv=d.forwardRef(({className:t,...e},n)=>l.jsx(Vl,{ref:n,className:B("-mx-1 my-1 h-px bg-muted",t),...e}));Wv.displayName=Vl.displayName;const we=[];for(let t=0;t<256;++t)we.push((t+256).toString(16).slice(1));function Kv(t,e=0){return(we[t[e+0]]+we[t[e+1]]+we[t[e+2]]+we[t[e+3]]+"-"+we[t[e+4]]+we[t[e+5]]+"-"+we[t[e+6]]+we[t[e+7]]+"-"+we[t[e+8]]+we[t[e+9]]+"-"+we[t[e+10]]+we[t[e+11]]+we[t[e+12]]+we[t[e+13]]+we[t[e+14]]+we[t[e+15]]).toLowerCase()}let lo;const Yv=new Uint8Array(16);function Xv(){if(!lo){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");lo=crypto.getRandomValues.bind(crypto)}return lo(Yv)}const Qv=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Gs={randomUUID:Qv};function Jv(t,e,n){var o;t=t||{};const r=t.random??((o=t.rng)==null?void 0:o.call(t))??Xv();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Kv(r)}function Zv(t,e,n){return Gs.randomUUID&&!t?Gs.randomUUID():Jv(t)}var Or={};const ex={},tx=Object.freeze(Object.defineProperty({__proto__:null,default:ex},Symbol.toStringTag,{value:"Module"})),V=Cu(tx);var Xl={exports:{}},Vi={exports:{}};const Ws=V,Ks=1800;let nx=class{constructor(e){this.options=e||{},this.cookies=[]}set(e,n){let r=Ws.parse(n||""),o=this.parse(e),i;return o.domain?(i=o.domain.replace(/^\./,""),(r.hostname.length<i.length||("."+r.hostname).substr(-i.length+1)!=="."+i)&&(o.domain=r.hostname)):o.domain=r.hostname,o.path||(o.path=this.getPath(r.pathname)),o.expires||(o.expires=new Date(Date.now()+(Number(this.options.sessionTimeout||Ks)||Ks)*1e3)),this.add(o)}get(e){return this.list(e).map(n=>n.name+"="+n.value).join("; ")}list(e){let n=[],r,o;for(r=this.cookies.length-1;r>=0;r--){if(o=this.cookies[r],this.isExpired(o)){this.cookies.splice(r,r);continue}this.match(o,e)&&n.unshift(o)}return n}parse(e){let n={};return(e||"").toString().split(";").forEach(r=>{let o=r.split("="),i=o.shift().trim().toLowerCase(),s=o.join("=").trim(),a;if(i)switch(i){case"expires":s=new Date(s),s.toString()!=="Invalid Date"&&(n.expires=s);break;case"path":n.path=s;break;case"domain":a=s.toLowerCase(),a.length&&a.charAt(0)!=="."&&(a="."+a),n.domain=a;break;case"max-age":n.expires=new Date(Date.now()+(Number(s)||0)*1e3);break;case"secure":n.secure=!0;break;case"httponly":n.httponly=!0;break;default:n.name||(n.name=i,n.value=s)}}),n}match(e,n){let r=Ws.parse(n||"");return!(r.hostname!==e.domain&&(e.domain.charAt(0)!=="."||("."+r.hostname).substr(-e.domain.length)!==e.domain)||this.getPath(r.pathname).substr(0,e.path.length)!==e.path||e.secure&&r.protocol!=="https:")}add(e){let n,r;if(!e||!e.name)return!1;for(n=0,r=this.cookies.length;n<r;n++)if(this.compare(this.cookies[n],e))return this.isExpired(e)?(this.cookies.splice(n,1),!1):(this.cookies[n]=e,!0);return this.isExpired(e)||this.cookies.push(e),!0}compare(e,n){return e.name===n.name&&e.path===n.path&&e.domain===n.domain&&e.secure===n.secure&&e.httponly===e.httponly}isExpired(e){return e.expires&&e.expires<new Date||!e.value}getPath(e){let n=(e||"/").split("/");return n.pop(),n=n.join("/").trim(),n.charAt(0)!=="/"&&(n="/"+n),n.substr(-1)!=="/"&&(n+="/"),n}};var rx=nx;const ox="nodemailer",ix="7.0.6",sx="https://nodemailer.com/",tt={name:ox,version:ix,homepage:sx},ax=V,cx=V,Ys=V,lx=V,dx=V.PassThrough,Ql=rx,px=tt,ux=V,fx=5;Vi.exports=function(t,e){return Jl(t,e)};Vi.exports.Cookies=Ql;function Jl(t,e){e=e||{},e.fetchRes=e.fetchRes||new dx,e.cookies=e.cookies||new Ql,e.redirects=e.redirects||0,e.maxRedirects=isNaN(e.maxRedirects)?fx:e.maxRedirects,e.cookie&&([].concat(e.cookie||[]).forEach(u=>{e.cookies.set(u,t)}),e.cookie=!1);let n=e.fetchRes,r=Ys.parse(t),o=(e.method||"").toString().trim().toUpperCase()||"GET",i=!1,s,a,c=r.protocol==="https:"?cx:ax,p={"accept-encoding":"gzip,deflate","user-agent":"nodemailer/"+px.version};if(Object.keys(e.headers||{}).forEach(u=>{p[u.toLowerCase().trim()]=e.headers[u]}),e.userAgent&&(p["user-agent"]=e.userAgent),r.auth&&(p.Authorization="Basic "+Buffer.from(r.auth).toString("base64")),(s=e.cookies.get(t))&&(p.cookie=s),e.body){if(e.contentType!==!1&&(p["Content-Type"]=e.contentType||"application/x-www-form-urlencoded"),typeof e.body.pipe=="function")p["Transfer-Encoding"]="chunked",a=e.body,a.on("error",u=>{i||(i=!0,u.type="FETCH",u.sourceUrl=t,n.emit("error",u))});else{if(e.body instanceof Buffer)a=e.body;else if(typeof e.body=="object")try{a=Buffer.from(Object.keys(e.body).map(u=>{let h=e.body[u].toString().trim();return encodeURIComponent(u)+"="+encodeURIComponent(h)}).join("&"))}catch(u){if(i)return;i=!0,u.type="FETCH",u.sourceUrl=t,n.emit("error",u);return}else a=Buffer.from(e.body.toString().trim());p["Content-Type"]=e.contentType||"application/x-www-form-urlencoded",p["Content-Length"]=a.length}o=(e.method||"").toString().trim().toUpperCase()||"POST"}let f,m={method:o,host:r.hostname,path:r.path,port:r.port?r.port:r.protocol==="https:"?443:80,headers:p,rejectUnauthorized:!1,agent:!1};e.tls&&Object.keys(e.tls).forEach(u=>{m[u]=e.tls[u]}),r.protocol==="https:"&&r.hostname&&r.hostname!==m.host&&!ux.isIP(r.hostname)&&!m.servername&&(m.servername=r.hostname);try{f=c.request(m)}catch(u){return i=!0,setImmediate(()=>{u.type="FETCH",u.sourceUrl=t,n.emit("error",u)}),n}return e.timeout&&f.setTimeout(e.timeout,()=>{if(i)return;i=!0,f.abort();let u=new Error("Request Timeout");u.type="FETCH",u.sourceUrl=t,n.emit("error",u)}),f.on("error",u=>{i||(i=!0,u.type="FETCH",u.sourceUrl=t,n.emit("error",u))}),f.on("response",u=>{let h;if(!i){switch(u.headers["content-encoding"]){case"gzip":case"deflate":h=lx.createUnzip();break}if(u.headers["set-cookie"]&&[].concat(u.headers["set-cookie"]||[]).forEach(x=>{e.cookies.set(x,t)}),[301,302,303,307,308].includes(u.statusCode)&&u.headers.location){if(e.redirects++,e.redirects>e.maxRedirects){i=!0;let x=new Error("Maximum redirect count exceeded");x.type="FETCH",x.sourceUrl=t,n.emit("error",x),f.abort();return}return e.method="GET",e.body=!1,Jl(Ys.resolve(t,u.headers.location),e)}if(n.statusCode=u.statusCode,n.headers=u.headers,u.statusCode>=300&&!e.allowErrorResponse){i=!0;let x=new Error("Invalid status code "+u.statusCode);x.type="FETCH",x.sourceUrl=t,n.emit("error",x),f.abort();return}u.on("error",x=>{i||(i=!0,x.type="FETCH",x.sourceUrl=t,n.emit("error",x),f.abort())}),h?(u.pipe(h).pipe(n),h.on("error",x=>{i||(i=!0,x.type="FETCH",x.sourceUrl=t,n.emit("error",x),f.abort())})):u.pipe(n)}}),setImmediate(()=>{if(a)try{if(typeof a.pipe=="function")return a.pipe(f);f.write(a)}catch(u){i=!0,u.type="FETCH",u.sourceUrl=t,n.emit("error",u);return}f.end()}),n}var Lr=Vi.exports;(function(t){const e=V,n=V,r=V,o=Lr,i=V,s=V,a=V,c=5*60*1e3;let p;try{p=a.networkInterfaces()}catch{}t.exports.networkInterfaces=p;const f=(v,y)=>{let w=t.exports.networkInterfaces;return w?Object.keys(w).map(S=>w[S]).reduce((S,_)=>S.concat(_),[]).filter(S=>!S.internal||y).filter(S=>S.family==="IPv"+v||S.family===v).length>0:!0},m=(v,y,w,b)=>{if(w=w||{},!f(v,w.allowInternalNetworkInterfaces))return b(null,[]);(i.Resolver?new i.Resolver(w):i)["resolve"+v](y,(A,E)=>{if(A){switch(A.code){case i.NODATA:case i.NOTFOUND:case i.NOTIMP:case i.SERVFAIL:case i.CONNREFUSED:case i.REFUSED:case"EAI_AGAIN":return b(null,[])}return b(A)}return b(null,Array.isArray(E)?E:[].concat(E||[]))})},u=t.exports.dnsCache=new Map,h=(v,y)=>v?Object.assign({servername:v.servername,host:!v.addresses||!v.addresses.length?null:v.addresses.length===1?v.addresses[0]:v.addresses[Math.floor(Math.random()*v.addresses.length)]},y||{}):Object.assign({},y||{});t.exports.resolveHostname=(v,y)=>{if(v=v||{},!v.host&&v.servername&&(v.host=v.servername),!v.host||s.isIP(v.host)){let b={addresses:[v.host],servername:v.servername||!1};return y(null,h(b,{cached:!1}))}let w;if(u.has(v.host)&&(w=u.get(v.host),!w.expires||w.expires>=Date.now()))return y(null,h(w.value,{cached:!0}));m(4,v.host,v,(b,S)=>{if(b)return w?y(null,h(w.value,{cached:!0,error:b})):y(b);if(S&&S.length){let _={addresses:S,servername:v.servername||v.host};return u.set(v.host,{value:_,expires:Date.now()+(v.dnsTtl||c)}),y(null,h(_,{cached:!1}))}m(6,v.host,v,(_,A)=>{if(_)return w?y(null,h(w.value,{cached:!0,error:_})):y(_);if(A&&A.length){let E={addresses:A,servername:v.servername||v.host};return u.set(v.host,{value:E,expires:Date.now()+(v.dnsTtl||c)}),y(null,h(E,{cached:!1}))}try{i.lookup(v.host,{all:!0},(E,T)=>{if(E)return w?y(null,h(w.value,{cached:!0,error:E})):y(E);let C=T?T.filter(R=>f(R.family)).map(R=>R.address).shift():!1;if(T&&T.length&&!C&&console.warn(`Failed to resolve IPv${T[0].family} addresses with current network`),!C&&w)return y(null,h(w.value,{cached:!0}));let k={addresses:C?[C]:[v.host],servername:v.servername||v.host};return u.set(v.host,{value:k,expires:Date.now()+(v.dnsTtl||c)}),y(null,h(k,{cached:!1}))})}catch(E){return w?y(null,h(w.value,{cached:!0,error:E})):y(E)}})})},t.exports.parseConnectionUrl=v=>{v=v||"";let y={};return[e.parse(v,!0)].forEach(w=>{let b;switch(w.protocol){case"smtp:":y.secure=!1;break;case"smtps:":y.secure=!0;break;case"direct:":y.direct=!0;break}!isNaN(w.port)&&Number(w.port)&&(y.port=Number(w.port)),w.hostname&&(y.host=w.hostname),w.auth&&(b=w.auth.split(":"),y.auth||(y.auth={}),y.auth.user=b.shift(),y.auth.pass=b.join(":")),Object.keys(w.query||{}).forEach(S=>{let _=y,A=S,E=w.query[S];switch(isNaN(E)||(E=Number(E)),E){case"true":E=!0;break;case"false":E=!1;break}if(S.indexOf("tls.")===0)A=S.substr(4),y.tls||(y.tls={}),_=y.tls;else if(S.indexOf(".")>=0)return;A in _||(_[A]=E)})}),y},t.exports._logFunc=(v,y,w,b,S,..._)=>{let A={};Object.keys(w||{}).forEach(E=>{E!=="level"&&(A[E]=w[E])}),Object.keys(b||{}).forEach(E=>{E!=="level"&&(A[E]=b[E])}),v[y](A,S,..._)},t.exports.getLogger=(v,y)=>{v=v||{};let w={},b=["trace","debug","info","warn","error","fatal"];if(!v.logger)return b.forEach(_=>{w[_]=()=>!1}),w;let S=v.logger;return v.logger===!0&&(S=g(b)),b.forEach(_=>{w[_]=(A,E,...T)=>{t.exports._logFunc(S,_,y,A,E,...T)}}),w},t.exports.callbackPromise=(v,y)=>function(){let w=Array.from(arguments),b=w.shift();b?y(b):v(...w)},t.exports.parseDataURI=v=>{if(typeof v!="string"||!v.startsWith("data:"))return null;const y=v.indexOf(",");if(y===-1)return null;const w=v.substring(y+1),b=v.substring(5,y);let S;const _=b.split(";");if(_.length>0){const C=_[_.length-1].toLowerCase().trim();["base64","utf8","utf-8"].includes(C)&&C.indexOf("=")===-1&&(S=C,_.pop())}const A=_.length>0?_.shift():"application/octet-stream",E={};for(let C=0;C<_.length;C++){const k=_[C],R=k.indexOf("=");if(R>0){const P=k.substring(0,R).trim(),F=k.substring(R+1).trim();P&&(E[P]=F)}}let T;try{if(S==="base64")T=Buffer.from(w,"base64");else try{T=Buffer.from(decodeURIComponent(w))}catch{T=Buffer.from(w)}}catch{T=Buffer.alloc(0)}return{data:T,encoding:S||null,contentType:A||"application/octet-stream",params:E}},t.exports.resolveContent=(v,y,w)=>{let b;w||(b=new Promise((E,T)=>{w=t.exports.callbackPromise(E,T)}));let S=v&&v[y]&&v[y].content||v[y],_,A=(typeof v[y]=="object"&&v[y].encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!S)return w(null,S);if(typeof S=="object"){if(typeof S.pipe=="function")return x(S,(E,T)=>{if(E)return w(E);v[y].content?v[y].content=T:v[y]=T,w(null,T)});if(/^https?:\/\//i.test(S.path||S.href))return _=o(S.path||S.href),x(_,w);if(/^data:/i.test(S.path||S.href)){let E=t.exports.parseDataURI(S.path||S.href);return!E||!E.data?w(null,Buffer.from(0)):w(null,E.data)}else if(S.path)return x(r.createReadStream(S.path),w)}return typeof v[y].content=="string"&&!["utf8","usascii","ascii"].includes(A)&&(S=Buffer.from(v[y].content,A)),setImmediate(()=>w(null,S)),b},t.exports.assign=function(){let v=Array.from(arguments),y=v.shift()||{};return v.forEach(w=>{Object.keys(w||{}).forEach(b=>{["tls","auth"].includes(b)&&w[b]&&typeof w[b]=="object"?(y[b]||(y[b]={}),Object.keys(w[b]).forEach(S=>{y[b][S]=w[b][S]})):y[b]=w[b]})}),y},t.exports.encodeXText=v=>{if(!/[^\x21-\x2A\x2C-\x3C\x3E-\x7E]/.test(v))return v;let y=Buffer.from(v),w="";for(let b=0,S=y.length;b<S;b++){let _=y[b];_<33||_>126||_===43||_===61?w+="+"+(_<16?"0":"")+_.toString(16).toUpperCase():w+=String.fromCharCode(_)}return w};function x(v,y){let w=!1,b=[],S=0;v.on("error",_=>{w||(w=!0,y(_))}),v.on("readable",()=>{let _;for(;(_=v.read())!==null;)b.push(_),S+=_.length}),v.on("end",()=>{if(w)return;w=!0;let _;try{_=Buffer.concat(b,S)}catch(A){return y(A)}y(null,_)})}function g(v){let y=0,w=new Map;v.forEach(_=>{_.length>y&&(y=_.length)}),v.forEach(_=>{let A=_.toUpperCase();A.length<y&&(A+=" ".repeat(y-A.length)),w.set(_,A)});let b=(_,A,E,...T)=>{let C="";A&&(A.tnx==="server"?C="S: ":A.tnx==="client"&&(C="C: "),A.sid&&(C="["+A.sid+"] "+C),A.cid&&(C="[#"+A.cid+"] "+C)),E=n.format(E,...T),E.split(/\r?\n/).forEach(k=>{console.log("[%s] %s %s",new Date().toISOString().substr(0,19).replace(/T/," "),w.get(_),C+k)})},S={};return v.forEach(_=>{S[_]=b.bind(null,_)}),S}})(Xl);var Ae=Xl.exports;const mx=V,Xs="application/octet-stream",hx="bin",Qs=new Map([["application/acad","dwg"],["application/applixware","aw"],["application/arj","arj"],["application/atom+xml","xml"],["application/atomcat+xml","atomcat"],["application/atomsvc+xml","atomsvc"],["application/base64",["mm","mme"]],["application/binhex","hqx"],["application/binhex4","hqx"],["application/book",["book","boo"]],["application/ccxml+xml,","ccxml"],["application/cdf","cdf"],["application/cdmi-capability","cdmia"],["application/cdmi-container","cdmic"],["application/cdmi-domain","cdmid"],["application/cdmi-object","cdmio"],["application/cdmi-queue","cdmiq"],["application/clariscad","ccad"],["application/commonground","dp"],["application/cu-seeme","cu"],["application/davmount+xml","davmount"],["application/drafting","drw"],["application/dsptype","tsp"],["application/dssc+der","dssc"],["application/dssc+xml","xdssc"],["application/dxf","dxf"],["application/ecmascript",["js","es"]],["application/emma+xml","emma"],["application/envoy","evy"],["application/epub+zip","epub"],["application/excel",["xls","xl","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/exi","exi"],["application/font-tdpfr","pfr"],["application/fractals","fif"],["application/freeloader","frl"],["application/futuresplash","spl"],["application/geo+json","geojson"],["application/gnutar","tgz"],["application/groupwise","vew"],["application/hlp","hlp"],["application/hta","hta"],["application/hyperstudio","stk"],["application/i-deas","unv"],["application/iges",["iges","igs"]],["application/inf","inf"],["application/internet-property-stream","acx"],["application/ipfix","ipfix"],["application/java","class"],["application/java-archive","jar"],["application/java-byte-code","class"],["application/java-serialized-object","ser"],["application/java-vm","class"],["application/javascript","js"],["application/json","json"],["application/lha","lha"],["application/lzx","lzx"],["application/mac-binary","bin"],["application/mac-binhex","hqx"],["application/mac-binhex40","hqx"],["application/mac-compactpro","cpt"],["application/macbinary","bin"],["application/mads+xml","mads"],["application/marc","mrc"],["application/marcxml+xml","mrcx"],["application/mathematica","ma"],["application/mathml+xml","mathml"],["application/mbedlet","mbd"],["application/mbox","mbox"],["application/mcad","mcd"],["application/mediaservercontrol+xml","mscml"],["application/metalink4+xml","meta4"],["application/mets+xml","mets"],["application/mime","aps"],["application/mods+xml","mods"],["application/mp21","m21"],["application/mp4","mp4"],["application/mspowerpoint",["ppt","pot","pps","ppz"]],["application/msword",["doc","dot","w6w","wiz","word"]],["application/mswrite","wri"],["application/mxf","mxf"],["application/netmc","mcp"],["application/octet-stream",["*"]],["application/oda","oda"],["application/oebps-package+xml","opf"],["application/ogg","ogx"],["application/olescript","axs"],["application/onenote","onetoc"],["application/patch-ops-error+xml","xer"],["application/pdf","pdf"],["application/pgp-encrypted","asc"],["application/pgp-signature","pgp"],["application/pics-rules","prf"],["application/pkcs-12","p12"],["application/pkcs-crl","crl"],["application/pkcs10","p10"],["application/pkcs7-mime",["p7c","p7m"]],["application/pkcs7-signature","p7s"],["application/pkcs8","p8"],["application/pkix-attr-cert","ac"],["application/pkix-cert",["cer","crt"]],["application/pkix-crl","crl"],["application/pkix-pkipath","pkipath"],["application/pkixcmp","pki"],["application/plain","text"],["application/pls+xml","pls"],["application/postscript",["ps","ai","eps"]],["application/powerpoint","ppt"],["application/pro_eng",["part","prt"]],["application/prs.cww","cww"],["application/pskc+xml","pskcxml"],["application/rdf+xml","rdf"],["application/reginfo+xml","rif"],["application/relax-ng-compact-syntax","rnc"],["application/resource-lists+xml","rl"],["application/resource-lists-diff+xml","rld"],["application/ringing-tones","rng"],["application/rls-services+xml","rs"],["application/rsd+xml","rsd"],["application/rss+xml","xml"],["application/rtf",["rtf","rtx"]],["application/sbml+xml","sbml"],["application/scvp-cv-request","scq"],["application/scvp-cv-response","scs"],["application/scvp-vp-request","spq"],["application/scvp-vp-response","spp"],["application/sdp","sdp"],["application/sea","sea"],["application/set","set"],["application/set-payment-initiation","setpay"],["application/set-registration-initiation","setreg"],["application/shf+xml","shf"],["application/sla","stl"],["application/smil",["smi","smil"]],["application/smil+xml","smi"],["application/solids","sol"],["application/sounder","sdr"],["application/sparql-query","rq"],["application/sparql-results+xml","srx"],["application/srgs","gram"],["application/srgs+xml","grxml"],["application/sru+xml","sru"],["application/ssml+xml","ssml"],["application/step",["step","stp"]],["application/streamingmedia","ssm"],["application/tei+xml","tei"],["application/thraud+xml","tfi"],["application/timestamped-data","tsd"],["application/toolbook","tbk"],["application/vda","vda"],["application/vnd.3gpp.pic-bw-large","plb"],["application/vnd.3gpp.pic-bw-small","psb"],["application/vnd.3gpp.pic-bw-var","pvb"],["application/vnd.3gpp2.tcap","tcap"],["application/vnd.3m.post-it-notes","pwn"],["application/vnd.accpac.simply.aso","aso"],["application/vnd.accpac.simply.imp","imp"],["application/vnd.acucobol","acu"],["application/vnd.acucorp","atc"],["application/vnd.adobe.air-application-installer-package+zip","air"],["application/vnd.adobe.fxp","fxp"],["application/vnd.adobe.xdp+xml","xdp"],["application/vnd.adobe.xfdf","xfdf"],["application/vnd.ahead.space","ahead"],["application/vnd.airzip.filesecure.azf","azf"],["application/vnd.airzip.filesecure.azs","azs"],["application/vnd.amazon.ebook","azw"],["application/vnd.americandynamics.acc","acc"],["application/vnd.amiga.ami","ami"],["application/vnd.android.package-archive","apk"],["application/vnd.anser-web-certificate-issue-initiation","cii"],["application/vnd.anser-web-funds-transfer-initiation","fti"],["application/vnd.antix.game-component","atx"],["application/vnd.apple.installer+xml","mpkg"],["application/vnd.apple.mpegurl","m3u8"],["application/vnd.aristanetworks.swi","swi"],["application/vnd.audiograph","aep"],["application/vnd.blueice.multipass","mpm"],["application/vnd.bmi","bmi"],["application/vnd.businessobjects","rep"],["application/vnd.chemdraw+xml","cdxml"],["application/vnd.chipnuts.karaoke-mmd","mmd"],["application/vnd.cinderella","cdy"],["application/vnd.claymore","cla"],["application/vnd.cloanto.rp9","rp9"],["application/vnd.clonk.c4group","c4g"],["application/vnd.cluetrust.cartomobile-config","c11amc"],["application/vnd.cluetrust.cartomobile-config-pkg","c11amz"],["application/vnd.commonspace","csp"],["application/vnd.contact.cmsg","cdbcmsg"],["application/vnd.cosmocaller","cmc"],["application/vnd.crick.clicker","clkx"],["application/vnd.crick.clicker.keyboard","clkk"],["application/vnd.crick.clicker.palette","clkp"],["application/vnd.crick.clicker.template","clkt"],["application/vnd.crick.clicker.wordbank","clkw"],["application/vnd.criticaltools.wbs+xml","wbs"],["application/vnd.ctc-posml","pml"],["application/vnd.cups-ppd","ppd"],["application/vnd.curl.car","car"],["application/vnd.curl.pcurl","pcurl"],["application/vnd.data-vision.rdz","rdz"],["application/vnd.denovo.fcselayout-link","fe_launch"],["application/vnd.dna","dna"],["application/vnd.dolby.mlp","mlp"],["application/vnd.dpgraph","dpg"],["application/vnd.dreamfactory","dfac"],["application/vnd.dvb.ait","ait"],["application/vnd.dvb.service","svc"],["application/vnd.dynageo","geo"],["application/vnd.ecowin.chart","mag"],["application/vnd.enliven","nml"],["application/vnd.epson.esf","esf"],["application/vnd.epson.msf","msf"],["application/vnd.epson.quickanime","qam"],["application/vnd.epson.salt","slt"],["application/vnd.epson.ssf","ssf"],["application/vnd.eszigno3+xml","es3"],["application/vnd.ezpix-album","ez2"],["application/vnd.ezpix-package","ez3"],["application/vnd.fdf","fdf"],["application/vnd.fdsn.seed","seed"],["application/vnd.flographit","gph"],["application/vnd.fluxtime.clip","ftc"],["application/vnd.framemaker","fm"],["application/vnd.frogans.fnc","fnc"],["application/vnd.frogans.ltf","ltf"],["application/vnd.fsc.weblaunch","fsc"],["application/vnd.fujitsu.oasys","oas"],["application/vnd.fujitsu.oasys2","oa2"],["application/vnd.fujitsu.oasys3","oa3"],["application/vnd.fujitsu.oasysgp","fg5"],["application/vnd.fujitsu.oasysprs","bh2"],["application/vnd.fujixerox.ddd","ddd"],["application/vnd.fujixerox.docuworks","xdw"],["application/vnd.fujixerox.docuworks.binder","xbd"],["application/vnd.fuzzysheet","fzs"],["application/vnd.genomatix.tuxedo","txd"],["application/vnd.geogebra.file","ggb"],["application/vnd.geogebra.tool","ggt"],["application/vnd.geometry-explorer","gex"],["application/vnd.geonext","gxt"],["application/vnd.geoplan","g2w"],["application/vnd.geospace","g3w"],["application/vnd.gmx","gmx"],["application/vnd.google-earth.kml+xml","kml"],["application/vnd.google-earth.kmz","kmz"],["application/vnd.grafeq","gqf"],["application/vnd.groove-account","gac"],["application/vnd.groove-help","ghf"],["application/vnd.groove-identity-message","gim"],["application/vnd.groove-injector","grv"],["application/vnd.groove-tool-message","gtm"],["application/vnd.groove-tool-template","tpl"],["application/vnd.groove-vcard","vcg"],["application/vnd.hal+xml","hal"],["application/vnd.handheld-entertainment+xml","zmm"],["application/vnd.hbci","hbci"],["application/vnd.hhe.lesson-player","les"],["application/vnd.hp-hpgl",["hgl","hpg","hpgl"]],["application/vnd.hp-hpid","hpid"],["application/vnd.hp-hps","hps"],["application/vnd.hp-jlyt","jlt"],["application/vnd.hp-pcl","pcl"],["application/vnd.hp-pclxl","pclxl"],["application/vnd.hydrostatix.sof-data","sfd-hdstx"],["application/vnd.hzn-3d-crossword","x3d"],["application/vnd.ibm.minipay","mpy"],["application/vnd.ibm.modcap","afp"],["application/vnd.ibm.rights-management","irm"],["application/vnd.ibm.secure-container","sc"],["application/vnd.iccprofile","icc"],["application/vnd.igloader","igl"],["application/vnd.immervision-ivp","ivp"],["application/vnd.immervision-ivu","ivu"],["application/vnd.insors.igm","igm"],["application/vnd.intercon.formnet","xpw"],["application/vnd.intergeo","i2g"],["application/vnd.intu.qbo","qbo"],["application/vnd.intu.qfx","qfx"],["application/vnd.ipunplugged.rcprofile","rcprofile"],["application/vnd.irepository.package+xml","irp"],["application/vnd.is-xpr","xpr"],["application/vnd.isac.fcs","fcs"],["application/vnd.jam","jam"],["application/vnd.jcp.javame.midlet-rms","rms"],["application/vnd.jisp","jisp"],["application/vnd.joost.joda-archive","joda"],["application/vnd.kahootz","ktz"],["application/vnd.kde.karbon","karbon"],["application/vnd.kde.kchart","chrt"],["application/vnd.kde.kformula","kfo"],["application/vnd.kde.kivio","flw"],["application/vnd.kde.kontour","kon"],["application/vnd.kde.kpresenter","kpr"],["application/vnd.kde.kspread","ksp"],["application/vnd.kde.kword","kwd"],["application/vnd.kenameaapp","htke"],["application/vnd.kidspiration","kia"],["application/vnd.kinar","kne"],["application/vnd.koan","skp"],["application/vnd.kodak-descriptor","sse"],["application/vnd.las.las+xml","lasxml"],["application/vnd.llamagraphics.life-balance.desktop","lbd"],["application/vnd.llamagraphics.life-balance.exchange+xml","lbe"],["application/vnd.lotus-1-2-3","123"],["application/vnd.lotus-approach","apr"],["application/vnd.lotus-freelance","pre"],["application/vnd.lotus-notes","nsf"],["application/vnd.lotus-organizer","org"],["application/vnd.lotus-screencam","scm"],["application/vnd.lotus-wordpro","lwp"],["application/vnd.macports.portpkg","portpkg"],["application/vnd.mcd","mcd"],["application/vnd.medcalcdata","mc1"],["application/vnd.mediastation.cdkey","cdkey"],["application/vnd.mfer","mwf"],["application/vnd.mfmp","mfm"],["application/vnd.micrografx.flo","flo"],["application/vnd.micrografx.igx","igx"],["application/vnd.mif","mif"],["application/vnd.mobius.daf","daf"],["application/vnd.mobius.dis","dis"],["application/vnd.mobius.mbk","mbk"],["application/vnd.mobius.mqy","mqy"],["application/vnd.mobius.msl","msl"],["application/vnd.mobius.plc","plc"],["application/vnd.mobius.txf","txf"],["application/vnd.mophun.application","mpn"],["application/vnd.mophun.certificate","mpc"],["application/vnd.mozilla.xul+xml","xul"],["application/vnd.ms-artgalry","cil"],["application/vnd.ms-cab-compressed","cab"],["application/vnd.ms-excel",["xls","xla","xlc","xlm","xlt","xlw","xlb","xll"]],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-fontobject","eot"],["application/vnd.ms-htmlhelp","chm"],["application/vnd.ms-ims","ims"],["application/vnd.ms-lrm","lrm"],["application/vnd.ms-officetheme","thmx"],["application/vnd.ms-outlook","msg"],["application/vnd.ms-pki.certstore","sst"],["application/vnd.ms-pki.pko","pko"],["application/vnd.ms-pki.seccat","cat"],["application/vnd.ms-pki.stl","stl"],["application/vnd.ms-pkicertstore","sst"],["application/vnd.ms-pkiseccat","cat"],["application/vnd.ms-pkistl","stl"],["application/vnd.ms-powerpoint",["ppt","pot","pps","ppa","pwz"]],["application/vnd.ms-powerpoint.addin.macroenabled.12","ppam"],["application/vnd.ms-powerpoint.presentation.macroenabled.12","pptm"],["application/vnd.ms-powerpoint.slide.macroenabled.12","sldm"],["application/vnd.ms-powerpoint.slideshow.macroenabled.12","ppsm"],["application/vnd.ms-powerpoint.template.macroenabled.12","potm"],["application/vnd.ms-project","mpp"],["application/vnd.ms-word.document.macroenabled.12","docm"],["application/vnd.ms-word.template.macroenabled.12","dotm"],["application/vnd.ms-works",["wks","wcm","wdb","wps"]],["application/vnd.ms-wpl","wpl"],["application/vnd.ms-xpsdocument","xps"],["application/vnd.mseq","mseq"],["application/vnd.musician","mus"],["application/vnd.muvee.style","msty"],["application/vnd.neurolanguage.nlu","nlu"],["application/vnd.noblenet-directory","nnd"],["application/vnd.noblenet-sealer","nns"],["application/vnd.noblenet-web","nnw"],["application/vnd.nokia.configuration-message","ncm"],["application/vnd.nokia.n-gage.data","ngdat"],["application/vnd.nokia.n-gage.symbian.install","n-gage"],["application/vnd.nokia.radio-preset","rpst"],["application/vnd.nokia.radio-presets","rpss"],["application/vnd.nokia.ringing-tone","rng"],["application/vnd.novadigm.edm","edm"],["application/vnd.novadigm.edx","edx"],["application/vnd.novadigm.ext","ext"],["application/vnd.oasis.opendocument.chart","odc"],["application/vnd.oasis.opendocument.chart-template","otc"],["application/vnd.oasis.opendocument.database","odb"],["application/vnd.oasis.opendocument.formula","odf"],["application/vnd.oasis.opendocument.formula-template","odft"],["application/vnd.oasis.opendocument.graphics","odg"],["application/vnd.oasis.opendocument.graphics-template","otg"],["application/vnd.oasis.opendocument.image","odi"],["application/vnd.oasis.opendocument.image-template","oti"],["application/vnd.oasis.opendocument.presentation","odp"],["application/vnd.oasis.opendocument.presentation-template","otp"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/vnd.oasis.opendocument.spreadsheet-template","ots"],["application/vnd.oasis.opendocument.text","odt"],["application/vnd.oasis.opendocument.text-master","odm"],["application/vnd.oasis.opendocument.text-template","ott"],["application/vnd.oasis.opendocument.text-web","oth"],["application/vnd.olpc-sugar","xo"],["application/vnd.oma.dd2+xml","dd2"],["application/vnd.openofficeorg.extension","oxt"],["application/vnd.openxmlformats-officedocument.presentationml.presentation","pptx"],["application/vnd.openxmlformats-officedocument.presentationml.slide","sldx"],["application/vnd.openxmlformats-officedocument.presentationml.slideshow","ppsx"],["application/vnd.openxmlformats-officedocument.presentationml.template","potx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","docx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.template","dotx"],["application/vnd.osgeo.mapguide.package","mgp"],["application/vnd.osgi.dp","dp"],["application/vnd.palm","pdb"],["application/vnd.pawaafile","paw"],["application/vnd.pg.format","str"],["application/vnd.pg.osasli","ei6"],["application/vnd.picsel","efif"],["application/vnd.pmi.widget","wg"],["application/vnd.pocketlearn","plf"],["application/vnd.powerbuilder6","pbd"],["application/vnd.previewsystems.box","box"],["application/vnd.proteus.magazine","mgz"],["application/vnd.publishare-delta-tree","qps"],["application/vnd.pvi.ptid1","ptid"],["application/vnd.quark.quarkxpress","qxd"],["application/vnd.realvnc.bed","bed"],["application/vnd.recordare.musicxml","mxl"],["application/vnd.recordare.musicxml+xml","musicxml"],["application/vnd.rig.cryptonote","cryptonote"],["application/vnd.rim.cod","cod"],["application/vnd.rn-realmedia","rm"],["application/vnd.rn-realplayer","rnx"],["application/vnd.route66.link66+xml","link66"],["application/vnd.sailingtracker.track","st"],["application/vnd.seemail","see"],["application/vnd.sema","sema"],["application/vnd.semd","semd"],["application/vnd.semf","semf"],["application/vnd.shana.informed.formdata","ifm"],["application/vnd.shana.informed.formtemplate","itp"],["application/vnd.shana.informed.interchange","iif"],["application/vnd.shana.informed.package","ipk"],["application/vnd.simtech-mindmapper","twd"],["application/vnd.smaf","mmf"],["application/vnd.smart.teacher","teacher"],["application/vnd.solent.sdkm+xml","sdkm"],["application/vnd.spotfire.dxp","dxp"],["application/vnd.spotfire.sfs","sfs"],["application/vnd.stardivision.calc","sdc"],["application/vnd.stardivision.draw","sda"],["application/vnd.stardivision.impress","sdd"],["application/vnd.stardivision.math","smf"],["application/vnd.stardivision.writer","sdw"],["application/vnd.stardivision.writer-global","sgl"],["application/vnd.stepmania.stepchart","sm"],["application/vnd.sun.xml.calc","sxc"],["application/vnd.sun.xml.calc.template","stc"],["application/vnd.sun.xml.draw","sxd"],["application/vnd.sun.xml.draw.template","std"],["application/vnd.sun.xml.impress","sxi"],["application/vnd.sun.xml.impress.template","sti"],["application/vnd.sun.xml.math","sxm"],["application/vnd.sun.xml.writer","sxw"],["application/vnd.sun.xml.writer.global","sxg"],["application/vnd.sun.xml.writer.template","stw"],["application/vnd.sus-calendar","sus"],["application/vnd.svd","svd"],["application/vnd.symbian.install","sis"],["application/vnd.syncml+xml","xsm"],["application/vnd.syncml.dm+wbxml","bdm"],["application/vnd.syncml.dm+xml","xdm"],["application/vnd.tao.intent-module-archive","tao"],["application/vnd.tmobile-livetv","tmo"],["application/vnd.trid.tpt","tpt"],["application/vnd.triscape.mxs","mxs"],["application/vnd.trueapp","tra"],["application/vnd.ufdl","ufd"],["application/vnd.uiq.theme","utz"],["application/vnd.umajin","umj"],["application/vnd.unity","unityweb"],["application/vnd.uoml+xml","uoml"],["application/vnd.vcx","vcx"],["application/vnd.visio","vsd"],["application/vnd.visionary","vis"],["application/vnd.vsf","vsf"],["application/vnd.wap.wbxml","wbxml"],["application/vnd.wap.wmlc","wmlc"],["application/vnd.wap.wmlscriptc","wmlsc"],["application/vnd.webturbo","wtb"],["application/vnd.wolfram.player","nbp"],["application/vnd.wordperfect","wpd"],["application/vnd.wqd","wqd"],["application/vnd.wt.stf","stf"],["application/vnd.xara",["web","xar"]],["application/vnd.xfdl","xfdl"],["application/vnd.yamaha.hv-dic","hvd"],["application/vnd.yamaha.hv-script","hvs"],["application/vnd.yamaha.hv-voice","hvp"],["application/vnd.yamaha.openscoreformat","osf"],["application/vnd.yamaha.openscoreformat.osfpvg+xml","osfpvg"],["application/vnd.yamaha.smaf-audio","saf"],["application/vnd.yamaha.smaf-phrase","spf"],["application/vnd.yellowriver-custom-menu","cmp"],["application/vnd.zul","zir"],["application/vnd.zzazz.deck+xml","zaz"],["application/vocaltec-media-desc","vmd"],["application/vocaltec-media-file","vmf"],["application/voicexml+xml","vxml"],["application/widget","wgt"],["application/winhlp","hlp"],["application/wordperfect",["wp","wp5","wp6","wpd"]],["application/wordperfect6.0",["w60","wp5"]],["application/wordperfect6.1","w61"],["application/wsdl+xml","wsdl"],["application/wspolicy+xml","wspolicy"],["application/x-123","wk1"],["application/x-7z-compressed","7z"],["application/x-abiword","abw"],["application/x-ace-compressed","ace"],["application/x-aim","aim"],["application/x-authorware-bin","aab"],["application/x-authorware-map","aam"],["application/x-authorware-seg","aas"],["application/x-bcpio","bcpio"],["application/x-binary","bin"],["application/x-binhex40","hqx"],["application/x-bittorrent","torrent"],["application/x-bsh",["bsh","sh","shar"]],["application/x-bytecode.elisp","elc"],["application/x-bytecode.python","pyc"],["application/x-bzip","bz"],["application/x-bzip2",["boz","bz2"]],["application/x-cdf","cdf"],["application/x-cdlink","vcd"],["application/x-chat",["cha","chat"]],["application/x-chess-pgn","pgn"],["application/x-cmu-raster","ras"],["application/x-cocoa","cco"],["application/x-compactpro","cpt"],["application/x-compress","z"],["application/x-compressed",["tgz","gz","z","zip"]],["application/x-conference","nsc"],["application/x-cpio","cpio"],["application/x-cpt","cpt"],["application/x-csh","csh"],["application/x-debian-package","deb"],["application/x-deepv","deepv"],["application/x-director",["dir","dcr","dxr"]],["application/x-doom","wad"],["application/x-dtbncx+xml","ncx"],["application/x-dtbook+xml","dtb"],["application/x-dtbresource+xml","res"],["application/x-dvi","dvi"],["application/x-elc","elc"],["application/x-envoy",["env","evy"]],["application/x-esrehber","es"],["application/x-excel",["xls","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/x-font-bdf","bdf"],["application/x-font-ghostscript","gsf"],["application/x-font-linux-psf","psf"],["application/x-font-otf","otf"],["application/x-font-pcf","pcf"],["application/x-font-snf","snf"],["application/x-font-ttf","ttf"],["application/x-font-type1","pfa"],["application/x-font-woff","woff"],["application/x-frame","mif"],["application/x-freelance","pre"],["application/x-futuresplash","spl"],["application/x-gnumeric","gnumeric"],["application/x-gsp","gsp"],["application/x-gss","gss"],["application/x-gtar","gtar"],["application/x-gzip",["gz","gzip"]],["application/x-hdf","hdf"],["application/x-helpfile",["help","hlp"]],["application/x-httpd-imap","imap"],["application/x-ima","ima"],["application/x-internet-signup",["ins","isp"]],["application/x-internett-signup","ins"],["application/x-inventor","iv"],["application/x-ip2","ip"],["application/x-iphone","iii"],["application/x-java-class","class"],["application/x-java-commerce","jcm"],["application/x-java-jnlp-file","jnlp"],["application/x-javascript","js"],["application/x-koan",["skd","skm","skp","skt"]],["application/x-ksh","ksh"],["application/x-latex",["latex","ltx"]],["application/x-lha","lha"],["application/x-lisp","lsp"],["application/x-livescreen","ivy"],["application/x-lotus","wq1"],["application/x-lotusscreencam","scm"],["application/x-lzh","lzh"],["application/x-lzx","lzx"],["application/x-mac-binhex40","hqx"],["application/x-macbinary","bin"],["application/x-magic-cap-package-1.0","mc$"],["application/x-mathcad","mcd"],["application/x-meme","mm"],["application/x-midi",["mid","midi"]],["application/x-mif","mif"],["application/x-mix-transfer","nix"],["application/x-mobipocket-ebook","prc"],["application/x-mplayer2","asx"],["application/x-ms-application","application"],["application/x-ms-wmd","wmd"],["application/x-ms-wmz","wmz"],["application/x-ms-xbap","xbap"],["application/x-msaccess","mdb"],["application/x-msbinder","obd"],["application/x-mscardfile","crd"],["application/x-msclip","clp"],["application/x-msdownload",["exe","dll"]],["application/x-msexcel",["xls","xla","xlw"]],["application/x-msmediaview",["mvb","m13","m14"]],["application/x-msmetafile","wmf"],["application/x-msmoney","mny"],["application/x-mspowerpoint","ppt"],["application/x-mspublisher","pub"],["application/x-msschedule","scd"],["application/x-msterminal","trm"],["application/x-mswrite","wri"],["application/x-navi-animation","ani"],["application/x-navidoc","nvd"],["application/x-navimap","map"],["application/x-navistyle","stl"],["application/x-netcdf",["cdf","nc"]],["application/x-newton-compatible-pkg","pkg"],["application/x-nokia-9000-communicator-add-on-software","aos"],["application/x-omc","omc"],["application/x-omcdatamaker","omcd"],["application/x-omcregerator","omcr"],["application/x-pagemaker",["pm4","pm5"]],["application/x-pcl","pcl"],["application/x-perfmon",["pma","pmc","pml","pmr","pmw"]],["application/x-pixclscript","plx"],["application/x-pkcs10","p10"],["application/x-pkcs12",["p12","pfx"]],["application/x-pkcs7-certificates",["p7b","spc"]],["application/x-pkcs7-certreqresp","p7r"],["application/x-pkcs7-mime",["p7m","p7c"]],["application/x-pkcs7-signature",["p7s","p7a"]],["application/x-pointplus","css"],["application/x-portable-anymap","pnm"],["application/x-project",["mpc","mpt","mpv","mpx"]],["application/x-qpro","wb1"],["application/x-rar-compressed","rar"],["application/x-rtf","rtf"],["application/x-sdp","sdp"],["application/x-sea","sea"],["application/x-seelogo","sl"],["application/x-sh","sh"],["application/x-shar",["shar","sh"]],["application/x-shockwave-flash","swf"],["application/x-silverlight-app","xap"],["application/x-sit","sit"],["application/x-sprite",["spr","sprite"]],["application/x-stuffit","sit"],["application/x-stuffitx","sitx"],["application/x-sv4cpio","sv4cpio"],["application/x-sv4crc","sv4crc"],["application/x-tar","tar"],["application/x-tbook",["sbk","tbk"]],["application/x-tcl","tcl"],["application/x-tex","tex"],["application/x-tex-tfm","tfm"],["application/x-texinfo",["texi","texinfo"]],["application/x-troff",["roff","t","tr"]],["application/x-troff-man","man"],["application/x-troff-me","me"],["application/x-troff-ms","ms"],["application/x-troff-msvideo","avi"],["application/x-ustar","ustar"],["application/x-visio",["vsd","vst","vsw"]],["application/x-vnd.audioexplosion.mzz","mzz"],["application/x-vnd.ls-xpix","xpix"],["application/x-vrml","vrml"],["application/x-wais-source",["src","wsrc"]],["application/x-winhelp","hlp"],["application/x-wintalk","wtk"],["application/x-world",["wrl","svr"]],["application/x-wpwin","wpd"],["application/x-wri","wri"],["application/x-x509-ca-cert",["cer","crt","der"]],["application/x-x509-user-cert","crt"],["application/x-xfig","fig"],["application/x-xpinstall","xpi"],["application/x-zip-compressed","zip"],["application/xcap-diff+xml","xdf"],["application/xenc+xml","xenc"],["application/xhtml+xml","xhtml"],["application/xml","xml"],["application/xml-dtd","dtd"],["application/xop+xml","xop"],["application/xslt+xml","xslt"],["application/xspf+xml","xspf"],["application/xv+xml","mxml"],["application/yang","yang"],["application/yin+xml","yin"],["application/ynd.ms-pkipko","pko"],["application/zip","zip"],["audio/adpcm","adp"],["audio/aiff",["aiff","aif","aifc"]],["audio/basic",["snd","au"]],["audio/it","it"],["audio/make",["funk","my","pfunk"]],["audio/make.my.funk","pfunk"],["audio/mid",["mid","rmi"]],["audio/midi",["midi","kar","mid"]],["audio/mod","mod"],["audio/mp4","mp4a"],["audio/mpeg",["mpga","mp3","m2a","mp2","mpa","mpg"]],["audio/mpeg3","mp3"],["audio/nspaudio",["la","lma"]],["audio/ogg","oga"],["audio/s3m","s3m"],["audio/tsp-audio","tsi"],["audio/tsplayer","tsp"],["audio/vnd.dece.audio","uva"],["audio/vnd.digital-winds","eol"],["audio/vnd.dra","dra"],["audio/vnd.dts","dts"],["audio/vnd.dts.hd","dtshd"],["audio/vnd.lucent.voice","lvp"],["audio/vnd.ms-playready.media.pya","pya"],["audio/vnd.nuera.ecelp4800","ecelp4800"],["audio/vnd.nuera.ecelp7470","ecelp7470"],["audio/vnd.nuera.ecelp9600","ecelp9600"],["audio/vnd.qcelp","qcp"],["audio/vnd.rip","rip"],["audio/voc","voc"],["audio/voxware","vox"],["audio/wav","wav"],["audio/webm","weba"],["audio/x-aac","aac"],["audio/x-adpcm","snd"],["audio/x-aiff",["aiff","aif","aifc"]],["audio/x-au","au"],["audio/x-gsm",["gsd","gsm"]],["audio/x-jam","jam"],["audio/x-liveaudio","lam"],["audio/x-mid",["mid","midi"]],["audio/x-midi",["midi","mid"]],["audio/x-mod","mod"],["audio/x-mpeg","mp2"],["audio/x-mpeg-3","mp3"],["audio/x-mpegurl","m3u"],["audio/x-mpequrl","m3u"],["audio/x-ms-wax","wax"],["audio/x-ms-wma","wma"],["audio/x-nspaudio",["la","lma"]],["audio/x-pn-realaudio",["ra","ram","rm","rmm","rmp"]],["audio/x-pn-realaudio-plugin",["ra","rmp","rpm"]],["audio/x-psid","sid"],["audio/x-realaudio","ra"],["audio/x-twinvq","vqf"],["audio/x-twinvq-plugin",["vqe","vql"]],["audio/x-vnd.audioexplosion.mjuicemediafile","mjf"],["audio/x-voc","voc"],["audio/x-wav","wav"],["audio/xm","xm"],["chemical/x-cdx","cdx"],["chemical/x-cif","cif"],["chemical/x-cmdf","cmdf"],["chemical/x-cml","cml"],["chemical/x-csml","csml"],["chemical/x-pdb",["pdb","xyz"]],["chemical/x-xyz","xyz"],["drawing/x-dwf","dwf"],["i-world/i-vrml","ivr"],["image/bmp",["bmp","bm"]],["image/cgm","cgm"],["image/cis-cod","cod"],["image/cmu-raster",["ras","rast"]],["image/fif","fif"],["image/florian",["flo","turbot"]],["image/g3fax","g3"],["image/gif","gif"],["image/ief",["ief","iefs"]],["image/jpeg",["jpeg","jpe","jpg","jfif","jfif-tbnl"]],["image/jutvision","jut"],["image/ktx","ktx"],["image/naplps",["nap","naplps"]],["image/pict",["pic","pict"]],["image/pipeg","jfif"],["image/pjpeg",["jfif","jpe","jpeg","jpg"]],["image/png",["png","x-png"]],["image/prs.btif","btif"],["image/svg+xml","svg"],["image/tiff",["tif","tiff"]],["image/vasa","mcf"],["image/vnd.adobe.photoshop","psd"],["image/vnd.dece.graphic","uvi"],["image/vnd.djvu","djvu"],["image/vnd.dvb.subtitle","sub"],["image/vnd.dwg",["dwg","dxf","svf"]],["image/vnd.dxf","dxf"],["image/vnd.fastbidsheet","fbs"],["image/vnd.fpx","fpx"],["image/vnd.fst","fst"],["image/vnd.fujixerox.edmics-mmr","mmr"],["image/vnd.fujixerox.edmics-rlc","rlc"],["image/vnd.ms-modi","mdi"],["image/vnd.net-fpx",["fpx","npx"]],["image/vnd.rn-realflash","rf"],["image/vnd.rn-realpix","rp"],["image/vnd.wap.wbmp","wbmp"],["image/vnd.xiff","xif"],["image/webp","webp"],["image/x-cmu-raster","ras"],["image/x-cmx","cmx"],["image/x-dwg",["dwg","dxf","svf"]],["image/x-freehand","fh"],["image/x-icon","ico"],["image/x-jg","art"],["image/x-jps","jps"],["image/x-niff",["niff","nif"]],["image/x-pcx","pcx"],["image/x-pict",["pct","pic"]],["image/x-portable-anymap","pnm"],["image/x-portable-bitmap","pbm"],["image/x-portable-graymap","pgm"],["image/x-portable-greymap","pgm"],["image/x-portable-pixmap","ppm"],["image/x-quicktime",["qif","qti","qtif"]],["image/x-rgb","rgb"],["image/x-tiff",["tif","tiff"]],["image/x-windows-bmp","bmp"],["image/x-xbitmap","xbm"],["image/x-xbm","xbm"],["image/x-xpixmap",["xpm","pm"]],["image/x-xwd","xwd"],["image/x-xwindowdump","xwd"],["image/xbm","xbm"],["image/xpm","xpm"],["message/rfc822",["eml","mht","mhtml","nws","mime"]],["model/iges",["iges","igs"]],["model/mesh","msh"],["model/vnd.collada+xml","dae"],["model/vnd.dwf","dwf"],["model/vnd.gdl","gdl"],["model/vnd.gtw","gtw"],["model/vnd.mts","mts"],["model/vnd.vtu","vtu"],["model/vrml",["vrml","wrl","wrz"]],["model/x-pov","pov"],["multipart/x-gzip","gzip"],["multipart/x-ustar","ustar"],["multipart/x-zip","zip"],["music/crescendo",["mid","midi"]],["music/x-karaoke","kar"],["paleovu/x-pv","pvu"],["text/asp","asp"],["text/calendar","ics"],["text/css","css"],["text/csv","csv"],["text/ecmascript","js"],["text/h323","323"],["text/html",["html","htm","stm","acgi","htmls","htx","shtml"]],["text/iuls","uls"],["text/javascript","js"],["text/mcf","mcf"],["text/n3","n3"],["text/pascal","pas"],["text/plain",["txt","bas","c","h","c++","cc","com","conf","cxx","def","f","f90","for","g","hh","idc","jav","java","list","log","lst","m","mar","pl","sdml","text"]],["text/plain-bas","par"],["text/prs.lines.tag","dsc"],["text/richtext",["rtx","rt","rtf"]],["text/scriplet","wsc"],["text/scriptlet","sct"],["text/sgml",["sgm","sgml"]],["text/tab-separated-values","tsv"],["text/troff","t"],["text/turtle","ttl"],["text/uri-list",["uni","unis","uri","uris"]],["text/vnd.abc","abc"],["text/vnd.curl","curl"],["text/vnd.curl.dcurl","dcurl"],["text/vnd.curl.mcurl","mcurl"],["text/vnd.curl.scurl","scurl"],["text/vnd.fly","fly"],["text/vnd.fmi.flexstor","flx"],["text/vnd.graphviz","gv"],["text/vnd.in3d.3dml","3dml"],["text/vnd.in3d.spot","spot"],["text/vnd.rn-realtext","rt"],["text/vnd.sun.j2me.app-descriptor","jad"],["text/vnd.wap.wml","wml"],["text/vnd.wap.wmlscript","wmls"],["text/webviewhtml","htt"],["text/x-asm",["asm","s"]],["text/x-audiosoft-intra","aip"],["text/x-c",["c","cc","cpp"]],["text/x-component","htc"],["text/x-fortran",["for","f","f77","f90"]],["text/x-h",["h","hh"]],["text/x-java-source",["java","jav"]],["text/x-java-source,java","java"],["text/x-la-asf","lsx"],["text/x-m","m"],["text/x-pascal","p"],["text/x-script","hlb"],["text/x-script.csh","csh"],["text/x-script.elisp","el"],["text/x-script.guile","scm"],["text/x-script.ksh","ksh"],["text/x-script.lisp","lsp"],["text/x-script.perl","pl"],["text/x-script.perl-module","pm"],["text/x-script.phyton","py"],["text/x-script.rexx","rexx"],["text/x-script.scheme","scm"],["text/x-script.sh","sh"],["text/x-script.tcl","tcl"],["text/x-script.tcsh","tcsh"],["text/x-script.zsh","zsh"],["text/x-server-parsed-html",["shtml","ssi"]],["text/x-setext","etx"],["text/x-sgml",["sgm","sgml"]],["text/x-speech",["spc","talk"]],["text/x-uil","uil"],["text/x-uuencode",["uu","uue"]],["text/x-vcalendar","vcs"],["text/x-vcard","vcf"],["text/xml","xml"],["video/3gpp","3gp"],["video/3gpp2","3g2"],["video/animaflex","afl"],["video/avi","avi"],["video/avs-video","avs"],["video/dl","dl"],["video/fli","fli"],["video/gl","gl"],["video/h261","h261"],["video/h263","h263"],["video/h264","h264"],["video/jpeg","jpgv"],["video/jpm","jpm"],["video/mj2","mj2"],["video/mp4","mp4"],["video/mpeg",["mpeg","mp2","mpa","mpe","mpg","mpv2","m1v","m2v","mp3"]],["video/msvideo","avi"],["video/ogg","ogv"],["video/quicktime",["mov","qt","moov"]],["video/vdo","vdo"],["video/vivo",["viv","vivo"]],["video/vnd.dece.hd","uvh"],["video/vnd.dece.mobile","uvm"],["video/vnd.dece.pd","uvp"],["video/vnd.dece.sd","uvs"],["video/vnd.dece.video","uvv"],["video/vnd.fvt","fvt"],["video/vnd.mpegurl","mxu"],["video/vnd.ms-playready.media.pyv","pyv"],["video/vnd.rn-realvideo","rv"],["video/vnd.uvvu.mp4","uvu"],["video/vnd.vivo",["viv","vivo"]],["video/vosaic","vos"],["video/webm","webm"],["video/x-amt-demorun","xdr"],["video/x-amt-showrun","xsr"],["video/x-atomic3d-feature","fmf"],["video/x-dl","dl"],["video/x-dv",["dif","dv"]],["video/x-f4v","f4v"],["video/x-fli","fli"],["video/x-flv","flv"],["video/x-gl","gl"],["video/x-isvideo","isu"],["video/x-la-asf",["lsf","lsx"]],["video/x-m4v","m4v"],["video/x-motion-jpeg","mjpg"],["video/x-mpeg",["mp3","mp2"]],["video/x-mpeq2a","mp2"],["video/x-ms-asf",["asf","asr","asx"]],["video/x-ms-asf-plugin","asx"],["video/x-ms-wm","wm"],["video/x-ms-wmv","wmv"],["video/x-ms-wmx","wmx"],["video/x-ms-wvx","wvx"],["video/x-msvideo","avi"],["video/x-qtc","qtc"],["video/x-scm","scm"],["video/x-sgi-movie",["movie","mv"]],["windows/metafile","wmf"],["www/mime","mime"],["x-conference/x-cooltalk","ice"],["x-music/x-midi",["mid","midi"]],["x-world/x-3dmf",["3dm","3dmf","qd3","qd3d"]],["x-world/x-svr","svr"],["x-world/x-vrml",["flr","vrml","wrl","wrz","xaf","xof"]],["x-world/x-vrt","vrt"],["xgl/drawing","xgz"],["xgl/movie","xmz"]]),Js=new Map([["123","application/vnd.lotus-1-2-3"],["323","text/h323"],["*","application/octet-stream"],["3dm","x-world/x-3dmf"],["3dmf","x-world/x-3dmf"],["3dml","text/vnd.in3d.3dml"],["3g2","video/3gpp2"],["3gp","video/3gpp"],["7z","application/x-7z-compressed"],["a","application/octet-stream"],["aab","application/x-authorware-bin"],["aac","audio/x-aac"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abc","text/vnd.abc"],["abw","application/x-abiword"],["ac","application/pkix-attr-cert"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acgi","text/html"],["acu","application/vnd.acucobol"],["acx","application/internet-property-stream"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afl","video/animaflex"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/postscript"],["aif",["audio/aiff","audio/x-aiff"]],["aifc",["audio/aiff","audio/x-aiff"]],["aiff",["audio/aiff","audio/x-aiff"]],["aim","application/x-aim"],["aip","text/x-audiosoft-intra"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["ani","application/x-navi-animation"],["aos","application/x-nokia-9000-communicator-add-on-software"],["apk","application/vnd.android.package-archive"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["aps","application/mime"],["arc","application/octet-stream"],["arj",["application/arj","application/octet-stream"]],["art","image/x-jg"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asp","text/asp"],["asr","video/x-ms-asf"],["asx",["video/x-ms-asf","application/x-mplayer2","video/x-ms-asf-plugin"]],["atc","application/vnd.acucorp"],["atomcat","application/atomcat+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au",["audio/basic","audio/x-au"]],["avi",["video/avi","video/msvideo","application/x-troff-msvideo","video/x-msvideo"]],["avs","video/avs-video"],["aw","application/applixware"],["axs","application/olescript"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azw","application/vnd.amazon.ebook"],["bas","text/plain"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin",["application/octet-stream","application/mac-binary","application/macbinary","application/x-macbinary","application/x-binary"]],["bm","image/bmp"],["bmi","application/vnd.bmi"],["bmp",["image/bmp","image/x-windows-bmp"]],["boo","application/book"],["book","application/book"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bsh","application/x-bsh"],["btif","image/prs.btif"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c",["text/plain","text/x-c"]],["c++","text/plain"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["c4g","application/vnd.clonk.c4group"],["cab","application/vnd.ms-cab-compressed"],["car","application/vnd.curl.car"],["cat",["application/vnd.ms-pkiseccat","application/vnd.ms-pki.seccat"]],["cc",["text/plain","text/x-c"]],["ccad","application/clariscad"],["cco","application/x-cocoa"],["ccxml","application/ccxml+xml,"],["cdbcmsg","application/vnd.contact.cmsg"],["cdf",["application/cdf","application/x-cdf","application/x-netcdf"]],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer",["application/pkix-cert","application/x-x509-ca-cert"]],["cgm","image/cgm"],["cha","application/x-chat"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cla","application/vnd.claymore"],["class",["application/octet-stream","application/java","application/java-byte-code","application/java-vm","application/x-java-class"]],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod",["image/cis-cod","application/vnd.rim.cod"]],["com",["application/octet-stream","text/plain"]],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt",["application/mac-compactpro","application/x-compactpro","application/x-cpt"]],["crd","application/x-mscardfile"],["crl",["application/pkix-crl","application/pkcs-crl"]],["crt",["application/pkix-cert","application/x-x509-user-cert","application/x-x509-ca-cert"]],["cryptonote","application/vnd.rig.cryptonote"],["csh",["text/x-script.csh","application/x-csh"]],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["css",["text/css","application/x-pointplus"]],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxx","text/plain"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["davmount","application/davmount+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["deb","application/x-debian-package"],["deepv","application/x-deepv"],["def","text/plain"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dif","video/x-dv"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["djvu","image/vnd.djvu"],["dl",["video/dl","video/x-dl"]],["dll","application/x-msdownload"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.document.macroenabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroenabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp",["application/commonground","application/vnd.osgi.dp"]],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drw","application/drafting"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dv","video/x-dv"],["dvi","application/x-dvi"],["dwf",["model/vnd.dwf","drawing/x-dwf"]],["dwg",["application/acad","image/vnd.dwg","image/x-dwg"]],["dxf",["application/dxf","image/vnd.dwg","image/vnd.dxf","image/x-dwg"]],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["el","text/x-script.elisp"],["elc",["application/x-elc","application/x-bytecode.elisp"]],["eml","message/rfc822"],["emma","application/emma+xml"],["env","application/x-envoy"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es",["application/ecmascript","application/x-esrehber"]],["es3","application/vnd.eszigno3+xml"],["esf","application/vnd.epson.esf"],["etx","text/x-setext"],["evy",["application/envoy","application/x-envoy"]],["exe",["application/octet-stream","application/x-msdownload"]],["exi","application/exi"],["ext","application/vnd.novadigm.ext"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f",["text/plain","text/x-fortran"]],["f4v","video/x-f4v"],["f77","text/x-fortran"],["f90",["text/plain","text/x-fortran"]],["fbs","image/vnd.fastbidsheet"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fh","image/x-freehand"],["fif",["application/fractals","image/fif"]],["fig","application/x-xfig"],["fli",["video/fli","video/x-fli"]],["flo",["image/florian","application/vnd.micrografx.flo"]],["flr","x-world/x-vrml"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fmf","video/x-atomic3d-feature"],["fnc","application/vnd.frogans.fnc"],["for",["text/plain","text/x-fortran"]],["fpx",["image/vnd.fpx","image/vnd.net-fpx"]],["frl","application/freeloader"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["funk","audio/make"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g","text/plain"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gdl","model/vnd.gdl"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["gl",["video/gl","video/x-gl"]],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gph","application/vnd.flographit"],["gqf","application/vnd.grafeq"],["gram","application/srgs"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsd","audio/x-gsm"],["gsf","application/x-font-ghostscript"],["gsm","audio/x-gsm"],["gsp","application/x-gsp"],["gss","application/x-gss"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxt","application/vnd.geonext"],["gz",["application/x-gzip","application/x-compressed"]],["gzip",["multipart/x-gzip","application/x-gzip"]],["h",["text/plain","text/x-h"]],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hdf","application/x-hdf"],["help","application/x-helpfile"],["hgl","application/vnd.hp-hpgl"],["hh",["text/plain","text/x-h"]],["hlb","text/x-script"],["hlp",["application/winhlp","application/hlp","application/x-helpfile","application/x-winhelp"]],["hpg","application/vnd.hp-hpgl"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx",["application/mac-binhex40","application/binhex","application/binhex4","application/mac-binhex","application/x-binhex40","application/x-mac-binhex40"]],["hta","application/hta"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["htmls","text/html"],["htt","text/webviewhtml"],["htx","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["ico","image/x-icon"],["ics","text/calendar"],["idc","text/plain"],["ief","image/ief"],["iefs","image/ief"],["ifm","application/vnd.shana.informed.formdata"],["iges",["application/iges","model/iges"]],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs",["application/iges","model/iges"]],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["iii","application/x-iphone"],["ima","application/x-ima"],["imap","application/x-httpd-imap"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["inf","application/inf"],["ins",["application/x-internet-signup","application/x-internett-signup"]],["ip","application/x-ip2"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["isp","application/x-internet-signup"],["isu","video/x-isvideo"],["it","audio/it"],["itp","application/vnd.shana.informed.formtemplate"],["iv","application/x-inventor"],["ivp","application/vnd.immervision-ivp"],["ivr","i-world/i-vrml"],["ivu","application/vnd.immervision-ivu"],["ivy","application/x-livescreen"],["jad","text/vnd.sun.j2me.app-descriptor"],["jam",["application/vnd.jam","audio/x-jam"]],["jar","application/java-archive"],["jav",["text/plain","text/x-java-source"]],["java",["text/plain","text/x-java-source,java","text/x-java-source"]],["jcm","application/x-java-commerce"],["jfif",["image/pipeg","image/jpeg","image/pjpeg"]],["jfif-tbnl","image/jpeg"],["jisp","application/vnd.jisp"],["jlt","application/vnd.hp-jlyt"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jpe",["image/jpeg","image/pjpeg"]],["jpeg",["image/jpeg","image/pjpeg"]],["jpg",["image/jpeg","image/pjpeg"]],["jpgv","video/jpeg"],["jpm","video/jpm"],["jps","image/x-jps"],["js",["application/javascript","application/ecmascript","text/javascript","text/ecmascript","application/x-javascript"]],["json","application/json"],["jut","image/jutvision"],["kar",["audio/midi","music/x-karaoke"]],["karbon","application/vnd.kde.karbon"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["ksh",["application/x-ksh","text/x-script.ksh"]],["ksp","application/vnd.kde.kspread"],["ktx","image/ktx"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["la",["audio/nspaudio","audio/x-nspaudio"]],["lam","audio/x-liveaudio"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["lha",["application/octet-stream","application/lha","application/x-lha"]],["lhx","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["lma",["audio/nspaudio","audio/x-nspaudio"]],["log","text/plain"],["lrm","application/vnd.ms-lrm"],["lsf","video/x-la-asf"],["lsp",["application/x-lisp","text/x-script.lisp"]],["lst","text/plain"],["lsx",["video/x-la-asf","text/x-la-asf"]],["ltf","application/vnd.frogans.ltf"],["ltx","application/x-latex"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh",["application/octet-stream","application/x-lzh"]],["lzx",["application/lzx","application/octet-stream","application/x-lzx"]],["m",["text/plain","text/x-m"]],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m1v","video/mpeg"],["m21","application/mp21"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3u",["audio/x-mpegurl","audio/x-mpequrl"]],["m3u8","application/vnd.apple.mpegurl"],["m4v","video/x-m4v"],["ma","application/mathematica"],["mads","application/mads+xml"],["mag","application/vnd.ecowin.chart"],["man","application/x-troff-man"],["map","application/x-navimap"],["mar","text/plain"],["mathml","application/mathml+xml"],["mbd","application/mbedlet"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc$","application/x-magic-cap-package-1.0"],["mc1","application/vnd.medcalcdata"],["mcd",["application/mcad","application/vnd.mcd","application/x-mathcad"]],["mcf",["image/vasa","text/mcf"]],["mcp","application/netmc"],["mcurl","text/vnd.curl.mcurl"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["me","application/x-troff-me"],["meta4","application/metalink4+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mht","message/rfc822"],["mhtml","message/rfc822"],["mid",["audio/mid","audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["midi",["audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["mif",["application/vnd.mif","application/x-mif","application/x-frame"]],["mime",["message/rfc822","www/mime"]],["mj2","video/mj2"],["mjf","audio/x-vnd.audioexplosion.mjuicemediafile"],["mjpg","video/x-motion-jpeg"],["mlp","application/vnd.dolby.mlp"],["mm",["application/base64","application/x-meme"]],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mme","application/base64"],["mmf","application/vnd.smaf"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mny","application/x-msmoney"],["mod",["audio/mod","audio/x-mod"]],["mods","application/mods+xml"],["moov","video/quicktime"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2",["video/mpeg","audio/mpeg","video/x-mpeg","audio/x-mpeg","video/x-mpeq2a"]],["mp3",["audio/mpeg","audio/mpeg3","video/mpeg","audio/x-mpeg-3","video/x-mpeg"]],["mp4",["video/mp4","application/mp4"]],["mp4a","audio/mp4"],["mpa",["video/mpeg","audio/mpeg"]],["mpc",["application/vnd.mophun.certificate","application/x-project"]],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg",["video/mpeg","audio/mpeg"]],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/x-project"],["mpv","application/x-project"],["mpv2","video/mpeg"],["mpx","application/x-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","application/x-troff-ms"],["mscml","application/mediaservercontrol+xml"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msl","application/vnd.mobius.msl"],["msty","application/vnd.muvee.style"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musicxml","application/vnd.recordare.musicxml+xml"],["mv","video/x-sgi-movie"],["mvb","application/x-msmediaview"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["my","audio/make"],["mzz","application/x-vnd.audioexplosion.mzz"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nap","image/naplps"],["naplps","image/naplps"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncm","application/vnd.nokia.configuration-message"],["ncx","application/x-dtbncx+xml"],["ngdat","application/vnd.nokia.n-gage.data"],["nif","image/x-niff"],["niff","image/x-niff"],["nix","application/x-mix-transfer"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nvd","application/x-navidoc"],["nws","message/rfc822"],["o","application/octet-stream"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omc","application/x-omc"],["omcd","application/x-omcdatamaker"],["omcr","application/x-omcregerator"],["onetoc","application/onenote"],["opf","application/oebps-package+xml"],["org","application/vnd.lotus-organizer"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","application/x-font-otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p10",["application/pkcs10","application/x-pkcs10"]],["p12",["application/pkcs-12","application/x-pkcs12"]],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7m",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7r","application/x-pkcs7-certreqresp"],["p7s",["application/pkcs7-signature","application/x-pkcs7-signature"]],["p8","application/pkcs8"],["par","text/plain-bas"],["part","application/pro_eng"],["pas","text/pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcf","application/x-font-pcf"],["pcl",["application/vnd.hp-pcl","application/x-pcl"]],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb",["application/vnd.palm","chemical/x-pdb"]],["pdf","application/pdf"],["pfa","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfunk",["audio/make","audio/make.my.funk"]],["pfx","application/x-pkcs12"],["pgm",["image/x-portable-graymap","image/x-portable-greymap"]],["pgn","application/x-chess-pgn"],["pgp","application/pgp-signature"],["pic",["image/pict","image/x-pict"]],["pict","image/pict"],["pkg","application/x-newton-compatible-pkg"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pko",["application/ynd.ms-pkipko","application/vnd.ms-pki.pko"]],["pl",["text/plain","text/x-script.perl"]],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["plx","application/x-pixclscript"],["pm",["text/x-script.perl-module","image/x-xpixmap"]],["pm4","application/x-pagemaker"],["pm5","application/x-pagemaker"],["pma","application/x-perfmon"],["pmc","application/x-perfmon"],["pml",["application/vnd.ctc-posml","application/x-perfmon"]],["pmr","application/x-perfmon"],["pmw","application/x-perfmon"],["png","image/png"],["pnm",["application/x-portable-anymap","image/x-portable-anymap"]],["portpkg","application/vnd.macports.portpkg"],["pot",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["potm","application/vnd.ms-powerpoint.template.macroenabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["pov","model/x-pov"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt",["application/vnd.ms-powerpoint","application/mspowerpoint","application/powerpoint","application/x-mspowerpoint"]],["pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["ppz","application/mspowerpoint"],["prc","application/x-mobipocket-ebook"],["pre",["application/vnd.lotus-freelance","application/x-freelance"]],["prf","application/pics-rules"],["prt","application/pro_eng"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd",["application/octet-stream","image/vnd.adobe.photoshop"]],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pvu","paleovu/x-pv"],["pwn","application/vnd.3m.post-it-notes"],["pwz","application/vnd.ms-powerpoint"],["py","text/x-script.phyton"],["pya","audio/vnd.ms-playready.media.pya"],["pyc","application/x-bytecode.python"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qcp","audio/vnd.qcelp"],["qd3","x-world/x-3dmf"],["qd3d","x-world/x-3dmf"],["qfx","application/vnd.intu.qfx"],["qif","image/x-quicktime"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qtc","video/x-qtc"],["qti","image/x-quicktime"],["qtif","image/x-quicktime"],["qxd","application/vnd.quark.quarkxpress"],["ra",["audio/x-realaudio","audio/x-pn-realaudio","audio/x-pn-realaudio-plugin"]],["ram","audio/x-pn-realaudio"],["rar","application/x-rar-compressed"],["ras",["image/cmu-raster","application/x-cmu-raster","image/x-cmu-raster"]],["rast","image/cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rexx","text/x-script.rexx"],["rf","image/vnd.rn-realflash"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm",["application/vnd.rn-realmedia","audio/x-pn-realaudio"]],["rmi","audio/mid"],["rmm","audio/x-pn-realaudio"],["rmp",["audio/x-pn-realaudio-plugin","audio/x-pn-realaudio"]],["rms","application/vnd.jcp.javame.midlet-rms"],["rnc","application/relax-ng-compact-syntax"],["rng",["application/ringing-tones","application/vnd.nokia.ringing-tone"]],["rnx","application/vnd.rn-realplayer"],["roff","application/x-troff"],["rp","image/vnd.rn-realpix"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsd","application/rsd+xml"],["rt",["text/richtext","text/vnd.rn-realtext"]],["rtf",["application/rtf","text/richtext","application/x-rtf"]],["rtx",["text/richtext","application/rtf"]],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["saveme","application/octet-stream"],["sbk","application/x-tbook"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm",["application/vnd.lotus-screencam","video/x-scm","text/x-script.guile","application/x-lotusscreencam","text/x-script.scheme"]],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["sct","text/scriptlet"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkm","application/vnd.solent.sdkm+xml"],["sdml","text/plain"],["sdp",["application/sdp","application/x-sdp"]],["sdr","application/sounder"],["sdw","application/vnd.stardivision.writer"],["sea",["application/sea","application/x-sea"]],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["ser","application/java-serialized-object"],["set","application/set"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sgl","application/vnd.stardivision.writer-global"],["sgm",["text/sgml","text/x-sgml"]],["sgml",["text/sgml","text/x-sgml"]],["sh",["application/x-shar","application/x-bsh","application/x-sh","text/x-script.sh"]],["shar",["application/x-bsh","application/x-shar"]],["shf","application/shf+xml"],["shtml",["text/html","text/x-server-parsed-html"]],["sid","audio/x-psid"],["sis","application/vnd.symbian.install"],["sit",["application/x-stuffit","application/x-sit"]],["sitx","application/x-stuffitx"],["skd","application/x-koan"],["skm","application/x-koan"],["skp",["application/vnd.koan","application/x-koan"]],["skt","application/x-koan"],["sl","application/x-seelogo"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi",["application/smil","application/smil+xml"]],["smil","application/smil"],["snd",["audio/basic","audio/x-adpcm"]],["snf","application/x-font-snf"],["sol","application/solids"],["spc",["text/x-speech","application/x-pkcs7-certificates"]],["spf","application/vnd.yamaha.smaf-phrase"],["spl",["application/futuresplash","application/x-futuresplash"]],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spr","application/x-sprite"],["sprite","application/x-sprite"],["src","application/x-wais-source"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssi","text/x-server-parsed-html"],["ssm","application/streamingmedia"],["ssml","application/ssml+xml"],["sst",["application/vnd.ms-pkicertstore","application/vnd.ms-pki.certstore"]],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["step","application/step"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl",["application/vnd.ms-pkistl","application/sla","application/vnd.ms-pki.stl","application/x-navistyle"]],["stm","text/html"],["stp","application/step"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["sub","image/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svf",["image/vnd.dwg","image/x-dwg"]],["svg","image/svg+xml"],["svr",["x-world/x-svr","application/x-world"]],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t",["text/troff","application/x-troff"]],["talk","text/x-speech"],["tao","application/vnd.tao.intent-module-archive"],["tar","application/x-tar"],["tbk",["application/toolbook","application/x-tbook"]],["tcap","application/vnd.3gpp2.tcap"],["tcl",["text/x-script.tcl","application/x-tcl"]],["tcsh","text/x-script.tcsh"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text",["application/plain","text/plain"]],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tgz",["application/gnutar","application/x-compressed"]],["thmx","application/vnd.ms-officetheme"],["tif",["image/tiff","image/x-tiff"]],["tiff",["image/tiff","image/x-tiff"]],["tmo","application/vnd.tmobile-livetv"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","application/x-troff"],["tra","application/vnd.trueapp"],["trm","application/x-msterminal"],["tsd","application/timestamped-data"],["tsi","audio/tsp-audio"],["tsp",["application/dsptype","audio/tsplayer"]],["tsv","text/tab-separated-values"],["ttf","application/x-font-ttf"],["ttl","text/turtle"],["turbot","image/florian"],["twd","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["ufd","application/vnd.ufdl"],["uil","text/x-uil"],["uls","text/iuls"],["umj","application/vnd.umajin"],["uni","text/uri-list"],["unis","text/uri-list"],["unityweb","application/vnd.unity"],["unv","application/i-deas"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["ustar",["application/x-ustar","multipart/x-ustar"]],["utz","application/vnd.uiq.theme"],["uu",["application/octet-stream","text/x-uuencode"]],["uue","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vda","application/vda"],["vdo","video/vdo"],["vew","application/groupwise"],["vis","application/vnd.visionary"],["viv",["video/vivo","video/vnd.vivo"]],["vivo",["video/vivo","video/vnd.vivo"]],["vmd","application/vocaltec-media-desc"],["vmf","application/vocaltec-media-file"],["voc",["audio/voc","audio/x-voc"]],["vos","video/vosaic"],["vox","audio/voxware"],["vqe","audio/x-twinvq-plugin"],["vqf","audio/x-twinvq"],["vql","audio/x-twinvq-plugin"],["vrml",["model/vrml","x-world/x-vrml","application/x-vrml"]],["vrt","x-world/x-vrt"],["vsd",["application/vnd.visio","application/x-visio"]],["vsf","application/vnd.vsf"],["vst","application/x-visio"],["vsw","application/x-visio"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w60","application/wordperfect6.0"],["w61","application/wordperfect6.1"],["w6w","application/msword"],["wad","application/x-doom"],["wav",["audio/wav","audio/x-wav"]],["wax","audio/x-ms-wax"],["wb1","application/x-qpro"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/vnd.wap.wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["web","application/vnd.xara"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wiz","application/msword"],["wk1","application/x-123"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf",["windows/metafile","application/x-msmetafile"]],["wml","text/vnd.wap.wml"],["wmlc","application/vnd.wap.wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-ms-wmz"],["woff","application/x-font-woff"],["word","application/msword"],["wp","application/wordperfect"],["wp5",["application/wordperfect","application/wordperfect6.0"]],["wp6","application/wordperfect"],["wpd",["application/wordperfect","application/vnd.wordperfect","application/x-wpwin"]],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wq1","application/x-lotus"],["wqd","application/vnd.wqd"],["wri",["application/mswrite","application/x-wri","application/x-mswrite"]],["wrl",["model/vrml","x-world/x-vrml","application/x-world"]],["wrz",["model/vrml","x-world/x-vrml"]],["wsc","text/scriplet"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wsrc","application/x-wais-source"],["wtb","application/vnd.webturbo"],["wtk","application/x-wintalk"],["wvx","video/x-ms-wvx"],["x-png","image/png"],["x3d","application/vnd.hzn-3d-crossword"],["xaf","x-world/x-vrml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm",["image/xbm","image/x-xbm","image/x-xbitmap"]],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdr","video/x-amt-demorun"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xgz","xgl/drawing"],["xhtml","application/xhtml+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlam","application/vnd.ms-excel.addin.macroenabled.12"],["xlb",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlc",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xld",["application/excel","application/x-excel"]],["xlk",["application/excel","application/x-excel"]],["xll",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlm",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xls",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroenabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xltm","application/vnd.ms-excel.template.macroenabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlv",["application/excel","application/x-excel"]],["xlw",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xm","audio/xm"],["xml",["application/xml","text/xml","application/atom+xml","application/rss+xml"]],["xmz","xgl/movie"],["xo","application/vnd.olpc-sugar"],["xof","x-world/x-vrml"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpix","application/x-vnd.ls-xpix"],["xpm",["image/xpm","image/x-xpixmap"]],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xsr","video/x-amt-showrun"],["xul","application/vnd.mozilla.xul+xml"],["xwd",["image/x-xwd","image/x-xwindowdump"]],["xyz",["chemical/x-xyz","chemical/x-pdb"]],["yang","application/yang"],["yin","application/yin+xml"],["z",["application/x-compressed","application/x-compress"]],["zaz","application/vnd.zzazz.deck+xml"],["zip",["application/zip","multipart/x-zip","application/x-zip-compressed","application/x-compressed"]],["zir","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zoo","application/octet-stream"],["zsh","text/x-script.zsh"]]);var Zl={detectMimeType(t){if(!t)return Xs;let e=mx.parse(t),n=(e.ext.substr(1)||e.name||"").split("?").shift().trim().toLowerCase(),r=Xs;return Js.has(n)&&(r=Js.get(n)),Array.isArray(r)?r[0]:r},detectExtension(t){if(!t)return hx;let e=(t||"").toLowerCase().trim().split("/"),n=e.shift().trim(),r=e.join("/").trim();if(Qs.has(n+"/"+r)){let o=Qs.get(n+"/"+r);return Array.isArray(o)?o[0]:o}switch(n){case"text":return"txt";default:return"bin"}}};const en=2147483647,Qe=36,qi=1,Cn=26,gx=38,vx=700,ed=72,td=128,nd="-",xx=/^xn--/,yx=/[^\0-\x7F]/,wx=/[\x2E\u3002\uFF0E\uFF61]/g,bx={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},po=Qe-qi,Je=Math.floor,uo=String.fromCharCode;function ft(t){throw new RangeError(bx[t])}function Sx(t,e){const n=[];let r=t.length;for(;r--;)n[r]=e(t[r]);return n}function rd(t,e){const n=t.split("@");let r="";n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(wx,".");const o=t.split("."),i=Sx(o,e).join(".");return r+i}function od(t){const e=[];let n=0;const r=t.length;for(;n<r;){const o=t.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){const i=t.charCodeAt(n++);(i&64512)==56320?e.push(((o&1023)<<10)+(i&1023)+65536):(e.push(o),n--)}else e.push(o)}return e}const _x=t=>String.fromCodePoint(...t),Ex=function(t){return t>=48&&t<58?26+(t-48):t>=65&&t<91?t-65:t>=97&&t<123?t-97:Qe},Zs=function(t,e){return t+22+75*(t<26)-((e!=0)<<5)},id=function(t,e,n){let r=0;for(t=n?Je(t/vx):t>>1,t+=Je(t/e);t>po*Cn>>1;r+=Qe)t=Je(t/po);return Je(r+(po+1)*t/(t+gx))},sd=function(t){const e=[],n=t.length;let r=0,o=td,i=ed,s=t.lastIndexOf(nd);s<0&&(s=0);for(let a=0;a<s;++a)t.charCodeAt(a)>=128&&ft("not-basic"),e.push(t.charCodeAt(a));for(let a=s>0?s+1:0;a<n;){const c=r;for(let f=1,m=Qe;;m+=Qe){a>=n&&ft("invalid-input");const u=Ex(t.charCodeAt(a++));u>=Qe&&ft("invalid-input"),u>Je((en-r)/f)&&ft("overflow"),r+=u*f;const h=m<=i?qi:m>=i+Cn?Cn:m-i;if(u<h)break;const x=Qe-h;f>Je(en/x)&&ft("overflow"),f*=x}const p=e.length+1;i=id(r-c,p,c==0),Je(r/p)>en-o&&ft("overflow"),o+=Je(r/p),r%=p,e.splice(r++,0,o)}return String.fromCodePoint(...e)},ad=function(t){const e=[];t=od(t);const n=t.length;let r=td,o=0,i=ed;for(const c of t)c<128&&e.push(uo(c));const s=e.length;let a=s;for(s&&e.push(nd);a<n;){let c=en;for(const f of t)f>=r&&f<c&&(c=f);const p=a+1;c-r>Je((en-o)/p)&&ft("overflow"),o+=(c-r)*p,r=c;for(const f of t)if(f<r&&++o>en&&ft("overflow"),f===r){let m=o;for(let u=Qe;;u+=Qe){const h=u<=i?qi:u>=i+Cn?Cn:u-i;if(m<h)break;const x=m-h,g=Qe-h;e.push(uo(Zs(h+x%g,0))),m=Je(x/g)}e.push(uo(Zs(m,0))),i=id(o,p,a===s),o=0,++a}++o,++r}return e.join("")},Cx=function(t){return rd(t,function(e){return xx.test(e)?sd(e.slice(4).toLowerCase()):e})},Tx=function(t){return rd(t,function(e){return yx.test(e)?"xn--"+ad(e):e})},kx={version:"2.3.1",ucs2:{decode:od,encode:_x},decode:sd,encode:ad,toASCII:Tx,toUnicode:Cx};var cd=kx;const Ax=V.Transform;function Wo(t){return typeof t=="string"&&(t=Buffer.from(t,"utf-8")),t.toString("base64")}function ld(t,e){if(t=(t||"").toString(),e=e||76,t.length<=e)return t;let n=[],r=0,o=e*1024;for(;r<t.length;){let i=t.substr(r,o).replace(new RegExp(".{"+e+"}","g"),`$&\r
`);n.push(i),r+=o}return n.join("")}let Nx=class extends Ax{constructor(e){super(),this.options=e||{},this.options.lineLength!==!1&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this._remainingBytes=!1,this.inputBytes=0,this.outputBytes=0}_transform(e,n,r){if(n!=="buffer"&&(e=Buffer.from(e,n)),!e||!e.length)return setImmediate(r);this.inputBytes+=e.length,this._remainingBytes&&this._remainingBytes.length&&(e=Buffer.concat([this._remainingBytes,e],this._remainingBytes.length+e.length),this._remainingBytes=!1),e.length%3?(this._remainingBytes=e.slice(e.length-e.length%3),e=e.slice(0,e.length-e.length%3)):this._remainingBytes=!1;let o=this._curLine+Wo(e);if(this.options.lineLength){o=ld(o,this.options.lineLength);let i=o.lastIndexOf(`
`);i<0?(this._curLine=o,o=""):(this._curLine=o.substring(i+1),o=o.substring(0,i+1),o&&!o.endsWith(`\r
`)&&(o+=`\r
`))}else this._curLine="";o&&(this.outputBytes+=o.length,this.push(Buffer.from(o,"ascii"))),setImmediate(r)}_flush(e){this._remainingBytes&&this._remainingBytes.length&&(this._curLine+=Wo(this._remainingBytes)),this._curLine&&(this.outputBytes+=this._curLine.length,this.push(Buffer.from(this._curLine,"ascii")),this._curLine=""),e()}};var dd={encode:Wo,wrap:ld,Encoder:Nx};const jx=V.Transform;function Ko(t){typeof t=="string"&&(t=Buffer.from(t,"utf-8"));let e=[[9],[10],[13],[32,60],[62,126]],n="",r;for(let o=0,i=t.length;o<i;o++){if(r=t[o],Rx(r,e)&&!((r===32||r===9)&&(o===i-1||t[o+1]===10||t[o+1]===13))){n+=String.fromCharCode(r);continue}n+="="+(r<16?"0":"")+r.toString(16).toUpperCase()}return n}function pd(t,e){if(t=(t||"").toString(),e=e||76,t.length<=e)return t;let n=0,r=t.length,o,i,s,a=Math.floor(e/3),c="";for(;n<r;){if(s=t.substr(n,e),o=s.match(/\r\n/)){s=s.substr(0,o.index+o[0].length),c+=s,n+=s.length;continue}if(s.substr(-1)===`
`){c+=s,n+=s.length;continue}else if(o=s.substr(-a).match(/\n.*?$/)){s=s.substr(0,s.length-(o[0].length-1)),c+=s,n+=s.length;continue}else if(s.length>e-a&&(o=s.substr(-a).match(/[ \t.,!?][^ \t.,!?]*$/)))s=s.substr(0,s.length-(o[0].length-1));else if(s.match(/[=][\da-f]{0,2}$/i))for((o=s.match(/[=][\da-f]{0,1}$/i))&&(s=s.substr(0,s.length-o[0].length));s.length>3&&s.length<r-n&&!s.match(/^(?:=[\da-f]{2}){1,4}$/i)&&(o=s.match(/[=][\da-f]{2}$/gi))&&(i=parseInt(o[0].substr(1,2),16),!(i<128||(s=s.substr(0,s.length-3),i>=192))););n+s.length<r&&s.substr(-1)!==`
`?(s.length===e&&s.match(/[=][\da-f]{2}$/i)?s=s.substr(0,s.length-3):s.length===e&&(s=s.substr(0,s.length-1)),n+=s.length,s+=`=\r
`):n+=s.length,c+=s}return c}function Rx(t,e){for(let n=e.length-1;n>=0;n--)if(e[n].length&&(e[n].length===1&&t===e[n][0]||e[n].length===2&&t>=e[n][0]&&t<=e[n][1]))return!0;return!1}class Mx extends jx{constructor(e){super(),this.options=e||{},this.options.lineLength!==!1&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this.inputBytes=0,this.outputBytes=0}_transform(e,n,r){let o;if(n!=="buffer"&&(e=Buffer.from(e,n)),!e||!e.length)return r();this.inputBytes+=e.length,this.options.lineLength?(o=this._curLine+Ko(e),o=pd(o,this.options.lineLength),o=o.replace(/(^|\n)([^\n]*)$/,(i,s,a)=>(this._curLine=a,s)),o&&(this.outputBytes+=o.length,this.push(o))):(o=Ko(e),this.outputBytes+=o.length,this.push(o,"ascii")),r()}_flush(e){this._curLine&&(this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii")),e()}}var ud={encode:Ko,wrap:pd,Encoder:Mx};const un=dd,Px=ud,ea=Zl;var Dr={isPlainText(t,e){return!(typeof t!="string"||(e?/[\x00-\x08\x0b\x0c\x0e-\x1f"\u0080-\uFFFF]/:/[\x00-\x08\x0b\x0c\x0e-\x1f\u0080-\uFFFF]/).test(t))},hasLongerLines(t,e){return t.length>128*1024?!0:new RegExp("^.{"+(e+1)+",}","m").test(t)},encodeWord(t,e,n){e=(e||"Q").toString().toUpperCase().trim().charAt(0),n=n||0;let r,o="UTF-8";if(n&&n>7+o.length&&(n-=7+o.length),e==="Q"?r=Px.encode(t).replace(/[^a-z0-9!*+\-/=]/gi,i=>{let s=i.charCodeAt(0).toString(16).toUpperCase();return i===" "?"_":"="+(s.length===1?"0"+s:s)}):e==="B"&&(r=typeof t=="string"?t:un.encode(t),n=n?Math.max(3,(n-n%4)/4*3):0),n&&(e!=="B"?r:un.encode(t)).length>n)if(e==="Q")r=this.splitMimeEncodedString(r,n).join("?= =?"+o+"?"+e+"?");else{let i=[],s="";for(let a=0,c=r.length;a<c;a++){let p=r.charAt(a);/[\ud83c\ud83d\ud83e]/.test(p)&&a<c-1&&(p+=r.charAt(++a)),Buffer.byteLength(s+p)<=n||a===0?s+=p:(i.push(un.encode(s)),s=p)}s&&i.push(un.encode(s)),i.length>1?r=i.join("?= =?"+o+"?"+e+"?"):r=i.join("")}else e==="B"&&(r=un.encode(t));return"=?"+o+"?"+e+"?"+r+(r.substr(-2)==="?="?"":"?=")},encodeWords(t,e,n,r){n=n||0;let o,i=t.match(/(?:^|\s)([^\s]*["\u0080-\uFFFF])/);if(!i)return t;if(r)return this.encodeWord(t,e,n);let s=t.match(/(["\u0080-\uFFFF][^\s]*)[^"\u0080-\uFFFF]*$/);if(!s)return t;let a=i.index+(i[0].match(/[^\s]/)||{index:0}).index,c=s.index+(s[1]||"").length;return o=(a?t.substr(0,a):"")+this.encodeWord(t.substring(a,c),e||"Q",n)+(c<t.length?t.substr(c):""),o},buildHeaderValue(t){let e=[];return Object.keys(t.params||{}).forEach(n=>{let r=t.params[n];!this.isPlainText(r,!0)||r.length>=75?this.buildHeaderParam(n,r,50).forEach(o=>{!/[\s"\\;:/=(),<>@[\]?]|^[-']|'$/.test(o.value)||o.key.substr(-1)==="*"?e.push(o.key+"="+o.value):e.push(o.key+"="+JSON.stringify(o.value))}):/[\s'"\\;:/=(),<>@[\]?]|^-/.test(r)?e.push(n+"="+JSON.stringify(r)):e.push(n+"="+r)}),t.value+(e.length?"; "+e.join("; "):"")},buildHeaderParam(t,e,n){let r=[],o=typeof e=="string"?e:(e||"").toString(),i,s,a,c,p=0,f,m;if(n=n||50,this.isPlainText(e,!0)){if(o.length<=n)return[{key:t,value:o}];o=o.replace(new RegExp(".{"+n+"}","g"),u=>(r.push({line:u}),"")),o&&r.push({line:o})}else{if(/[\uD800-\uDBFF]/.test(o)){for(i=[],f=0,m=o.length;f<m;f++)s=o.charAt(f),a=s.charCodeAt(0),a>=55296&&a<=56319&&f<m-1?(s+=o.charAt(f+1),i.push(s),f++):i.push(s);o=i}c="utf-8''";let u=!0;for(p=0,f=0,m=o.length;f<m;f++){if(s=o[f],u)s=this.safeEncodeURIComponent(s);else if(s=s===" "?s:this.safeEncodeURIComponent(s),s!==o[f])if((this.safeEncodeURIComponent(c)+s).length>=n)r.push({line:c,encoded:u}),c="",p=f-1;else{u=!0,f=p,c="";continue}(c+s).length>=n?(r.push({line:c,encoded:u}),c=s=o[f]===" "?" ":this.safeEncodeURIComponent(o[f]),s===o[f]?(u=!1,p=f-1):u=!0):c+=s}c&&r.push({line:c,encoded:u})}return r.map((u,h)=>({key:t+"*"+h+(u.encoded?"*":""),value:u.line}))},parseHeaderValue(t){let e={value:!1,params:{}},n=!1,r="",o="value",i=!1,s=!1,a;for(let c=0,p=t.length;c<p;c++)if(a=t.charAt(c),o==="key"){if(a==="="){n=r.trim().toLowerCase(),o="value",r="";continue}r+=a}else{if(s)r+=a;else if(a==="\\"){s=!0;continue}else i&&a===i?i=!1:!i&&a==='"'?i=a:!i&&a===";"?(n===!1?e.value=r.trim():e.params[n]=r.trim(),o="key",r=""):r+=a;s=!1}return o==="value"?n===!1?e.value=r.trim():e.params[n]=r.trim():r.trim()&&(e.params[r.trim().toLowerCase()]=""),Object.keys(e.params).forEach(c=>{let p,f,m,u;(m=c.match(/(\*(\d+)|\*(\d+)\*|\*)$/))&&(p=c.substr(0,m.index),f=Number(m[2]||m[3])||0,(!e.params[p]||typeof e.params[p]!="object")&&(e.params[p]={charset:!1,values:[]}),u=e.params[c],f===0&&m[0].substr(-1)==="*"&&(m=u.match(/^([^']*)'[^']*'(.*)$/))&&(e.params[p].charset=m[1]||"iso-8859-1",u=m[2]),e.params[p].values[f]=u,delete e.params[c])}),Object.keys(e.params).forEach(c=>{let p;e.params[c]&&Array.isArray(e.params[c].values)&&(p=e.params[c].values.map(f=>f||"").join(""),e.params[c].charset?e.params[c]="=?"+e.params[c].charset+"?Q?"+p.replace(/[=?_\s]/g,f=>{let m=f.charCodeAt(0).toString(16);return f===" "?"_":"%"+(m.length<2?"0":"")+m}).replace(/%/g,"=")+"?=":e.params[c]=p)}),e},detectExtension:t=>ea.detectExtension(t),detectMimeType:t=>ea.detectMimeType(t),foldLines(t,e,n){t=(t||"").toString(),e=e||76;let r=0,o=t.length,i="",s,a;for(;r<o;){if(s=t.substr(r,e),s.length<e){i+=s;break}if(a=s.match(/^[^\n\r]*(\r?\n|\r)/)){s=a[0],i+=s,r+=s.length;continue}else(a=s.match(/(\s+)[^\s]*$/))&&a[0].length-(n?(a[1]||"").length:0)<s.length?s=s.substr(0,s.length-(a[0].length-(n?(a[1]||"").length:0))):(a=t.substr(r+s.length).match(/^[^\s]+(\s*)/))&&(s=s+a[0].substr(0,a[0].length-(n?0:(a[1]||"").length)));i+=s,r+=s.length,r<o&&(i+=`\r
`)}return i},splitMimeEncodedString:(t,e)=>{let n,r,o,i,s=[];for(e=Math.max(e||0,12);t.length;){for(n=t.substr(0,e),(r=n.match(/[=][0-9A-F]?$/i))&&(n=n.substr(0,r.index)),i=!1;!i;)i=!0,(r=t.substr(n.length).match(/^[=]([0-9A-F]{2})/i))&&(o=parseInt(r[1],16),o<194&&o>127&&(n=n.substr(0,n.length-3),i=!1));n.length&&s.push(n),t=t.substr(n.length)}return s},encodeURICharComponent:t=>{let e="",n=t.charCodeAt(0).toString(16).toUpperCase();if(n.length%2&&(n="0"+n),n.length>2)for(let r=0,o=n.length/2;r<o;r++)e+="%"+n.substr(r,2);else e+="%"+n;return e},safeEncodeURIComponent(t){t=(t||"").toString();try{t=encodeURIComponent(t)}catch{return t.replace(/[^\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]+/g,"")}return t.replace(/[\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]/g,e=>this.encodeURICharComponent(e))}};function Ix(t){let e=!1,n="text",r,o=[],i={address:[],comment:[],group:[],text:[]},s,a;for(s=0,a=t.length;s<a;s++){let c=t[s],p=s?t[s-1]:null;if(c.type==="operator")switch(c.value){case"<":n="address";break;case"(":n="comment";break;case":":n="group",e=!0;break;default:n="text";break}else c.value&&(n==="address"&&(c.value=c.value.replace(/^[^<]*<\s*/,"")),p&&p.noBreak&&i[n].length?i[n][i[n].length-1]+=c.value:i[n].push(c.value))}if(!i.text.length&&i.comment.length&&(i.text=i.comment,i.comment=[]),e)i.text=i.text.join(" "),o.push({name:i.text||r&&r.name,group:i.group.length?fd(i.group.join(",")):[]});else{if(!i.address.length&&i.text.length){for(s=i.text.length-1;s>=0;s--)if(i.text[s].match(/^[^@\s]+@[^@\s]+$/)){i.address=i.text.splice(s,1);break}let c=function(p){return i.address.length?p:(i.address=[p.trim()]," ")};if(!i.address.length)for(s=i.text.length-1;s>=0&&(i.text[s]=i.text[s].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,c).trim(),!i.address.length);s--);}if(!i.text.length&&i.comment.length&&(i.text=i.comment,i.comment=[]),i.address.length>1&&(i.text=i.text.concat(i.address.splice(1))),i.text=i.text.join(" "),i.address=i.address.join(" "),!i.address&&e)return[];r={address:i.address||i.text||"",name:i.text||i.address||""},r.address===r.name&&((r.address||"").match(/@/)?r.name="":r.address=""),o.push(r)}return o}class Ox{constructor(e){this.str=(e||"").toString(),this.operatorCurrent="",this.operatorExpecting="",this.node=null,this.escaped=!1,this.list=[],this.operators={'"':'"',"(":")","<":">",",":"",":":";",";":""}}tokenize(){let e=[];for(let n=0,r=this.str.length;n<r;n++){let o=this.str.charAt(n),i=n<r-1?this.str.charAt(n+1):null;this.checkChar(o,i)}return this.list.forEach(n=>{n.value=(n.value||"").toString().trim(),n.value&&e.push(n)}),e}checkChar(e,n){if(!this.escaped){if(e===this.operatorExpecting){this.node={type:"operator",value:e},n&&![" ","	","\r",`
`,",",";"].includes(n)&&(this.node.noBreak=!0),this.list.push(this.node),this.node=null,this.operatorExpecting="",this.escaped=!1;return}else if(!this.operatorExpecting&&e in this.operators){this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting=this.operators[e],this.escaped=!1;return}else if(['"',"'"].includes(this.operatorExpecting)&&e==="\\"){this.escaped=!0;return}}this.node||(this.node={type:"text",value:""},this.list.push(this.node)),e===`
`&&(e=" "),(e.charCodeAt(0)>=33||[" ","	"].includes(e))&&(this.node.value+=e),this.escaped=!1}}function fd(t,e){e=e||{};let r=new Ox(t).tokenize(),o=[],i=[],s=[];if(r.forEach(a=>{a.type==="operator"&&(a.value===","||a.value===";")?(i.length&&o.push(i),i=[]):i.push(a)}),i.length&&o.push(i),o.forEach(a=>{a=Ix(a),a.length&&(s=s.concat(a))}),e.flatten){let a=[],c=p=>{p.forEach(f=>{if(f.group)return c(f.group);a.push(f)})};return c(s),a}return s}var Lx=fd;const Dx=V.Transform;let zx=class extends Dx{constructor(){super(),this.lastByte=!1}_transform(e,n,r){e.length&&(this.lastByte=e[e.length-1]),this.push(e),r()}_flush(e){return this.lastByte===10?e():this.lastByte===13?(this.push(Buffer.from(`
`)),e()):(this.push(Buffer.from(`\r
`)),e())}};var Fx=zx;const $x=V,Ux=$x.Transform;let Hx=class extends Ux{constructor(e){super(e),this.options=e||{},this.lastByte=!1}_transform(e,n,r){let o,i=0;for(let s=0,a=e.length;s<a;s++)e[s]===10&&(s&&e[s-1]!==13||!s&&this.lastByte!==13)&&(s>i&&(o=e.slice(i,s),this.push(o)),this.push(Buffer.from(`\r
`)),i=s+1);i&&i<e.length?(o=e.slice(i),this.push(o)):i||this.push(e),this.lastByte=e[e.length-1],r()}};var md=Hx;const Bx=V,Vx=Bx.Transform;let qx=class extends Vx{constructor(e){super(e),this.options=e||{}}_transform(e,n,r){let o,i=0;for(let s=0,a=e.length;s<a;s++)e[s]===13&&(o=e.slice(i,s),i=s+1,this.push(o));i&&i<e.length?(o=e.slice(i),this.push(o)):i||this.push(e),r()}};var Gx=qx;const fo=V,Wx=V,Kx=cd,fn=V.PassThrough,Yx=Ae,ze=Dr,Xx=ud,Qx=dd,Jx=Lx,Zx=Lr,ey=Fx,ty=md,ny=Gx;let ry=class hd{constructor(e,n){this.nodeCounter=0,n=n||{},this.baseBoundary=n.baseBoundary||fo.randomBytes(8).toString("hex"),this.boundaryPrefix=n.boundaryPrefix||"--_NmP",this.disableFileAccess=!!n.disableFileAccess,this.disableUrlAccess=!!n.disableUrlAccess,this.normalizeHeaderKey=n.normalizeHeaderKey,this.date=new Date,this.rootNode=n.rootNode||this,this.keepBcc=!!n.keepBcc,n.filename&&(this.filename=n.filename,e||(e=ze.detectMimeType(this.filename.split(".").pop()))),this.textEncoding=(n.textEncoding||"").toString().trim().charAt(0).toUpperCase(),this.parentNode=n.parentNode,this.hostname=n.hostname,this.newline=n.newline,this.childNodes=[],this._nodeId=++this.rootNode.nodeCounter,this._headers=[],this._isPlainText=!1,this._hasLongLines=!1,this._envelope=!1,this._raw=!1,this._transforms=[],this._processFuncs=[],e&&this.setHeader("Content-Type",e)}createChild(e,n){!n&&typeof e=="object"&&(n=e,e=void 0);let r=new hd(e,n);return this.appendChild(r),r}appendChild(e){return e.rootNode!==this.rootNode&&(e.rootNode=this.rootNode,e._nodeId=++this.rootNode.nodeCounter),e.parentNode=this,this.childNodes.push(e),e}replace(e){return e===this?this:(this.parentNode.childNodes.forEach((n,r)=>{n===this&&(e.rootNode=this.rootNode,e.parentNode=this.parentNode,e._nodeId=this._nodeId,this.rootNode=this,this.parentNode=void 0,e.parentNode.childNodes[r]=e)}),e)}remove(){if(!this.parentNode)return this;for(let e=this.parentNode.childNodes.length-1;e>=0;e--)if(this.parentNode.childNodes[e]===this)return this.parentNode.childNodes.splice(e,1),this.parentNode=void 0,this.rootNode=this,this}setHeader(e,n){let r=!1,o;if(!n&&e&&typeof e=="object")return e.key&&"value"in e?this.setHeader(e.key,e.value):Array.isArray(e)?e.forEach(i=>{this.setHeader(i.key,i.value)}):Object.keys(e).forEach(i=>{this.setHeader(i,e[i])}),this;e=this._normalizeHeaderKey(e),o={key:e,value:n};for(let i=0,s=this._headers.length;i<s;i++)this._headers[i].key===e&&(r?(this._headers.splice(i,1),i--,s--):(this._headers[i]=o,r=!0));return r||this._headers.push(o),this}addHeader(e,n){return!n&&e&&typeof e=="object"?(e.key&&e.value?this.addHeader(e.key,e.value):Array.isArray(e)?e.forEach(r=>{this.addHeader(r.key,r.value)}):Object.keys(e).forEach(r=>{this.addHeader(r,e[r])}),this):Array.isArray(n)?(n.forEach(r=>{this.addHeader(e,r)}),this):(this._headers.push({key:this._normalizeHeaderKey(e),value:n}),this)}getHeader(e){e=this._normalizeHeaderKey(e);for(let n=0,r=this._headers.length;n<r;n++)if(this._headers[n].key===e)return this._headers[n].value}setContent(e){return this.content=e,typeof this.content.pipe=="function"?(this._contentErrorHandler=n=>{this.content.removeListener("error",this._contentErrorHandler),this.content=n},this.content.once("error",this._contentErrorHandler)):typeof this.content=="string"&&(this._isPlainText=ze.isPlainText(this.content),this._isPlainText&&ze.hasLongerLines(this.content,76)&&(this._hasLongLines=!0)),this}build(e){let n;e||(n=new Promise((a,c)=>{e=Yx.callbackPromise(a,c)}));let r=this.createReadStream(),o=[],i=0,s=!1;return r.on("readable",()=>{let a;for(;(a=r.read())!==null;)o.push(a),i+=a.length}),r.once("error",a=>{if(!s)return s=!0,e(a)}),r.once("end",a=>{if(!s)return s=!0,a&&a.length&&(o.push(a),i+=a.length),e(null,Buffer.concat(o,i))}),n}getTransferEncoding(){let e=!1,n=(this.getHeader("Content-Type")||"").toString().toLowerCase().trim();return this.content&&(e=(this.getHeader("Content-Transfer-Encoding")||"").toString().toLowerCase().trim(),(!e||!["base64","quoted-printable"].includes(e))&&(/^text\//i.test(n)?this._isPlainText&&!this._hasLongLines?e="7bit":typeof this.content=="string"||this.content instanceof Buffer?e=this._getTextEncoding(this.content)==="Q"?"quoted-printable":"base64":e=this.textEncoding==="B"?"base64":"quoted-printable":/^(multipart|message)\//i.test(n)||(e=e||"base64"))),e}buildHeaders(){let e=this.getTransferEncoding(),n=[];if(e&&this.setHeader("Content-Transfer-Encoding",e),this.filename&&!this.getHeader("Content-Disposition")&&this.setHeader("Content-Disposition","attachment"),this.rootNode===this){this.getHeader("Date")||this.setHeader("Date",this.date.toUTCString().replace(/GMT/,"+0000")),this.messageId(),this.getHeader("MIME-Version")||this.setHeader("MIME-Version","1.0");for(let r=this._headers.length-2;r>=0;r--){let o=this._headers[r];o.key==="Content-Type"&&(this._headers.splice(r,1),this._headers.push(o))}}return this._headers.forEach(r=>{let o=r.key,i=r.value,s,a,c={};if(!(i&&typeof i=="object"&&!["From","Sender","To","Cc","Bcc","Reply-To","Date","References"].includes(o)&&(Object.keys(i).forEach(f=>{f!=="value"&&(c[f]=i[f])}),i=(i.value||"").toString(),!i.trim()))){if(c.prepared){c.foldLines?n.push(ze.foldLines(o+": "+i)):n.push(o+": "+i);return}switch(r.key){case"Content-Disposition":s=ze.parseHeaderValue(i),this.filename&&(s.params.filename=this.filename),i=ze.buildHeaderValue(s);break;case"Content-Type":s=ze.parseHeaderValue(i),this._handleContentType(s),s.value.match(/^text\/plain\b/)&&typeof this.content=="string"&&/[\u0080-\uFFFF]/.test(this.content)&&(s.params.charset="utf-8"),i=ze.buildHeaderValue(s),this.filename&&(a=this._encodeWords(this.filename),(a!==this.filename||/[\s'"\\;:/=(),<>@[\]?]|^-/.test(a))&&(a='"'+a+'"'),i+="; name="+a);break;case"Bcc":if(!this.keepBcc)return;break}if(i=this._encodeHeaderValue(o,i),!!(i||"").toString().trim()){if(typeof this.normalizeHeaderKey=="function"){let f=this.normalizeHeaderKey(o,i);f&&typeof f=="string"&&f.length&&(o=f)}n.push(ze.foldLines(o+": "+i,76))}}}),n.join(`\r
`)}createReadStream(e){e=e||{};let n=new fn(e),r=n,o;this.stream(n,e,i=>{if(i){r.emit("error",i);return}n.end()});for(let i=0,s=this._transforms.length;i<s;i++)o=typeof this._transforms[i]=="function"?this._transforms[i]():this._transforms[i],r.once("error",a=>{o.emit("error",a)}),r=r.pipe(o);o=new ey,r.once("error",i=>{o.emit("error",i)}),r=r.pipe(o);for(let i=0,s=this._processFuncs.length;i<s;i++)o=this._processFuncs[i],r=o(r);if(this.newline){const s=["win","windows","dos",`\r
`].includes(this.newline.toString().toLowerCase())?new ty:new ny,a=r.pipe(s);return r.on("error",c=>a.emit("error",c)),a}return r}transform(e){this._transforms.push(e)}processFunc(e){this._processFuncs.push(e)}stream(e,n,r){let o=this.getTransferEncoding(),i,s,a=!1,c=m=>{a||(a=!0,r(m))},p=()=>{let m=0,u=()=>{if(m>=this.childNodes.length)return e.write(`\r
--`+this.boundary+`--\r
`),c();let h=this.childNodes[m++];e.write((m>1?`\r
`:"")+"--"+this.boundary+`\r
`),h.stream(e,n,x=>{if(x)return c(x);setImmediate(u)})};if(this.multipart)setImmediate(u);else return c()},f=()=>{if(this.content){if(Object.prototype.toString.call(this.content)==="[object Error]")return c(this.content);typeof this.content.pipe=="function"&&(this.content.removeListener("error",this._contentErrorHandler),this._contentErrorHandler=u=>c(u),this.content.once("error",this._contentErrorHandler));let m=()=>{["quoted-printable","base64"].includes(o)?(i=new(o==="base64"?Qx:Xx).Encoder(n),i.pipe(e,{end:!1}),i.once("end",p),i.once("error",u=>c(u)),s=this._getStream(this.content),s.pipe(i)):(s=this._getStream(this.content),s.pipe(e,{end:!1}),s.once("end",p)),s.once("error",u=>c(u))};if(this.content._resolve){let u=[],h=0,x=!1,g=this._getStream(this.content);g.on("error",v=>{x||(x=!0,c(v))}),g.on("readable",()=>{let v;for(;(v=g.read())!==null;)u.push(v),h+=v.length}),g.on("end",()=>{x||(x=!0,this.content._resolve=!1,this.content._resolvedValue=Buffer.concat(u,h),setImmediate(m))})}else setImmediate(m);return}else return setImmediate(p)};this._raw?setImmediate(()=>{if(Object.prototype.toString.call(this._raw)==="[object Error]")return c(this._raw);typeof this._raw.pipe=="function"&&this._raw.removeListener("error",this._contentErrorHandler);let m=this._getStream(this._raw);m.pipe(e,{end:!1}),m.on("error",u=>e.emit("error",u)),m.on("end",p)}):(e.write(this.buildHeaders()+`\r
\r
`),setImmediate(f))}setEnvelope(e){let n;this._envelope={from:!1,to:[]},e.from&&(n=[],this._convertAddresses(this._parseAddresses(e.from),n),n=n.filter(o=>o&&o.address),n.length&&n[0]&&(this._envelope.from=n[0].address)),["to","cc","bcc"].forEach(o=>{e[o]&&this._convertAddresses(this._parseAddresses(e[o]),this._envelope.to)}),this._envelope.to=this._envelope.to.map(o=>o.address).filter(o=>o);let r=["to","cc","bcc","from"];return Object.keys(e).forEach(o=>{r.includes(o)||(this._envelope[o]=e[o])}),this}getAddresses(){let e={};return this._headers.forEach(n=>{let r=n.key.toLowerCase();["from","sender","reply-to","to","cc","bcc"].includes(r)&&(Array.isArray(e[r])||(e[r]=[]),this._convertAddresses(this._parseAddresses(n.value),e[r]))}),e}getEnvelope(){if(this._envelope)return this._envelope;let e={from:!1,to:[]};return this._headers.forEach(n=>{let r=[];n.key==="From"||!e.from&&["Reply-To","Sender"].includes(n.key)?(this._convertAddresses(this._parseAddresses(n.value),r),r.length&&r[0]&&(e.from=r[0].address)):["To","Cc","Bcc"].includes(n.key)&&this._convertAddresses(this._parseAddresses(n.value),e.to)}),e.to=e.to.map(n=>n.address),e}messageId(){let e=this.getHeader("Message-ID");return e||(e=this._generateMessageId(),this.setHeader("Message-ID",e)),e}setRaw(e){return this._raw=e,this._raw&&typeof this._raw.pipe=="function"&&(this._contentErrorHandler=n=>{this._raw.removeListener("error",this._contentErrorHandler),this._raw=n},this._raw.once("error",this._contentErrorHandler)),this}_getStream(e){let n;return e._resolvedValue?(n=new fn,setImmediate(()=>{try{n.end(e._resolvedValue)}catch(r){n.emit("error",r)}}),n):typeof e.pipe=="function"?e:e&&typeof e.path=="string"&&!e.href?this.disableFileAccess?(n=new fn,setImmediate(()=>n.emit("error",new Error("File access rejected for "+e.path))),n):Wx.createReadStream(e.path):e&&typeof e.href=="string"?this.disableUrlAccess?(n=new fn,setImmediate(()=>n.emit("error",new Error("Url access rejected for "+e.href))),n):Zx(e.href,{headers:e.httpHeaders}):(n=new fn,setImmediate(()=>{try{n.end(e||"")}catch(r){n.emit("error",r)}}),n)}_parseAddresses(e){return[].concat.apply([],[].concat(e).map(n=>n&&n.address?(n.address=this._normalizeAddress(n.address),n.name=n.name||"",[n]):Jx(n)))}_normalizeHeaderKey(e){return e=(e||"").toString().replace(/\r?\n|\r/g," ").trim().toLowerCase().replace(/^X-SMTPAPI$|^(MIME|DKIM|ARC|BIMI)\b|^[a-z]|-(SPF|FBL|ID|MD5)$|-[a-z]/gi,n=>n.toUpperCase()).replace(/^Content-Features$/i,"Content-features"),e}_handleContentType(e){this.contentType=e.value.trim().toLowerCase(),this.multipart=/^multipart\//i.test(this.contentType)?this.contentType.substr(this.contentType.indexOf("/")+1):!1,this.multipart?this.boundary=e.params.boundary=e.params.boundary||this.boundary||this._generateBoundary():this.boundary=!1}_generateBoundary(){return this.rootNode.boundaryPrefix+"-"+this.rootNode.baseBoundary+"-Part_"+this._nodeId}_encodeHeaderValue(e,n){switch(e=this._normalizeHeaderKey(e),e){case"From":case"Sender":case"To":case"Cc":case"Bcc":case"Reply-To":return this._convertAddresses(this._parseAddresses(n));case"Message-ID":case"In-Reply-To":case"Content-Id":return n=(n||"").toString().replace(/\r?\n|\r/g," "),n.charAt(0)!=="<"&&(n="<"+n),n.charAt(n.length-1)!==">"&&(n=n+">"),n;case"References":return n=[].concat.apply([],[].concat(n||"").map(r=>(r=(r||"").toString().replace(/\r?\n|\r/g," ").trim(),r.replace(/<[^>]*>/g,o=>o.replace(/\s/g,"")).split(/\s+/)))).map(r=>(r.charAt(0)!=="<"&&(r="<"+r),r.charAt(r.length-1)!==">"&&(r=r+">"),r)),n.join(" ").trim();case"Date":return Object.prototype.toString.call(n)==="[object Date]"?n.toUTCString().replace(/GMT/,"+0000"):(n=(n||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(n));case"Content-Type":case"Content-Disposition":return(n||"").toString().replace(/\r?\n|\r/g," ");default:return n=(n||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(n)}}_convertAddresses(e,n){let r=[];return n=n||[],[].concat(e||[]).forEach(o=>{if(o.address)o.address=this._normalizeAddress(o.address),o.name?o.name&&r.push(`${this._encodeAddressName(o.name)} <${o.address}>`):r.push(o.address.indexOf(" ")>=0?`<${o.address}>`:`${o.address}`),o.address&&(n.filter(i=>i.address===o.address).length||n.push(o));else if(o.group){let i=(o.group.length?this._convertAddresses(o.group,n):"").trim();r.push(`${this._encodeAddressName(o.name)}:${i};`)}}),r.join(", ")}_normalizeAddress(e){e=(e||"").toString().replace(/[\x00-\x1F<>]+/g," ").trim();let n=e.lastIndexOf("@");if(n<0)return e;let r=e.substr(0,n),o=e.substr(n+1),i;try{i=Kx.toASCII(o.toLowerCase())}catch{}return r.indexOf(" ")>=0&&(r.charAt(0)!=='"'&&(r='"'+r),r.substr(-1)!=='"'&&(r=r+'"')),`${r}@${i}`}_encodeAddressName(e){return/^[\w ]*$/.test(e)?e:/^[\x20-\x7e]*$/.test(e)?'"'+e.replace(/([\\"])/g,"\\$1")+'"':ze.encodeWord(e,this._getTextEncoding(e),52)}_encodeWords(e){return ze.encodeWords(e,this._getTextEncoding(e),52,!0)}_getTextEncoding(e){e=(e||"").toString();let n=this.textEncoding,r,o;return n||(o=(e.match(/[\x00-\x08\x0B\x0C\x0E-\x1F\u0080-\uFFFF]/g)||[]).length,r=(e.match(/[a-z]/gi)||[]).length,n=o<r?"Q":"B"),n}_generateMessageId(){return"<"+[2,2,2,6].reduce((e,n)=>e+"-"+fo.randomBytes(n).toString("hex"),fo.randomBytes(4).toString("hex"))+"@"+(this.getEnvelope().from||this.hostname||"localhost").split("@").pop()+">"}};var Gi=ry;const mn=Gi,mo=Dr,oy=Ae.parseDataURI;let iy=class{constructor(e){this.mail=e||{},this.message=!1}compile(){return this._alternatives=this.getAlternatives(),this._htmlNode=this._alternatives.filter(e=>/^text\/html\b/i.test(e.contentType)).pop(),this._attachments=this.getAttachments(!!this._htmlNode),this._useRelated=!!(this._htmlNode&&this._attachments.related.length),this._useAlternative=this._alternatives.length>1,this._useMixed=this._attachments.attached.length>1||this._alternatives.length&&this._attachments.attached.length===1,this.mail.raw?this.message=new mn("message/rfc822",{newline:this.mail.newline}).setRaw(this.mail.raw):this._useMixed?this.message=this._createMixed():this._useAlternative?this.message=this._createAlternative():this._useRelated?this.message=this._createRelated():this.message=this._createContentNode(!1,[].concat(this._alternatives||[]).concat(this._attachments.attached||[]).shift()||{contentType:"text/plain",content:""}),this.mail.headers&&this.message.addHeader(this.mail.headers),["from","sender","to","cc","bcc","reply-to","in-reply-to","references","subject","message-id","date"].forEach(e=>{let n=e.replace(/-(\w)/g,(r,o)=>o.toUpperCase());this.mail[n]&&this.message.setHeader(e,this.mail[n])}),this.mail.envelope&&this.message.setEnvelope(this.mail.envelope),this.message.messageId(),this.message}getAttachments(e){let n,r,o=[].concat(this.mail.attachments||[]).map((i,s)=>{let a;/^data:/i.test(i.path||i.href)&&(i=this._processDataUrl(i));let c=i.contentType||mo.detectMimeType(i.filename||i.path||i.href||"bin"),p=/^image\//i.test(c),f=/^message\//i.test(c),m=i.contentDisposition||(f||p&&i.cid?"inline":"attachment"),u;return"contentTransferEncoding"in i?u=i.contentTransferEncoding:f?u="7bit":u="base64",a={contentType:c,contentDisposition:m,contentTransferEncoding:u},i.filename?a.filename=i.filename:!f&&i.filename!==!1&&(a.filename=(i.path||i.href||"").split("/").pop().split("?").shift()||"attachment-"+(s+1),a.filename.indexOf(".")<0&&(a.filename+="."+mo.detectExtension(a.contentType))),/^https?:\/\//i.test(i.path)&&(i.href=i.path,i.path=void 0),i.cid&&(a.cid=i.cid),i.raw?a.raw=i.raw:i.path?a.content={path:i.path}:i.href?a.content={href:i.href,httpHeaders:i.httpHeaders}:a.content=i.content||"",i.encoding&&(a.encoding=i.encoding),i.headers&&(a.headers=i.headers),a});return this.mail.icalEvent&&(typeof this.mail.icalEvent=="object"&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?n=this.mail.icalEvent:n={content:this.mail.icalEvent},r={},Object.keys(n).forEach(i=>{r[i]=n[i]}),r.contentType="application/ics",r.headers||(r.headers={}),r.filename=r.filename||"invite.ics",r.headers["Content-Disposition"]="attachment",r.headers["Content-Transfer-Encoding"]="base64"),e?{attached:o.filter(i=>!i.cid).concat(r||[]),related:o.filter(i=>!!i.cid)}:{attached:o.concat(r||[]),related:[]}}getAlternatives(){let e=[],n,r,o,i,s,a;return this.mail.text&&(typeof this.mail.text=="object"&&(this.mail.text.content||this.mail.text.path||this.mail.text.href||this.mail.text.raw)?n=this.mail.text:n={content:this.mail.text},n.contentType="text/plain; charset=utf-8"),this.mail.watchHtml&&(typeof this.mail.watchHtml=="object"&&(this.mail.watchHtml.content||this.mail.watchHtml.path||this.mail.watchHtml.href||this.mail.watchHtml.raw)?o=this.mail.watchHtml:o={content:this.mail.watchHtml},o.contentType="text/watch-html; charset=utf-8"),this.mail.amp&&(typeof this.mail.amp=="object"&&(this.mail.amp.content||this.mail.amp.path||this.mail.amp.href||this.mail.amp.raw)?i=this.mail.amp:i={content:this.mail.amp},i.contentType="text/x-amp-html; charset=utf-8"),this.mail.icalEvent&&(typeof this.mail.icalEvent=="object"&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?s=this.mail.icalEvent:s={content:this.mail.icalEvent},a={},Object.keys(s).forEach(c=>{a[c]=s[c]}),a.content&&typeof a.content=="object"&&(a.content._resolve=!0),a.filename=!1,a.contentType="text/calendar; charset=utf-8; method="+(a.method||"PUBLISH").toString().trim().toUpperCase(),a.headers||(a.headers={})),this.mail.html&&(typeof this.mail.html=="object"&&(this.mail.html.content||this.mail.html.path||this.mail.html.href||this.mail.html.raw)?r=this.mail.html:r={content:this.mail.html},r.contentType="text/html; charset=utf-8"),[].concat(n||[]).concat(o||[]).concat(i||[]).concat(r||[]).concat(a||[]).concat(this.mail.alternatives||[]).forEach(c=>{let p;/^data:/i.test(c.path||c.href)&&(c=this._processDataUrl(c)),p={contentType:c.contentType||mo.detectMimeType(c.filename||c.path||c.href||"txt"),contentTransferEncoding:c.contentTransferEncoding},c.filename&&(p.filename=c.filename),/^https?:\/\//i.test(c.path)&&(c.href=c.path,c.path=void 0),c.raw?p.raw=c.raw:c.path?p.content={path:c.path}:c.href?p.content={href:c.href}:p.content=c.content||"",c.encoding&&(p.encoding=c.encoding),c.headers&&(p.headers=c.headers),e.push(p)}),e}_createMixed(e){let n;return e?n=e.createChild("multipart/mixed",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):n=new mn("multipart/mixed",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._useAlternative?this._createAlternative(n):this._useRelated&&this._createRelated(n),[].concat(!this._useAlternative&&this._alternatives||[]).concat(this._attachments.attached||[]).forEach(r=>{(!this._useRelated||r!==this._htmlNode)&&this._createContentNode(n,r)}),n}_createAlternative(e){let n;return e?n=e.createChild("multipart/alternative",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):n=new mn("multipart/alternative",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._alternatives.forEach(r=>{this._useRelated&&this._htmlNode===r?this._createRelated(n):this._createContentNode(n,r)}),n}_createRelated(e){let n;return e?n=e.createChild('multipart/related; type="text/html"',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):n=new mn('multipart/related; type="text/html"',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._createContentNode(n,this._htmlNode),this._attachments.related.forEach(r=>this._createContentNode(n,r)),n}_createContentNode(e,n){n=n||{},n.content=n.content||"";let r,o=(n.encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");return e?r=e.createChild(n.contentType,{filename:n.filename,textEncoding:this.mail.textEncoding,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):r=new mn(n.contentType,{filename:n.filename,baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),n.headers&&r.addHeader(n.headers),n.cid&&r.setHeader("Content-Id","<"+n.cid.replace(/[<>]/g,"")+">"),n.contentTransferEncoding?r.setHeader("Content-Transfer-Encoding",n.contentTransferEncoding):this.mail.encoding&&/^text\//i.test(n.contentType)&&r.setHeader("Content-Transfer-Encoding",this.mail.encoding),(!/^text\//i.test(n.contentType)||n.contentDisposition)&&r.setHeader("Content-Disposition",n.contentDisposition||(n.cid&&/^image\//i.test(n.contentType)?"inline":"attachment")),typeof n.content=="string"&&!["utf8","usascii","ascii"].includes(o)&&(n.content=Buffer.from(n.content,o)),n.raw?r.setRaw(n.raw):r.setContent(n.content),r}_processDataUrl(e){const n=e.path||e.href;if(!n||typeof n!="string"||!n.startsWith("data:"))return e;if(n.length>1e5)return Object.assign({},e,{path:!1,href:!1,content:Buffer.alloc(0),contentType:e.contentType||"application/octet-stream"});let r;try{r=oy(n)}catch{return e}return r&&(e.content=r.data,e.contentType=e.contentType||r.contentType,"path"in e&&(e.path=!1),"href"in e&&(e.href=!1)),e}};var sy=iy;const ay=V.Transform;let cy=class extends ay{constructor(e){super(e),this.lastBytes=Buffer.alloc(4),this.headersParsed=!1,this.headerBytes=0,this.headerChunks=[],this.rawHeaders=!1,this.bodySize=0}updateLastBytes(e){let n=this.lastBytes.length,r=Math.min(e.length,n);for(let o=0,i=n-r;o<i;o++)this.lastBytes[o]=this.lastBytes[o+r];for(let o=1;o<=r;o++)this.lastBytes[n-o]=e[e.length-o]}checkHeaders(e){if(this.headersParsed)return!0;let n=this.lastBytes.length,r=0;this.curLinePos=0;for(let o=0,i=this.lastBytes.length+e.length;o<i;o++){let s;if(o<n?s=this.lastBytes[o]:s=e[o-n],s===10&&o){let a=o-1<n?this.lastBytes[o-1]:e[o-1-n],c=o>1?o-2<n?this.lastBytes[o-2]:e[o-2-n]:!1;if(a===10){this.headersParsed=!0,r=o-n+1,this.headerBytes+=r;break}else if(a===13&&c===10){this.headersParsed=!0,r=o-n+1,this.headerBytes+=r;break}}}if(this.headersParsed){if(this.headerChunks.push(e.slice(0,r)),this.rawHeaders=Buffer.concat(this.headerChunks,this.headerBytes),this.headerChunks=null,this.emit("headers",this.parseHeaders()),e.length-1>r){let o=e.slice(r);this.bodySize+=o.length,setImmediate(()=>this.push(o))}return!1}else this.headerBytes+=e.length,this.headerChunks.push(e);return this.updateLastBytes(e),!1}_transform(e,n,r){if(!e||!e.length)return r();typeof e=="string"&&(e=Buffer.from(e,n));let o;try{o=this.checkHeaders(e)}catch(i){return r(i)}o&&(this.bodySize+=e.length,this.push(e)),setImmediate(r)}_flush(e){if(this.headerChunks){let n=Buffer.concat(this.headerChunks,this.headerBytes);this.bodySize+=n.length,this.push(n),this.headerChunks=null}e()}parseHeaders(){let e=(this.rawHeaders||"").toString().split(/\r?\n/);for(let n=e.length-1;n>0;n--)/^\s/.test(e[n])&&(e[n-1]+=`
`+e[n],e.splice(n,1));return e.filter(n=>n.trim()).map(n=>({key:n.substr(0,n.indexOf(":")).trim().toLowerCase(),line:n}))}};var ly=cy;const dy=V.Transform,py=V;let uy=class extends dy{constructor(e){super(),e=e||{},this.chunkBuffer=[],this.chunkBufferLen=0,this.bodyHash=py.createHash(e.hashAlgo||"sha1"),this.remainder="",this.byteLength=0,this.debug=e.debug,this._debugBody=e.debug?[]:!1}updateHash(e){let n,r="",o="file";for(let s=e.length-1;s>=0;s--){let a=e[s];if(!(o==="file"&&(a===10||a===13))){if(o==="file"&&(a===9||a===32))o="line";else if(!(o==="line"&&(a===9||a===32))){if((o==="file"||o==="line")&&(o="body",s===e.length-1))break}}if(s===0){if(o==="file"&&(!this.remainder||/[\r\n]$/.test(this.remainder))||o==="line"&&(!this.remainder||/[ \t]$/.test(this.remainder))){this.remainder+=e.toString("binary");return}else if(o==="line"||o==="file"){r=e.toString("binary"),e=!1;break}}if(o==="body"){r=e.slice(s+1).toString("binary"),e=e.slice(0,s+1);break}}let i=!!this.remainder;if(e&&!i){for(let s=0,a=e.length;s<a;s++)if(s&&e[s]===10&&e[s-1]!==13){i=!0;break}else if(s&&e[s]===13&&e[s-1]===32){i=!0;break}else if(s&&e[s]===32&&e[s-1]===32){i=!0;break}else if(e[s]===9){i=!0;break}}i?(n=this.remainder+(e?e.toString("binary"):""),this.remainder=r,n=n.replace(/\r?\n/g,`
`).replace(/[ \t]*$/gm,"").replace(/[ \t]+/gm," ").replace(/\n/g,`\r
`),e=Buffer.from(n,"binary")):r&&(this.remainder=r),this.debug&&this._debugBody.push(e),this.bodyHash.update(e)}_transform(e,n,r){if(!e||!e.length)return r();typeof e=="string"&&(e=Buffer.from(e,n)),this.updateHash(e),this.byteLength+=e.length,this.push(e),r()}_flush(e){/[\r\n]$/.test(this.remainder)&&this.byteLength>2&&this.bodyHash.update(Buffer.from(`\r
`)),this.byteLength||this.push(Buffer.from(`\r
`)),this.emit("hash",this.bodyHash.digest("base64"),this.debug?Buffer.concat(this._debugBody):!1),e()}};var fy=uy,Wi={exports:{}};const my=cd,hy=Dr,gy=V;Wi.exports=(t,e,n,r)=>{r=r||{};let i=r.headerFieldNames||"From:Sender:Reply-To:Subject:Date:Message-ID:To:Cc:MIME-Version:Content-Type:Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:List-Id:List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive",s=gd(t,i,r.skipFields),a=vy(r.domainName,r.keySelector,s.fieldNames,e,n),c,p;s.headers+="dkim-signature:"+vd(a),c=gy.createSign(("rsa-"+e).toUpperCase()),c.update(s.headers);try{p=c.sign(r.privateKey,"base64")}catch{return!1}return a+p.replace(/(^.{73}|.{75}(?!\r?\n|\r))/g,`$&\r
 `).trim()};Wi.exports.relaxedHeaders=gd;function vy(t,e,n,r,o){let i=["v=1","a=rsa-"+r,"c=relaxed/relaxed","d="+my.toASCII(t),"q=dns/txt","s="+e,"bh="+o,"h="+n].join("; ");return hy.foldLines("DKIM-Signature: "+i,76)+`;\r
 b=`}function gd(t,e,n){let r=new Set,o=new Set,i=new Map;(n||"").toLowerCase().split(":").forEach(c=>{o.add(c.trim())}),(e||"").toLowerCase().split(":").filter(c=>!o.has(c.trim())).forEach(c=>{r.add(c.trim())});for(let c=t.length-1;c>=0;c--){let p=t[c];r.has(p.key)&&!i.has(p.key)&&i.set(p.key,vd(p.line))}let s=[],a=[];return r.forEach(c=>{i.has(c)&&(a.push(c),s.push(c+":"+i.get(c)))}),{headers:s.join(`\r
`)+`\r
`,fieldNames:a.join(":")}}function vd(t){return t.substr(t.indexOf(":")+1).replace(/\r?\n/g,"").replace(/\s+/g," ").trim()}var xy=Wi.exports;const yy=ly,wy=fy,by=xy,ho=V.PassThrough,go=V,Sy=V,_y=V,Ey="sha256",Cy=2*1024*1024;class Ty{constructor(e,n,r,o){this.options=e||{},this.keys=n,this.cacheTreshold=Number(this.options.cacheTreshold)||Cy,this.hashAlgo=this.options.hashAlgo||Ey,this.cacheDir=this.options.cacheDir||!1,this.chunks=[],this.chunklen=0,this.readPos=0,this.cachePath=this.cacheDir?Sy.join(this.cacheDir,"message."+Date.now()+"-"+_y.randomBytes(14).toString("hex")):!1,this.cache=!1,this.headers=!1,this.bodyHash=!1,this.parser=!1,this.relaxedBody=!1,this.input=r,this.output=o,this.output.usingCache=!1,this.hasErrored=!1,this.input.on("error",i=>{this.hasErrored=!0,this.cleanup(),o.emit("error",i)})}cleanup(){!this.cache||!this.cachePath||go.unlink(this.cachePath,()=>!1)}createReadCache(){this.cache=go.createReadStream(this.cachePath),this.cache.once("error",e=>{this.cleanup(),this.output.emit("error",e)}),this.cache.once("close",()=>{this.cleanup()}),this.cache.pipe(this.output)}sendNextChunk(){if(this.hasErrored)return;if(this.readPos>=this.chunks.length)return this.cache?this.createReadCache():this.output.end();let e=this.chunks[this.readPos++];if(this.output.write(e)===!1)return this.output.once("drain",()=>{this.sendNextChunk()});setImmediate(()=>this.sendNextChunk())}sendSignedOutput(){let e=0,n=()=>{if(e>=this.keys.length)return this.output.write(this.parser.rawHeaders),setImmediate(()=>this.sendNextChunk());let r=this.keys[e++],o=by(this.headers,this.hashAlgo,this.bodyHash,{domainName:r.domainName,keySelector:r.keySelector,privateKey:r.privateKey,headerFieldNames:this.options.headerFieldNames,skipFields:this.options.skipFields});return o&&this.output.write(Buffer.from(o+`\r
`)),setImmediate(n)};if(this.bodyHash&&this.headers)return n();this.output.write(this.parser.rawHeaders),this.sendNextChunk()}createWriteCache(){this.output.usingCache=!0,this.cache=go.createWriteStream(this.cachePath),this.cache.once("error",e=>{this.cleanup(),this.relaxedBody.unpipe(this.cache),this.relaxedBody.on("readable",()=>{for(;this.relaxedBody.read()!==null;);}),this.hasErrored=!0,this.output.emit("error",e)}),this.cache.once("close",()=>{this.sendSignedOutput()}),this.relaxedBody.removeAllListeners("readable"),this.relaxedBody.pipe(this.cache)}signStream(){this.parser=new yy,this.relaxedBody=new wy({hashAlgo:this.hashAlgo}),this.parser.on("headers",e=>{this.headers=e}),this.relaxedBody.on("hash",e=>{this.bodyHash=e}),this.relaxedBody.on("readable",()=>{let e;if(!this.cache){for(;(e=this.relaxedBody.read())!==null;)if(this.chunks.push(e),this.chunklen+=e.length,this.chunklen>=this.cacheTreshold&&this.cachePath)return this.createWriteCache()}}),this.relaxedBody.on("end",()=>{this.cache||this.sendSignedOutput()}),this.parser.pipe(this.relaxedBody),setImmediate(()=>this.input.pipe(this.parser))}}let ky=class{constructor(e){this.options=e||{},this.keys=[].concat(this.options.keys||{domainName:e.domainName,keySelector:e.keySelector,privateKey:e.privateKey})}sign(e,n){let r=new ho,o=e,i=!1;Buffer.isBuffer(e)?(i=e,o=new ho):typeof e=="string"&&(i=Buffer.from(e),o=new ho);let s=this.options;n&&Object.keys(n).length&&(s={},Object.keys(this.options||{}).forEach(c=>{s[c]=this.options[c]}),Object.keys(n||{}).forEach(c=>{c in s||(s[c]=n[c])}));let a=new Ty(s,this.keys,o,r);return setImmediate(()=>{a.signStream(),i&&setImmediate(()=>{o.end(i)})}),r}};var Ay=ky;const ta=V,na=V,Ny=V;function xd(t,e,n,r){let o=Ny.parse(t),i,s,a;i={host:o.hostname,port:Number(o.port)?Number(o.port):o.protocol==="https:"?443:80},o.protocol==="https:"?(i.rejectUnauthorized=!1,s=na.connect.bind(na)):s=ta.connect.bind(ta);let c=!1,p=m=>{if(!c){c=!0;try{a.destroy()}catch{}r(m)}},f=()=>{let m=new Error("Proxy socket timed out");m.code="ETIMEDOUT",p(m)};a=s(i,()=>{if(c)return;let m={Host:n+":"+e,Connection:"close"};o.auth&&(m["Proxy-Authorization"]="Basic "+Buffer.from(o.auth).toString("base64")),a.write("CONNECT "+n+":"+e+` HTTP/1.1\r
`+Object.keys(m).map(x=>x+": "+m[x]).join(`\r
`)+`\r
\r
`);let u="",h=x=>{let g,v;if(!c&&(u+=x.toString("binary"),g=u.match(/\r\n\r\n/))){if(a.removeListener("data",h),v=u.substr(g.index+g[0].length),u=u.substr(0,g.index),v&&a.unshift(Buffer.from(v,"binary")),c=!0,g=u.match(/^HTTP\/\d+\.\d+ (\d+)/i),!g||(g[1]||"").charAt(0)!=="2"){try{a.destroy()}catch{}return r(new Error("Invalid response from proxy"+(g&&": "+g[1]||"")))}return a.removeListener("error",p),a.removeListener("timeout",f),a.setTimeout(0),r(null,a)}};a.on("data",h)}),a.setTimeout(xd.timeout||30*1e3),a.on("timeout",f),a.once("error",p)}var jy=xd;const ra=Ae,Ry=Gi,Wt=Dr;let My=class{constructor(e,n){this.mailer=e,this.data={},this.message=null,n=n||{};let r=e.options||{},o=e._defaults||{};Object.keys(n).forEach(i=>{this.data[i]=n[i]}),this.data.headers=this.data.headers||{},Object.keys(o).forEach(i=>{i in this.data?i==="headers"&&Object.keys(o.headers).forEach(s=>{s in this.data.headers||(this.data.headers[s]=o.headers[s])}):this.data[i]=o[i]}),["disableFileAccess","disableUrlAccess","normalizeHeaderKey"].forEach(i=>{i in r&&(this.data[i]=r[i])})}resolveContent(...e){return ra.resolveContent(...e)}resolveAll(e){let n=[[this.data,"html"],[this.data,"text"],[this.data,"watchHtml"],[this.data,"amp"],[this.data,"icalEvent"]];this.data.alternatives&&this.data.alternatives.length&&this.data.alternatives.forEach((c,p)=>{n.push([this.data.alternatives,p])}),this.data.attachments&&this.data.attachments.length&&this.data.attachments.forEach((c,p)=>{c.filename||(c.filename=(c.path||c.href||"").split("/").pop().split("?").shift()||"attachment-"+(p+1),c.filename.indexOf(".")<0&&(c.filename+="."+Wt.detectExtension(c.contentType))),c.contentType||(c.contentType=Wt.detectMimeType(c.filename||c.path||c.href||"bin")),n.push([this.data.attachments,p])});let r=new Ry;["from","to","cc","bcc","sender","replyTo"].forEach(c=>{let p;this.message?p=[].concat(r._parseAddresses(this.message.getHeader(c==="replyTo"?"reply-to":c))||[]):this.data[c]&&(p=[].concat(r._parseAddresses(this.data[c])||[])),p&&p.length?this.data[c]=p:c in this.data&&(this.data[c]=null)}),["from","sender"].forEach(c=>{this.data[c]&&(this.data[c]=this.data[c].shift())});let s=0,a=()=>{if(s>=n.length)return e(null,this.data);let c=n[s++];if(!c[0]||!c[0][c[1]])return a();ra.resolveContent(...c,(p,f)=>{if(p)return e(p);let m={content:f};c[0][c[1]]&&typeof c[0][c[1]]=="object"&&!Buffer.isBuffer(c[0][c[1]])&&Object.keys(c[0][c[1]]).forEach(u=>{!(u in m)&&!["content","path","href","raw"].includes(u)&&(m[u]=c[0][c[1]][u])}),c[0][c[1]]=m,a()})};setImmediate(()=>a())}normalize(e){let n=this.data.envelope||this.message.getEnvelope(),r=this.message.messageId();this.resolveAll((o,i)=>o?e(o):(i.envelope=n,i.messageId=r,["html","text","watchHtml","amp"].forEach(s=>{i[s]&&i[s].content&&(typeof i[s].content=="string"?i[s]=i[s].content:Buffer.isBuffer(i[s].content)&&(i[s]=i[s].content.toString()))}),i.icalEvent&&Buffer.isBuffer(i.icalEvent.content)&&(i.icalEvent.content=i.icalEvent.content.toString("base64"),i.icalEvent.encoding="base64"),i.alternatives&&i.alternatives.length&&i.alternatives.forEach(s=>{s&&s.content&&Buffer.isBuffer(s.content)&&(s.content=s.content.toString("base64"),s.encoding="base64")}),i.attachments&&i.attachments.length&&i.attachments.forEach(s=>{s&&s.content&&Buffer.isBuffer(s.content)&&(s.content=s.content.toString("base64"),s.encoding="base64")}),i.normalizedHeaders={},Object.keys(i.headers||{}).forEach(s=>{let a=[].concat(i.headers[s]||[]).shift();a=a&&a.value||a,a&&(["references","in-reply-to","message-id","content-id"].includes(s)&&(a=this.message._encodeHeaderValue(s,a)),i.normalizedHeaders[s]=a)}),i.list&&typeof i.list=="object"&&this._getListHeaders(i.list).forEach(a=>{i.normalizedHeaders[a.key]=a.value.map(c=>c&&c.value||c).join(", ")}),i.references&&(i.normalizedHeaders.references=this.message._encodeHeaderValue("references",i.references)),i.inReplyTo&&(i.normalizedHeaders["in-reply-to"]=this.message._encodeHeaderValue("in-reply-to",i.inReplyTo)),e(null,i)))}setMailerHeader(){!this.message||!this.data.xMailer||this.message.setHeader("X-Mailer",this.data.xMailer)}setPriorityHeaders(){if(!(!this.message||!this.data.priority))switch((this.data.priority||"").toString().toLowerCase()){case"high":this.message.setHeader("X-Priority","1 (Highest)"),this.message.setHeader("X-MSMail-Priority","High"),this.message.setHeader("Importance","High");break;case"low":this.message.setHeader("X-Priority","5 (Lowest)"),this.message.setHeader("X-MSMail-Priority","Low"),this.message.setHeader("Importance","Low");break}}setListHeaders(){!this.message||!this.data.list||typeof this.data.list!="object"||this.data.list&&typeof this.data.list=="object"&&this._getListHeaders(this.data.list).forEach(e=>{e.value.forEach(n=>{this.message.addHeader(e.key,n)})})}_getListHeaders(e){return Object.keys(e).map(n=>({key:"list-"+n.toLowerCase().trim(),value:[].concat(e[n]||[]).map(r=>({prepared:!0,foldLines:!0,value:[].concat(r||[]).map(o=>{if(typeof o=="string"&&(o={url:o}),o&&o.url){if(n.toLowerCase().trim()==="id"){let s=o.comment||"";return Wt.isPlainText(s)?s='"'+s+'"':s=Wt.encodeWord(s),(o.comment?s+" ":"")+this._formatListUrl(o.url).replace(/^<[^:]+\/{,2}/,"")}let i=o.comment||"";return Wt.isPlainText(i)||(i=Wt.encodeWord(i)),this._formatListUrl(o.url)+(o.comment?" ("+i+")":"")}return""}).filter(o=>o).join(", ")}))}))}_formatListUrl(e){return e=e.replace(/[\s<]+|[\s>]+/g,""),/^(https?|mailto|ftp):/.test(e)?"<"+e+">":/^[^@]+@[^@]+$/.test(e)?"<mailto:"+e+">":"<http://"+e+">"}};var Py=My;const Iy=V,oa=Ae,Oy=Zl,Ly=sy,ia=Ay,Dy=jy,zy=V,Fy=V,vo=tt,$y=Py,Uy=V,Hy=V,By=V;class Vy extends Iy{constructor(e,n,r){super(),this.options=n||{},this._defaults=r||{},this._defaultPlugins={compile:[(...o)=>this._convertDataImages(...o)],stream:[]},this._userPlugins={compile:[],stream:[]},this.meta=new Map,this.dkim=this.options.dkim?new ia(this.options.dkim):!1,this.transporter=e,this.transporter.mailer=this,this.logger=oa.getLogger(this.options,{component:this.options.component||"mail"}),this.logger.debug({tnx:"create"},"Creating transport: %s",this.getVersionString()),typeof this.transporter.on=="function"&&(this.transporter.on("log",o=>{this.logger.debug({tnx:"transport"},"%s: %s",o.type,o.message)}),this.transporter.on("error",o=>{this.logger.error({err:o,tnx:"transport"},"Transport Error: %s",o.message),this.emit("error",o)}),this.transporter.on("idle",(...o)=>{this.emit("idle",...o)}),this.transporter.on("clear",(...o)=>{this.emit("clear",...o)})),["close","isIdle","verify"].forEach(o=>{this[o]=(...i)=>typeof this.transporter[o]=="function"?(o==="verify"&&typeof this.getSocket=="function"&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1),this.transporter[o](...i)):(this.logger.warn({tnx:"transport",methodName:o},"Non existing method %s called for transport",o),!1)}),this.options.proxy&&typeof this.options.proxy=="string"&&this.setupProxy(this.options.proxy)}use(e,n){return e=(e||"").toString(),this._userPlugins.hasOwnProperty(e)?this._userPlugins[e].push(n):this._userPlugins[e]=[n],this}sendMail(e,n=null){let r;n||(r=new Promise((i,s)=>{n=oa.callbackPromise(i,s)})),typeof this.getSocket=="function"&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1);let o=new $y(this,e);return this.logger.debug({tnx:"transport",name:this.transporter.name,version:this.transporter.version,action:"send"},"Sending mail using %s/%s",this.transporter.name,this.transporter.version),this._processPlugins("compile",o,i=>{if(i)return this.logger.error({err:i,tnx:"plugin",action:"compile"},"PluginCompile Error: %s",i.message),n(i);o.message=new Ly(o.data).compile(),o.setMailerHeader(),o.setPriorityHeaders(),o.setListHeaders(),this._processPlugins("stream",o,s=>{if(s)return this.logger.error({err:s,tnx:"plugin",action:"stream"},"PluginStream Error: %s",s.message),n(s);(o.data.dkim||this.dkim)&&o.message.processFunc(a=>{let c=o.data.dkim?new ia(o.data.dkim):this.dkim;return this.logger.debug({tnx:"DKIM",messageId:o.message.messageId(),dkimDomains:c.keys.map(p=>p.keySelector+"."+p.domainName).join(", ")},"Signing outgoing message with %s keys",c.keys.length),c.sign(a,o.data._dkim)}),this.transporter.send(o,(...a)=>{a[0]&&this.logger.error({err:a[0],tnx:"transport",action:"send"},"Send Error: %s",a[0].message),n(...a)})})}),r}getVersionString(){return zy.format("%s (%s; +%s; %s/%s)",vo.name,vo.version,vo.homepage,this.transporter.name,this.transporter.version)}_processPlugins(e,n,r){if(e=(e||"").toString(),!this._userPlugins.hasOwnProperty(e))return r();let o=this._userPlugins[e]||[],i=this._defaultPlugins[e]||[];if(o.length&&this.logger.debug({tnx:"transaction",pluginCount:o.length,step:e},"Using %s plugins for %s",o.length,e),o.length+i.length===0)return r();let s=0,a="default",c=()=>{let p=a==="default"?i:o;if(s>=p.length)if(a==="default"&&o.length)a="user",s=0,p=o;else return r();let f=p[s++];f(n,m=>{if(m)return r(m);c()})};c()}setupProxy(e){let n=Fy.parse(e);this.getSocket=(r,o)=>{let i=n.protocol.replace(/:$/,"").toLowerCase();if(this.meta.has("proxy_handler_"+i))return this.meta.get("proxy_handler_"+i)(n,r,o);switch(i){case"http":case"https":Dy(n.href,r.port,r.host,(s,a)=>s?o(s):o(null,{connection:a}));return;case"socks":case"socks5":case"socks4":case"socks4a":{if(!this.meta.has("proxy_socks_module"))return o(new Error("Socks module not loaded"));let s=a=>{let c=!!this.meta.get("proxy_socks_module").SocksClient,p=c?this.meta.get("proxy_socks_module").SocksClient:this.meta.get("proxy_socks_module"),f=Number(n.protocol.replace(/\D/g,""))||5,m={proxy:{ipaddress:a,port:Number(n.port),type:f},[c?"destination":"target"]:{host:r.host,port:r.port},command:"connect"};if(n.auth){let u=decodeURIComponent(n.auth.split(":").shift()),h=decodeURIComponent(n.auth.split(":").pop());c?(m.proxy.userId=u,m.proxy.password=h):f===4?m.userid=u:m.authentication={username:u,password:h}}p.createConnection(m,(u,h)=>u?o(u):o(null,{connection:h.socket||h}))};return Uy.isIP(n.hostname)?s(n.hostname):Hy.resolve(n.hostname,(a,c)=>{if(a)return o(a);s(Array.isArray(c)?c[0]:c)})}}o(new Error("Unknown proxy configuration"))}}_convertDataImages(e,n){if(!this.options.attachDataUrls&&!e.data.attachDataUrls||!e.data.html)return n();e.resolveContent(e.data,"html",(r,o)=>{if(r)return n(r);let i=0;o=(o||"").toString().replace(/(<img\b[^<>]{0,1024} src\s{0,20}=[\s"']{0,20})(data:([^;]+);[^"'>\s]+)/gi,(s,a,c,p)=>{let f=By.randomBytes(10).toString("hex")+"@localhost";return e.data.attachments||(e.data.attachments=[]),Array.isArray(e.data.attachments)||(e.data.attachments=[].concat(e.data.attachments||[])),e.data.attachments.push({path:c,cid:f,filename:"image-"+ ++i+"."+Oy.detectExtension(p)}),a+"cid:"+f}),e.data.html=o,n()})}set(e,n){return this.meta.set(e,n)}get(e){return this.meta.get(e)}}var qy=Vy;const Gy=V,Wy=Gy.Transform;let Ky=class extends Wy{constructor(e){super(e),this.options=e||{},this._curLine="",this.inByteCount=0,this.outByteCount=0,this.lastByte=!1}_transform(e,n,r){let o=[],i=0,s,a,c=0,p;if(!e||!e.length)return r();for(typeof e=="string"&&(e=Buffer.from(e)),this.inByteCount+=e.length,s=0,a=e.length;s<a;s++)e[s]===46?(s&&e[s-1]===10||!s&&(!this.lastByte||this.lastByte===10))&&(p=e.slice(c,s+1),o.push(p),o.push(Buffer.from(".")),i+=p.length+1,c=s+1):e[s]===10&&(s&&e[s-1]!==13||!s&&this.lastByte!==13)&&(s>c?(p=e.slice(c,s),o.push(p),i+=p.length+2):i+=2,o.push(Buffer.from(`\r
`)),c=s+1);i?(c<e.length&&(p=e.slice(c),o.push(p),i+=p.length),this.outByteCount+=i,this.push(Buffer.concat(o,i))):(this.outByteCount+=e.length,this.push(e)),this.lastByte=e[e.length-1],r()}_flush(e){let n;this.lastByte===10?n=Buffer.from(`.\r
`):this.lastByte===13?n=Buffer.from(`
.\r
`):n=Buffer.from(`\r
.\r
`),this.outByteCount+=n.length,this.push(n),e()}};var Yy=Ky;const Xy=tt,Qy=V.EventEmitter,sa=V,aa=V,Jy=V,ca=V,Zy=Yy,la=V.PassThrough,ot=Ae,ew=2*60*1e3,da=10*60*1e3,tw=30*1e3,nw=30*1e3;let rw=class extends Qy{constructor(e){super(e),this.id=ca.randomBytes(8).toString("base64").replace(/\W/g,""),this.stage="init",this.options=e||{},this.secureConnection=!!this.options.secure,this.alreadySecured=!!this.options.secured,this.port=Number(this.options.port)||(this.secureConnection?465:587),this.host=this.options.host||"localhost",this.servername=this.options.servername?this.options.servername:sa.isIP(this.host)?!1:this.host,this.allowInternalNetworkInterfaces=this.options.allowInternalNetworkInterfaces||!1,typeof this.options.secure>"u"&&this.port===465&&(this.secureConnection=!0),this.name=this.options.name||this._getHostname(),this.logger=ot.getLogger(this.options,{component:this.options.component||"smtp-connection",sid:this.id}),this.customAuth=new Map,Object.keys(this.options.customAuth||{}).forEach(n=>{let r=(n||"").toString().trim().toUpperCase();r&&this.customAuth.set(r,this.options.customAuth[n])}),this.version=Xy.version,this.authenticated=!1,this.destroyed=!1,this.secure=!!this.secureConnection,this._remainder="",this._responseQueue=[],this.lastServerResponse=!1,this._socket=!1,this._supportedAuth=[],this.allowsAuth=!1,this._envelope=!1,this._supportedExtensions=[],this._maxAllowedSize=0,this._responseActions=[],this._recipientQueue=[],this._greetingTimeout=!1,this._connectionTimeout=!1,this._destroyed=!1,this._closing=!1,this._onSocketData=n=>this._onData(n),this._onSocketError=n=>this._onError(n,"ESOCKET",!1,"CONN"),this._onSocketClose=()=>this._onClose(),this._onSocketEnd=()=>this._onEnd(),this._onSocketTimeout=()=>this._onTimeout()}connect(e){if(typeof e=="function"){this.once("connect",()=>{this.logger.debug({tnx:"smtp"},"SMTP handshake finished"),e()});const o=this._isDestroyedMessage("connect");if(o)return e(this._formatError(o,"ECONNECTION",!1,"CONN"))}let n={port:this.port,host:this.host,allowInternalNetworkInterfaces:this.allowInternalNetworkInterfaces,timeout:this.options.dnsTimeout||nw};this.options.localAddress&&(n.localAddress=this.options.localAddress);let r=()=>{this._connectionTimeout=setTimeout(()=>{this._onError("Connection timeout","ETIMEDOUT",!1,"CONN")},this.options.connectionTimeout||ew),this._socket.on("error",this._onSocketError)};if(this.options.connection){this._socket=this.options.connection,r(),this.secureConnection&&!this.alreadySecured?setImmediate(()=>this._upgradeConnection(o=>{if(o){this._onError(new Error("Error initiating TLS - "+(o.message||o)),"ETLS",!1,"CONN");return}this._onConnect()})):setImmediate(()=>this._onConnect());return}else return this.options.socket?(this._socket=this.options.socket,ot.resolveHostname(n,(o,i)=>{if(o)return setImmediate(()=>this._onError(o,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:n.host,resolved:i.host,cached:!!i.cached},"Resolved %s as %s [cache %s]",n.host,i.host,i.cached?"hit":"miss"),Object.keys(i).forEach(s=>{s.charAt(0)!=="_"&&i[s]&&(n[s]=i[s])});try{this._socket.connect(this.port,this.host,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),r()}catch(s){return setImmediate(()=>this._onError(s,"ECONNECTION",!1,"CONN"))}})):this.secureConnection?(this.options.tls&&Object.keys(this.options.tls).forEach(o=>{n[o]=this.options.tls[o]}),this.servername&&!n.servername&&(n.servername=this.servername),ot.resolveHostname(n,(o,i)=>{if(o)return setImmediate(()=>this._onError(o,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:n.host,resolved:i.host,cached:!!i.cached},"Resolved %s as %s [cache %s]",n.host,i.host,i.cached?"hit":"miss"),Object.keys(i).forEach(s=>{s.charAt(0)!=="_"&&i[s]&&(n[s]=i[s])});try{this._socket=aa.connect(n,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),r()}catch(s){return setImmediate(()=>this._onError(s,"ECONNECTION",!1,"CONN"))}})):ot.resolveHostname(n,(o,i)=>{if(o)return setImmediate(()=>this._onError(o,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:n.host,resolved:i.host,cached:!!i.cached},"Resolved %s as %s [cache %s]",n.host,i.host,i.cached?"hit":"miss"),Object.keys(i).forEach(s=>{s.charAt(0)!=="_"&&i[s]&&(n[s]=i[s])});try{this._socket=sa.connect(n,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),r()}catch(s){return setImmediate(()=>this._onError(s,"ECONNECTION",!1,"CONN"))}})}quit(){this._sendCommand("QUIT"),this._responseActions.push(this.close)}close(){if(clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._responseActions=[],this._closing)return;this._closing=!0;let e="end";this.stage==="init"&&(e="destroy"),this.logger.debug({tnx:"smtp"},'Closing connection to the server using "%s"',e);let n=this._socket&&this._socket.socket||this._socket;if(n&&!n.destroyed)try{n[e]()}catch{}this._destroy()}login(e,n){const r=this._isDestroyedMessage("login");if(r)return n(this._formatError(r,"ECONNECTION",!1,"API"));if(this._auth=e||{},this._authMethod=(this._auth.method||"").toString().trim().toUpperCase()||!1,!this._authMethod&&this._auth.oauth2&&!this._auth.credentials?this._authMethod="XOAUTH2":(!this._authMethod||this._authMethod==="XOAUTH2"&&!this._auth.oauth2)&&(this._authMethod=(this._supportedAuth[0]||"PLAIN").toUpperCase().trim()),this._authMethod!=="XOAUTH2"&&(!this._auth.credentials||!this._auth.credentials.user||!this._auth.credentials.pass))if(this._auth.user&&this._auth.pass||this.customAuth.has(this._authMethod))this._auth.credentials={user:this._auth.user,pass:this._auth.pass,options:this._auth.options};else return n(this._formatError('Missing credentials for "'+this._authMethod+'"',"EAUTH",!1,"API"));if(this.customAuth.has(this._authMethod)){let o=this.customAuth.get(this._authMethod),i,s=!1,a=()=>{s||(s=!0,this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,n(null,!0))},c=f=>{s||(s=!0,n(this._formatError(f,"EAUTH",i,"AUTH "+this._authMethod)))},p=o({auth:this._auth,method:this._authMethod,extensions:[].concat(this._supportedExtensions),authMethods:[].concat(this._supportedAuth),maxAllowedSize:this._maxAllowedSize||!1,sendCommand:(f,m)=>{let u;return m||(u=new Promise((h,x)=>{m=ot.callbackPromise(h,x)})),this._responseActions.push(h=>{i=h;let x=h.match(/^(\d+)(?:\s(\d+\.\d+\.\d+))?\s/),g={command:f,response:h};x?(g.status=Number(x[1])||0,x[2]&&(g.code=x[2]),g.text=h.substr(x[0].length)):(g.text=h,g.status=0),m(null,g)}),setImmediate(()=>this._sendCommand(f)),u},resolve:a,reject:c});p&&typeof p.catch=="function"&&p.then(a).catch(c);return}switch(this._authMethod){case"XOAUTH2":this._handleXOauth2Token(!1,n);return;case"LOGIN":this._responseActions.push(o=>{this._actionAUTH_LOGIN_USER(o,n)}),this._sendCommand("AUTH LOGIN");return;case"PLAIN":this._responseActions.push(o=>{this._actionAUTHComplete(o,n)}),this._sendCommand("AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0"+this._auth.credentials.pass,"utf-8").toString("base64"),"AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0/* secret */","utf-8").toString("base64"));return;case"CRAM-MD5":this._responseActions.push(o=>{this._actionAUTH_CRAM_MD5(o,n)}),this._sendCommand("AUTH CRAM-MD5");return}return n(this._formatError('Unknown authentication method "'+this._authMethod+'"',"EAUTH",!1,"API"))}send(e,n,r){if(!n)return r(this._formatError("Empty message","EMESSAGE",!1,"API"));const o=this._isDestroyedMessage("send message");if(o)return r(this._formatError(o,"ECONNECTION",!1,"API"));if(this._maxAllowedSize&&e.size>this._maxAllowedSize)return setImmediate(()=>{r(this._formatError("Message size larger than allowed "+this._maxAllowedSize,"EMESSAGE",!1,"MAIL FROM"))});let i=!1,s=function(){i||(i=!0,r(...arguments))};typeof n.on=="function"&&n.on("error",c=>s(this._formatError(c,"ESTREAM",!1,"API")));let a=Date.now();this._setEnvelope(e,(c,p)=>{if(c){let u=new la;return typeof n.pipe=="function"?n.pipe(u):(u.write(n),u.end()),s(c)}let f=Date.now(),m=this._createSendStream((u,h)=>u?s(u):(p.envelopeTime=f-a,p.messageTime=Date.now()-f,p.messageSize=m.outByteCount,p.response=h,s(null,p)));typeof n.pipe=="function"?n.pipe(m):(m.write(n),m.end())})}reset(e){this._sendCommand("RSET"),this._responseActions.push(n=>n.charAt(0)!=="2"?e(this._formatError("Could not reset session state. response="+n,"EPROTOCOL",n,"RSET")):(this._envelope=!1,e(null,!0)))}_onConnect(){if(clearTimeout(this._connectionTimeout),this.logger.info({tnx:"network",localAddress:this._socket.localAddress,localPort:this._socket.localPort,remoteAddress:this._socket.remoteAddress,remotePort:this._socket.remotePort},"%s established to %s:%s",this.secure?"Secure connection":"Connection",this._socket.remoteAddress,this._socket.remotePort),this._destroyed){this.close();return}this.stage="connected",this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout),this._socket.removeListener("close",this._onSocketClose),this._socket.removeListener("end",this._onSocketEnd),this._socket.on("data",this._onSocketData),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||da),this._socket.on("timeout",this._onSocketTimeout),this._greetingTimeout=setTimeout(()=>{this._socket&&!this._destroyed&&this._responseActions[0]===this._actionGreeting&&this._onError("Greeting never received","ETIMEDOUT",!1,"CONN")},this.options.greetingTimeout||tw),this._responseActions.push(this._actionGreeting),this._socket.resume()}_onData(e){if(this._destroyed||!e||!e.length)return;let n=(e||"").toString("binary"),r=(this._remainder+n).split(/\r?\n/),o;this._remainder=r.pop();for(let i=0,s=r.length;i<s;i++){if(this._responseQueue.length&&(o=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(o.split(`
`).pop()))){this._responseQueue[this._responseQueue.length-1]+=`
`+r[i];continue}this._responseQueue.push(r[i])}this._responseQueue.length&&(o=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(o.split(`
`).pop()))||this._processResponse()}_onError(e,n,r,o){clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),!this._destroyed&&(e=this._formatError(e,n,r,o),this.logger.error(r,e.message),this.emit("error",e),this.close())}_formatError(e,n,r,o){let i;/Error\]$/i.test(Object.prototype.toString.call(e))?i=e:i=new Error(e),n&&n!=="Error"&&(i.code=n),r&&(i.response=r,i.message+=": "+r);let s=typeof r=="string"&&Number((r.match(/^\d+/)||[])[0])||!1;return s&&(i.responseCode=s),o&&(i.command=o),i}_onClose(){let e=!1;if(this._remainder&&this._remainder.trim()&&((this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"server"},this._remainder.replace(/\r?\n$/,"")),this.lastServerResponse=e=this._remainder.trim()),this.logger.info({tnx:"network"},"Connection closed"),this.upgrading&&!this._destroyed)return this._onError(new Error("Connection closed unexpectedly"),"ETLS",e,"CONN");if(![this._actionGreeting,this.close].includes(this._responseActions[0])&&!this._destroyed)return this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",e,"CONN");if(/^[45]\d{2}\b/.test(e))return this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",e,"CONN");this._destroy()}_onEnd(){this._socket&&!this._socket.destroyed&&this._socket.destroy()}_onTimeout(){return this._onError(new Error("Timeout"),"ETIMEDOUT",!1,"CONN")}_destroy(){this._destroyed||(this._destroyed=!0,this.emit("end"))}_upgradeConnection(e){this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout);let n=this._socket,r={socket:this._socket,host:this.host};Object.keys(this.options.tls||{}).forEach(o=>{r[o]=this.options.tls[o]}),this.servername&&!r.servername&&(r.servername=this.servername),this.upgrading=!0;try{this._socket=aa.connect(r,()=>(this.secure=!0,this.upgrading=!1,this._socket.on("data",this._onSocketData),n.removeListener("close",this._onSocketClose),n.removeListener("end",this._onSocketEnd),e(null,!0)))}catch(o){return e(o)}this._socket.on("error",this._onSocketError),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||da),this._socket.on("timeout",this._onSocketTimeout),n.resume()}_processResponse(){if(!this._responseQueue.length)return!1;let e=this.lastServerResponse=(this._responseQueue.shift()||"").toString();if(/^\d+-/.test(e.split(`
`).pop()))return;(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"server"},e.replace(/\r?\n$/,"")),e.trim()||setImmediate(()=>this._processResponse());let n=this._responseActions.shift();if(typeof n=="function")n.call(this,e),setImmediate(()=>this._processResponse());else return this._onError(new Error("Unexpected Response"),"EPROTOCOL",e,"CONN")}_sendCommand(e,n){if(!this._destroyed){if(this._socket.destroyed)return this.close();(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"client"},(n||e||"").toString().replace(/\r?\n$/,"")),this._socket.write(Buffer.from(e+`\r
`,"utf-8"))}}_setEnvelope(e,n){let r=[],o=!1;if(this._envelope=e||{},this._envelope.from=(this._envelope.from&&this._envelope.from.address||this._envelope.from||"").toString().trim(),this._envelope.to=[].concat(this._envelope.to||[]).map(i=>(i&&i.address||i||"").toString().trim()),!this._envelope.to.length)return n(this._formatError("No recipients defined","EENVELOPE",!1,"API"));if(this._envelope.from&&/[\r\n<>]/.test(this._envelope.from))return n(this._formatError("Invalid sender "+JSON.stringify(this._envelope.from),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.from)&&(o=!0);for(let i=0,s=this._envelope.to.length;i<s;i++){if(!this._envelope.to[i]||/[\r\n<>]/.test(this._envelope.to[i]))return n(this._formatError("Invalid recipient "+JSON.stringify(this._envelope.to[i]),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.to[i])&&(o=!0)}if(this._envelope.rcptQueue=JSON.parse(JSON.stringify(this._envelope.to||[])),this._envelope.rejected=[],this._envelope.rejectedErrors=[],this._envelope.accepted=[],this._envelope.dsn)try{this._envelope.dsn=this._setDsnEnvelope(this._envelope.dsn)}catch(i){return n(this._formatError("Invalid DSN "+i.message,"EENVELOPE",!1,"API"))}this._responseActions.push(i=>{this._actionMAIL(i,n)}),o&&this._supportedExtensions.includes("SMTPUTF8")&&(r.push("SMTPUTF8"),this._usingSmtpUtf8=!0),this._envelope.use8BitMime&&this._supportedExtensions.includes("8BITMIME")&&(r.push("BODY=8BITMIME"),this._using8BitMime=!0),this._envelope.size&&this._supportedExtensions.includes("SIZE")&&r.push("SIZE="+this._envelope.size),this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.ret&&r.push("RET="+ot.encodeXText(this._envelope.dsn.ret)),this._envelope.dsn.envid&&r.push("ENVID="+ot.encodeXText(this._envelope.dsn.envid))),this._sendCommand("MAIL FROM:<"+this._envelope.from+">"+(r.length?" "+r.join(" "):""))}_setDsnEnvelope(e){let n=(e.ret||e.return||"").toString().toUpperCase()||null;if(n)switch(n){case"HDRS":case"HEADERS":n="HDRS";break;case"FULL":case"BODY":n="FULL";break}if(n&&!["FULL","HDRS"].includes(n))throw new Error("ret: "+JSON.stringify(n));let r=(e.envid||e.id||"").toString()||null,o=e.notify||null;if(o){typeof o=="string"&&(o=o.split(",")),o=o.map(c=>c.trim().toUpperCase());let s=["NEVER","SUCCESS","FAILURE","DELAY"];if(o.filter(c=>!s.includes(c)).length||o.length>1&&o.includes("NEVER"))throw new Error("notify: "+JSON.stringify(o.join(",")));o=o.join(",")}let i=(e.recipient||e.orcpt||"").toString()||null;return i&&i.indexOf(";")<0&&(i="rfc822;"+i),{ret:n,envid:r,notify:o,orcpt:i}}_getDsnRcptToArgs(){let e=[];return this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.notify&&e.push("NOTIFY="+ot.encodeXText(this._envelope.dsn.notify)),this._envelope.dsn.orcpt&&e.push("ORCPT="+ot.encodeXText(this._envelope.dsn.orcpt))),e.length?" "+e.join(" "):""}_createSendStream(e){let n=new Zy,r;return this.options.lmtp?this._envelope.accepted.forEach((o,i)=>{let s=i===this._envelope.accepted.length-1;this._responseActions.push(a=>{this._actionLMTPStream(o,s,a,e)})}):this._responseActions.push(o=>{this._actionSMTPStream(o,e)}),n.pipe(this._socket,{end:!1}),this.options.debug&&(r=new la,r.on("readable",()=>{let o;for(;o=r.read();)this.logger.debug({tnx:"message"},o.toString("binary").replace(/\r?\n$/,""))}),n.pipe(r)),n.once("end",()=>{this.logger.info({tnx:"message",inByteCount:n.inByteCount,outByteCount:n.outByteCount},"<%s bytes encoded mime message (source size %s bytes)>",n.outByteCount,n.inByteCount)}),n}_actionGreeting(e){if(clearTimeout(this._greetingTimeout),e.substr(0,3)!=="220"){this._onError(new Error("Invalid greeting. response="+e),"EPROTOCOL",e,"CONN");return}this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name))}_actionLHLO(e){if(e.charAt(0)!=="2"){this._onError(new Error("Invalid LHLO. response="+e),"EPROTOCOL",e,"LHLO");return}this._actionEHLO(e)}_actionEHLO(e){let n;if(e.substr(0,3)==="421"){this._onError(new Error("Server terminates connection. response="+e),"ECONNECTION",e,"EHLO");return}if(e.charAt(0)!=="2"){if(this.options.requireTLS){this._onError(new Error("EHLO failed but HELO does not support required STARTTLS. response="+e),"ECONNECTION",e,"EHLO");return}this._responseActions.push(this._actionHELO),this._sendCommand("HELO "+this.name);return}if(this._ehloLines=e.split(/\r?\n/).map(r=>r.replace(/^\d+[ -]/,"").trim()).filter(r=>r).slice(1),!this.secure&&!this.options.ignoreTLS&&(/[ -]STARTTLS\b/im.test(e)||this.options.requireTLS)){this._sendCommand("STARTTLS"),this._responseActions.push(this._actionSTARTTLS);return}/[ -]SMTPUTF8\b/im.test(e)&&this._supportedExtensions.push("SMTPUTF8"),/[ -]DSN\b/im.test(e)&&this._supportedExtensions.push("DSN"),/[ -]8BITMIME\b/im.test(e)&&this._supportedExtensions.push("8BITMIME"),/[ -]PIPELINING\b/im.test(e)&&this._supportedExtensions.push("PIPELINING"),/[ -]AUTH\b/i.test(e)&&(this.allowsAuth=!0),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)PLAIN/i.test(e)&&this._supportedAuth.push("PLAIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)LOGIN/i.test(e)&&this._supportedAuth.push("LOGIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)CRAM-MD5/i.test(e)&&this._supportedAuth.push("CRAM-MD5"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)XOAUTH2/i.test(e)&&this._supportedAuth.push("XOAUTH2"),(n=e.match(/[ -]SIZE(?:[ \t]+(\d+))?/im))&&(this._supportedExtensions.push("SIZE"),this._maxAllowedSize=Number(n[1])||0),this.emit("connect")}_actionHELO(e){if(e.charAt(0)!=="2"){this._onError(new Error("Invalid HELO. response="+e),"EPROTOCOL",e,"HELO");return}this.allowsAuth=!0,this.emit("connect")}_actionSTARTTLS(e){if(e.charAt(0)!=="2"){if(this.options.opportunisticTLS)return this.logger.info({tnx:"smtp"},"Failed STARTTLS upgrade, continuing unencrypted"),this.emit("connect");this._onError(new Error("Error upgrading connection with STARTTLS"),"ETLS",e,"STARTTLS");return}this._upgradeConnection((n,r)=>{if(n){this._onError(new Error("Error initiating TLS - "+(n.message||n)),"ETLS",!1,"STARTTLS");return}this.logger.info({tnx:"smtp"},"Connection upgraded with STARTTLS"),r?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)):this.emit("connect")})}_actionAUTH_LOGIN_USER(e,n){if(!/^334[ -]/.test(e)){n(this._formatError('Invalid login sequence while waiting for "334 VXNlcm5hbWU6"',"EAUTH",e,"AUTH LOGIN"));return}this._responseActions.push(r=>{this._actionAUTH_LOGIN_PASS(r,n)}),this._sendCommand(Buffer.from(this._auth.credentials.user+"","utf-8").toString("base64"))}_actionAUTH_CRAM_MD5(e,n){let r=e.match(/^334\s+(.+)$/),o="";if(r)o=r[1];else return n(this._formatError("Invalid login sequence while waiting for server challenge string","EAUTH",e,"AUTH CRAM-MD5"));let i=Buffer.from(o,"base64").toString("ascii"),s=ca.createHmac("md5",this._auth.credentials.pass);s.update(i);let a=this._auth.credentials.user+" "+s.digest("hex");this._responseActions.push(c=>{this._actionAUTH_CRAM_MD5_PASS(c,n)}),this._sendCommand(Buffer.from(a).toString("base64"),Buffer.from(this._auth.credentials.user+" /* secret */").toString("base64"))}_actionAUTH_CRAM_MD5_PASS(e,n){if(!e.match(/^235\s+/))return n(this._formatError('Invalid login sequence while waiting for "235"',"EAUTH",e,"AUTH CRAM-MD5"));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,n(null,!0)}_actionAUTH_LOGIN_PASS(e,n){if(!/^334[ -]/.test(e))return n(this._formatError('Invalid login sequence while waiting for "334 UGFzc3dvcmQ6"',"EAUTH",e,"AUTH LOGIN"));this._responseActions.push(r=>{this._actionAUTHComplete(r,n)}),this._sendCommand(Buffer.from((this._auth.credentials.pass||"").toString(),"utf-8").toString("base64"),Buffer.from("/* secret */","utf-8").toString("base64"))}_actionAUTHComplete(e,n,r){if(!r&&typeof n=="function"&&(r=n,n=!1),e.substr(0,3)==="334"){this._responseActions.push(o=>{n||this._authMethod!=="XOAUTH2"?this._actionAUTHComplete(o,!0,r):setImmediate(()=>this._handleXOauth2Token(!0,r))}),this._sendCommand("");return}if(e.charAt(0)!=="2")return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),r(this._formatError("Invalid login","EAUTH",e,"AUTH "+this._authMethod));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,r(null,!0)}_actionMAIL(e,n){let r,o;if(Number(e.charAt(0))!==2)return this._usingSmtpUtf8&&/^550 /.test(e)&&/[\x80-\uFFFF]/.test(this._envelope.from)?r="Internationalized mailbox name not allowed":r="Mail command failed",n(this._formatError(r,"EENVELOPE",e,"MAIL FROM"));if(this._envelope.rcptQueue.length)if(this._recipientQueue=[],this._supportedExtensions.includes("PIPELINING"))for(;this._envelope.rcptQueue.length;)o=this._envelope.rcptQueue.shift(),this._recipientQueue.push(o),this._responseActions.push(i=>{this._actionRCPT(i,n)}),this._sendCommand("RCPT TO:<"+o+">"+this._getDsnRcptToArgs());else o=this._envelope.rcptQueue.shift(),this._recipientQueue.push(o),this._responseActions.push(i=>{this._actionRCPT(i,n)}),this._sendCommand("RCPT TO:<"+o+">"+this._getDsnRcptToArgs());else return n(this._formatError("Can't send mail - no recipients defined","EENVELOPE",!1,"API"))}_actionRCPT(e,n){let r,o,i=this._recipientQueue.shift();if(Number(e.charAt(0))!==2?(this._usingSmtpUtf8&&/^553 /.test(e)&&/[\x80-\uFFFF]/.test(i)?r="Internationalized mailbox name not allowed":r="Recipient command failed",this._envelope.rejected.push(i),o=this._formatError(r,"EENVELOPE",e,"RCPT TO"),o.recipient=i,this._envelope.rejectedErrors.push(o)):this._envelope.accepted.push(i),!this._envelope.rcptQueue.length&&!this._recipientQueue.length)if(this._envelope.rejected.length<this._envelope.to.length)this._responseActions.push(s=>{this._actionDATA(s,n)}),this._sendCommand("DATA");else return o=this._formatError("Can't send mail - all recipients were rejected","EENVELOPE",e,"RCPT TO"),o.rejected=this._envelope.rejected,o.rejectedErrors=this._envelope.rejectedErrors,n(o);else this._envelope.rcptQueue.length&&(i=this._envelope.rcptQueue.shift(),this._recipientQueue.push(i),this._responseActions.push(s=>{this._actionRCPT(s,n)}),this._sendCommand("RCPT TO:<"+i+">"+this._getDsnRcptToArgs()))}_actionDATA(e,n){if(!/^[23]/.test(e))return n(this._formatError("Data command failed","EENVELOPE",e,"DATA"));let r={accepted:this._envelope.accepted,rejected:this._envelope.rejected};this._ehloLines&&this._ehloLines.length&&(r.ehlo=this._ehloLines),this._envelope.rejectedErrors.length&&(r.rejectedErrors=this._envelope.rejectedErrors),n(null,r)}_actionSMTPStream(e,n){return Number(e.charAt(0))!==2?n(this._formatError("Message failed","EMESSAGE",e,"DATA")):n(null,e)}_actionLMTPStream(e,n,r,o){let i;if(Number(r.charAt(0))!==2){i=this._formatError("Message failed for recipient "+e,"EMESSAGE",r,"DATA"),i.recipient=e,this._envelope.rejected.push(e),this._envelope.rejectedErrors.push(i);for(let s=0,a=this._envelope.accepted.length;s<a;s++)this._envelope.accepted[s]===e&&this._envelope.accepted.splice(s,1)}if(n)return o(null,r)}_handleXOauth2Token(e,n){this._auth.oauth2.getToken(e,(r,o)=>{if(r)return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),n(this._formatError(r,"EAUTH",!1,"AUTH XOAUTH2"));this._responseActions.push(i=>{this._actionAUTHComplete(i,e,n)}),this._sendCommand("AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token(o),"AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token("/* secret */"))})}_isDestroyedMessage(e){if(this._destroyed)return"Cannot "+e+" - smtp connection is already destroyed.";if(this._socket){if(this._socket.destroyed)return"Cannot "+e+" - smtp connection socket is already destroyed.";if(!this._socket.writable)return"Cannot "+e+" - smtp connection socket is already half-closed."}}_getHostname(){let e;try{e=Jy.hostname()||""}catch{e="localhost"}return(!e||e.indexOf(".")<0)&&(e="[127.0.0.1]"),e.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)&&(e="["+e+"]"),e}};var Ki=rw;const ow=V.Stream,iw=Lr,sw=V,aw=Ae;let cw=class extends ow{constructor(e,n){if(super(),this.options=e||{},e&&e.serviceClient){if(!e.privateKey||!e.user){setImmediate(()=>this.emit("error",new Error('Options "privateKey" and "user" are required for service account!')));return}let r=Math.min(Math.max(Number(this.options.serviceRequestTimeout)||0,0),3600);this.options.serviceRequestTimeout=r||5*60}if(this.logger=aw.getLogger({logger:n},{component:this.options.component||"OAuth2"}),this.provisionCallback=typeof this.options.provisionCallback=="function"?this.options.provisionCallback:!1,this.options.accessUrl=this.options.accessUrl||"https://accounts.google.com/o/oauth2/token",this.options.customHeaders=this.options.customHeaders||{},this.options.customParams=this.options.customParams||{},this.accessToken=this.options.accessToken||!1,this.options.expires&&Number(this.options.expires))this.expires=this.options.expires;else{let r=Math.max(Number(this.options.timeout)||0,0);this.expires=r&&Date.now()+r*1e3||0}this.renewing=!1,this.renewalQueue=[]}getToken(e,n){if(!e&&this.accessToken&&(!this.expires||this.expires>Date.now()))return this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"reuse"},"Reusing existing access token for %s",this.options.user),n(null,this.accessToken);if(!this.provisionCallback&&!this.options.refreshToken&&!this.options.serviceClient)return this.accessToken?(this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"reuse"},"Reusing existing access token (no refresh capability) for %s",this.options.user),n(null,this.accessToken)):(this.logger.error({tnx:"OAUTH2",user:this.options.user,action:"renew"},"Cannot renew access token for %s: No refresh mechanism available",this.options.user),n(new Error("Can't create new access token for user")));if(this.renewing)return this.renewalQueue.push({renew:e,callback:n});this.renewing=!0;const r=(o,i)=>{this.renewalQueue.forEach(s=>s.callback(o,i)),this.renewalQueue=[],this.renewing=!1,o?this.logger.error({err:o,tnx:"OAUTH2",user:this.options.user,action:"renew"},"Failed generating new Access Token for %s",this.options.user):this.logger.info({tnx:"OAUTH2",user:this.options.user,action:"renew"},"Generated new Access Token for %s",this.options.user),n(o,i)};this.provisionCallback?this.provisionCallback(this.options.user,!!e,(o,i,s)=>{!o&&i&&(this.accessToken=i,this.expires=s||0),r(o,i)}):this.generateToken(r)}updateToken(e,n){this.accessToken=e,n=Math.max(Number(n)||0,0),this.expires=n&&Date.now()+n*1e3||0,this.emit("token",{user:this.options.user,accessToken:e||"",expires:this.expires})}generateToken(e){let n,r;if(this.options.serviceClient){let o=Math.floor(Date.now()/1e3),i={iss:this.options.serviceClient,scope:this.options.scope||"https://mail.google.com/",sub:this.options.user,aud:this.options.accessUrl,iat:o,exp:o+this.options.serviceRequestTimeout},s;try{s=this.jwtSignRS256(i)}catch{return e(new Error("Can't generate token. Check your auth options"))}n={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:s},r={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:i}}else{if(!this.options.refreshToken)return e(new Error("Can't create new access token for user"));n={client_id:this.options.clientId||"",client_secret:this.options.clientSecret||"",refresh_token:this.options.refreshToken,grant_type:"refresh_token"},r={client_id:this.options.clientId||"",client_secret:(this.options.clientSecret||"").substr(0,6)+"...",refresh_token:(this.options.refreshToken||"").substr(0,6)+"...",grant_type:"refresh_token"}}Object.keys(this.options.customParams).forEach(o=>{n[o]=this.options.customParams[o],r[o]=this.options.customParams[o]}),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"generate"},"Requesting token using: %s",JSON.stringify(r)),this.postRequest(this.options.accessUrl,n,this.options,(o,i)=>{let s;if(o)return e(o);try{s=JSON.parse(i.toString())}catch(c){return e(c)}if(!s||typeof s!="object")return this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",(i||"").toString()),e(new Error("Invalid authentication response"));let a={};if(Object.keys(s).forEach(c=>{c!=="access_token"?a[c]=s[c]:a[c]=(s[c]||"").toString().substr(0,6)+"..."}),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",JSON.stringify(a)),s.error){let c=s.error;return s.error_description&&(c+=": "+s.error_description),s.error_uri&&(c+=" ("+s.error_uri+")"),e(new Error(c))}return s.access_token?(this.updateToken(s.access_token,s.expires_in),e(null,this.accessToken)):e(new Error("No access token"))})}buildXOAuth2Token(e){let n=["user="+(this.options.user||""),"auth=Bearer "+(e||this.accessToken),"",""];return Buffer.from(n.join(""),"utf-8").toString("base64")}postRequest(e,n,r,o){let i=!1,s=[],a=0,c=iw(e,{method:"post",headers:r.customHeaders,body:n,allowErrorResponse:!0});c.on("readable",()=>{let p;for(;(p=c.read())!==null;)s.push(p),a+=p.length}),c.once("error",p=>{if(!i)return i=!0,o(p)}),c.once("end",()=>{if(!i)return i=!0,o(null,Buffer.concat(s,a))})}toBase64URL(e){return typeof e=="string"&&(e=Buffer.from(e)),e.toString("base64").replace(/[=]+/g,"").replace(/\+/g,"-").replace(/\//g,"_")}jwtSignRS256(e){e=['{"alg":"RS256","typ":"JWT"}',JSON.stringify(e)].map(r=>this.toBase64URL(r)).join(".");let n=sw.createSign("RSA-SHA256").update(e).sign(this.options.privateKey);return e+"."+this.toBase64URL(n)}};var yd=cw;const lw=Ki,dw=Ae.assign,pw=yd,uw=V;let fw=class extends uw{constructor(e){if(super(),this.pool=e,this.options=e.options,this.logger=this.pool.logger,this.options.auth)switch((this.options.auth.type||"").toString().toUpperCase()){case"OAUTH2":{let n=new pw(this.options.auth,this.logger);n.provisionCallback=this.pool.mailer&&this.pool.mailer.get("oauth2_provision_cb")||n.provisionCallback,this.auth={type:"OAUTH2",user:this.options.auth.user,oauth2:n,method:"XOAUTH2"},n.on("token",r=>this.pool.mailer.emit("token",r)),n.on("error",r=>this.emit("error",r));break}default:if(!this.options.auth.user&&!this.options.auth.pass)break;this.auth={type:(this.options.auth.type||"").toString().toUpperCase()||"LOGIN",user:this.options.auth.user,credentials:{user:this.options.auth.user||"",pass:this.options.auth.pass,options:this.options.auth.options},method:(this.options.auth.method||"").trim().toUpperCase()||this.options.authMethod||!1}}this._connection=!1,this._connected=!1,this.messages=0,this.available=!0}connect(e){this.pool.getSocket(this.options,(n,r)=>{if(n)return e(n);let o=!1,i=this.options;r&&r.connection&&(this.logger.info({tnx:"proxy",remoteAddress:r.connection.remoteAddress,remotePort:r.connection.remotePort,destHost:i.host||"",destPort:i.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",r.connection.remoteAddress,r.connection.remotePort,i.host||"",i.port||""),i=dw(!1,i),Object.keys(r).forEach(s=>{i[s]=r[s]})),this.connection=new lw(i),this.connection.once("error",s=>{if(this.emit("error",s),!o)return o=!0,e(s)}),this.connection.once("end",()=>{if(this.close(),o)return;o=!0;let s=setTimeout(()=>{if(o)return;let a=new Error("Unexpected socket close");this.connection&&this.connection._socket&&this.connection._socket.upgrading&&(a.code="ETLS"),e(a)},1e3);try{s.unref()}catch{}}),this.connection.connect(()=>{if(!o)if(this.auth&&(this.connection.allowsAuth||i.forceAuth))this.connection.login(this.auth,s=>{if(!o){if(o=!0,s)return this.connection.close(),this.emit("error",s),e(s);this._connected=!0,e(null,!0)}});else return o=!0,this._connected=!0,e(null,!0)})})}send(e,n){if(!this._connected)return this.connect(s=>s?n(s):this.send(e,n));let r=e.message.getEnvelope(),o=e.message.messageId(),i=[].concat(r.to||[]);i.length>3&&i.push("...and "+i.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:o,cid:this.id},"Sending message %s using #%s to <%s>",o,this.id,i.join(", ")),e.data.dsn&&(r.dsn=e.data.dsn),this.connection.send(r,e.message.createReadStream(),(s,a)=>{if(this.messages++,s)return this.connection.close(),this.emit("error",s),n(s);a.envelope={from:r.from,to:r.to},a.messageId=o,setImmediate(()=>{let c;this.messages>=this.options.maxMessages?(c=new Error("Resource exhausted"),c.code="EMAXLIMIT",this.connection.close(),this.emit("error",c)):this.pool._checkRateLimit(()=>{this.available=!0,this.emit("available")})}),n(null,a)})}close(){this._connected=!1,this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.connection&&this.connection.close(),this.emit("close")}};var mw=fw;const hw={description:"Alibaba Cloud Mail",domains:["aliyun.com"],host:"smtp.aliyun.com",port:465,secure:!0},gw={description:"Alibaba Cloud Enterprise Mail",host:"smtp.qiye.aliyun.com",port:465,secure:!0},vw={description:"AOL Mail",domains:["aol.com"],host:"smtp.aol.com",port:587},xw={description:"Aruba PEC (Italian email provider)",domains:["aruba.it","pec.aruba.it"],aliases:["Aruba PEC"],host:"smtps.aruba.it",port:465,secure:!0,authMethod:"LOGIN"},yw={description:"Bluewin (Swiss email provider)",host:"smtpauths.bluewin.ch",domains:["bluewin.ch"],port:465},ww={description:"BOL Mail (Brazilian provider)",domains:["bol.com.br"],host:"smtp.bol.com.br",port:587,requireTLS:!0},bw={description:"DebugMail (email testing service)",host:"debugmail.io",port:25},Sw={description:"Disroot (privacy-focused provider)",domains:["disroot.org"],host:"disroot.org",port:587,secure:!1,authMethod:"LOGIN"},_w={description:"Dyn Email Delivery",aliases:["Dynect"],host:"smtp.dynect.net",port:25},Ew={description:"Elastic Email",aliases:["Elastic Email"],host:"smtp.elasticemail.com",port:465,secure:!0},Cw={description:"Ethereal Email (email testing service)",aliases:["ethereal.email"],host:"smtp.ethereal.email",port:587},Tw={description:"FastMail",domains:["fastmail.fm"],host:"smtp.fastmail.com",port:465,secure:!0},kw={description:"Gandi Mail",aliases:["Gandi","Gandi Mail"],host:"mail.gandi.net",port:587},Aw={description:"Gmail",aliases:["Google Mail"],domains:["gmail.com","googlemail.com"],host:"smtp.gmail.com",port:465,secure:!0},Nw={description:"GMX Mail",domains:["gmx.com","gmx.net","gmx.de"],host:"mail.gmx.com",port:587},jw={description:"GoDaddy Email (US)",host:"smtpout.secureserver.net",port:25},Rw={description:"GoDaddy Email (Asia)",host:"smtp.asia.secureserver.net",port:25},Mw={description:"GoDaddy Email (Europe)",host:"smtp.europe.secureserver.net",port:25},Pw={description:"Outlook.com / Hotmail",aliases:["Outlook","Outlook.com","Hotmail.com"],domains:["hotmail.com","outlook.com"],host:"smtp-mail.outlook.com",port:587},Iw={description:"iCloud Mail",aliases:["Me","Mac"],domains:["me.com","mac.com"],host:"smtp.mail.me.com",port:587},Ow={description:"Infomaniak Mail (Swiss hosting provider)",host:"mail.infomaniak.com",domains:["ik.me","ikmail.com","etik.com"],port:587},Lw={description:"KolabNow (secure email service)",domains:["kolabnow.com"],aliases:["Kolab"],host:"smtp.kolabnow.com",port:465,secure:!0,authMethod:"LOGIN"},Dw={description:"Loopia (Swedish hosting provider)",host:"mailcluster.loopia.se",port:465},zw={description:"Loops",host:"smtp.loops.so",port:587},Fw={description:"MailDev (local email testing)",port:1025,ignoreTLS:!0},$w={description:"MailerSend",host:"smtp.mailersend.net",port:587},Uw={description:"Mailgun",host:"smtp.mailgun.org",port:465,secure:!0},Hw={description:"Mailjet",host:"in.mailjet.com",port:587},Bw={description:"Mailosaur (email testing service)",host:"mailosaur.io",port:25},Vw={description:"Mailtrap",host:"live.smtp.mailtrap.io",port:587},qw={description:"Mandrill (by Mailchimp)",host:"smtp.mandrillapp.com",port:587},Gw={description:"Naver Mail (Korean email provider)",host:"smtp.naver.com",port:587},Ww={description:"OhMySMTP (email delivery service)",host:"smtp.ohmysmtp.com",port:587,secure:!1},Kw={description:"One.com Email",host:"send.one.com",port:465,secure:!0},Yw={description:"OpenMailBox",aliases:["OMB","openmailbox.org"],host:"smtp.openmailbox.org",port:465,secure:!0},Xw={description:"Microsoft 365 / Office 365",host:"smtp.office365.com",port:587,secure:!1},Qw={description:"Postmark",aliases:["PostmarkApp"],host:"smtp.postmarkapp.com",port:2525},Jw={description:"Proton Mail",aliases:["ProtonMail","Proton.me","Protonmail.com","Protonmail.ch"],domains:["proton.me","protonmail.com","pm.me","protonmail.ch"],host:"smtp.protonmail.ch",port:587,requireTLS:!0},Zw={description:"QQ Mail",domains:["qq.com"],host:"smtp.qq.com",port:465,secure:!0},eb={description:"QQ Enterprise Mail",aliases:["QQ Enterprise"],domains:["exmail.qq.com"],host:"smtp.exmail.qq.com",port:465,secure:!0},tb={description:"Resend",host:"smtp.resend.com",port:465,secure:!0},nb={description:"Runbox (Norwegian email provider)",domains:["runbox.com"],host:"smtp.runbox.com",port:465,secure:!0},rb={description:"SendCloud (Chinese email delivery)",host:"smtp.sendcloud.net",port:2525},ob={description:"SendGrid",host:"smtp.sendgrid.net",port:587},ib={description:"Brevo (formerly Sendinblue)",aliases:["Brevo"],host:"smtp-relay.brevo.com",port:587},sb={description:"SendPulse",host:"smtp-pulse.com",port:465,secure:!0},ab={description:"AWS SES US East (N. Virginia)",host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},cb={description:"Seznam Email (Czech email provider)",aliases:["Seznam Email"],domains:["seznam.cz","email.cz","post.cz","spoluzaci.cz"],host:"smtp.seznam.cz",port:465,secure:!0},lb={description:"SMTP2GO",host:"mail.smtp2go.com",port:2525},db={description:"SparkPost",aliases:["SparkPost","SparkPost Mail"],domains:["sparkpost.com"],host:"smtp.sparkpostmail.com",port:587,secure:!1},pb={description:"Tipimail (email delivery service)",host:"smtp.tipimail.com",port:587},ub={description:"Tutanota (Tuta Mail)",domains:["tutanota.com","tuta.com","tutanota.de","tuta.io"],host:"smtp.tutanota.com",port:465,secure:!0},fb={description:"Yahoo Mail",domains:["yahoo.com"],host:"smtp.mail.yahoo.com",port:465,secure:!0},mb={description:"Yandex Mail",domains:["yandex.ru"],host:"smtp.yandex.ru",port:465,secure:!0},hb={description:"Zimbra Mail Server",aliases:["Zimbra Collaboration"],host:"smtp.zimbra.com",port:587,requireTLS:!0},gb={description:"Zoho Mail",host:"smtp.zoho.com",port:465,secure:!0,authMethod:"LOGIN"},vb={126:{description:"126 Mail (NetEase)",host:"smtp.126.com",port:465,secure:!0},163:{description:"163 Mail (NetEase)",host:"smtp.163.com",port:465,secure:!0},"1und1":{description:"1&1 Mail (German hosting provider)",host:"smtp.1und1.de",port:465,secure:!0,authMethod:"LOGIN"},Aliyun:hw,AliyunQiye:gw,AOL:vw,Aruba:xw,Bluewin:yw,BOL:ww,DebugMail:bw,Disroot:Sw,DynectEmail:_w,ElasticEmail:Ew,Ethereal:Cw,FastMail:Tw,"Feishu Mail":{description:"Feishu Mail (Lark)",aliases:["Feishu","FeishuMail"],domains:["www.feishu.cn"],host:"smtp.feishu.cn",port:465,secure:!0},"Forward Email":{description:"Forward Email (email forwarding service)",aliases:["FE","ForwardEmail"],domains:["forwardemail.net"],host:"smtp.forwardemail.net",port:465,secure:!0},GandiMail:kw,Gmail:Aw,GMX:Nw,Godaddy:jw,GodaddyAsia:Rw,GodaddyEurope:Mw,"hot.ee":{description:"Hot.ee (Estonian email provider)",host:"mail.hot.ee"},Hotmail:Pw,iCloud:Iw,Infomaniak:Ow,KolabNow:Lw,Loopia:Dw,Loops:zw,"mail.ee":{description:"Mail.ee (Estonian email provider)",host:"smtp.mail.ee"},"Mail.ru":{description:"Mail.ru",host:"smtp.mail.ru",port:465,secure:!0},"Mailcatch.app":{description:"Mailcatch (email testing service)",host:"sandbox-smtp.mailcatch.app",port:2525},Maildev:Fw,MailerSend:$w,Mailgun:Uw,Mailjet:Hw,Mailosaur:Bw,Mailtrap:Vw,Mandrill:qw,Naver:Gw,OhMySMTP:Ww,One:Kw,OpenMailBox:Yw,Outlook365:Xw,Postmark:Qw,Proton:Jw,"qiye.aliyun":{description:"Alibaba Mail Enterprise Edition",host:"smtp.mxhichina.com",port:"465",secure:!0},QQ:Zw,QQex:eb,Resend:tb,Runbox:nb,SendCloud:rb,SendGrid:ob,SendinBlue:ib,SendPulse:sb,SES:ab,"SES-AP-NORTHEAST-1":{description:"AWS SES Asia Pacific (Tokyo)",host:"email-smtp.ap-northeast-1.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-2":{description:"AWS SES Asia Pacific (Seoul)",host:"email-smtp.ap-northeast-2.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-3":{description:"AWS SES Asia Pacific (Osaka)",host:"email-smtp.ap-northeast-3.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTH-1":{description:"AWS SES Asia Pacific (Mumbai)",host:"email-smtp.ap-south-1.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTHEAST-1":{description:"AWS SES Asia Pacific (Singapore)",host:"email-smtp.ap-southeast-1.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTHEAST-2":{description:"AWS SES Asia Pacific (Sydney)",host:"email-smtp.ap-southeast-2.amazonaws.com",port:465,secure:!0},"SES-CA-CENTRAL-1":{description:"AWS SES Canada (Central)",host:"email-smtp.ca-central-1.amazonaws.com",port:465,secure:!0},"SES-EU-CENTRAL-1":{description:"AWS SES Europe (Frankfurt)",host:"email-smtp.eu-central-1.amazonaws.com",port:465,secure:!0},"SES-EU-NORTH-1":{description:"AWS SES Europe (Stockholm)",host:"email-smtp.eu-north-1.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-1":{description:"AWS SES Europe (Ireland)",host:"email-smtp.eu-west-1.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-2":{description:"AWS SES Europe (London)",host:"email-smtp.eu-west-2.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-3":{description:"AWS SES Europe (Paris)",host:"email-smtp.eu-west-3.amazonaws.com",port:465,secure:!0},"SES-SA-EAST-1":{description:"AWS SES South America (São Paulo)",host:"email-smtp.sa-east-1.amazonaws.com",port:465,secure:!0},"SES-US-EAST-1":{description:"AWS SES US East (N. Virginia)",host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-EAST-2":{description:"AWS SES US East (Ohio)",host:"email-smtp.us-east-2.amazonaws.com",port:465,secure:!0},"SES-US-GOV-EAST-1":{description:"AWS SES GovCloud (US-East)",host:"email-smtp.us-gov-east-1.amazonaws.com",port:465,secure:!0},"SES-US-GOV-WEST-1":{description:"AWS SES GovCloud (US-West)",host:"email-smtp.us-gov-west-1.amazonaws.com",port:465,secure:!0},"SES-US-WEST-1":{description:"AWS SES US West (N. California)",host:"email-smtp.us-west-1.amazonaws.com",port:465,secure:!0},"SES-US-WEST-2":{description:"AWS SES US West (Oregon)",host:"email-smtp.us-west-2.amazonaws.com",port:465,secure:!0},Seznam:cb,SMTP2GO:lb,Sparkpost:db,Tipimail:pb,Tutanota:ub,Yahoo:fb,Yandex:mb,Zimbra:hb,Zoho:gb},pa=vb,Zn={};Object.keys(pa).forEach(t=>{let e=pa[t];Zn[er(t)]=xo(e),[].concat(e.aliases||[]).forEach(n=>{Zn[er(n)]=xo(e)}),[].concat(e.domains||[]).forEach(n=>{Zn[er(n)]=xo(e)})});function er(t){return t.replace(/[^a-zA-Z0-9.-]/g,"").toLowerCase()}function xo(t){let e=["domains","aliases"],n={};return Object.keys(t).forEach(r=>{e.indexOf(r)<0&&(n[r]=t[r])}),n}var wd=function(t){return t=er(t.split("@").pop()),Zn[t]||!1};const xb=V,ua=mw,fa=Ki,yb=wd,hn=Ae,wb=tt;let bb=class extends xb{constructor(e){super(),e=e||{},typeof e=="string"&&(e={url:e});let n,r=e.service;typeof e.getSocket=="function"&&(this.getSocket=e.getSocket),e.url&&(n=hn.parseConnectionUrl(e.url),r=r||n.service),this.options=hn.assign(!1,e,n,r&&yb(r)),this.options.maxConnections=this.options.maxConnections||5,this.options.maxMessages=this.options.maxMessages||100,this.logger=hn.getLogger(this.options,{component:this.options.component||"smtp-pool"});let o=new fa(this.options);this.name="SMTP (pool)",this.version=wb.version+"[client:"+o.version+"]",this._rateLimit={counter:0,timeout:null,waiting:[],checkpoint:!1,delta:Number(this.options.rateDelta)||1e3,limit:Number(this.options.rateLimit)||0},this._closed=!1,this._queue=[],this._connections=[],this._connectionCounter=0,this.idling=!0,setImmediate(()=>{this.idling&&this.emit("idle")})}getSocket(e,n){return setImmediate(()=>n(null,!1))}send(e,n){return this._closed?!1:(this._queue.push({mail:e,requeueAttempts:0,callback:n}),this.idling&&this._queue.length>=this.options.maxConnections&&(this.idling=!1),setImmediate(()=>this._processMessages()),!0)}close(){let e,n=this._connections.length;if(this._closed=!0,clearTimeout(this._rateLimit.timeout),!n&&!this._queue.length)return;for(let o=n-1;o>=0;o--)this._connections[o]&&this._connections[o].available&&(e=this._connections[o],e.close(),this.logger.info({tnx:"connection",cid:e.id,action:"removed"},"Connection #%s removed",e.id));if(n&&!this._connections.length&&this.logger.debug({tnx:"connection"},"All connections removed"),!this._queue.length)return;let r=()=>{if(!this._queue.length){this.logger.debug({tnx:"connection"},"Pending queue entries cleared");return}let o=this._queue.shift();if(o&&typeof o.callback=="function")try{o.callback(new Error("Connection pool was closed"))}catch(i){this.logger.error({err:i,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,i.message)}setImmediate(r)};setImmediate(r)}_processMessages(){let e,n,r;if(this._closed)return;if(!this._queue.length){this.idling||(this.idling=!0,this.emit("idle"));return}for(n=0,r=this._connections.length;n<r;n++)if(this._connections[n].available){e=this._connections[n];break}if(!e&&this._connections.length<this.options.maxConnections&&(e=this._createConnection()),!e){this.idling=!1;return}!this.idling&&this._queue.length<this.options.maxConnections&&(this.idling=!0,this.emit("idle"));let o=e.queueEntry=this._queue.shift();o.messageId=(e.queueEntry.mail.message.getHeader("message-id")||"").replace(/[<>\s]/g,""),e.available=!1,this.logger.debug({tnx:"pool",cid:e.id,messageId:o.messageId,action:"assign"},"Assigned message <%s> to #%s (%s)",o.messageId,e.id,e.messages+1),this._rateLimit.limit&&(this._rateLimit.counter++,this._rateLimit.checkpoint||(this._rateLimit.checkpoint=Date.now())),e.send(o.mail,(i,s)=>{if(o===e.queueEntry){try{o.callback(i,s)}catch(a){this.logger.error({err:a,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,a.message)}e.queueEntry=!1}})}_createConnection(){let e=new ua(this);return e.id=++this._connectionCounter,this.logger.info({tnx:"pool",cid:e.id,action:"conection"},"Created new pool resource #%s",e.id),e.on("available",()=>{this.logger.debug({tnx:"connection",cid:e.id,action:"available"},"Connection #%s became available",e.id),this._closed?this.close():this._processMessages()}),e.once("error",n=>{if(n.code!=="EMAXLIMIT"?this.logger.error({err:n,tnx:"pool",cid:e.id},"Pool Error for #%s: %s",e.id,n.message):this.logger.debug({tnx:"pool",cid:e.id,action:"maxlimit"},"Max messages limit exchausted for #%s",e.id),e.queueEntry){try{e.queueEntry.callback(n)}catch(r){this.logger.error({err:r,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,r.message)}e.queueEntry=!1}this._removeConnection(e),this._continueProcessing()}),e.once("close",()=>{this.logger.info({tnx:"connection",cid:e.id,action:"closed"},"Connection #%s was closed",e.id),this._removeConnection(e),e.queueEntry?setTimeout(()=>{e.queueEntry&&(this._shouldRequeuOnConnectionClose(e.queueEntry)?this._requeueEntryOnConnectionClose(e):this._failDeliveryOnConnectionClose(e)),this._continueProcessing()},50):(!this._closed&&this.idling&&!this._connections.length&&this.emit("clear"),this._continueProcessing())}),this._connections.push(e),e}_shouldRequeuOnConnectionClose(e){return this.options.maxRequeues===void 0||this.options.maxRequeues<0?!0:e.requeueAttempts<this.options.maxRequeues}_failDeliveryOnConnectionClose(e){if(e.queueEntry&&e.queueEntry.callback){try{e.queueEntry.callback(new Error("Reached maximum number of retries after connection was closed"))}catch(n){this.logger.error({err:n,tnx:"callback",messageId:e.queueEntry.messageId,cid:e.id},"Callback error for #%s: %s",e.id,n.message)}e.queueEntry=!1}}_requeueEntryOnConnectionClose(e){e.queueEntry.requeueAttempts=e.queueEntry.requeueAttempts+1,this.logger.debug({tnx:"pool",cid:e.id,messageId:e.queueEntry.messageId,action:"requeue"},"Re-queued message <%s> for #%s. Attempt: #%s",e.queueEntry.messageId,e.id,e.queueEntry.requeueAttempts),this._queue.unshift(e.queueEntry),e.queueEntry=!1}_continueProcessing(){this._closed?this.close():setTimeout(()=>this._processMessages(),100)}_removeConnection(e){let n=this._connections.indexOf(e);n!==-1&&this._connections.splice(n,1)}_checkRateLimit(e){if(!this._rateLimit.limit)return e();let n=Date.now();if(this._rateLimit.counter<this._rateLimit.limit)return e();if(this._rateLimit.waiting.push(e),this._rateLimit.checkpoint<=n-this._rateLimit.delta)return this._clearRateLimit();this._rateLimit.timeout||(this._rateLimit.timeout=setTimeout(()=>this._clearRateLimit(),this._rateLimit.delta-(n-this._rateLimit.checkpoint)),this._rateLimit.checkpoint=n)}_clearRateLimit(){for(clearTimeout(this._rateLimit.timeout),this._rateLimit.timeout=null,this._rateLimit.counter=0,this._rateLimit.checkpoint=!1;this._rateLimit.waiting.length;){let e=this._rateLimit.waiting.shift();setImmediate(e)}}isIdle(){return this.idling}verify(e){let n;e||(n=new Promise((o,i)=>{e=hn.callbackPromise(o,i)}));let r=new ua(this).auth;return this.getSocket(this.options,(o,i)=>{if(o)return e(o);let s=this.options;i&&i.connection&&(this.logger.info({tnx:"proxy",remoteAddress:i.connection.remoteAddress,remotePort:i.connection.remotePort,destHost:s.host||"",destPort:s.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",i.connection.remoteAddress,i.connection.remotePort,s.host||"",s.port||""),s=hn.assign(!1,s),Object.keys(i).forEach(f=>{s[f]=i[f]}));let a=new fa(s),c=!1;a.once("error",f=>{if(!c)return c=!0,a.close(),e(f)}),a.once("end",()=>{if(!c)return c=!0,e(new Error("Connection closed"))});let p=()=>{if(!c)return c=!0,a.quit(),e(null,!0)};a.connect(()=>{if(!c)if(r&&(a.allowsAuth||s.forceAuth))a.login(r,f=>{if(!c){if(f)return c=!0,a.close(),e(f);p()}});else if(!r&&a.allowsAuth&&s.forceAuth){let f=new Error("Authentication info was not provided");return f.code="NoAuth",c=!0,a.close(),e(f)}else p()})}),n}};var Sb=bb;const _b=V,yo=Ki,Eb=wd,Kt=Ae,Cb=yd,Tb=tt;let kb=class extends _b{constructor(e){super(),e=e||{},typeof e=="string"&&(e={url:e});let n,r=e.service;typeof e.getSocket=="function"&&(this.getSocket=e.getSocket),e.url&&(n=Kt.parseConnectionUrl(e.url),r=r||n.service),this.options=Kt.assign(!1,e,n,r&&Eb(r)),this.logger=Kt.getLogger(this.options,{component:this.options.component||"smtp-transport"});let o=new yo(this.options);this.name="SMTP",this.version=Tb.version+"[client:"+o.version+"]",this.options.auth&&(this.auth=this.getAuth({}))}getSocket(e,n){return setImmediate(()=>n(null,!1))}getAuth(e){if(!e)return this.auth;let n=!1,r={};if(this.options.auth&&typeof this.options.auth=="object"&&Object.keys(this.options.auth).forEach(o=>{n=!0,r[o]=this.options.auth[o]}),e&&typeof e=="object"&&Object.keys(e).forEach(o=>{n=!0,r[o]=e[o]}),!n)return!1;switch((r.type||"").toString().toUpperCase()){case"OAUTH2":{if(!r.service&&!r.user)return!1;let o=new Cb(r,this.logger);return o.provisionCallback=this.mailer&&this.mailer.get("oauth2_provision_cb")||o.provisionCallback,o.on("token",i=>this.mailer.emit("token",i)),o.on("error",i=>this.emit("error",i)),{type:"OAUTH2",user:r.user,oauth2:o,method:"XOAUTH2"}}default:return{type:(r.type||"").toString().toUpperCase()||"LOGIN",user:r.user,credentials:{user:r.user||"",pass:r.pass,options:r.options},method:(r.method||"").trim().toUpperCase()||this.options.authMethod||!1}}}send(e,n){this.getSocket(this.options,(r,o)=>{if(r)return n(r);let i=!1,s=this.options;o&&o.connection&&(this.logger.info({tnx:"proxy",remoteAddress:o.connection.remoteAddress,remotePort:o.connection.remotePort,destHost:s.host||"",destPort:s.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",o.connection.remoteAddress,o.connection.remotePort,s.host||"",s.port||""),s=Kt.assign(!1,s),Object.keys(o).forEach(p=>{s[p]=o[p]}));let a=new yo(s);a.once("error",p=>{if(!i)return i=!0,a.close(),n(p)}),a.once("end",()=>{if(i)return;let p=setTimeout(()=>{if(i)return;i=!0;let f=new Error("Unexpected socket close");a&&a._socket&&a._socket.upgrading&&(f.code="ETLS"),n(f)},1e3);try{p.unref()}catch{}});let c=()=>{let p=e.message.getEnvelope(),f=e.message.messageId(),m=[].concat(p.to||[]);m.length>3&&m.push("...and "+m.splice(2).length+" more"),e.data.dsn&&(p.dsn=e.data.dsn),this.logger.info({tnx:"send",messageId:f},"Sending message %s to <%s>",f,m.join(", ")),a.send(p,e.message.createReadStream(),(u,h)=>{if(i=!0,a.close(),u)return this.logger.error({err:u,tnx:"send"},"Send error for %s: %s",f,u.message),n(u);h.envelope={from:p.from,to:p.to},h.messageId=f;try{return n(null,h)}catch(x){this.logger.error({err:x,tnx:"callback"},"Callback error for %s: %s",f,x.message)}})};a.connect(()=>{if(i)return;let p=this.getAuth(e.data.auth);p&&(a.allowsAuth||s.forceAuth)?a.login(p,f=>{if(p&&p!==this.auth&&p.oauth2&&p.oauth2.removeAllListeners(),!i){if(f)return i=!0,a.close(),n(f);c()}}):c()})})}verify(e){let n;return e||(n=new Promise((r,o)=>{e=Kt.callbackPromise(r,o)})),this.getSocket(this.options,(r,o)=>{if(r)return e(r);let i=this.options;o&&o.connection&&(this.logger.info({tnx:"proxy",remoteAddress:o.connection.remoteAddress,remotePort:o.connection.remotePort,destHost:i.host||"",destPort:i.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",o.connection.remoteAddress,o.connection.remotePort,i.host||"",i.port||""),i=Kt.assign(!1,i),Object.keys(o).forEach(p=>{i[p]=o[p]}));let s=new yo(i),a=!1;s.once("error",p=>{if(!a)return a=!0,s.close(),e(p)}),s.once("end",()=>{if(!a)return a=!0,e(new Error("Connection closed"))});let c=()=>{if(!a)return a=!0,s.quit(),e(null,!0)};s.connect(()=>{if(a)return;let p=this.getAuth({});if(p&&(s.allowsAuth||i.forceAuth))s.login(p,f=>{if(!a){if(f)return a=!0,s.close(),e(f);c()}});else if(!p&&s.allowsAuth&&i.forceAuth){let f=new Error("Authentication info was not provided");return f.code="NoAuth",a=!0,s.close(),e(f)}else c()})}),n}close(){this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.emit("close")}};var Ab=kb;const Nb=V.spawn,jb=tt,Rb=Ae;let Mb=class{constructor(e){e=e||{},this._spawn=Nb,this.options=e||{},this.name="Sendmail",this.version=jb.version,this.path="sendmail",this.args=!1,this.winbreak=!1,this.logger=Rb.getLogger(this.options,{component:this.options.component||"sendmail"}),e&&(typeof e=="string"?this.path=e:typeof e=="object"&&(e.path&&(this.path=e.path),Array.isArray(e.args)&&(this.args=e.args),this.winbreak=["win","windows","dos",`\r
`].includes((e.newline||"").toString().toLowerCase())))}send(e,n){e.message.keepBcc=!0;let r=e.data.envelope||e.message.getEnvelope(),o=e.message.messageId(),i,s,a;if([].concat(r.from||[]).concat(r.to||[]).some(f=>/^-/.test(f)))return n(new Error("Can not send mail. Invalid envelope addresses."));this.args?i=["-i"].concat(this.args).concat(r.to):i=["-i"].concat(r.from?["-f",r.from]:[]).concat(r.to);let p=f=>{if(!a&&(a=!0,typeof n=="function"))return f?n(f):n(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:o,response:"Messages queued for delivery"})};try{s=this._spawn(this.path,i)}catch(f){return this.logger.error({err:f,tnx:"spawn",messageId:o},"Error occurred while spawning sendmail. %s",f.message),p(f)}if(s){s.on("error",u=>{this.logger.error({err:u,tnx:"spawn",messageId:o},"Error occurred when sending message %s. %s",o,u.message),p(u)}),s.once("exit",u=>{if(!u)return p();let h;u===127?h=new Error("Sendmail command not found, process exited with code "+u):h=new Error("Sendmail exited with code "+u),this.logger.error({err:h,tnx:"stdin",messageId:o},"Error sending message %s to sendmail. %s",o,h.message),p(h)}),s.once("close",p),s.stdin.on("error",u=>{this.logger.error({err:u,tnx:"stdin",messageId:o},"Error occurred when piping message %s to sendmail. %s",o,u.message),p(u)});let f=[].concat(r.to||[]);f.length>3&&f.push("...and "+f.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:o},"Sending message %s to <%s>",o,f.join(", "));let m=e.message.createReadStream();m.once("error",u=>{this.logger.error({err:u,tnx:"stdin",messageId:o},"Error occurred when generating message %s. %s",o,u.message),s.kill("SIGINT"),p(u)}),m.pipe(s.stdin)}else return p(new Error("sendmail was not found"))}};var Pb=Mb;const Ib=tt,Ob=Ae;let Lb=class{constructor(e){e=e||{},this.options=e||{},this.name="StreamTransport",this.version=Ib.version,this.logger=Ob.getLogger(this.options,{component:this.options.component||"stream-transport"}),this.winbreak=["win","windows","dos",`\r
`].includes((e.newline||"").toString().toLowerCase())}send(e,n){e.message.keepBcc=!0;let r=e.data.envelope||e.message.getEnvelope(),o=e.message.messageId(),i=[].concat(r.to||[]);i.length>3&&i.push("...and "+i.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:o},"Sending message %s to <%s> using %s line breaks",o,i.join(", "),this.winbreak?"<CR><LF>":"<LF>"),setImmediate(()=>{let s;try{s=e.message.createReadStream()}catch(p){return this.logger.error({err:p,tnx:"send",messageId:o},"Creating send stream failed for %s. %s",o,p.message),n(p)}if(!this.options.buffer)return s.once("error",p=>{this.logger.error({err:p,tnx:"send",messageId:o},"Failed creating message for %s. %s",o,p.message)}),n(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:o,message:s});let a=[],c=0;s.on("readable",()=>{let p;for(;(p=s.read())!==null;)a.push(p),c+=p.length}),s.once("error",p=>(this.logger.error({err:p,tnx:"send",messageId:o},"Failed creating message for %s. %s",o,p.message),n(p))),s.on("end",()=>n(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:o,message:Buffer.concat(a,c)}))})}};var Db=Lb;const zb=tt,Fb=Ae;let $b=class{constructor(e){e=e||{},this.options=e||{},this.name="JSONTransport",this.version=zb.version,this.logger=Fb.getLogger(this.options,{component:this.options.component||"json-transport"})}send(e,n){e.message.keepBcc=!0;let r=e.data.envelope||e.message.getEnvelope(),o=e.message.messageId(),i=[].concat(r.to||[]);i.length>3&&i.push("...and "+i.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:o},"Composing JSON structure of %s to <%s>",o,i.join(", ")),setImmediate(()=>{e.normalize((s,a)=>s?(this.logger.error({err:s,tnx:"send",messageId:o},"Failed building JSON structure for %s. %s",o,s.message),n(s)):(delete a.envelope,delete a.normalizedHeaders,n(null,{envelope:r,messageId:o,message:this.options.skipEncoding?a:JSON.stringify(a)})))})}};var Ub=$b;const Hb=V,Bb=tt,ma=Ae,Vb=md,qb=Gi;let Gb=class extends Hb{constructor(e){super(),e=e||{},this.options=e||{},this.ses=this.options.SES,this.name="SESTransport",this.version=Bb.version,this.logger=ma.getLogger(this.options,{component:this.options.component||"ses-transport"})}getRegion(e){return this.ses.sesClient.config&&typeof this.ses.sesClient.config.region=="function"?this.ses.sesClient.config.region().then(n=>e(null,n)).catch(n=>e(n)):e(null,!1)}send(e,n){let r=e.message._headers.find(c=>/^from$/i.test(c.key));if(r){let c=new qb("text/plain");r=c._convertAddresses(c._parseAddresses(r.value))}let o=e.data.envelope||e.message.getEnvelope(),i=e.message.messageId(),s=[].concat(o.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:i},"Sending message %s to <%s>",i,s.join(", "));let a=c=>{e.data._dkim||(e.data._dkim={}),e.data._dkim.skipFields&&typeof e.data._dkim.skipFields=="string"?e.data._dkim.skipFields+=":date:message-id":e.data._dkim.skipFields="date:message-id";let p=e.message.createReadStream(),f=p.pipe(new Vb),m=[],u=0;f.on("readable",()=>{let h;for(;(h=f.read())!==null;)m.push(h),u+=h.length}),p.once("error",h=>f.emit("error",h)),f.once("error",h=>{c(h)}),f.once("end",()=>c(null,Buffer.concat(m,u)))};setImmediate(()=>a((c,p)=>{if(c)return this.logger.error({err:c,tnx:"send",messageId:i},"Failed creating message for %s. %s",i,c.message),n(c);let f={Content:{Raw:{Data:p}},FromEmailAddress:r||o.from,Destination:{ToAddresses:o.to}};Object.keys(e.data.ses||{}).forEach(m=>{f[m]=e.data.ses[m]}),this.getRegion((m,u)=>{(m||!u)&&(u="us-east-1");const h=new this.ses.SendEmailCommand(f);this.ses.sesClient.send(h).then(g=>{u==="us-east-1"&&(u="email"),n(null,{envelope:{from:o.from,to:o.to},messageId:"<"+g.MessageId+(/@/.test(g.MessageId)?"":"@"+u+".amazonses.com")+">",response:g.MessageId,raw:p})}).catch(g=>{this.logger.error({err:g,tnx:"send"},"Send error for %s: %s",i,g.message),n(g)})})}))}verify(e){let n;e||(n=new Promise((i,s)=>{e=ma.callbackPromise(i,s)}));const r=i=>i&&!["InvalidParameterValue","MessageRejected"].includes(i.code||i.Code||i.name)?e(i):e(null,!0),o={Content:{Raw:{Data:Buffer.from(`From: <invalid@invalid>\r
To: <invalid@invalid>\r
 Subject: Invalid\r
\r
Invalid`)}},FromEmailAddress:"invalid@invalid",Destination:{ToAddresses:["invalid@invalid"]}};return this.getRegion((i,s)=>{const a=new this.ses.SendEmailCommand(o);this.ses.sesClient.send(a).then(p=>r(null)).catch(p=>r(p))}),n}};var Wb=Gb,zr={};const Kb=qy,bd=Ae,Yb=Sb,Xb=Ab,Qb=Pb,Jb=Db,Zb=Ub,e0=Wb,t0=Lr,ha=tt,n0=(zr.ETHEREAL_API||"https://api.nodemailer.com").replace(/\/+$/,""),r0=(zr.ETHEREAL_WEB||"https://ethereal.email").replace(/\/+$/,""),ga=(zr.ETHEREAL_API_KEY||"").replace(/\s*/g,"")||null,o0=["true","yes","y","1"].includes((zr.ETHEREAL_CACHE||"yes").toString().trim().toLowerCase());let vn=!1;Or.createTransport=function(t,e){let n,r,o;if(typeof t=="object"&&typeof t.send!="function"||typeof t=="string"&&/^(smtps?|direct):/i.test(t))if((n=typeof t=="string"?t:t.url)?r=bd.parseConnectionUrl(n):r=t,r.pool)t=new Yb(r);else if(r.sendmail)t=new Qb(r);else if(r.streamTransport)t=new Jb(r);else if(r.jsonTransport)t=new Zb(r);else if(r.SES){if(r.SES.ses&&r.SES.aws){let i=new Error("Using legacy SES configuration, expecting @aws-sdk/client-sesv2, see https://nodemailer.com/transports/ses/");throw i.code="LegacyConfig",i}t=new e0(r)}else t=new Xb(r);return o=new Kb(t,r,e),o};Or.createTestAccount=function(t,e){let n;if(!e&&typeof t=="function"&&(e=t,t=!1),e||(n=new Promise((c,p)=>{e=bd.callbackPromise(c,p)})),o0&&vn)return setImmediate(()=>e(null,vn)),n;t=t||n0;let r=[],o=0,i={},s={requestor:ha.name,version:ha.version};ga&&(i.Authorization="Bearer "+ga);let a=t0(t+"/user",{contentType:"application/json",method:"POST",headers:i,body:Buffer.from(JSON.stringify(s))});return a.on("readable",()=>{let c;for(;(c=a.read())!==null;)r.push(c),o+=c.length}),a.once("error",c=>e(c)),a.once("end",()=>{let c=Buffer.concat(r,o),p,f;try{p=JSON.parse(c.toString())}catch(m){f=m}if(f)return e(f);if(p.status!=="success"||p.error)return e(new Error(p.error||"Request failed"));delete p.status,vn=p,e(null,vn)}),n};Or.getTestMessageUrl=function(t){if(!t||!t.response)return!1;let e=new Map;return t.response.replace(/\[([^\]]+)\]$/,(n,r)=>{r.replace(/\b([A-Z0-9]+)=([^\s]+)/g,(o,i,s)=>{e.set(i,s)})}),e.has("STATUS")&&e.has("MSGID")?(vn.web||r0)+"/message/"+e.get("MSGID"):!1};const Ct=class Ct{constructor(){H(this,"transporter");H(this,"pendingConfirmations",new Map);this.transporter=Or.createTransporter({host:"smtp.resend.com",port:2465,secure:!0,auth:{user:"resend",pass:"re_2FWqfJwk_62EVzhW3YKUUCtCUwKEstLhs"}}),console.log("📧 EmailConfirmationService initialized with SMTP")}static getInstance(){return Ct.instance||(Ct.instance=new Ct),Ct.instance}async sendEmailViaSMTP(e,n,r){try{const o=await this.transporter.sendMail({from:"noreply@mobirides.com",to:e,subject:n,html:r});return console.log("Email sent successfully:",o.messageId),{success:!0,messageId:o.messageId}}catch(o){console.error("Error sending email via SMTP:",o);let i="Failed to send confirmation email";return o instanceof Error&&(o.message.includes("Invalid login")?i="Email service authentication failed. Please check SMTP configuration.":o.message.includes("ENOTFOUND")?i="Unable to connect to email server. Please check your internet connection.":o.message.includes("EAUTH")?i="Email authentication failed. Please verify your API key.":i=`Email sending failed: ${o.message}`),{success:!1,error:i}}}generateConfirmationEmailHTML(e,n,r){return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Confirm your MobiRides account</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; border-radius: 8px 8px 0 0; }
          .content { background: #f9f9f9; padding: 30px; border-radius: 0 0 8px 8px; }
          .button { display: inline-block; background: #667eea; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; margin: 20px 0; }
          .footer { text-align: center; margin-top: 30px; color: #666; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>Welcome to MobiRides!</h1>
          </div>
          <div class="content">
            <h2>Hi ${e},</h2>
            <p>Thank you for signing up for MobiRides! We're excited to have you join our car-sharing community.</p>
            <p>To complete your registration and activate your account, please click the button below:</p>
            <div style="text-align: center;">
              <a href="${n}" class="button">Confirm Your Email</a>
            </div>
            <p>If the button doesn't work, you can also copy and paste this link into your browser:</p>
            <p style="word-break: break-all; color: #667eea;">${n}</p>
            <p><strong>Important:</strong> This confirmation link will expire in 24 hours for security reasons.</p>
            <p>If you didn't create an account with MobiRides, you can safely ignore this email.</p>
          </div>
          <div class="footer">
            <p>Best regards,<br>The MobiRides Team</p>
            <p>This email was sent to ${r}</p>
          </div>
        </div>
      </body>
      </html>
    `}async initiateSignup(e){try{const{data:n}=await I.from("profiles").select("id").eq("email",e.email).single();if(n)return{success:!1,error:"An account with this email already exists. Please sign in instead."};const r=Zv();this.pendingConfirmations.set(r,{...e,token:r});const o=`${window.location.origin}/confirm-email?token=${r}`,i=this.generateConfirmationEmailHTML(e.fullName,o,e.email);return(await this.sendEmailViaSMTP(e.email,"Confirm your MobiRides account",i)).success?(setTimeout(()=>{this.pendingConfirmations.delete(r)},24*60*60*1e3),{success:!0}):(this.pendingConfirmations.delete(r),{success:!1,error:"Failed to send confirmation email. Please try again."})}catch(n){console.error("Error initiating signup:",n);let r="Failed to create account";return n instanceof Error&&(n.message.includes("Email service authentication failed")?r="Email verification service is temporarily unavailable. Please try again later.":n.message.includes("Unable to connect to email server")?r="Network connection issue. Please check your internet and try again.":n.message.includes("Email authentication failed")?r="Email service configuration error. Please contact support.":r=n.message),{success:!1,error:r}}}async confirmEmail(e){try{const n=this.pendingConfirmations.get(e);if(!n)return{success:!1,error:"Invalid or expired confirmation token."};const{data:r,error:o}=await I.auth.signUp({email:n.email,password:n.password,options:{data:{full_name:n.fullName,phone_number:n.phoneNumber,email_confirmed:!0},emailRedirectTo:`${window.location.origin}/`}});return o?(console.error("Error creating user account:",o),{success:!1,error:o.message}):(this.pendingConfirmations.delete(e),r.user&&console.log("User account created successfully:",r.user.id),{success:!0})}catch(n){return console.error("Error confirming email:",n),{success:!1,error:"An unexpected error occurred during confirmation."}}}async resendConfirmation(e){try{let n,r;for(const[a,c]of this.pendingConfirmations.entries())if(c.email===e){n=c,r=a;break}if(!n||!r)return{success:!1,error:"No pending confirmation found for this email."};const o=`${window.location.origin}/confirm-email?token=${r}`,i=this.generateConfirmationEmailHTML(n.fullName,o,n.email);return(await this.sendEmailViaSMTP(n.email,"Confirm your MobiRides account",i)).success?{success:!0}:{success:!1,error:"Failed to resend confirmation email. Please try again."}}catch(n){console.error("Error resending confirmation:",n);let r="Failed to resend confirmation email";return n instanceof Error&&(n.message.includes("Email service authentication failed")?r="Email verification service is temporarily unavailable. Please try again later.":n.message.includes("Unable to connect to email server")?r="Network connection issue. Please check your internet and try again.":n.message.includes("Email authentication failed")?r="Email service configuration error. Please contact support.":r=n.message),{success:!1,error:r}}}};H(Ct,"instance");let Yo=Ct;const i0=Yo.getInstance(),s0=[{code:"+213",country:"DZ 🇩🇿"},{code:"+244",country:"AO 🇦🇴"},{code:"+267",country:"BW 🇧🇼"},{code:"+226",country:"BF 🇧🇫"},{code:"+257",country:"BI 🇧🇮"},{code:"+237",country:"CM 🇨🇲"},{code:"+238",country:"CV 🇨🇻"},{code:"+236",country:"CF 🇨🇫"},{code:"+235",country:"TD 🇹🇩"},{code:"+269",country:"KM 🇰🇲"},{code:"+242",country:"CG 🇨🇬"},{code:"+243",country:"CD 🇨🇩"},{code:"+253",country:"DJ 🇩🇯"},{code:"+20",country:"EG 🇪🇬"},{code:"+240",country:"GQ 🇬🇶"},{code:"+291",country:"ER 🇪🇷"},{code:"+251",country:"ET 🇪🇹"},{code:"+241",country:"GA 🇬🇦"},{code:"+220",country:"GM 🇬🇲"},{code:"+233",country:"GH 🇬🇭"},{code:"+224",country:"GN 🇬🇳"},{code:"+245",country:"GW 🇬🇼"},{code:"+254",country:"KE 🇰🇪"},{code:"+266",country:"LS 🇱🇸"},{code:"+231",country:"LR 🇱🇷"},{code:"+218",country:"LY 🇱🇾"},{code:"+261",country:"MG 🇲🇬"},{code:"+265",country:"MW 🇲🇼"},{code:"+223",country:"ML 🇲🇱"},{code:"+222",country:"MR 🇲🇷"},{code:"+230",country:"MU 🇲🇺"},{code:"+212",country:"MA 🇲🇦"},{code:"+258",country:"MZ 🇲🇿"},{code:"+264",country:"NA 🇳🇦"},{code:"+227",country:"NE 🇳🇪"},{code:"+234",country:"NG 🇳🇬"},{code:"+250",country:"RW 🇷🇼"},{code:"+239",country:"ST 🇸🇹"},{code:"+221",country:"SN 🇸🇳"},{code:"+232",country:"SL 🇸🇱"},{code:"+252",country:"SO 🇸🇴"},{code:"+27",country:"ZA 🇿🇦"},{code:"+211",country:"SS 🇸🇸"},{code:"+249",country:"SD 🇸🇩"},{code:"+268",country:"SZ 🇸🇿"},{code:"+255",country:"TZ 🇹🇿"},{code:"+228",country:"TG 🇹🇬"},{code:"+216",country:"TN 🇹🇳"},{code:"+256",country:"UG 🇺🇬"},{code:"+260",country:"ZM 🇿🇲"},{code:"+263",country:"ZW 🇿🇼"},{code:"+44",country:"UK 🇬🇧"},{code:"+91",country:"IN 🇮🇳"},{code:"+61",country:"AU 🇦🇺"},{code:"+86",country:"CN 🇨🇳"},{code:"+33",country:"FR 🇫🇷"},{code:"+49",country:"DE 🇩🇪"},{code:"+81",country:"JP 🇯🇵"},{code:"+52",country:"MX 🇲🇽"},{code:"+55",country:"BR 🇧🇷"}],a0=({onSuccess:t})=>{const[e,n]=d.useState(""),[r,o]=d.useState(""),[i,s]=d.useState(""),[a,c]=d.useState(""),[p,f]=d.useState(""),[m,u]=d.useState("+267"),[h,x]=d.useState(!1),[g,v]=d.useState(!1),[y,w]=d.useState(!1),[b,S]=d.useState(""),_=E=>E.replace(/[^\d+]/g,""),A=async E=>{if(E.preventDefault(),x(!0),S(""),!a.trim()){S("Please enter your full name"),x(!1);return}if(!p.trim()){S("Please enter your phone number"),x(!1);return}if(r!==i){S("Passwords do not match"),x(!1);return}if(r.length<6){S("Password must be at least 6 characters long"),x(!1);return}try{const T=_(`${m}${p}`),C=await i0.initiateSignup({email:e,password:r,fullName:a.trim(),phoneNumber:T});if(!C.success){S(C.error||"Failed to create account. Please try again.");return}te.success("Account created successfully! Please check your email to verify your account."),n(""),o(""),s(""),c(""),f(""),u("+267"),t==null||t()}catch(T){console.error("Signup error:",T),S("An unexpected error occurred. Please try again.")}finally{x(!1)}};return l.jsxs("form",{onSubmit:A,className:"space-y-4",children:[b&&l.jsx(kr,{variant:"destructive",children:l.jsx(Ar,{children:b})}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(mt,{htmlFor:"signup-full-name",children:"Full Name"}),l.jsx(Xe,{id:"signup-full-name",type:"text",value:a,onChange:E=>c(E.target.value),placeholder:"Enter your full name",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(mt,{htmlFor:"signup-email",children:"Email"}),l.jsx(Xe,{id:"signup-email",type:"email",value:e,onChange:E=>n(E.target.value),placeholder:"Enter your email",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(mt,{htmlFor:"signup-phone",children:"Phone Number"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(Vv,{value:m,onValueChange:u,children:[l.jsx(ql,{className:"w-[140px]",children:l.jsx(qv,{placeholder:"Country"})}),l.jsx(Kl,{children:s0.map(({code:E,country:T})=>l.jsxs(Yl,{value:E,children:[T," (",E,")"]},E))})]}),l.jsx(Xe,{id:"signup-phone",type:"tel",value:p,onChange:E=>f(_(E.target.value)),placeholder:"Enter phone number",className:"flex-1",required:!0})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(mt,{htmlFor:"signup-password",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(Xe,{id:"signup-password",type:g?"text":"password",value:r,onChange:E=>o(E.target.value),placeholder:"Create a password",className:"pr-10",required:!0}),l.jsxs(pe,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 text-muted-foreground hover:text-foreground",onClick:()=>v(!g),children:[g?l.jsx(jo,{className:"h-4 w-4"}):l.jsx(Ro,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:g?"Hide password":"Show password"})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(mt,{htmlFor:"signup-confirm-password",children:"Confirm Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(Xe,{id:"signup-confirm-password",type:y?"text":"password",value:i,onChange:E=>s(E.target.value),placeholder:"Confirm your password",className:"pr-10",required:!0}),l.jsxs(pe,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 text-muted-foreground hover:text-foreground",onClick:()=>w(!y),children:[y?l.jsx(jo,{className:"h-4 w-4"}):l.jsx(Ro,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:y?"Hide password":"Show password"})]})]})]}),l.jsx(pe,{type:"submit",className:"w-full",disabled:h,children:h?"Creating account...":"Sign Up"})]})},c0=({onSuccess:t,idPrefix:e="signin"})=>{const[n,r]=d.useState(""),[o,i]=d.useState(""),[s,a]=d.useState(!1),[c,p]=d.useState(!1),[f,m]=d.useState(!1),[u,h]=d.useState(""),x=async v=>{v.preventDefault(),a(!0),h("");try{const{error:y}=await I.auth.signInWithPassword({email:n,password:o});if(y){y.message.includes("Invalid login credentials")?h("Invalid email or password. Please check your credentials and try again."):y.message.includes("Email not confirmed")?h("Please check your email and click the confirmation link before signing in."):h(y.message);return}te.success("Signed in successfully!"),t==null||t()}catch(y){console.error("SignInForm: Unexpected error",y),h("An unexpected error occurred")}finally{a(!1)}},g=async()=>{if(!n){h("Please enter your email address first");return}p(!0),h("");try{const{error:v}=await I.auth.resetPasswordForEmail(n,{redirectTo:`${window.location.origin}/reset-password`});if(v){h(v.message);return}te.success("Password reset email sent! Check your inbox.")}catch{h("Failed to send reset email. Please try again.")}finally{p(!1)}};return l.jsxs("form",{onSubmit:x,className:"space-y-4",children:[u&&l.jsx(kr,{variant:"destructive",children:l.jsx(Ar,{children:u})}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(mt,{htmlFor:`${e}-email`,children:"Email"}),l.jsx(Xe,{id:`${e}-email`,type:"email",value:n,onChange:v=>r(v.target.value),placeholder:"Enter your email",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(mt,{htmlFor:`${e}-password`,children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(Xe,{id:`${e}-password`,type:f?"text":"password",value:o,onChange:v=>i(v.target.value),placeholder:"Enter your password",className:"pr-10",required:!0}),l.jsxs(pe,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 text-muted-foreground hover:text-foreground",onClick:()=>m(!f),children:[f?l.jsx(jo,{className:"h-4 w-4"}):l.jsx(Ro,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:f?"Hide password":"Show password"})]})]})]}),l.jsx(pe,{type:"submit",className:"w-full",disabled:s,children:s?"Signing in...":"Sign In"}),l.jsx("div",{className:"text-center",children:l.jsx(pe,{type:"button",variant:"link",className:"text-sm text-muted-foreground hover:text-primary",onClick:g,disabled:c,children:c?"Sending reset email...":"Forgot your password?"})})]})},l0=({isOpen:t,onClose:e,defaultTab:n="signin",idPrefix:r="auth"})=>{const[o,i]=d.useState(n),s=ka(),a=Tu();d.useEffect(()=>{t&&s(`/?auth=${o}`,{replace:!0})},[o,t,s]),d.useEffect(()=>()=>{t&&a.search.includes("auth=")&&s("/",{replace:!0})},[t,a.search,s]);const c=p=>{p||(e(),s("/",{replace:!0}))};return l.jsx(bc,{open:t,onOpenChange:c,children:l.jsxs(_i,{className:"sm:max-w-[425px]",children:[l.jsxs(Ei,{children:[l.jsxs(Ci,{className:"text-center text-2xl font-bold",children:["Welcome to ",l.jsx("span",{className:"text-primary",children:"Mobirides"})]}),l.jsx(Ti,{className:"text-center",children:"Access your account to book cars, manage reservations, and explore our services."})]}),l.jsxs(tg,{value:o,onValueChange:p=>i(p),className:"w-full",children:[l.jsxs(Bc,{className:"grid w-full grid-cols-2",children:[l.jsx(Oo,{value:"signin",children:"Sign In"}),l.jsx(Oo,{value:"signup",children:"Sign Up"})]}),l.jsx(Lo,{value:"signin",className:"mt-4",children:l.jsx(c0,{onSuccess:e,idPrefix:`${r}-signin`})}),l.jsx(Lo,{value:"signup",className:"mt-4",children:l.jsx(a0,{})})]})]})})},fe=({children:t})=>{const{isAuthenticated:e,isLoading:n}=of(),[r,o]=d.useState(!1);O.useEffect(()=>{!n&&!e?o(!0):e&&o(!1)},[e,n]);const i=()=>{o(!1)};return n?l.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):l.jsx(l.Fragment,{children:e?t:l.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[l.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Authentication Required"}),l.jsx("p",{className:"text-gray-600 mb-8",children:"Please sign in to access this page"}),l.jsx(l0,{isOpen:r,onClose:i,defaultTab:"signin",idPrefix:"protected"})]})})},Sd=d.createContext(void 0);function d0({children:t}){const[e,n]=d.useState(()=>{const o=localStorage.getItem("theme"),i=window.matchMedia("(prefers-color-scheme: dark)").matches;return o||(i?"dark":"light")});d.useEffect(()=>{localStorage.setItem("theme",e),e==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[e]);const r=()=>{n(o=>o==="light"?"dark":"light")};return l.jsx(Sd.Provider,{value:{theme:e,toggleTheme:r},children:t})}function XC(){const t=d.useContext(Sd);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t}class p0 extends d.Component{constructor(){super(...arguments);H(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:l.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:l.jsxs(kr,{className:"max-w-md",children:[l.jsx(th,{className:"h-4 w-4"}),l.jsxs(Ar,{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold",children:"Something went wrong"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"An unexpected error occurred. Please try refreshing the page."})]}),l.jsxs(pe,{onClick:()=>window.location.reload(),className:"w-full",variant:"outline",children:[l.jsx(Ym,{className:"mr-2 h-4 w-4"}),"Refresh Page"]})]})]})}):this.props.children}}const Tt=class Tt{constructor(){H(this,"token",null);H(this,"tokenValid",!1);H(this,"tokenPromise",null)}static getInstance(){return Tt.instance||(Tt.instance=new Tt),Tt.instance}async getToken(){if(this.token)return this.token;if(this.tokenPromise)return this.tokenPromise;try{this.tokenPromise=Xi();const e=await this.tokenPromise;if(!e)throw new Error("No Mapbox token available");return this.token=e,this.tokenValid=!0,this.tokenPromise=null,e}catch(e){throw this.tokenPromise=null,console.error("Error getting Mapbox token:",e),e}}getTokenState(){return{token:this.token,valid:this.tokenValid}}async validateAndSetToken(e){try{return!e||e.trim().length===0?!1:(this.token=e,this.tokenValid=!0,window.mapboxgl&&(window.mapboxgl.accessToken=e),!0)}catch(n){return console.error("Error validating token:",n),!1}}getInstanceManager(){return{isReady:()=>!0,getMapboxModule:async()=>({})}}clearToken(){this.token=null,this.tokenValid=!1,this.tokenPromise=null,window.mapboxgl&&(window.mapboxgl.accessToken="")}};H(Tt,"instance");let Xo=Tt;const bn=Xo.getInstance(),kt=class kt{constructor(){H(this,"currentState","uninitialized");H(this,"resourceState",{token:!1,module:!1,dom:!1});H(this,"subscribers",[]);H(this,"transitionInProgress",!1)}static getInstance(){return kt.instance||(kt.instance=new kt),kt.instance}getCurrentState(){return this.currentState}getResourceState(){return{...this.resourceState}}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter(n=>n!==e)}notifySubscribers(){this.subscribers.forEach(e=>{e.onStateChange(this.currentState)})}async transition(e){if(this.transitionInProgress){console.warn(`[StateManager] State transition already in progress: ${this.currentState} -> ${e}`);return}this.transitionInProgress=!0,console.log(`[StateManager] Starting transition from ${this.currentState} to ${e}`);try{if(!this.isValidTransition(this.currentState,e))throw new Error(`Invalid state transition from ${this.currentState} to ${e}`);if(e==="core_initializing"&&!this.areResourcesReady())throw new Error("Cannot transition to core_initializing: resources not ready");this.currentState=e,this.notifySubscribers(),console.log(`[StateManager] Successfully transitioned to ${e}`)}catch(n){console.error("[StateManager] Transition error:",n),this.currentState="error",this.notifySubscribers()}finally{this.transitionInProgress=!1}}updateResourceState(e){console.log("[StateManager] Updating resource state:",e),this.resourceState={...this.resourceState,...e},this.areResourcesReady()&&this.currentState==="resources_acquiring"&&(console.log("[StateManager] All resources ready, transitioning to core_initializing"),this.transition("core_initializing"))}areResourcesReady(){return Object.values(this.resourceState).every(e=>e)}isValidTransition(e,n){var o;return((o={uninitialized:["prerequisites_checking","error"],prerequisites_checking:["resources_acquiring","error"],resources_acquiring:["core_initializing","error"],core_initializing:["features_activating","error"],features_activating:["ready","error"],ready:["error"],error:["prerequisites_checking"]}[e])==null?void 0:o.includes(n))??!1}};H(kt,"instance");let Qo=kt;const be=Qo.getInstance(),At=class At{constructor(){H(this,"subscribers",[])}static getInstance(){return At.instance||(At.instance=new At),At.instance}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter(n=>n!==e)}emit(e){console.log("[EventBus] Emitting event:",e),this.subscribers.forEach(n=>(n.onEvent(e),e))}};H(At,"instance");let Jo=At;const Se=Jo.getInstance(),va={token:[],module:["token"],dom:[]};class Yi{constructor(e){H(this,"state",{status:"pending",timestamp:Date.now()});H(this,"metrics",{loadTime:0,validationTime:0,errorCount:0,lastValidated:0,dependencyValidationTime:0});this.type=e}setState(e,n){const r=this.state.status;if(!this.isValidStateTransition(r,e)){console.warn(`Invalid state transition from ${r} to ${e}`);return}const o=Date.now();this.state={status:e,error:n,timestamp:o},e==="error"&&this.metrics.errorCount++,e==="ready"&&(this.metrics.loadTime=o-this.metrics.lastValidated),Se.emit({type:"resourceUpdate",payload:{type:this.type,state:this.state,previousState:r,metrics:{...this.metrics}}})}async validateWithMetrics(){const e=Date.now();try{const n=await this.validate(),r=Date.now()-e;return this.metrics.validationTime=r,this.metrics.lastValidated=Date.now(),{isValid:n,metrics:{validationTime:r,lastValidated:this.metrics.lastValidated}}}catch(n){return{isValid:!1,error:n instanceof Error?n.message:"Validation failed",metrics:{validationTime:Date.now()-e}}}}getState(){return{...this.state}}getMetrics(){return{...this.metrics}}isValidStateTransition(e,n){var o;return((o={pending:["loading","error"],loading:["ready","error"],ready:["loading","error","pending"],error:["loading","pending"]}[e])==null?void 0:o.includes(n))??!1}}class u0 extends Yi{constructor(){super("token");H(this,"token",null)}async acquire(){try{this.setState("loading");try{return this.token=await bn.getToken(),this.token?this.token.length>0?(this.setState("ready"),!0):(this.setState("error","Invalid token format"),!1):(this.setState("error","No token available"),!1)}catch(n){return console.error("Error loading token:",n),this.setState("error",n instanceof Error?n.message:"Failed to load Mapbox token"),!1}}catch(n){return console.error("Resource load error:",n),this.setState("error",n instanceof Error?n.message:"Unknown error loading token"),!1}}async release(){this.token=null,this.setState("pending")}async validate(){const n=bn.getTokenState();return n.token&&n.valid?(this.setState("ready"),!0):(this.setState("error","Token not valid"),!1)}async configure(n){return!0}getToken(){return bn.getTokenState().token}getState(){return this.state}}class f0 extends Yi{constructor(){super("module")}async acquire(){try{if(this.setState("loading"),Et)return console.log("Mapbox module already available globally"),typeof window<"u"&&(window.mapboxgl=Et),this.setState("ready"),!0;const e=bn.getTokenState();if(!e.token)return this.setState("error","Mapbox token not available"),!1;const n=bn.getInstanceManager();try{return await n.getMapboxModule(),typeof window<"u"&&!window.mapboxgl&&(window.mapboxgl=Et),typeof window<"u"&&!window.mapboxgl?(this.setState("error","Failed to load Mapbox GL JS module"),!1):(e.token&&typeof window<"u"&&window.mapboxgl&&(window.mapboxgl.accessToken=e.token),this.setState("ready"),!0)}catch(r){return console.error("Error loading Mapbox module:",r),this.setState("error",r instanceof Error?r.message:"Failed to load Mapbox GL JS module"),!1}}catch(e){return console.error("Resource load error:",e),this.setState("error",e instanceof Error?e.message:"Unknown error loading Mapbox GL JS module"),!1}}async release(){this.setState("pending")}async validate(){return typeof window<"u"&&window.mapboxgl||Et?(typeof window<"u"&&(window.mapboxgl=window.mapboxgl||Et),this.setState("ready"),!0):(this.setState("error","Mapbox GL JS module not loaded"),!1)}async configure(e){return!0}getState(){return this.state}}class m0 extends Yi{constructor(){super("dom");H(this,"container",null);H(this,"config",null)}async configure(n){if(this.type!=="dom")return!1;try{const r=n;return this.config=r,this.container=r.container,this.container?(this.setState("ready"),!0):(this.setState("error","Invalid container configuration"),!1)}catch(r){return this.setState("error",r instanceof Error?r.message:"Configuration failed"),!1}}async acquire(){var n,r;try{if(this.setState("loading"),!this.container)return this.setState("error","No DOM container configured"),!1;if(!this.container.isConnected)return this.setState("error","Container not connected to DOM"),!1;if((r=(n=this.config)==null?void 0:n.options)!=null&&r.validateSize){const{minWidth:o=0,minHeight:i=0}=this.config.options,s=this.container.getBoundingClientRect();if(s.width<o||s.height<i)return this.setState("error","Container size validation failed"),!1}return this.setState("ready"),!0}catch(o){return this.setState("error",o instanceof Error?o.message:"Failed to acquire DOM container"),!1}}async release(){this.container=null,this.config=null,this.setState("pending")}async validate(){var n,r;try{if(!this.container||!this.container.isConnected)return this.setState("error","DOM container not valid"),!1;if((r=(n=this.config)==null?void 0:n.options)!=null&&r.validateSize){const{minWidth:o=0,minHeight:i=0}=this.config.options,s=this.container.getBoundingClientRect();if(s.width<o||s.height<i)return this.setState("error","Container size validation failed"),!1}return this.setState("ready"),!0}catch(o){return this.setState("error",o instanceof Error?o.message:"DOM validation failed"),!1}}}const Nt=class Nt{constructor(){H(this,"resources",new Map);H(this,"state",{});H(this,"validationInProgress",!1);H(this,"dom");H(this,"module");H(this,"token");this.initializeResources()}static getInstance(){return Nt.instance||(Nt.instance=new Nt),Nt.instance}initializeResources(){this.resources.set("token",new u0),this.resources.set("module",new f0),this.resources.set("dom",new m0),this.resources.forEach((e,n)=>{this.state[n]=e.getState()})}async configureDOMResource(e){return this.configureTypedResource("dom",e)}async configureModuleResource(e){return this.configureTypedResource("module",e)}async configureTokenResource(e){return this.configureTypedResource("token",e)}async configureTypedResource(e,n){console.log(`[ResourceManager] Configuring resource: ${e}`);const r=this.resources.get(e);if(!r)throw new Error(`Resource ${e} not found`);try{return await r.configure(n)}catch(o){return console.error(`[ResourceManager] Failed to configure resource ${e}:`,o),Se.emit({type:"error",payload:`Failed to configure resource ${e}: ${o}`}),!1}}async acquireResource(e){console.log(`[ResourceManager] Acquiring resource: ${e}`);const n=this.resources.get(e);if(!n)throw new Error(`Resource ${e} not found`);try{const r=await this.validateDependencies(e);if(!r.isValid)return console.error(`[ResourceManager] Dependencies not valid for ${e}:`,r.error),Se.emit({type:"error",payload:r.error||`Dependencies not valid for resource ${e}`}),!1;const o=await n.acquire();return this.state[e]=n.getState(),o&&(be.updateResourceState({[e]:!0}),console.log(`[ResourceManager] Successfully acquired resource: ${e}`)),o}catch(r){return console.error(`[ResourceManager] Failed to acquire resource ${e}:`,r),Se.emit({type:"error",payload:`Failed to acquire resource ${e}: ${r}`}),!1}}async releaseResource(e){console.log(`[ResourceManager] Releasing resource: ${e}`);const n=this.resources.get(e);if(!n)throw new Error(`Resource ${e} not found`);try{await n.release(),this.state[e]=n.getState(),be.updateResourceState({[e]:!1}),console.log(`[ResourceManager] Successfully released resource: ${e}`)}catch(r){console.error(`[ResourceManager] Failed to release resource ${e}:`,r),Se.emit({type:"error",payload:`Failed to release resource ${e}: ${r}`})}}async validateDependencies(e){const n=va[e],r=Date.now();for(const o of n){const i=this.resources.get(o);if(!i)return{isValid:!1,error:`Dependency ${o} not found for resource ${e}`,metrics:{dependencyValidationTime:Date.now()-r}};if(!await i.validate())return{isValid:!1,error:`Dependency ${o} validation failed for resource ${e}`,metrics:{dependencyValidationTime:Date.now()-r}}}return{isValid:!0,metrics:{dependencyValidationTime:Date.now()-r}}}async releaseAll(){console.log("[ResourceManager] Starting release of all resources");const e=Array.from(this.resources.keys()),n=this.sortByDependencies(e).reverse();for(const r of n)await this.releaseResource(r);console.log("[ResourceManager] Completed release of all resources")}sortByDependencies(e){const n=new Set,r=[],o=i=>{if(!n.has(i)){n.add(i);for(const s of va[i])o(s);r.push(i)}};return e.forEach(o),r}getResource(e){return this.resources.get(e)}getResourceState(e){return this.state[e]}getAllResourceStates(){return{...this.state}}};H(Nt,"instance");let Zo=Nt;const Oe=Zo.getInstance(),jt=class jt{constructor(){H(this,"checkpoints",[]);H(this,"maxCheckpoints",5);H(this,"recoveryAttempts",new Map)}static getInstance(){return jt.instance||(jt.instance=new jt),jt.instance}createCheckpoint(){const e={state:be.getCurrentState(),resources:be.getResourceState(),map:{isInitialized:!!Ue.getMap(),isStyleLoaded:Ue.isStyleLoaded()},timestamp:Date.now()};return this.checkpoints.push(e),this.checkpoints.length>this.maxCheckpoints&&this.checkpoints.shift(),e}async recoverToCheckpoint(e){try{const n=this.determineRecoveryAction(e),r=this.recoveryAttempts.get(n.level)||0;if(r>=n.maxAttempts)throw new Error(`Maximum recovery attempts reached for level ${n.level}`);switch(this.recoveryAttempts.set(n.level,r+1),n.level){case 1:await this.recoverStyleLoading();break;case 2:await this.recoverMapInstance();break;case 3:await this.recoverResources(n.retainResources);break;case 4:await this.performCompleteReset();break}return await be.transition(n.target),this.recoveryAttempts.delete(n.level),{success:!0,newState:n.target}}catch(n){return console.error("[RollbackManager] Recovery failed:",n),{success:!1,newState:"error",error:n instanceof Error?n.message:"Recovery failed"}}}determineRecoveryAction(e){return be.getCurrentState()==="error"?{level:4,target:"prerequisites_checking",retainResources:[],maxAttempts:3}:!Ue.isStyleLoaded()&&e.map.isStyleLoaded?{level:1,target:e.state,retainResources:["token","module","dom"],maxAttempts:5}:!Ue.getMap()&&e.map.isInitialized?{level:2,target:"core_initializing",retainResources:["token","module"],maxAttempts:3}:{level:3,target:"resources_acquiring",retainResources:["token"],maxAttempts:3}}async recoverStyleLoading(){const e=Ue.getMap();if(!e)throw new Error("Map instance not available");await new Promise((n,r)=>{const o=setTimeout(()=>{r(new Error("Style loading timeout during recovery"))},1e4);e.once("style.load",()=>{clearTimeout(o),n()}),e.setStyle(e.getStyle())})}async recoverMapInstance(){await Ue.cleanup();const e=Oe.getResource("dom");if(!e)throw new Error("DOM resource not available");if(e.getState().status!=="ready")throw new Error("DOM resource not ready");const r=document.createElement("div");r.style.width="100%",r.style.height="100%",await Ue.initialize(r,{style:"mapbox://styles/mapbox/streets-v12",center:[-24.6282,25.9692],zoom:12})}async recoverResources(e){const n=Object.keys(be.getResourceState());for(const r of n)e.includes(r)||await Oe.releaseResource(r);for(const r of n)be.getResourceState()[r]||await Oe.acquireResource(r)}async performCompleteReset(){await Ue.cleanup(),this.checkpoints=[],this.recoveryAttempts.clear(),Se.emit({type:"stateChange",payload:{state:"uninitialized"}})}getLatestCheckpoint(){return this.checkpoints[this.checkpoints.length-1]||null}clearCheckpoints(){this.checkpoints=[],this.recoveryAttempts.clear()}};H(jt,"instance");let ei=jt;const Ee=ei.getInstance();class h0{async initialize(e,n,r,o){try{if(console.log("[MapInitializer] Starting map initialization"),await be.transition("prerequisites_checking"),Ee.createCheckpoint(),console.log("[MapInitializer] Configuring resources"),await this.configureResources(e),await be.transition("resources_acquiring"),Ee.createCheckpoint(),console.log("[MapInitializer] Acquiring resources"),!await this.acquireResources()){const a=Ee.getLatestCheckpoint();throw a&&await Ee.recoverToCheckpoint(a),new Error("Failed to acquire required resources")}if(await be.transition("core_initializing"),Ee.createCheckpoint(),console.log("[MapInitializer] Creating map instance"),r=new Et.Map({container:e,...n}),await be.transition("features_activating"),Ee.createCheckpoint(),!await this.waitForStyleToLoad(r,o)){const a=Ee.getLatestCheckpoint();throw a&&await Ee.recoverToCheckpoint(a),new Error("Style loading timeout")}return await be.transition("ready"),Ee.createCheckpoint(),console.log("[MapInitializer] Map initialization complete"),{map:r,success:!0}}catch(i){console.error("[MapInitializer] Initialization error:",i),Se.emit({type:"error",payload:i instanceof Error?i.message:"Failed to initialize map"});const s=Ee.getLatestCheckpoint();return s?(await Ee.recoverToCheckpoint(s)).success||await be.transition("error"):await be.transition("error"),{map:r,success:!1}}}async configureResources(e){await Oe.configureDOMResource({container:e,options:{validateSize:!0,minWidth:100,minHeight:100}}),await Oe.configureModuleResource({validateInstance:!0,validateDependencies:!0}),await Oe.configureTokenResource({refreshInterval:18e5,validateOnRefresh:!0,validateDependencies:!0})}async acquireResources(){const e=await Oe.acquireResource("token"),n=await Oe.acquireResource("module"),r=await Oe.acquireResource("dom");return e&&n&&r}async waitForStyleToLoad(e,n){return new Promise(r=>{if(!e)return r(!1);if(e.isStyleLoaded())n(!0),r(!0);else{const o=setTimeout(()=>{n(!1),r(!1)},1e4);e.once("style.load",()=>{clearTimeout(o),n(!0),r(!0)})}})}}const g0=new h0,Rt=class Rt{constructor(){}static getInstance(){return Rt.instance||(Rt.instance=new Rt),Rt.instance}updateView(e){const n=Ue.getMap();n&&n.easeTo({...e,duration:1e3})}getViewport(){const e=Ue.getMap();return e?{center:[e.getCenter().lng,e.getCenter().lat],zoom:e.getZoom(),pitch:e.getPitch(),bearing:e.getBearing()}:null}};H(Rt,"instance");let ti=Rt;const _d=ti.getInstance();class v0{setupEventHandlers(e,n){e&&(e.on("error",r=>{console.error("[MapEvents] Map error:",r),Se.emit({type:"error",payload:r.error?r.error.message:"Map error occurred"});const o=Ee.getLatestCheckpoint();o&&Ee.recoverToCheckpoint(o)}),e.on("style.load",()=>{console.log("[MapEvents] Map style loaded"),n(!0),Se.emit({type:"stateChange",payload:{state:"style_loaded"}}),Ee.createCheckpoint()}),e.on("moveend",()=>{if(!e)return;const r=_d.getViewport();Se.emit({type:"stateChange",payload:{state:"viewport_changed",viewport:r}})}))}removeEventHandlers(e){if(!e)return;const n=()=>{},r=()=>{},o=()=>{};e.off("error",n),e.off("style.load",r),e.off("moveend",o)}}const Ed=new v0;class x0{async cleanup(e){console.log("[MapCleanup] Starting cleanup"),e&&(Ed.removeEventHandlers(e),e.remove()),await Oe.releaseResource("dom"),await Oe.releaseResource("module"),await Oe.releaseResource("token"),await be.transition("uninitialized"),Ee.clearCheckpoints(),console.log("[MapCleanup] Cleanup complete")}}const y0=new x0,Mt=class Mt{constructor(){H(this,"map",null);H(this,"styleLoaded",!1)}static getInstance(){return Mt.instance||(Mt.instance=new Mt),Mt.instance}async initialize(e,n){const r=await g0.initialize(e,n,this.map,o=>{this.styleLoaded=o});return this.map=r.map,this.map&&r.success?(Ed.setupEventHandlers(this.map,o=>{this.styleLoaded=o}),!0):!1}getMap(){return this.map}isStyleLoaded(){return this.styleLoaded}async cleanup(){await y0.cleanup(this.map),this.map=null,this.styleLoaded=!1}};H(Mt,"instance");let ni=Mt;const Ue=ni.getInstance(),w0=t=>{const e=document.createElement("div");e.className="relative";const n=document.createElement("div");n.className="w-4 h-4 bg-blue-500 rounded-full border-2 border-white shadow-lg";const r=document.createElement("div"),o=Math.min(Math.max(t/5,16),100);return r.style.width=`${o}px`,r.style.height=`${o}px`,r.style.position="absolute",r.style.left=`${-o/2+8}px`,r.style.top=`${-o/2+8}px`,r.className="absolute rounded-full bg-blue-500/20 animate-pulse",e.appendChild(r),e.appendChild(n),e},Tn=new Map,b0=async t=>{try{if(Tn.has(t)){console.log(`Already subscribed to updates for car ${t}`);return}const{data:{user:e}}=await I.auth.getUser();if(!e){te.error("You must be logged in to subscribe to location updates");return}console.log(`Subscribing to real-time location updates for car ${t}`);const n=I.channel(`car-location-${t}`).on("presence",{event:"sync"},()=>{const r=n.presenceState();console.log("Current presence state:",r)}).on("presence",{event:"join"},({key:r,newPresences:o})=>{console.log("Join event:",r,o),te.success("Someone is now tracking this car location")}).on("presence",{event:"leave"},({key:r,leftPresences:o})=>{console.log("Leave event:",r,o),te.info("Someone stopped tracking this car location")}).on("broadcast",{event:"location-update"},r=>{E0(r.payload)}).subscribe(async r=>{r==="SUBSCRIBED"&&(await n.track({user_id:e.id,online_at:new Date().toISOString()}),console.log(`Successfully subscribed to location updates for car ${t}`),Tn.set(t,{subscription:n,userId:e.id}))})}catch(e){console.error("Error subscribing to location updates:",e),te.error("Failed to subscribe to location updates")}},S0=t=>{try{const e=Tn.get(t);if(!e){console.log(`No active subscription found for car ${t}`);return}console.log(`Unsubscribing from location updates for car ${t}`),e.subscription.unsubscribe(),Tn.delete(t),console.log(`Successfully unsubscribed from location updates for car ${t}`)}catch(e){console.error("Error unsubscribing from location updates:",e)}},_0=async(t,e)=>{try{const{data:{user:n}}=await I.auth.getUser();if(!n)return;const r=Tn.get(e);if(!r||r.userId!==n.id){console.log("No active subscription or not the owner, not broadcasting");return}const o={carId:e,userId:n.id,latitude:t.latitude,longitude:t.longitude,accuracy:t.accuracy,timestamp:new Date().toISOString(),scope:"all"};console.log("Broadcasting location update:",o),await r.subscription.send({type:"broadcast",event:"location-update",payload:o}),console.log("Location update broadcast successful")}catch(n){console.error("Error broadcasting location update:",n)}},E0=t=>{console.log("Received location update:",t),Se.emit({type:"realtimeLocationUpdate",payload:{carId:t.carId,location:{latitude:t.latitude,longitude:t.longitude,accuracy:t.accuracy},userId:t.userId,timestamp:t.timestamp}})},Pt=class Pt{constructor(){H(this,"watchId",null);H(this,"userMarker",null);H(this,"carId",null);H(this,"lastBroadcast",0);H(this,"broadcastInterval",5e3)}static getInstance(){return Pt.instance||(Pt.instance=new Pt),Pt.instance}startTracking(){if(!navigator.geolocation){Se.emit({type:"error",payload:"Geolocation is not supported by your browser"});return}this.watchId===null&&(this.getUserCar(),this.watchId=navigator.geolocation.watchPosition(this.handleLocationUpdate.bind(this),this.handleLocationError.bind(this),{enableHighAccuracy:!0,timeout:1e4,maximumAge:5e3}))}stopTracking(){this.watchId!==null&&(navigator.geolocation.clearWatch(this.watchId),this.watchId=null),this.userMarker&&(this.userMarker.remove(),this.userMarker=null),this.carId=null}async getUserCar(){try{const{data:{user:e}}=await I.auth.getUser();if(!e)return;const{data:n}=await I.from("cars").select("id").eq("owner_id",e.id);n&&n.length>0&&(this.carId=n[0].id,console.log(`Set active car ID for location broadcasting: ${this.carId}`))}catch(e){console.error("Error fetching user car:",e)}}handleLocationUpdate(e){const n={latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy};this.updateMarker(n),Se.emit({type:"locationUpdate",payload:n});const r=Date.now();this.carId&&r-this.lastBroadcast>this.broadcastInterval&&(_0(n,this.carId),this.lastBroadcast=r)}handleLocationError(e){let n="Location error: ";switch(e.code){case e.PERMISSION_DENIED:n+="Location permission denied",te.error(n);break;case e.POSITION_UNAVAILABLE:n+="Location information unavailable",te.error(n);break;case e.TIMEOUT:n+="Location request timed out",te.error(n);break;default:n+="Unknown error occurred",te.error(n)}Se.emit({type:"error",payload:n})}updateMarker(e){const n=Ue.getMap();if(!n)return;this.userMarker&&this.userMarker.remove();const r=w0(e.accuracy);this.userMarker=new Et.Marker({element:r}).setLngLat([e.longitude,e.latitude]).addTo(n),_d.updateView({center:[e.longitude,e.latitude],zoom:14})}};H(Pt,"instance");let ri=Pt;const wo=ri.getInstance(),It=class It{constructor(){H(this,"state","disabled");H(this,"permissionStatus",null);H(this,"sharingScope","none");H(this,"carId",null);this.checkPermissionStatus()}static getInstance(){return It.instance||(It.instance=new It),It.instance}async checkPermissionStatus(){try{const e=await navigator.permissions.query({name:"geolocation"});this.permissionStatus=e.state,e.addEventListener("change",()=>{this.permissionStatus=e.state,this.handlePermissionChange(e.state)})}catch(e){console.error("Error checking location permission:",e)}}handlePermissionChange(e){switch(e){case"granted":this.state==="enabled"&&wo.startTracking();break;case"denied":this.setState("permission_denied"),te.error("Location permission was denied. Please enable location services to use this feature.");break}}setState(e){this.state=e,Se.emit({type:"locationUpdate",payload:{state:e,sharingScope:this.sharingScope}})}setSharingScope(e,n){return this.sharingScope=e,n&&(this.carId=n),e!=="none"&&this.state==="enabled"?this.startRealTimeSharing():this.stopRealTimeSharing(),Se.emit({type:"locationUpdate",payload:{state:this.state,sharingScope:e}}),this.sharingScope}getSharingScope(){return this.sharingScope}async startRealTimeSharing(){if(!this.carId){const e=await this.getUserCar();if(e&&e.length>0)this.carId=e[0].id;else{console.warn("No car found for real-time location sharing");return}}b0(this.carId),te.success(`Real-time location sharing ${this.sharingScope==="trip_only"?"for trips":""} enabled`)}stopRealTimeSharing(){this.carId&&(S0(this.carId),te.success("Real-time location sharing disabled"))}async getUserCar(){try{const{data:{user:e}}=await I.auth.getUser();if(!e)return null;const{data:n}=await I.from("cars").select("id").eq("owner_id",e.id);return n}catch(e){return console.error("Error fetching user car:",e),null}}async enableTracking(){try{const{data:{user:e}}=await I.auth.getUser();return e?navigator.geolocation?(wo.startTracking(),this.setState("enabled"),this.sharingScope!=="none"&&this.startRealTimeSharing(),te.success("Location tracking enabled"),!0):(te.error("Geolocation is not supported by your browser"),!1):(te.error("You must be logged in to enable location tracking"),!1)}catch(e){return console.error("Error enabling tracking:",e),this.setState("error"),te.error("Failed to enable location tracking"),!1}}disableTracking(){wo.stopTracking(),this.stopRealTimeSharing(),this.setState("disabled"),te.success("Location tracking disabled")}getCurrentState(){return this.state}};H(It,"instance");let oi=It;const QC=oi.getInstance();let bo=null;const Xi=async()=>{try{if(bo)return console.log("Using cached Mapbox token"),bo;console.log("Fetching new Mapbox token");const t="pk.eyJ1IjoibWFwaGFueWFuZSIsImEiOiJjbTdtMHp1OHUwaDhxMmlxdG5za3QzNTNzIn0.naTWJv5M3LuvUvB18-5RSQ";return typeof window<"u"&&window.mapboxgl?(console.log("Setting token on mapboxgl instance:",t.substring(0,10)+"..."),window.mapboxgl.accessToken=t):console.log("mapboxgl not available yet, token will be set later"),bo=t,console.log("Mapbox token retrieved successfully"),t}catch(t){return console.error("Error getting Mapbox token:",t),""}},C0=d.createContext({token:null,isValid:!1,loading:!0,refreshToken:async()=>{}}),T0=({children:t})=>{const[e,n]=d.useState({token:null,isValid:!1,loading:!0}),r=async()=>{console.info("[MapboxTokenProvider] Initializing token..."),n(i=>({...i,loading:!0}));try{const i=await Xi();if(console.info("[MapboxTokenProvider] Token initialized:",i?"✓":"✗"),!i)throw new Error("No token returned from token manager");window.mapboxgl?(console.log("[MapboxTokenProvider] Setting token on mapboxgl:",i.substring(0,10)+"..."),window.mapboxgl.accessToken=i):console.warn("[MapboxTokenProvider] mapboxgl not available yet"),n({token:i,isValid:!0,loading:!1})}catch(i){console.error("[MapboxTokenProvider] Failed to initialize token",i),te.error("Failed to initialize map. Please try again later."),n({token:null,isValid:!1,loading:!1})}},o=async()=>{console.info("[MapboxTokenProvider] Refreshing token...");try{n(i=>({...i,loading:!0,isValid:!1})),await r(),console.info("[MapboxTokenProvider] Token refresh completed successfully"),te.success("Map configuration refreshed")}catch(i){throw console.error("[MapboxTokenProvider] Token refresh failed",i),te.error("Failed to refresh map configuration"),i}};return d.useEffect(()=>{console.info("[MapboxTokenProvider] Component mounted, initializing token..."),r()},[]),l.jsx(C0.Provider,{value:{...e,refreshToken:o},children:t})};var k0=Object.defineProperty,A0=Object.defineProperties,N0=Object.getOwnPropertyDescriptors,pr=Object.getOwnPropertySymbols,Cd=Object.prototype.hasOwnProperty,Td=Object.prototype.propertyIsEnumerable,xa=(t,e,n)=>e in t?k0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fe=(t,e)=>{for(var n in e||(e={}))Cd.call(e,n)&&xa(t,n,e[n]);if(pr)for(var n of pr(e))Td.call(e,n)&&xa(t,n,e[n]);return t},kd=(t,e)=>A0(t,N0(e)),j0=(t,e)=>{var n={};for(var r in t)Cd.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&pr)for(var r of pr(t))e.indexOf(r)<0&&Td.call(t,r)&&(n[r]=t[r]);return n},R0=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},So=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},tr=(t,e,n)=>(R0(t,e,"access private method"),n),xn=(t,e,n)=>new Promise((r,o)=>{var i=c=>{try{a(n.next(c))}catch(p){o(p)}},s=c=>{try{a(n.throw(c))}catch(p){o(p)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,s);a((n=n.apply(t,e)).next())}),Ce=class{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90");if(this.lng>180||this.lng<-180)throw new Error("Invalid LngLat longitude value: must be between -180 and 180")}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}static convert(t){if(t instanceof Ce)return new Ce(t.lng,t.lat);if(Array.isArray(t)&&t.length===2)return new Ce(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null&&("lng"in t||"lon"in t)&&"lat"in t)return new Ce(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}},yn=class{constructor(t,e){this._sw=Ce.convert(t),this._ne=Ce.convert(e)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ce(this.getWest(),this.getNorth())}getSouthEast(){return new Ce(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toFlatArray(){return[this._sw.lng,this._sw.lat,this._ne.lng,this._ne.lat]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}static convert(t){if(!t)throw new Error("Invalid LngLatBounds convert value: falsy");if(t instanceof yn)return new yn(t.getSouthWest(),t.getNorthEast());if(Array.isArray(t)&&t.length===2)return new yn(Ce.convert(t[0]),Ce.convert(t[1]));if(Array.isArray(t)&&t.length===4)return new yn(Ce.convert([t[0],t[1]]),Ce.convert([t[2],t[3]]));throw new Error("`LngLatBoundsLike` argument must be specified as an array [<LngLatLike>, <LngLatLike>] or an array [<west>, <south>, <east>, <north>]")}};function M0(){const e=(Math.random().toString(16)+Date.now().toString(16)+Math.random().toString(16)).replace(/\./g,"");return[e.slice(0,8),e.slice(8,12),"4"+e.slice(12,15)+"-8"+e.slice(15,18),e.slice(18,30)].join("-")}var ur=class{constructor(t){this.id=t??M0()}toString(){return this.id}static convert(t){return new ur(t instanceof ur?t.id:t.toString())}},P0="Unknown error",I0=class extends Error{constructor(t,e){super(String(t.message||t.error||P0)),this.name="MapboxError",this.statusCode=e}toString(){return`${this.name} (${this.statusCode}): ${this.message}`}};function Kn(t){return xn(this,null,function*(){if(!t.ok){const e=yield t.json();throw new I0(e,t.status)}})}var ya=globalThis.fetch,O0=globalThis.AbortController;function Yn(){if(!ya)throw new Error("Fetch implementation not found. Please include a fetch polyfill in your application or use `polyfillFetch` from `@mapbox/search-js-core` to fix this issue.");return{fetch:ya,AbortController:O0}}function ii(...t){const e=[];for(const n of t){if(!n)continue;const r=Object.entries(n);for(const[o,i]of r)i!=null&&e.push(`${o}=${encodeURIComponent(String(i))}`)}return e.join("&")}var Fr="https://api.mapbox.com/search/searchbox/v1",L0="suggest",D0="retrieve",z0="category",F0="reverse",$0=`${Fr}/${L0}`,U0=`${Fr}/${D0}`,H0=`${Fr}/${z0}`,B0=`${Fr}/${F0}`,Ad="\\.\\d{1,256}",V0=`\\d{1,3}(${Ad})?`,wa=`(-?(${V0}|${Ad}))`,q0=new RegExp(`^[ ]*${wa},\\s*${wa}[ ]*$`),G0=/[\s,]+/,nr,si,ai,Nd,Qi,jd,Rd=class{constructor(t={}){So(this,nr),So(this,ai),So(this,Qi);const e=t,{accessToken:n}=e,r=j0(e,["accessToken"]);this.accessToken=n,this.defaults=Fe(Fe({},Rd.defaults),r)}suggest(t,e){return xn(this,null,function*(){var n;if(!t)throw new Error("searchText is required");if(q0.test(t)&&e.allowReverse){let m=t.trim().split(G0).map(x=>x.trim());e.flipCoordinates&&(m=m.reverse());const u=m.join(","),h=yield this.reverse(u,e);return tr(this,ai,Nd).call(this,h)}const{sessionToken:o,signal:i}=e,s=kd(Fe(Fe({},this.defaults),e),{q:t,sessionToken:o});if(s.eta_type&&(!s.origin||!s.navigation_profile))throw new Error("to provide eta estimate: eta, navigation_profile, and origin are required");if(s.origin&&!s.navigation_profile)throw new Error("to provide distance estimate: both navigation_profile and origin are required");const a=new URL($0);a.search=tr(this,nr,si).call(this,s);const{fetch:c}=Yn(),p=yield c(a.toString(),{signal:i});yield Kn(p);const f=yield p.json();return f.url=a.toString(),(n=f.suggestions)==null||n.forEach(m=>{m._source="mapbox"}),f})}retrieve(t,e){return xn(this,null,function*(){if(!t)throw new Error("suggestion is required");if(t._originalFeature)return{type:"FeatureCollection",features:[t._originalFeature],url:t._originalUrl||""};if(t._geometry)return{type:"FeatureCollection",features:[{type:"Feature",properties:t,geometry:t._geometry}]};const{sessionToken:n,signal:r,language:o}=e,i=ur.convert(n),s=Fe(Fe({},this.defaults),o&&{language:o}),a=new URL(`${U0}/${encodeURIComponent(t.mapbox_id)}`);a.search=ii({access_token:this.accessToken,session_token:i.id},{language:s.language});const{fetch:c}=Yn(),p=yield c(a.toString(),{signal:r});yield Kn(p);const f=yield p.json();return f.url=a.toString(),f})}category(t){return xn(this,arguments,function*(e,n={}){if(!e)throw new Error("category is required");const r=Fe(Fe({},this.defaults),n),o=new URL(`${H0}/${encodeURIComponent(e)}`);o.search=tr(this,nr,si).call(this,r);const{fetch:i}=Yn(),s=yield i(o.toString(),{signal:r.signal});yield Kn(s);const a=yield s.json();return a.url=o.toString(),a})}reverse(t){return xn(this,arguments,function*(e,n={}){var r;if(!e)throw new Error("lngLat is required");const[o,i]=typeof e=="string"?e.split(",").map(m=>parseFloat(m)):Ce.convert(e).toArray();if(isNaN(o)||isNaN(i))throw new Error("lngLat is required");const s=Fe(Fe({},this.defaults),n),a=new URL(B0);a.search=ii({access_token:this.accessToken,language:s.language,limit:s.limit,longitude:o,latitude:i},s.types&&{types:typeof s.types=="string"?s.types:[...s.types].join(",")});const{fetch:c}=Yn(),p=yield c(a.toString(),{signal:s.signal});yield Kn(p);const f=yield p.json();return f.url=a.toString(),(r=f.features)==null||r.forEach(m=>{m._source="mapbox"}),f})}},Md=Rd;nr=new WeakSet;si=function(t){return ii({q:t.q,access_token:this.accessToken,language:t.language,limit:t.limit,navigation_profile:t.navigation_profile,route:t.route,route_geometry:t.route_geometry,sar_type:t.sar_type,time_deviation:t.time_deviation,eta_type:t.eta_type,country:t.country,poi_category:t.poi_category,rich_metadata_provider:t.rich_metadata_provider,poi_category_exclusions:t.poi_category_exclusions},t.sessionToken&&{session_token:ur.convert(t.sessionToken).id},t.proximity&&{proximity:typeof t.proximity=="string"?t.proximity:Ce.convert(t.proximity).toArray().join(",")},t.origin&&{origin:typeof t.origin=="string"?t.origin:Ce.convert(t.origin).toArray().join(",")},t.bbox&&{bbox:typeof t.bbox=="string"?t.bbox:yn.convert(t.bbox).toFlatArray().join(",")},t.types&&{types:typeof t.types=="string"?t.types:[...t.types].join(",")})};ai=new WeakSet;Nd=function(t){return{suggestions:t.features.map(e=>tr(this,Qi,jd).call(this,e,t.url)),attribution:t.attribution,url:t.url}};Qi=new WeakSet;jd=function(t,e){return kd(Fe({},t.properties),{_originalFeature:t,_originalUrl:e,_source:t._source})};Md.defaults={language:"en"};class W0{constructor(){H(this,"searchBox",null);H(this,"isInitialized",!1);H(this,"sessionToken",null)}async initialize(){if(!this.isInitialized)try{const e=await Xi();if(!e)throw new Error("Mapbox token not available");this.searchBox=new Md({accessToken:e,language:"en",limit:5,country:"BW"}),this.sessionToken=crypto.randomUUID(),this.isInitialized=!0,console.log("Mapbox Search JS initialized successfully")}catch(e){throw console.error("Failed to initialize Mapbox Search JS:",e),e}}async search(e){if(this.isInitialized||await this.initialize(),!this.searchBox||!e.trim()||!this.sessionToken)return{suggestions:[],query:e};try{return{suggestions:(await this.searchBox.suggest(e,{sessionToken:this.sessionToken,proximity:[25.9087,-24.6541]})).suggestions.map(o=>{var i,s,a,c,p,f,m,u,h,x,g,v;return{id:o.mapbox_id||o.name,name:o.name,full_address:o.full_address||o.place_formatted||o.name,coordinates:[((s=(i=o._geometry)==null?void 0:i.coordinates)==null?void 0:s[0])||0,((c=(a=o._geometry)==null?void 0:a.coordinates)==null?void 0:c[1])||0],place_type:o.feature_type||"place",context:{country:(f=(p=o.context)==null?void 0:p.country)==null?void 0:f.name,region:(u=(m=o.context)==null?void 0:m.region)==null?void 0:u.name,district:(x=(h=o.context)==null?void 0:h.district)==null?void 0:x.name,place:(v=(g=o.context)==null?void 0:g.place)==null?void 0:v.name}}}),query:e}}catch(n){return console.error("Search failed:",n),{suggestions:[],query:e}}}async getCoordinates(e){if(this.isInitialized||await this.initialize(),!this.searchBox||!this.sessionToken)return null;try{const n={mapbox_id:e,name:"",name_preferred:"",feature_type:"poi",address:"",full_address:"",place_formatted:"",context:{},language:"en",maki:"",poi_category:[],poi_category_ids:[],brand:[],brand_id:"",external_ids:{},metadata:{},_geometry:{coordinates:[0,0]}},r=await this.searchBox.retrieve(n,{sessionToken:this.sessionToken});if(r.features&&r.features.length>0){const o=r.features[0];return[o.geometry.coordinates[0],o.geometry.coordinates[1]]}return null}catch(n){return console.error("Failed to retrieve coordinates:",n),null}}}const K0=new W0,Pd=d.createContext(void 0),JC=()=>{const t=d.useContext(Pd);if(!t)throw new Error("useLocationSearch must be used within a LocationSearchProvider");return t},Y0=({children:t})=>{const[e,n]=d.useState({suggestions:[],query:""}),[r,o]=d.useState([]),[i,s]=d.useState([]),[a,c]=d.useState(!1),[p,f]=d.useState(null);d.useEffect(()=>{const v=localStorage.getItem("locationRecentSearches"),y=localStorage.getItem("locationFavorites");if(v)try{o(JSON.parse(v))}catch(w){console.error("Failed to parse recent searches:",w)}if(y)try{s(JSON.parse(y))}catch(w){console.error("Failed to parse favorites:",w)}},[]);const m=d.useCallback(async v=>{if(!v.trim()){n({suggestions:[],query:""});return}c(!0),f(null);try{const y=await K0.search(v);n(y)}catch(y){f("Search failed. Please try again."),console.error("Search error:",y)}finally{c(!1)}},[]),u=d.useCallback(v=>{o(y=>{const w=y.filter(S=>S.id!==v.id),b=[v,...w].slice(0,10);return localStorage.setItem("locationRecentSearches",JSON.stringify(b)),b})},[]),h=d.useCallback(v=>{s(y=>{if(y.some(b=>b.id===v.id))return y;const w=[...y,v];return localStorage.setItem("locationFavorites",JSON.stringify(w)),w})},[]),x=d.useCallback(v=>{s(y=>{const w=y.filter(b=>b.id!==v);return localStorage.setItem("locationFavorites",JSON.stringify(w)),w})},[]),g=d.useCallback(()=>{o([]),localStorage.removeItem("locationRecentSearches")},[]);return l.jsx(Pd.Provider,{value:{searchResults:e,recentSearches:r,favorites:i,isLoading:a,error:p,search:m,selectLocation:u,addToFavorites:h,removeFromFavorites:x,clearRecentSearches:g},children:t})};var it=(t=>(t.PERSONAL_INFO="personal_info",t.DOCUMENT_UPLOAD="document_upload",t.SELFIE_VERIFICATION="selfie_verification",t.PHONE_VERIFICATION="phone_verification",t.ADDRESS_CONFIRMATION="address_confirmation",t.REVIEW_SUBMIT="review_submit",t.PROCESSING_STATUS="processing_status",t.COMPLETION="completion",t))(it||{}),X0=(t=>(t.NOT_STARTED="not_started",t.IN_PROGRESS="in_progress",t.COMPLETED="completed",t.FAILED="failed",t.REJECTED="rejected",t.PENDING_REVIEW="pending_review",t))(X0||{});class Ke{static async fetchUserProfileData(e){try{const{data:n,error:r}=await I.from("profiles").select("full_name, phone_number, emergency_contact_name, emergency_contact_phone, role").eq("id",e).maybeSingle();return r?(console.error("[VerificationService] Error fetching profile:",r),null):n}catch(n){return console.error("[VerificationService] Failed to fetch profile:",n),null}}static mapProfileToPersonalInfo(e,n){return e?{fullName:e.full_name||"",phoneNumber:e.phone_number||"",email:n||"",emergencyContact:{name:e.emergency_contact_name||"",relationship:"",phoneNumber:e.emergency_contact_phone||""},dateOfBirth:"",nationalIdNumber:"",address:{street:"",area:"",city:"",postalCode:""}}:{email:n||""}}static determineCompletionStatus(e){return e?{personal_info_completed:!!(e.full_name&&e.phone_number),phone_verified:!!e.phone_number}:{personal_info_completed:!1,phone_verified:!1}}static async initializeVerification(e,n){try{console.log("[VerificationService] Initializing verification for user:",e);const{data:r}=await I.from("user_verifications").select("*").eq("user_id",e).maybeSingle();if(r)return console.log("[VerificationService] Verification already exists:",r),r;const o=await this.fetchUserProfileData(e);console.log("[VerificationService] Fetched profile data:",o);const{data:{user:i}}=await I.auth.getUser(),s=(i==null?void 0:i.email)||null,a=this.mapProfileToPersonalInfo(o,s),c=this.determineCompletionStatus(o);let p="personal_info";c.personal_info_completed&&(p="document_upload");const{data:f,error:m}=await I.from("user_verifications").insert([{user_id:e,current_step:p,overall_status:"not_started",personal_info:a,user_role:n,personal_info_completed:c.personal_info_completed,documents_completed:!1,selfie_completed:!1,phone_verified:c.phone_verified,address_confirmed:!1}]).select().single();if(m)throw console.error("[VerificationService] Error creating verification:",m.message,"Code:",m.code),new Error(`Failed to initialize verification: ${m.message}`);return console.log("[VerificationService] Created verification with profile data:",f),f}catch(r){throw console.error("[VerificationService] Failed to initialize verification:",r),r}}static async loadVerificationData(e){try{const{data:n,error:r}=await I.from("user_verifications").select("*").eq("user_id",e).maybeSingle();return r?(console.error("[VerificationService] Error loading verification:",r),null):n}catch(n){return console.error("[VerificationService] Failed to load verification:",n),null}}static async updatePersonalInfo(e,n){try{const{error:r}=await I.from("user_verifications").update({personal_info:n,personal_info_completed:!0,current_step:"document_upload",last_updated_at:new Date().toISOString()}).eq("user_id",e);return r?(console.error("[VerificationService] Failed to update personal info:",r),!1):!0}catch(r){return console.error("[VerificationService] Failed to update personal info:",r),!1}}static async completeSelfieVerification(e){try{const{error:n}=await I.from("user_verifications").update({selfie_completed:!0,current_step:"phone_verification",last_updated_at:new Date().toISOString()}).eq("user_id",e);return n?(console.error("[VerificationService] Failed to complete selfie verification:",n),!1):!0}catch(n){return console.error("[VerificationService] Failed to complete selfie verification:",n),!1}}static async updatePhoneVerification(e,n){try{const{error:r}=await I.from("user_verifications").update({phone_verified:!!n.isVerified,current_step:n.isVerified?"address_confirmation":"phone_verification",last_updated_at:new Date().toISOString()}).eq("user_id",e);return r?(console.error("[VerificationService] Failed to update phone verification:",r),!1):!0}catch(r){return console.error("[VerificationService] Failed to update phone verification:",r),!1}}static async updateAddressConfirmation(e,n){try{const{error:r}=await I.from("user_verifications").update({address_confirmed:!!n.isConfirmed,current_step:n.isConfirmed?"review_submit":"address_confirmation",last_updated_at:new Date().toISOString()}).eq("user_id",e);return r?(console.error("[VerificationService] Failed to update address confirmation:",r),!1):!0}catch(r){return console.error("[VerificationService] Failed to update address confirmation:",r),!1}}static async submitForReview(e){try{const{error:n}=await I.from("user_verifications").update({current_step:"processing_status",overall_status:"pending_review",last_updated_at:new Date().toISOString()}).eq("user_id",e);return n?(console.error("[VerificationService] Failed to submit for review:",n),!1):!0}catch(n){return console.error("[VerificationService] Failed to submit for review:",n),!1}}static async completeVerification(e){try{const{error:n}=await I.from("user_verifications").update({current_step:"completion",overall_status:"completed",completed_at:new Date().toISOString(),last_updated_at:new Date().toISOString()}).eq("user_id",e);return n?(console.error("[VerificationService] Failed to complete verification:",n),!1):!0}catch(n){return console.error("[VerificationService] Failed to complete verification:",n),!1}}static async completeDocumentUpload(e){try{const{error:n}=await I.from("user_verifications").update({documents_completed:!0,current_step:it.SELFIE_VERIFICATION,last_updated_at:new Date().toISOString()}).eq("user_id",e);return n?(console.error("[VerificationService] Failed to complete document upload:",n),!1):!0}catch(n){return console.error("[VerificationService] Failed to complete document upload:",n),!1}}static async navigateToStep(e,n){try{const{error:r}=await I.from("user_verifications").update({current_step:n,last_updated_at:new Date().toISOString()}).eq("user_id",e);return r?(console.error("[VerificationService] Failed to navigate to step:",r),!1):!0}catch(r){return console.error("[VerificationService] Failed to navigate to step:",r),!1}}static async refreshFromProfile(e){try{const n=await this.fetchUserProfileData(e),{data:{user:r}}=await I.auth.getUser(),o=(r==null?void 0:r.email)||null,i=this.mapProfileToPersonalInfo(n,o),s=this.determineCompletionStatus(n),{error:a}=await I.from("user_verifications").update({personal_info:i,personal_info_completed:s.personal_info_completed,phone_verified:s.phone_verified,last_updated_at:new Date().toISOString()}).eq("user_id",e);return a?(console.error("[VerificationService] Failed to refresh from profile:",a),!1):!0}catch(n){return console.error("[VerificationService] Failed to refresh from profile:",n),!1}}}const Id=d.createContext(void 0),ZC=()=>{const t=d.useContext(Id);if(t===void 0)throw new Error("useVerification must be used within a VerificationProvider");return t},Q0=({children:t})=>{const[e,n]=d.useState(null),[r,o]=d.useState(!1),[i,s]=d.useState(null),[a,c]=d.useState(!1),p=d.useCallback(async(E,T)=>{if(r||a){console.log("[VerificationContext] Skipping initialization - already loading or initialized");return}try{o(!0),s(null),console.log("[VerificationContext] Initializing verification for user:",E);const C=await Ke.initializeVerification(E,T);n(C),c(!0)}catch(C){console.error("[VerificationContext] Failed to initialize verification:",C),s(C instanceof Error?C.message:"Failed to initialize verification")}finally{o(!1)}},[r,a]),f=d.useCallback(async()=>{if(e!=null&&e.user_id)try{const E=await Ke.loadVerificationData(e.user_id);E&&n(E)}catch(E){console.error("[VerificationContext] Failed to refresh data:",E)}},[e==null?void 0:e.user_id]),m=d.useCallback(async()=>{if(e!=null&&e.user_id)try{o(!0),await Ke.refreshFromProfile(e.user_id),await f()}catch(E){throw console.error("[VerificationContext] Failed to refresh from profile:",E),E}finally{o(!1)}},[e==null?void 0:e.user_id,f]),u=d.useCallback(async E=>{if(!(e!=null&&e.user_id))throw new Error("No verification data");try{o(!0),await Ke.updatePersonalInfo(e.user_id,E),await f()}catch(T){throw console.error("[VerificationContext] Failed to update personal info:",T),T}finally{o(!1)}},[e==null?void 0:e.user_id,f]),h=d.useCallback(async E=>{try{o(!0);const T=await Ke.completeDocumentUpload(E);return T&&await f(),T}catch(T){return console.error("Failed to complete document upload:",T),!1}finally{o(!1)}},[f]),x=d.useCallback(async()=>{if(!(e!=null&&e.user_id))throw new Error("No verification data");try{o(!0),await Ke.completeSelfieVerification(e.user_id),await f()}catch(E){throw console.error("[VerificationContext] Failed to complete selfie verification:",E),E}finally{o(!1)}},[e==null?void 0:e.user_id,f]),g=d.useCallback(async E=>{if(!(e!=null&&e.user_id))throw new Error("No verification data");try{o(!0),await Ke.updatePhoneVerification(e.user_id,E),await f()}catch(T){throw console.error("[VerificationContext] Failed to update phone verification:",T),T}finally{o(!1)}},[e==null?void 0:e.user_id,f]),v=d.useCallback(async E=>{if(!(e!=null&&e.user_id))throw new Error("No verification data");try{o(!0),await Ke.updateAddressConfirmation(e.user_id,E),await f()}catch(T){throw console.error("[VerificationContext] Failed to update address confirmation:",T),T}finally{o(!1)}},[e==null?void 0:e.user_id,f]),y=d.useCallback(async()=>{if(!(e!=null&&e.user_id))throw new Error("No verification data");try{o(!0),await Ke.submitForReview(e.user_id),await f()}catch(E){throw console.error("[VerificationContext] Failed to submit for review:",E),E}finally{o(!1)}},[e==null?void 0:e.user_id,f]),w=d.useCallback(async E=>{if(!(e!=null&&e.user_id))throw new Error("No verification data");try{await Ke.navigateToStep(e.user_id,E),await f()}catch(T){throw console.error("[VerificationContext] Failed to navigate to step:",T),T}},[e==null?void 0:e.user_id,f]),b=d.useCallback(E=>{if(!e)return!1;switch(E){case it.PERSONAL_INFO:return!0;case it.DOCUMENT_UPLOAD:return e.personal_info_completed;case it.SELFIE_VERIFICATION:return e.personal_info_completed&&e.documents_completed;case it.PHONE_VERIFICATION:return e.personal_info_completed&&e.documents_completed&&e.selfie_completed;case it.ADDRESS_CONFIRMATION:return e.personal_info_completed&&e.documents_completed&&e.selfie_completed&&e.phone_verified;case it.REVIEW_SUBMIT:return e.personal_info_completed&&e.documents_completed&&e.selfie_completed&&e.phone_verified&&e.address_confirmed;default:return!1}},[e]),S=d.useCallback(()=>{if(!e)return{completed:0,total:8,percentage:0};const E=Object.values(it),C=E.indexOf(e.current_step)+1,k=E.length,R=Math.round(C/k*100);return{completed:C,total:k,percentage:R}},[e]),_=d.useCallback(()=>{n(null),o(!1),s(null),c(!1)},[]),A={verificationData:e,isLoading:r,error:i,isInitialized:a,initializeVerification:p,refreshData:f,refreshFromProfile:m,updatePersonalInfo:u,completeDocumentUpload:h,completeSelfieVerification:x,updatePhoneVerification:g,updateAddressConfirmation:v,submitForReview:y,navigateToStep:w,canNavigateToStep:b,getStepProgress:S,resetVerification:_};return l.jsx(Id.Provider,{value:A,children:t})},J0=1,Z0=1e6;let _o=0;function eS(){return _o=(_o+1)%Number.MAX_SAFE_INTEGER,_o.toString()}const Eo=new Map,ba=t=>{if(Eo.has(t))return;const e=setTimeout(()=>{Eo.delete(t),Sn({type:"REMOVE_TOAST",toastId:t})},Z0);Eo.set(t,e)},tS=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,J0)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?ba(n):t.toasts.forEach(r=>{ba(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},rr=[];let or={toasts:[]};function Sn(t){or=tS(or,t),rr.forEach(e=>{e(or)})}function Od({...t}){const e=eS(),n=o=>Sn({type:"UPDATE_TOAST",toast:{...o,id:e}}),r=()=>Sn({type:"DISMISS_TOAST",toastId:e});return Sn({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:o=>{o||r()}}}),{id:e,dismiss:r,update:n}}function eT(){const[t,e]=d.useState(or);return d.useEffect(()=>(rr.push(e),()=>{const n=rr.indexOf(e);n>-1&&rr.splice(n,1)}),[t]),{...t,toast:Od,dismiss:n=>Sn({type:"DISMISS_TOAST",toastId:n})}}const Re={success:(t,e)=>{te.success(t,{duration:(e==null?void 0:e.duration)||4e3})},error:(t,e)=>{te.error(t,{duration:(e==null?void 0:e.duration)||6e3})},info:(t,e)=>{te.info(t,{duration:(e==null?void 0:e.duration)||4e3})},warning:(t,e)=>{te.warning(t,{duration:(e==null?void 0:e.duration)||5e3})},loading:t=>te.loading(t),promise:(t,e)=>te.promise(t,e),dismiss:t=>{te.dismiss(t)},custom:t=>Od({title:t.title,description:t.description,variant:t.variant,action:t.action,duration:t.duration})},nS=async t=>{try{const{data:{user:e},error:n}=await I.auth.getUser();if(n)throw console.error("Authentication error:",n),new Error(`Authentication failed: ${n.message}`);if(!e)throw console.error("No user found in authentication"),new Error("User not authenticated - no user object returned");const{data:r,error:o}=await I.from("handover_sessions").select("*").eq("booking_id",t.booking_id).eq("handover_type","pickup").maybeSingle();if(o)throw console.error("Error checking existing pickup handover session:",o),new Error(`Failed to check existing pickup session: ${o.message}`);if(r)return{...r,handover_type:r.handover_type||"pickup"};const i={booking_id:t.booking_id,host_id:t.host_id,renter_id:t.renter_id,host_ready:!1,renter_ready:!1,handover_completed:!1,handover_type:"pickup"},{data:s,error:a}=await I.from("handover_sessions").insert(i).select().single();if(a)throw console.error("Error creating pickup handover session:",a),a.code==="23503"?new Error("Invalid booking, host, or renter ID - record not found"):a.code==="42501"?(console.error("RLS policy violation:",a),Re.error("Permission denied: You don't have access to create a pickup handover session"),new Error("Permission denied - check RLS policies for handover_sessions")):new Error(`Failed to create pickup handover session: ${a.message}`);if(!s)throw new Error("Failed to create pickup handover session - no data returned");if(e.id===t.host_id)try{const{data:c}=await I.from("profiles").select("full_name").eq("id",t.host_id).single(),p=(c==null?void 0:c.full_name)||"The host",{data:f}=await I.from("bookings").select("car_id").eq("id",t.booking_id).single(),m=f==null?void 0:f.car_id;if(m){const u=`${p} is ready to hand over the car keys. Please share your location to coordinate the pickup.`,{error:h}=await I.from("notifications").insert({type:"pickup_location_shared",title:"Car Pickup Ready",content:u,related_car_id:m,related_booking_id:t.booking_id,role_target:"renter_only"});h&&console.error("Error creating pickup notification:",h.message||JSON.stringify(h,null,2))}}catch(c){console.error("Error sending pickup notification:",c instanceof Error?c.message:JSON.stringify(c,null,2))}return{...s,handover_type:s.handover_type||"pickup"}}catch(e){throw console.error("Pickup handover session creation failed:",e),e}},rS=async t=>{try{const{data:{user:e},error:n}=await I.auth.getUser();if(n)throw console.error("Authentication error:",n),new Error(`Authentication failed: ${n.message}`);if(!e)throw console.error("No user found in authentication"),new Error("User not authenticated - no user object returned");const{data:r,error:o}=await I.from("handover_sessions").select("*").eq("booking_id",t.booking_id).eq("handover_type","return").maybeSingle();if(o)throw console.error("Error checking existing return handover session:",o),new Error(`Failed to check existing return session: ${o.message}`);if(r)return{...r,handover_type:r.handover_type||"return"};const i={booking_id:t.booking_id,host_id:t.host_id,renter_id:t.renter_id,host_ready:!1,renter_ready:!1,handover_completed:!1,handover_type:"return"},{data:s,error:a}=await I.from("handover_sessions").insert(i).select().single();if(a)throw console.error("Error creating return handover session:",a),a.code==="23503"?new Error("Invalid booking, host, or renter ID - record not found"):a.code==="42501"?(console.error("RLS policy violation:",a),Re.error("Permission denied: You don't have access to create a return handover session"),new Error("Permission denied - check RLS policies for handover_sessions")):new Error(`Failed to create return handover session: ${a.message}`);if(!s)throw new Error("Failed to create return handover session - no data returned");if(e.id===t.renter_id)try{const{data:c}=await I.from("profiles").select("full_name").eq("id",t.renter_id).single(),p=(c==null?void 0:c.full_name)||"The renter",{data:f}=await I.from("bookings").select("car_id").eq("id",t.booking_id).single(),m=f==null?void 0:f.car_id;if(m){const u=`${p} is ready to return your car. Please coordinate the return location and time.`,{error:h}=await I.from("notifications").insert({type:"arrival_notification",title:"Car Return Ready",content:u,related_car_id:m,related_booking_id:t.booking_id,role_target:"host_only"});h&&console.error("Error creating return notification:",h.message||JSON.stringify(h,null,2))}}catch(c){console.error("Error sending return notification:",c instanceof Error?c.message:JSON.stringify(c,null,2))}return{...s,handover_type:s.handover_type||"return"}}catch(e){throw console.error("Return handover session creation failed:",e),e}},oS=async(t,e="pickup",n,r)=>{if(!t)throw new Error("Booking ID is required");if(!n)throw new Error("Host ID is required");if(!r)throw new Error("Renter ID is required");if(e==="pickup")return nS({booking_id:t,host_id:n,renter_id:r});if(e==="return")return rS({booking_id:t,host_id:n,renter_id:r});throw new Error(`Invalid handover type: ${e}`)},iS=async(t,e)=>{try{let n=I.from("handover_sessions").select("*").eq("booking_id",t);e&&(n=n.eq("handover_type",e));const{data:r,error:o}=await n.order("created_at",{ascending:!1}).limit(1).maybeSingle();if(o)throw o;return r}catch(n){return console.error("Error fetching handover session:",n instanceof Error?n.message:JSON.stringify(n,null,2)),null}},sS=async(t,e,n,r)=>{try{const o=n?"host_location":"renter_location",{error:i}=await I.from("handover_sessions").update({[o]:r,updated_at:new Date().toISOString()}).eq("id",t).eq(n?"host_id":"renter_id",e);if(i)throw i;return!0}catch(o){return console.error("Error updating location:",o),Re.error("Failed to update your location"),!1}},tT=async t=>{try{const{error:e}=await I.from("handover_sessions").update({handover_completed:!0,updated_at:new Date().toISOString()}).eq("id",t);if(e)throw e;return!0}catch(e){return console.error("Error completing handover:",e),Re.error("Failed to complete handover"),!1}},Ld=d.createContext(void 0),nT=()=>{const t=d.useContext(Ld);if(!t)throw new Error("useHandover must be used within a HandoverProvider");return t},Sa=t=>{if(!t)return null;try{if(typeof t=="string"){const e=JSON.parse(t);return{latitude:e.latitude,longitude:e.longitude,address:e.address||"",timestamp:e.timestamp||Date.now()}}else if(typeof t=="object"&&t!==null){const e=t;return{latitude:e.latitude,longitude:e.longitude,address:e.address||"",timestamp:e.timestamp||Date.now()}}return null}catch(e){return console.error("Error converting location data:",e),null}},aS=t=>t?{id:t.id,booking_id:t.booking_id,host_id:t.host_id,renter_id:t.renter_id,host_ready:!!t.host_ready,renter_ready:!!t.renter_ready,host_location:Sa(t.host_location),renter_location:Sa(t.renter_location),handover_completed:!!t.handover_completed,handover_type:t.handover_type||"pickup",created_at:t.created_at,updated_at:t.updated_at}:null,cS=t=>{if(!t)return"pickup";const e=new Date,n=new Date(t.start_date),r=new Date(t.end_date),o=Math.abs(e.getTime()-n.getTime()),i=Math.abs(e.getTime()-r.getTime());return e>=n&&i<o?"return":"pickup"},lS=({children:t})=>{const[e]=ku(),n=e.get("bookingId"),[r,o]=d.useState(null),[i,s]=d.useState(null),[a,c]=d.useState(null),[p,f]=d.useState(null),[m,u]=d.useState(null),[h,x]=d.useState(null),[g,v]=d.useState(!1),y=async()=>{if(!n)return;const{data:k,error:R}=await I.from("bookings").select("latitude, longitude, car_id").eq("id",n).single();if(R){Re.error("Failed to fetch destination"),console.error(R);return}s({latitude:k.latitude,longitude:k.longitude}),c(k.car_id)},w=async()=>{if(a)try{const{data:k,error:R}=await I.from("cars").select("owner_id").eq("id",a).single();R&&console.error("Error getting ownerId",R),f(k.owner_id);return}catch(k){console.error("Error fetching destination:",k)}};d.useEffect(()=>{n&&y()},[n]),d.useEffect(()=>{a&&w()},[a]),d.useEffect(()=>{(async()=>{const{data:R}=await I.auth.getUser();R!=null&&R.user&&o(R.user.id)})()},[]);const{data:b,isLoading:S}=pi({queryKey:["handover-booking",n],queryFn:async()=>{if(!n)return null;const{data:k,error:R}=await I.from("bookings").select(`
          *,
          renter:profiles!renter_id (
            id,
            full_name,
            avatar_url
          ),
          car:cars (
            *,
            owner:profiles!owner_id (
              id,
              full_name,
              avatar_url
            )
          )
        `).eq("id",n).single();if(R)throw R;return k},enabled:!!n});d.useEffect(()=>{(async()=>{var R;if(!n||!r||!p||!b){console.log("Missing requirements for handover session fetch:",{bookingId:n,currentUserId:r,ownerId:p,hasBookingDetails:!!b});return}console.log("Fetching handover session for booking:",n),v(!0);try{const P=cS(b);console.log("Determined handover type:",P);let F=await iS(n,P),$=!1;if(F)console.log(`Found existing ${P} handover session:`,F.id,"completed:",F.handover_completed);else if(console.log(`No ${P} handover session found, creating one...`),(R=b==null?void 0:b.renter)!=null&&R.id){const G=b.renter.id;if(console.log("Creating handover session with:",{bookingId:n,hostId:p,renterId:G,handoverType:P}),F=await oS(n,P,p,G),$=!0,F)console.log(`${P} handover session created:`,F.id);else throw new Error(`Failed to create ${P} handover session`)}else throw new Error("Cannot create handover session: missing renter information");if(F){console.log(`${P} handover session ready:`,F.id),u(F.id);let G;$?G=F:G=aS(F),x(G)}}catch(P){console.error("Error fetching/creating handover session:",P),Re.error("Failed to setup handover session")}finally{v(!1)}})()},[n,r,p,b]);const _=r===p,[A,E]=d.useState(!1),T=()=>{E(!A)},C=async({latitude:k,longitude:R,address:P})=>{if(console.log("updateLocation called with:",{handoverId:m,currentUserId:r,isHost:_,latitude:k,longitude:R}),g)return console.log("Handover session still loading, cannot update location"),Re.error("Handover session is still loading, please wait..."),!1;if(!m)return console.log("Missing handover session ID"),Re.error("Handover session not found. Please refresh the page."),!1;if(!r)return console.log("Missing current user ID"),Re.error("User not authenticated. Please log in again."),!1;const F={latitude:k,longitude:R,address:P,timestamp:Date.now()};console.log("Updating location with data:",F);try{const $=await sS(m,r,_,F);return $?(console.log("Location updated successfully"),Re.success("Location updated successfully")):console.log("Location update failed"),$}catch($){return console.error("Error updating location:",$),Re.error("Failed to update location"),!1}};return l.jsx(Ld.Provider,{value:{isLoading:S,isHandoverSessionLoading:g,isHost:_,bookingDetails:b,debugMode:A,toggleDebugMode:T,currentUserId:r,destination:i,ownerId:p,updateLocation:C,handoverStatus:h,handoverId:m},children:t})};var[$r,rT]=wt("Tooltip",[cn]),Ur=cn(),Dd="TooltipProvider",dS=700,ci="tooltip.open",[pS,Ji]=$r(Dd),zd=t=>{const{__scopeTooltip:e,delayDuration:n=dS,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:i}=t,[s,a]=d.useState(!0),c=d.useRef(!1),p=d.useRef(0);return d.useEffect(()=>{const f=p.current;return()=>window.clearTimeout(f)},[]),l.jsx(pS,{scope:e,isOpenDelayed:s,delayDuration:n,onOpen:d.useCallback(()=>{window.clearTimeout(p.current),a(!1)},[]),onClose:d.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>a(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:d.useCallback(f=>{c.current=f},[]),disableHoverableContent:o,children:i})};zd.displayName=Dd;var Hr="Tooltip",[uS,Br]=$r(Hr),Fd=t=>{const{__scopeTooltip:e,children:n,open:r,defaultOpen:o=!1,onOpenChange:i,disableHoverableContent:s,delayDuration:a}=t,c=Ji(Hr,t.__scopeTooltip),p=Ur(e),[f,m]=d.useState(null),u=He(),h=d.useRef(0),x=s??c.disableHoverableContent,g=a??c.delayDuration,v=d.useRef(!1),[y=!1,w]=Ot({prop:r,defaultProp:o,onChange:E=>{E?(c.onOpen(),document.dispatchEvent(new CustomEvent(ci))):c.onClose(),i==null||i(E)}}),b=d.useMemo(()=>y?v.current?"delayed-open":"instant-open":"closed",[y]),S=d.useCallback(()=>{window.clearTimeout(h.current),h.current=0,v.current=!1,w(!0)},[w]),_=d.useCallback(()=>{window.clearTimeout(h.current),h.current=0,w(!1)},[w]),A=d.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>{v.current=!0,w(!0),h.current=0},g)},[g,w]);return d.useEffect(()=>()=>{h.current&&(window.clearTimeout(h.current),h.current=0)},[]),l.jsx(zi,{...p,children:l.jsx(uS,{scope:e,contentId:u,open:y,stateAttribute:b,trigger:f,onTriggerChange:m,onTriggerEnter:d.useCallback(()=>{c.isOpenDelayed?A():S()},[c.isOpenDelayed,A,S]),onTriggerLeave:d.useCallback(()=>{x?_():(window.clearTimeout(h.current),h.current=0)},[_,x]),onOpen:S,onClose:_,disableHoverableContent:x,children:n})})};Fd.displayName=Hr;var li="TooltipTrigger",$d=d.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,o=Br(li,n),i=Ji(li,n),s=Ur(n),a=d.useRef(null),c=re(e,a,o.onTriggerChange),p=d.useRef(!1),f=d.useRef(!1),m=d.useCallback(()=>p.current=!1,[]);return d.useEffect(()=>()=>document.removeEventListener("pointerup",m),[m]),l.jsx(Fi,{asChild:!0,...s,children:l.jsx(Y.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:c,onPointerMove:D(t.onPointerMove,u=>{u.pointerType!=="touch"&&!f.current&&!i.isPointerInTransitRef.current&&(o.onTriggerEnter(),f.current=!0)}),onPointerLeave:D(t.onPointerLeave,()=>{o.onTriggerLeave(),f.current=!1}),onPointerDown:D(t.onPointerDown,()=>{p.current=!0,document.addEventListener("pointerup",m,{once:!0})}),onFocus:D(t.onFocus,()=>{p.current||o.onOpen()}),onBlur:D(t.onBlur,o.onClose),onClick:D(t.onClick,o.onClose)})})});$d.displayName=li;var fS="TooltipPortal",[oT,mS]=$r(fS,{forceMount:void 0}),nn="TooltipContent",Ud=d.forwardRef((t,e)=>{const n=mS(nn,t.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...i}=t,s=Br(nn,t.__scopeTooltip);return l.jsx(ke,{present:r||s.open,children:s.disableHoverableContent?l.jsx(Hd,{side:o,...i,ref:e}):l.jsx(hS,{side:o,...i,ref:e})})}),hS=d.forwardRef((t,e)=>{const n=Br(nn,t.__scopeTooltip),r=Ji(nn,t.__scopeTooltip),o=d.useRef(null),i=re(e,o),[s,a]=d.useState(null),{trigger:c,onClose:p}=n,f=o.current,{onPointerInTransitChange:m}=r,u=d.useCallback(()=>{a(null),m(!1)},[m]),h=d.useCallback((x,g)=>{const v=x.currentTarget,y={x:x.clientX,y:x.clientY},w=yS(y,v.getBoundingClientRect()),b=wS(y,w),S=bS(g.getBoundingClientRect()),_=_S([...b,...S]);a(_),m(!0)},[m]);return d.useEffect(()=>()=>u(),[u]),d.useEffect(()=>{if(c&&f){const x=v=>h(v,f),g=v=>h(v,c);return c.addEventListener("pointerleave",x),f.addEventListener("pointerleave",g),()=>{c.removeEventListener("pointerleave",x),f.removeEventListener("pointerleave",g)}}},[c,f,h,u]),d.useEffect(()=>{if(s){const x=g=>{const v=g.target,y={x:g.clientX,y:g.clientY},w=(c==null?void 0:c.contains(v))||(f==null?void 0:f.contains(v)),b=!SS(y,s);w?u():b&&(u(),p())};return document.addEventListener("pointermove",x),()=>document.removeEventListener("pointermove",x)}},[c,f,s,p,u]),l.jsx(Hd,{...t,ref:i})}),[gS,vS]=$r(Hr,{isInside:!1}),Hd=d.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:i,onPointerDownOutside:s,...a}=t,c=Br(nn,n),p=Ur(n),{onClose:f}=c;return d.useEffect(()=>(document.addEventListener(ci,f),()=>document.removeEventListener(ci,f)),[f]),d.useEffect(()=>{if(c.trigger){const m=u=>{const h=u.target;h!=null&&h.contains(c.trigger)&&f()};return window.addEventListener("scroll",m,{capture:!0}),()=>window.removeEventListener("scroll",m,{capture:!0})}},[c.trigger,f]),l.jsx(jn,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:m=>m.preventDefault(),onDismiss:f,children:l.jsxs($i,{"data-state":c.stateAttribute,...p,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[l.jsx(Ma,{children:r}),l.jsx(gS,{scope:n,isInside:!0,children:l.jsx(vv,{id:c.contentId,role:"tooltip",children:o||r})})]})})});Ud.displayName=nn;var Bd="TooltipArrow",xS=d.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,o=Ur(n);return vS(Bd,n).isInside?null:l.jsx(Ui,{...o,...r,ref:e})});xS.displayName=Bd;function yS(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),o=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,o,i)){case i:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function wS(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function bS(t){const{top:e,right:n,bottom:r,left:o}=t;return[{x:o,y:e},{x:n,y:e},{x:n,y:r},{x:o,y:r}]}function SS(t,e){const{x:n,y:r}=t;let o=!1;for(let i=0,s=e.length-1;i<e.length;s=i++){const a=e[i].x,c=e[i].y,p=e[s].x,f=e[s].y;c>r!=f>r&&n<(p-a)*(r-c)/(f-c)+a&&(o=!o)}return o}function _S(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),ES(e)}function ES(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const o=t[r];for(;e.length>=2;){const i=e[e.length-1],s=e[e.length-2];if((i.x-s.x)*(o.y-s.y)>=(i.y-s.y)*(o.x-s.x))e.pop();else break}e.push(o)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const o=t[r];for(;n.length>=2;){const i=n[n.length-1],s=n[n.length-2];if((i.x-s.x)*(o.y-s.y)>=(i.y-s.y)*(o.x-s.x))n.pop();else break}n.push(o)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var CS=zd,TS=Fd,kS=$d,Vd=Ud;const AS=CS,iT=TS,sT=kS,NS=d.forwardRef(({className:t,sideOffset:e=4,...n},r)=>l.jsx(Vd,{ref:r,sideOffset:e,className:B("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));NS.displayName=Vd.displayName;var jS={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function RS(t){if(typeof t=="number")return{value:t,unit:"px"};var e,n=(t.match(/^[0-9.]*/)||"").toString();n.includes(".")?e=parseFloat(n):e=parseInt(n,10);var r=(t.match(/[^0-9]*$/)||"").toString();return jS[r]?{value:e,unit:r}:(console.warn("React Spinners: ".concat(t," is not a valid css value. Defaulting to ").concat(e,"px.")),{value:e,unit:"px"})}function Co(t){var e=RS(t);return"".concat(e.value).concat(e.unit)}var qd=function(t,e,n){var r="react-spinners-".concat(t,"-").concat(n);if(typeof window>"u"||!window.document)return r;var o=document.createElement("style");document.head.appendChild(o);var i=o.sheet,s=`
    @keyframes `.concat(r,` {
      `).concat(e,`
    }
  `);return i&&i.insertRule(s,0),r},fr;(function(t){t.maroon="#800000",t.red="#FF0000",t.orange="#FFA500",t.yellow="#FFFF00",t.olive="#808000",t.green="#008000",t.purple="#800080",t.fuchsia="#FF00FF",t.lime="#00FF00",t.teal="#008080",t.aqua="#00FFFF",t.blue="#0000FF",t.navy="#000080",t.black="#000000",t.gray="#808080",t.silver="#C0C0C0",t.white="#FFFFFF"})(fr||(fr={}));var MS=function(t,e){if(t.includes("/"))return t.replace("rgb(","rgba(");var n=t.substring(t.startsWith("rgba(")?5:4,t.length-1).trim(),r=n.split(",");return r.length===4?t.replace("rgb(","rgba("):r.length===3?"rgba(".concat(n,", ").concat(e,")"):"rgba(".concat(n," / ").concat(e,")")},PS=function(t,e){if(t.startsWith("rgb"))return MS(t,e);if(Object.keys(fr).includes(t)&&(t=fr[t]),t[0]==="#"&&(t=t.slice(1)),t.length===3){var n="";t.split("").forEach(function(o){n+=o,n+=o}),t=n}var r=(t.match(/.{2}/g)||[]).map(function(o){return parseInt(o,16)}).join(", ");return"rgba(".concat(r,", ").concat(e,")")},mr=function(){return mr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},mr.apply(this,arguments)},IS=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},OS=qd("BarLoader","0% {left: -35%;right: 100%} 60% {left: 100%;right: -90%} 100% {left: 100%;right: -90%}","long"),LS=qd("BarLoader","0% {left: -200%;right: 100%} 60% {left: 107%;right: -8%} 100% {left: 107%;right: -8%}","short");function DS(t){var e=t.loading,n=e===void 0?!0:e,r=t.color,o=r===void 0?"#000000":r,i=t.speedMultiplier,s=i===void 0?1:i,a=t.cssOverride,c=a===void 0?{}:a,p=t.height,f=p===void 0?4:p,m=t.width,u=m===void 0?100:m,h=IS(t,["loading","color","speedMultiplier","cssOverride","height","width"]),x=mr({display:"inherit",position:"relative",width:Co(u),height:Co(f),overflow:"hidden",backgroundColor:PS(o,.2),backgroundClip:"padding-box"},c),g=function(v){return{position:"absolute",height:Co(f),overflow:"hidden",backgroundColor:o,backgroundClip:"padding-box",display:"block",borderRadius:2,willChange:"left, right",animationFillMode:"forwards",animation:"".concat(v===1?OS:LS," ").concat(2.1/s,"s ").concat(v===2?"".concat(1.15/s,"s"):""," ").concat(v===1?"cubic-bezier(0.65, 0.815, 0.735, 0.395)":"cubic-bezier(0.165, 0.84, 0.44, 1)"," infinite")}};return n?d.createElement("span",mr({style:x},h),d.createElement("span",{style:g(1)}),d.createElement("span",{style:g(2)})):null}const Q=({message:t="Loading your profile..."})=>l.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] w-full",children:[l.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:t}),l.jsx(DS,{color:"#7c3aed",width:100})]});function zS(t){const[e,n]=d.useState(!1);return d.useEffect(()=>{const r=window.matchMedia(t);r.matches!==e&&n(r.matches);const o=()=>n(r.matches);return r.addEventListener("change",o),()=>r.removeEventListener("change",o)},[e,t]),e}function Gd(){return zS("(max-width: 768px)")}var Zi="Avatar",[FS,aT]=wt(Zi),[$S,Wd]=FS(Zi),Kd=d.forwardRef((t,e)=>{const{__scopeAvatar:n,...r}=t,[o,i]=d.useState("idle");return l.jsx($S,{scope:n,imageLoadingStatus:o,onImageLoadingStatusChange:i,children:l.jsx(Y.span,{...r,ref:e})})});Kd.displayName=Zi;var Yd="AvatarImage",Xd=d.forwardRef((t,e)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:o=()=>{},...i}=t,s=Wd(Yd,n),a=US(r,i.referrerPolicy),c=ve(p=>{o(p),s.onImageLoadingStatusChange(p)});return xe(()=>{a!=="idle"&&c(a)},[a,c]),a==="loaded"?l.jsx(Y.img,{...i,ref:e,src:r}):null});Xd.displayName=Yd;var Qd="AvatarFallback",Jd=d.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:r,...o}=t,i=Wd(Qd,n),[s,a]=d.useState(r===void 0);return d.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>a(!0),r);return()=>window.clearTimeout(c)}},[r]),s&&i.imageLoadingStatus!=="loaded"?l.jsx(Y.span,{...o,ref:e}):null});Jd.displayName=Qd;function US(t,e){const[n,r]=d.useState("idle");return xe(()=>{if(!t){r("error");return}let o=!0;const i=new window.Image,s=a=>()=>{o&&r(a)};return r("loading"),i.onload=s("loaded"),i.onerror=s("error"),i.src=t,e&&(i.referrerPolicy=e),()=>{o=!1}},[t,e]),n}var Zd=Kd,ep=Xd,tp=Jd;const In=d.forwardRef(({className:t,...e},n)=>l.jsx(Zd,{ref:n,className:B("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));In.displayName=Zd.displayName;const On=d.forwardRef(({className:t,...e},n)=>l.jsx(ep,{ref:n,className:B("aspect-square h-full w-full",t),...e}));On.displayName=ep.displayName;const Ln=d.forwardRef(({className:t,...e},n)=>l.jsx(tp,{ref:n,className:B("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));Ln.displayName=tp.displayName;const HS=Tr("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",warning:"border-transparent bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",danger:"border-transparent bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",info:"border-transparent bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"}},defaultVariants:{variant:"default"}});function np({className:t,variant:e,...n}){return l.jsx("div",{className:B(HS({variant:e}),t),...n})}function BS(t,e){return d.useReducer((n,r)=>e[n][r]??n,t)}var es="ScrollArea",[rp,cT]=wt(es),[VS,De]=rp(es),op=d.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:o,scrollHideDelay:i=600,...s}=t,[a,c]=d.useState(null),[p,f]=d.useState(null),[m,u]=d.useState(null),[h,x]=d.useState(null),[g,v]=d.useState(null),[y,w]=d.useState(0),[b,S]=d.useState(0),[_,A]=d.useState(!1),[E,T]=d.useState(!1),C=re(e,R=>c(R)),k=Rn(o);return l.jsx(VS,{scope:n,type:r,dir:k,scrollHideDelay:i,scrollArea:a,viewport:p,onViewportChange:f,content:m,onContentChange:u,scrollbarX:h,onScrollbarXChange:x,scrollbarXEnabled:_,onScrollbarXEnabledChange:A,scrollbarY:g,onScrollbarYChange:v,scrollbarYEnabled:E,onScrollbarYEnabledChange:T,onCornerWidthChange:w,onCornerHeightChange:S,children:l.jsx(Y.div,{dir:k,...s,ref:C,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":b+"px",...t.style}})})});op.displayName=es;var ip="ScrollAreaViewport",sp=d.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,asChild:o,nonce:i,...s}=t,a=De(ip,n),c=d.useRef(null),p=re(e,c,a.onViewportChange);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),l.jsx(Y.div,{"data-radix-scroll-area-viewport":"",...s,asChild:o,ref:p,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e_({asChild:o,children:r},f=>l.jsx("div",{"data-radix-scroll-area-content":"",ref:a.onContentChange,style:{minWidth:a.scrollbarXEnabled?"fit-content":void 0},children:f}))})]})});sp.displayName=ip;var nt="ScrollAreaScrollbar",ts=d.forwardRef((t,e)=>{const{forceMount:n,...r}=t,o=De(nt,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:s}=o,a=t.orientation==="horizontal";return d.useEffect(()=>(a?i(!0):s(!0),()=>{a?i(!1):s(!1)}),[a,i,s]),o.type==="hover"?l.jsx(qS,{...r,ref:e,forceMount:n}):o.type==="scroll"?l.jsx(GS,{...r,ref:e,forceMount:n}):o.type==="auto"?l.jsx(ap,{...r,ref:e,forceMount:n}):o.type==="always"?l.jsx(ns,{...r,ref:e}):null});ts.displayName=nt;var qS=d.forwardRef((t,e)=>{const{forceMount:n,...r}=t,o=De(nt,t.__scopeScrollArea),[i,s]=d.useState(!1);return d.useEffect(()=>{const a=o.scrollArea;let c=0;if(a){const p=()=>{window.clearTimeout(c),s(!0)},f=()=>{c=window.setTimeout(()=>s(!1),o.scrollHideDelay)};return a.addEventListener("pointerenter",p),a.addEventListener("pointerleave",f),()=>{window.clearTimeout(c),a.removeEventListener("pointerenter",p),a.removeEventListener("pointerleave",f)}}},[o.scrollArea,o.scrollHideDelay]),l.jsx(ke,{present:n||i,children:l.jsx(ap,{"data-state":i?"visible":"hidden",...r,ref:e})})}),GS=d.forwardRef((t,e)=>{const{forceMount:n,...r}=t,o=De(nt,t.__scopeScrollArea),i=t.orientation==="horizontal",s=qr(()=>c("SCROLL_END"),100),[a,c]=BS("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return d.useEffect(()=>{if(a==="idle"){const p=window.setTimeout(()=>c("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(p)}},[a,o.scrollHideDelay,c]),d.useEffect(()=>{const p=o.viewport,f=i?"scrollLeft":"scrollTop";if(p){let m=p[f];const u=()=>{const h=p[f];m!==h&&(c("SCROLL"),s()),m=h};return p.addEventListener("scroll",u),()=>p.removeEventListener("scroll",u)}},[o.viewport,i,c,s]),l.jsx(ke,{present:n||a!=="hidden",children:l.jsx(ns,{"data-state":a==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:D(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:D(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),ap=d.forwardRef((t,e)=>{const n=De(nt,t.__scopeScrollArea),{forceMount:r,...o}=t,[i,s]=d.useState(!1),a=t.orientation==="horizontal",c=qr(()=>{if(n.viewport){const p=n.viewport.offsetWidth<n.viewport.scrollWidth,f=n.viewport.offsetHeight<n.viewport.scrollHeight;s(a?p:f)}},10);return rn(n.viewport,c),rn(n.content,c),l.jsx(ke,{present:r||i,children:l.jsx(ns,{"data-state":i?"visible":"hidden",...o,ref:e})})}),ns=d.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,o=De(nt,t.__scopeScrollArea),i=d.useRef(null),s=d.useRef(0),[a,c]=d.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),p=up(a.viewport,a.content),f={...r,sizes:a,onSizesChange:c,hasThumb:p>0&&p<1,onThumbChange:u=>i.current=u,onThumbPointerUp:()=>s.current=0,onThumbPointerDown:u=>s.current=u};function m(u,h){return JS(u,s.current,a,h)}return n==="horizontal"?l.jsx(WS,{...f,ref:e,onThumbPositionChange:()=>{if(o.viewport&&i.current){const u=o.viewport.scrollLeft,h=_a(u,a,o.dir);i.current.style.transform=`translate3d(${h}px, 0, 0)`}},onWheelScroll:u=>{o.viewport&&(o.viewport.scrollLeft=u)},onDragScroll:u=>{o.viewport&&(o.viewport.scrollLeft=m(u,o.dir))}}):n==="vertical"?l.jsx(KS,{...f,ref:e,onThumbPositionChange:()=>{if(o.viewport&&i.current){const u=o.viewport.scrollTop,h=_a(u,a);i.current.style.transform=`translate3d(0, ${h}px, 0)`}},onWheelScroll:u=>{o.viewport&&(o.viewport.scrollTop=u)},onDragScroll:u=>{o.viewport&&(o.viewport.scrollTop=m(u))}}):null}),WS=d.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...o}=t,i=De(nt,t.__scopeScrollArea),[s,a]=d.useState(),c=d.useRef(null),p=re(e,c,i.onScrollbarXChange);return d.useEffect(()=>{c.current&&a(getComputedStyle(c.current))},[c]),l.jsx(lp,{"data-orientation":"horizontal",...o,ref:p,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Vr(n)+"px",...t.style},onThumbPointerDown:f=>t.onThumbPointerDown(f.x),onDragScroll:f=>t.onDragScroll(f.x),onWheelScroll:(f,m)=>{if(i.viewport){const u=i.viewport.scrollLeft+f.deltaX;t.onWheelScroll(u),mp(u,m)&&f.preventDefault()}},onResize:()=>{c.current&&i.viewport&&s&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:gr(s.paddingLeft),paddingEnd:gr(s.paddingRight)}})}})}),KS=d.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...o}=t,i=De(nt,t.__scopeScrollArea),[s,a]=d.useState(),c=d.useRef(null),p=re(e,c,i.onScrollbarYChange);return d.useEffect(()=>{c.current&&a(getComputedStyle(c.current))},[c]),l.jsx(lp,{"data-orientation":"vertical",...o,ref:p,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Vr(n)+"px",...t.style},onThumbPointerDown:f=>t.onThumbPointerDown(f.y),onDragScroll:f=>t.onDragScroll(f.y),onWheelScroll:(f,m)=>{if(i.viewport){const u=i.viewport.scrollTop+f.deltaY;t.onWheelScroll(u),mp(u,m)&&f.preventDefault()}},onResize:()=>{c.current&&i.viewport&&s&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:gr(s.paddingTop),paddingEnd:gr(s.paddingBottom)}})}})}),[YS,cp]=rp(nt),lp=d.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:o,onThumbChange:i,onThumbPointerUp:s,onThumbPointerDown:a,onThumbPositionChange:c,onDragScroll:p,onWheelScroll:f,onResize:m,...u}=t,h=De(nt,n),[x,g]=d.useState(null),v=re(e,C=>g(C)),y=d.useRef(null),w=d.useRef(""),b=h.viewport,S=r.content-r.viewport,_=ve(f),A=ve(c),E=qr(m,10);function T(C){if(y.current){const k=C.clientX-y.current.left,R=C.clientY-y.current.top;p({x:k,y:R})}}return d.useEffect(()=>{const C=k=>{const R=k.target;(x==null?void 0:x.contains(R))&&_(k,S)};return document.addEventListener("wheel",C,{passive:!1}),()=>document.removeEventListener("wheel",C,{passive:!1})},[b,x,S,_]),d.useEffect(A,[r,A]),rn(x,E),rn(h.content,E),l.jsx(YS,{scope:n,scrollbar:x,hasThumb:o,onThumbChange:ve(i),onThumbPointerUp:ve(s),onThumbPositionChange:A,onThumbPointerDown:ve(a),children:l.jsx(Y.div,{...u,ref:v,style:{position:"absolute",...u.style},onPointerDown:D(t.onPointerDown,C=>{C.button===0&&(C.target.setPointerCapture(C.pointerId),y.current=x.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",h.viewport&&(h.viewport.style.scrollBehavior="auto"),T(C))}),onPointerMove:D(t.onPointerMove,T),onPointerUp:D(t.onPointerUp,C=>{const k=C.target;k.hasPointerCapture(C.pointerId)&&k.releasePointerCapture(C.pointerId),document.body.style.webkitUserSelect=w.current,h.viewport&&(h.viewport.style.scrollBehavior=""),y.current=null})})})}),hr="ScrollAreaThumb",dp=d.forwardRef((t,e)=>{const{forceMount:n,...r}=t,o=cp(hr,t.__scopeScrollArea);return l.jsx(ke,{present:n||o.hasThumb,children:l.jsx(XS,{ref:e,...r})})}),XS=d.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...o}=t,i=De(hr,n),s=cp(hr,n),{onThumbPositionChange:a}=s,c=re(e,m=>s.onThumbChange(m)),p=d.useRef(),f=qr(()=>{p.current&&(p.current(),p.current=void 0)},100);return d.useEffect(()=>{const m=i.viewport;if(m){const u=()=>{if(f(),!p.current){const h=ZS(m,a);p.current=h,a()}};return a(),m.addEventListener("scroll",u),()=>m.removeEventListener("scroll",u)}},[i.viewport,f,a]),l.jsx(Y.div,{"data-state":s.hasThumb?"visible":"hidden",...o,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:D(t.onPointerDownCapture,m=>{const h=m.target.getBoundingClientRect(),x=m.clientX-h.left,g=m.clientY-h.top;s.onThumbPointerDown({x,y:g})}),onPointerUp:D(t.onPointerUp,s.onThumbPointerUp)})});dp.displayName=hr;var rs="ScrollAreaCorner",pp=d.forwardRef((t,e)=>{const n=De(rs,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?l.jsx(QS,{...t,ref:e}):null});pp.displayName=rs;var QS=d.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,o=De(rs,n),[i,s]=d.useState(0),[a,c]=d.useState(0),p=!!(i&&a);return rn(o.scrollbarX,()=>{var m;const f=((m=o.scrollbarX)==null?void 0:m.offsetHeight)||0;o.onCornerHeightChange(f),c(f)}),rn(o.scrollbarY,()=>{var m;const f=((m=o.scrollbarY)==null?void 0:m.offsetWidth)||0;o.onCornerWidthChange(f),s(f)}),p?l.jsx(Y.div,{...r,ref:e,style:{width:i,height:a,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function gr(t){return t?parseInt(t,10):0}function up(t,e){const n=t/e;return isNaN(n)?0:n}function Vr(t){const e=up(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function JS(t,e,n,r="ltr"){const o=Vr(n),i=o/2,s=e||i,a=o-s,c=n.scrollbar.paddingStart+s,p=n.scrollbar.size-n.scrollbar.paddingEnd-a,f=n.content-n.viewport,m=r==="ltr"?[0,f]:[f*-1,0];return fp([c,p],m)(t)}function _a(t,e,n="ltr"){const r=Vr(e),o=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-o,s=e.content-e.viewport,a=i-r,c=n==="ltr"?[0,s]:[s*-1,0],p=Do(t,c);return fp([0,s],[0,a])(p)}function fp(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function mp(t,e){return t>0&&t<e}var ZS=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function o(){const i={left:t.scrollLeft,top:t.scrollTop},s=n.left!==i.left,a=n.top!==i.top;(s||a)&&e(),n=i,r=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(r)};function qr(t,e){const n=ve(t),r=d.useRef(0);return d.useEffect(()=>()=>window.clearTimeout(r.current),[]),d.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function rn(t,e){const n=ve(e);xe(()=>{let r=0;if(t){const o=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return o.observe(t),()=>{window.cancelAnimationFrame(r),o.unobserve(t)}}},[t,n])}function e_(t,e){const{asChild:n,children:r}=t;if(!n)return typeof e=="function"?e(r):e;const o=d.Children.only(r);return d.cloneElement(o,{children:typeof e=="function"?e(o.props.children):e})}var hp=op,t_=sp,n_=pp;const Gr=d.forwardRef(({className:t,children:e,...n},r)=>l.jsxs(hp,{ref:r,className:B("relative overflow-hidden",t),...n,children:[l.jsx(t_,{className:"h-full w-full rounded-[inherit]",children:e}),l.jsx(gp,{}),l.jsx(n_,{})]}));Gr.displayName=hp.displayName;const gp=d.forwardRef(({className:t,orientation:e="vertical",...n},r)=>l.jsx(ts,{ref:r,orientation:e,className:B("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:l.jsx(dp,{className:"relative flex-1 rounded-full bg-border"})}));gp.displayName=ts.displayName;function r_({conversations:t,selectedConversationId:e,currentUser:n,onSelectConversation:r,onNewConversation:o,searchTerm:i,onSearchChange:s}){const a=t,c=h=>{if(h.type==="direct"){const g=(h.participants||[]).find(v=>v.id!==n.id);return(g==null?void 0:g.name)||"Unknown User"}return h.title?h.title:(h.participants||[]).filter(g=>g.id!==n.id).map(g=>g.name).join(", ")},p=h=>{if(h.type==="group")return null;const x=(h.participants||[]).find(g=>g.id!==n.id);return x==null?void 0:x.avatar},f=h=>{if(!h.lastMessage)return"No messages yet";const x=(h.participants||[]).find(v=>{var y;return v.id===((y=h.lastMessage)==null?void 0:y.senderId)});return`${(x==null?void 0:x.id)===n.id?"You":x==null?void 0:x.name}: ${h.lastMessage.content}`},m=Gd(),u=()=>{window.history.back()};return l.jsxs("div",{className:"flex flex-col h-full bg-card border-r border-notification-border",children:[l.jsxs("div",{className:"p-4 border-b border-notification-border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[m&&l.jsx(pe,{variant:"ghost",size:"icon",className:"mr-1 bg-primary/5 hover:bg-primary/10 rounded-full transition-all duration-200 ease-in-out",onClick:u,children:l.jsx(uc,{className:"h-5 w-5 text-primary"})}),l.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Messages"})]}),l.jsx(pe,{size:"sm",onClick:o,className:"h-8 w-8 p-0",children:l.jsx(Km,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"relative",children:[l.jsx(wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),l.jsx(Xe,{placeholder:"Search conversations...",value:i,onChange:h=>s(h.target.value),className:"pl-9 bg-notification border-notification-border"})]})]}),l.jsx(Gr,{className:"flex-1",children:l.jsx("div",{className:"p-2",children:a.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(yi,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),l.jsx("p",{className:"text-muted-foreground",children:i?"No conversations match your search":"No conversations yet"})]}):l.jsx("div",{className:"space-y-1",children:a.map(h=>{const x=h.id===e,g=(h.participants||[]).find(v=>v.id!==n.id);return l.jsxs("div",{className:B("flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all duration-200","hover:bg-notification-hover",x&&"bg-primary/10 border border-primary/20"),onClick:()=>r(h.id),children:[l.jsxs("div",{className:"relative flex-shrink-0",children:[h.type==="group"?l.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:l.jsx(Mo,{className:"w-6 h-6 text-primary"})}):l.jsxs(In,{className:"w-12 h-12",children:[l.jsx(On,{src:p(h)}),l.jsx(Ln,{children:c(h).charAt(0).toUpperCase()})]}),h.type==="direct"&&g&&l.jsx("div",{className:B("absolute -bottom-0.5 -right-0.5 w-4 h-4 rounded-full border-2 border-card",g.status==="online"&&"bg-green-500",g.status==="away"&&"bg-yellow-500",g.status==="offline"&&"bg-gray-400")})]}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"font-medium text-foreground truncate",children:c(h)}),l.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[h.lastMessage&&l.jsx("span",{className:"text-xs text-muted-foreground",children:Aa(h.lastMessage.timestamp,{addSuffix:!0})}),h.unreadCount>0&&l.jsx(np,{variant:"default",className:"h-5 min-w-5 flex items-center justify-center text-xs px-1.5",children:h.unreadCount>99?"99+":h.unreadCount})]})]}),l.jsx("p",{className:"text-sm text-muted-foreground truncate mt-1",children:f(h)})]})]},h.id)})})})})]})}var di=["Enter"," "],o_=["ArrowDown","PageUp","Home"],vp=["ArrowUp","PageDown","End"],i_=[...o_,...vp],s_={ltr:[...di,"ArrowRight"],rtl:[...di,"ArrowLeft"]},a_={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Dn="Menu",[kn,c_,l_]=ki(Dn),[Ft,xp]=wt(Dn,[l_,cn,Cr]),Wr=cn(),yp=Cr(),[d_,$t]=Ft(Dn),[p_,zn]=Ft(Dn),wp=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:o,onOpenChange:i,modal:s=!0}=t,a=Wr(e),[c,p]=d.useState(null),f=d.useRef(!1),m=ve(i),u=Rn(o);return d.useEffect(()=>{const h=()=>{f.current=!0,document.addEventListener("pointerdown",x,{capture:!0,once:!0}),document.addEventListener("pointermove",x,{capture:!0,once:!0})},x=()=>f.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",x,{capture:!0}),document.removeEventListener("pointermove",x,{capture:!0})}},[]),l.jsx(zi,{...a,children:l.jsx(d_,{scope:e,open:n,onOpenChange:m,content:c,onContentChange:p,children:l.jsx(p_,{scope:e,onClose:d.useCallback(()=>m(!1),[m]),isUsingKeyboardRef:f,dir:u,modal:s,children:r})})})};wp.displayName=Dn;var u_="MenuAnchor",os=d.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,o=Wr(n);return l.jsx(Fi,{...o,...r,ref:e})});os.displayName=u_;var is="MenuPortal",[f_,bp]=Ft(is,{forceMount:void 0}),Sp=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:o}=t,i=$t(is,e);return l.jsx(f_,{scope:e,forceMount:n,children:l.jsx(ke,{present:n||i.open,children:l.jsx(br,{asChild:!0,container:o,children:r})})})};Sp.displayName=is;var Le="MenuContent",[m_,ss]=Ft(Le),_p=d.forwardRef((t,e)=>{const n=bp(Le,t.__scopeMenu),{forceMount:r=n.forceMount,...o}=t,i=$t(Le,t.__scopeMenu),s=zn(Le,t.__scopeMenu);return l.jsx(kn.Provider,{scope:t.__scopeMenu,children:l.jsx(ke,{present:r||i.open,children:l.jsx(kn.Slot,{scope:t.__scopeMenu,children:s.modal?l.jsx(h_,{...o,ref:e}):l.jsx(g_,{...o,ref:e})})})})}),h_=d.forwardRef((t,e)=>{const n=$t(Le,t.__scopeMenu),r=d.useRef(null),o=re(e,r);return d.useEffect(()=>{const i=r.current;if(i)return fi(i)},[]),l.jsx(as,{...t,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:D(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),g_=d.forwardRef((t,e)=>{const n=$t(Le,t.__scopeMenu);return l.jsx(as,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),as=d.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:c,onEscapeKeyDown:p,onPointerDownOutside:f,onFocusOutside:m,onInteractOutside:u,onDismiss:h,disableOutsideScroll:x,...g}=t,v=$t(Le,n),y=zn(Le,n),w=Wr(n),b=yp(n),S=c_(n),[_,A]=d.useState(null),E=d.useRef(null),T=re(e,E,v.onContentChange),C=d.useRef(0),k=d.useRef(""),R=d.useRef(0),P=d.useRef(null),F=d.useRef("right"),$=d.useRef(0),G=x?_r:d.Fragment,N=x?{as:ht,allowPinchZoom:!0}:void 0,L=j=>{var U,oe;const W=k.current+j,z=S().filter(ae=>!ae.disabled),q=document.activeElement,K=(U=z.find(ae=>ae.ref.current===q))==null?void 0:U.textValue,ie=z.map(ae=>ae.textValue),ge=A_(ie,W,K),se=(oe=z.find(ae=>ae.textValue===ge))==null?void 0:oe.ref.current;(function ae(ne){k.current=ne,window.clearTimeout(C.current),ne!==""&&(C.current=window.setTimeout(()=>ae(""),1e3))})(W),se&&setTimeout(()=>se.focus())};d.useEffect(()=>()=>window.clearTimeout(C.current),[]),ui();const M=d.useCallback(j=>{var z,q;return F.current===((z=P.current)==null?void 0:z.side)&&j_(j,(q=P.current)==null?void 0:q.area)},[]);return l.jsx(m_,{scope:n,searchRef:k,onItemEnter:d.useCallback(j=>{M(j)&&j.preventDefault()},[M]),onItemLeave:d.useCallback(j=>{var W;M(j)||((W=E.current)==null||W.focus(),A(null))},[M]),onTriggerLeave:d.useCallback(j=>{M(j)&&j.preventDefault()},[M]),pointerGraceTimerRef:R,onPointerGraceIntentChange:d.useCallback(j=>{P.current=j},[]),children:l.jsx(G,{...N,children:l.jsx(wr,{asChild:!0,trapped:o,onMountAutoFocus:D(i,j=>{var W;j.preventDefault(),(W=E.current)==null||W.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:l.jsx(jn,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:p,onPointerDownOutside:f,onFocusOutside:m,onInteractOutside:u,onDismiss:h,children:l.jsx(Ac,{asChild:!0,...b,dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:_,onCurrentTabStopIdChange:A,onEntryFocus:D(c,j=>{y.isUsingKeyboardRef.current||j.preventDefault()}),preventScrollOnEntryFocus:!0,children:l.jsx($i,{role:"menu","aria-orientation":"vertical","data-state":Fp(v.open),"data-radix-menu-content":"",dir:y.dir,...w,...g,ref:T,style:{outline:"none",...g.style},onKeyDown:D(g.onKeyDown,j=>{const z=j.target.closest("[data-radix-menu-content]")===j.currentTarget,q=j.ctrlKey||j.altKey||j.metaKey,K=j.key.length===1;z&&(j.key==="Tab"&&j.preventDefault(),!q&&K&&L(j.key));const ie=E.current;if(j.target!==ie||!i_.includes(j.key))return;j.preventDefault();const se=S().filter(U=>!U.disabled).map(U=>U.ref.current);vp.includes(j.key)&&se.reverse(),T_(se)}),onBlur:D(t.onBlur,j=>{j.currentTarget.contains(j.target)||(window.clearTimeout(C.current),k.current="")}),onPointerMove:D(t.onPointerMove,An(j=>{const W=j.target,z=$.current!==j.clientX;if(j.currentTarget.contains(W)&&z){const q=j.clientX>$.current?"right":"left";F.current=q,$.current=j.clientX}}))})})})})})})});_p.displayName=Le;var v_="MenuGroup",cs=d.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return l.jsx(Y.div,{role:"group",...r,ref:e})});cs.displayName=v_;var x_="MenuLabel",Ep=d.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return l.jsx(Y.div,{...r,ref:e})});Ep.displayName=x_;var vr="MenuItem",Ea="menu.itemSelect",Kr=d.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...o}=t,i=d.useRef(null),s=zn(vr,t.__scopeMenu),a=ss(vr,t.__scopeMenu),c=re(e,i),p=d.useRef(!1),f=()=>{const m=i.current;if(!n&&m){const u=new CustomEvent(Ea,{bubbles:!0,cancelable:!0});m.addEventListener(Ea,h=>r==null?void 0:r(h),{once:!0}),Pa(m,u),u.defaultPrevented?p.current=!1:s.onClose()}};return l.jsx(Cp,{...o,ref:c,disabled:n,onClick:D(t.onClick,f),onPointerDown:m=>{var u;(u=t.onPointerDown)==null||u.call(t,m),p.current=!0},onPointerUp:D(t.onPointerUp,m=>{var u;p.current||(u=m.currentTarget)==null||u.click()}),onKeyDown:D(t.onKeyDown,m=>{const u=a.searchRef.current!=="";n||u&&m.key===" "||di.includes(m.key)&&(m.currentTarget.click(),m.preventDefault())})})});Kr.displayName=vr;var Cp=d.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...i}=t,s=ss(vr,n),a=yp(n),c=d.useRef(null),p=re(e,c),[f,m]=d.useState(!1),[u,h]=d.useState("");return d.useEffect(()=>{const x=c.current;x&&h((x.textContent??"").trim())},[i.children]),l.jsx(kn.ItemSlot,{scope:n,disabled:r,textValue:o??u,children:l.jsx(Nc,{asChild:!0,...a,focusable:!r,children:l.jsx(Y.div,{role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:p,onPointerMove:D(t.onPointerMove,An(x=>{r?s.onItemLeave(x):(s.onItemEnter(x),x.defaultPrevented||x.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:D(t.onPointerLeave,An(x=>s.onItemLeave(x))),onFocus:D(t.onFocus,()=>m(!0)),onBlur:D(t.onBlur,()=>m(!1))})})})}),y_="MenuCheckboxItem",Tp=d.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...o}=t;return l.jsx(Rp,{scope:t.__scopeMenu,checked:n,children:l.jsx(Kr,{role:"menuitemcheckbox","aria-checked":xr(n)?"mixed":n,...o,ref:e,"data-state":ds(n),onSelect:D(o.onSelect,()=>r==null?void 0:r(xr(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Tp.displayName=y_;var kp="MenuRadioGroup",[w_,b_]=Ft(kp,{value:void 0,onValueChange:()=>{}}),Ap=d.forwardRef((t,e)=>{const{value:n,onValueChange:r,...o}=t,i=ve(r);return l.jsx(w_,{scope:t.__scopeMenu,value:n,onValueChange:i,children:l.jsx(cs,{...o,ref:e})})});Ap.displayName=kp;var Np="MenuRadioItem",jp=d.forwardRef((t,e)=>{const{value:n,...r}=t,o=b_(Np,t.__scopeMenu),i=n===o.value;return l.jsx(Rp,{scope:t.__scopeMenu,checked:i,children:l.jsx(Kr,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":ds(i),onSelect:D(r.onSelect,()=>{var s;return(s=o.onValueChange)==null?void 0:s.call(o,n)},{checkForDefaultPrevented:!1})})})});jp.displayName=Np;var ls="MenuItemIndicator",[Rp,S_]=Ft(ls,{checked:!1}),Mp=d.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...o}=t,i=S_(ls,n);return l.jsx(ke,{present:r||xr(i.checked)||i.checked===!0,children:l.jsx(Y.span,{...o,ref:e,"data-state":ds(i.checked)})})});Mp.displayName=ls;var __="MenuSeparator",Pp=d.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return l.jsx(Y.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});Pp.displayName=__;var E_="MenuArrow",Ip=d.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,o=Wr(n);return l.jsx(Ui,{...o,...r,ref:e})});Ip.displayName=E_;var C_="MenuSub",[lT,Op]=Ft(C_),wn="MenuSubTrigger",Lp=d.forwardRef((t,e)=>{const n=$t(wn,t.__scopeMenu),r=zn(wn,t.__scopeMenu),o=Op(wn,t.__scopeMenu),i=ss(wn,t.__scopeMenu),s=d.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:c}=i,p={__scopeMenu:t.__scopeMenu},f=d.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return d.useEffect(()=>f,[f]),d.useEffect(()=>{const m=a.current;return()=>{window.clearTimeout(m),c(null)}},[a,c]),l.jsx(os,{asChild:!0,...p,children:l.jsx(Cp,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":Fp(n.open),...t,ref:yr(e,o.onTriggerChange),onClick:m=>{var u;(u=t.onClick)==null||u.call(t,m),!(t.disabled||m.defaultPrevented)&&(m.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:D(t.onPointerMove,An(m=>{i.onItemEnter(m),!m.defaultPrevented&&!t.disabled&&!n.open&&!s.current&&(i.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),f()},100))})),onPointerLeave:D(t.onPointerLeave,An(m=>{var h,x;f();const u=(h=n.content)==null?void 0:h.getBoundingClientRect();if(u){const g=(x=n.content)==null?void 0:x.dataset.side,v=g==="right",y=v?-5:5,w=u[v?"left":"right"],b=u[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:m.clientX+y,y:m.clientY},{x:w,y:u.top},{x:b,y:u.top},{x:b,y:u.bottom},{x:w,y:u.bottom}],side:g}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(m),m.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:D(t.onKeyDown,m=>{var h;const u=i.searchRef.current!=="";t.disabled||u&&m.key===" "||s_[r.dir].includes(m.key)&&(n.onOpenChange(!0),(h=n.content)==null||h.focus(),m.preventDefault())})})})});Lp.displayName=wn;var Dp="MenuSubContent",zp=d.forwardRef((t,e)=>{const n=bp(Le,t.__scopeMenu),{forceMount:r=n.forceMount,...o}=t,i=$t(Le,t.__scopeMenu),s=zn(Le,t.__scopeMenu),a=Op(Dp,t.__scopeMenu),c=d.useRef(null),p=re(e,c);return l.jsx(kn.Provider,{scope:t.__scopeMenu,children:l.jsx(ke,{present:r||i.open,children:l.jsx(kn.Slot,{scope:t.__scopeMenu,children:l.jsx(as,{id:a.contentId,"aria-labelledby":a.triggerId,...o,ref:p,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var m;s.isUsingKeyboardRef.current&&((m=c.current)==null||m.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:D(t.onFocusOutside,f=>{f.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:D(t.onEscapeKeyDown,f=>{s.onClose(),f.preventDefault()}),onKeyDown:D(t.onKeyDown,f=>{var h;const m=f.currentTarget.contains(f.target),u=a_[s.dir].includes(f.key);m&&u&&(i.onOpenChange(!1),(h=a.trigger)==null||h.focus(),f.preventDefault())})})})})})});zp.displayName=Dp;function Fp(t){return t?"open":"closed"}function xr(t){return t==="indeterminate"}function ds(t){return xr(t)?"indeterminate":t?"checked":"unchecked"}function T_(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function k_(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function A_(t,e,n){const o=e.length>1&&Array.from(e).every(p=>p===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let s=k_(t,Math.max(i,0));o.length===1&&(s=s.filter(p=>p!==n));const c=s.find(p=>p.toLowerCase().startsWith(o.toLowerCase()));return c!==n?c:void 0}function N_(t,e){const{x:n,y:r}=t;let o=!1;for(let i=0,s=e.length-1;i<e.length;s=i++){const a=e[i].x,c=e[i].y,p=e[s].x,f=e[s].y;c>r!=f>r&&n<(p-a)*(r-c)/(f-c)+a&&(o=!o)}return o}function j_(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return N_(n,e)}function An(t){return e=>e.pointerType==="mouse"?t(e):void 0}var R_=wp,M_=os,P_=Sp,I_=_p,O_=cs,L_=Ep,D_=Kr,z_=Tp,F_=Ap,$_=jp,U_=Mp,H_=Pp,B_=Ip,V_=Lp,q_=zp,ps="DropdownMenu",[G_,dT]=wt(ps,[xp]),Te=xp(),[W_,$p]=G_(ps),Up=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:o,defaultOpen:i,onOpenChange:s,modal:a=!0}=t,c=Te(e),p=d.useRef(null),[f=!1,m]=Ot({prop:o,defaultProp:i,onChange:s});return l.jsx(W_,{scope:e,triggerId:He(),triggerRef:p,contentId:He(),open:f,onOpenChange:m,onOpenToggle:d.useCallback(()=>m(u=>!u),[m]),modal:a,children:l.jsx(R_,{...c,open:f,onOpenChange:m,dir:r,modal:a,children:n})})};Up.displayName=ps;var Hp="DropdownMenuTrigger",Bp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=t,i=$p(Hp,n),s=Te(n);return l.jsx(M_,{asChild:!0,...s,children:l.jsx(Y.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:yr(e,i.triggerRef),onPointerDown:D(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:D(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});Bp.displayName=Hp;var K_="DropdownMenuPortal",Vp=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Te(e);return l.jsx(P_,{...r,...n})};Vp.displayName=K_;var qp="DropdownMenuContent",Gp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=$p(qp,n),i=Te(n),s=d.useRef(!1);return l.jsx(I_,{id:o.contentId,"aria-labelledby":o.triggerId,...i,...r,ref:e,onCloseAutoFocus:D(t.onCloseAutoFocus,a=>{var c;s.current||(c=o.triggerRef.current)==null||c.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:D(t.onInteractOutside,a=>{const c=a.detail.originalEvent,p=c.button===0&&c.ctrlKey===!0,f=c.button===2||p;(!o.modal||f)&&(s.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Gp.displayName=qp;var Y_="DropdownMenuGroup",X_=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(O_,{...o,...r,ref:e})});X_.displayName=Y_;var Q_="DropdownMenuLabel",Wp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(L_,{...o,...r,ref:e})});Wp.displayName=Q_;var J_="DropdownMenuItem",Kp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(D_,{...o,...r,ref:e})});Kp.displayName=J_;var Z_="DropdownMenuCheckboxItem",Yp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(z_,{...o,...r,ref:e})});Yp.displayName=Z_;var eE="DropdownMenuRadioGroup",tE=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(F_,{...o,...r,ref:e})});tE.displayName=eE;var nE="DropdownMenuRadioItem",Xp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx($_,{...o,...r,ref:e})});Xp.displayName=nE;var rE="DropdownMenuItemIndicator",Qp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(U_,{...o,...r,ref:e})});Qp.displayName=rE;var oE="DropdownMenuSeparator",Jp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(H_,{...o,...r,ref:e})});Jp.displayName=oE;var iE="DropdownMenuArrow",sE=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(B_,{...o,...r,ref:e})});sE.displayName=iE;var aE="DropdownMenuSubTrigger",Zp=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(V_,{...o,...r,ref:e})});Zp.displayName=aE;var cE="DropdownMenuSubContent",eu=d.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=Te(n);return l.jsx(q_,{...o,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});eu.displayName=cE;var lE=Up,dE=Bp,pE=Vp,tu=Gp,nu=Wp,ru=Kp,ou=Yp,iu=Xp,su=Qp,au=Jp,cu=Zp,lu=eu;const uE=lE,fE=dE,mE=d.forwardRef(({className:t,inset:e,children:n,...r},o)=>l.jsxs(cu,{ref:o,className:B("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",t),...r,children:[n,l.jsx(Om,{className:"ml-auto h-4 w-4"})]}));mE.displayName=cu.displayName;const hE=d.forwardRef(({className:t,...e},n)=>l.jsx(lu,{ref:n,className:B("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));hE.displayName=lu.displayName;const du=d.forwardRef(({className:t,sideOffset:e=4,...n},r)=>l.jsx(pE,{children:l.jsx(tu,{ref:r,sideOffset:e,className:B("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));du.displayName=tu.displayName;const Yt=d.forwardRef(({className:t,inset:e,...n},r)=>l.jsx(ru,{ref:r,className:B("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));Yt.displayName=ru.displayName;const gE=d.forwardRef(({className:t,children:e,checked:n,...r},o)=>l.jsxs(ou,{ref:o,className:B("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(su,{children:l.jsx(xi,{className:"h-4 w-4"})})}),e]}));gE.displayName=ou.displayName;const vE=d.forwardRef(({className:t,children:e,...n},r)=>l.jsxs(iu,{ref:r,className:B("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(su,{children:l.jsx(Dm,{className:"h-2 w-2 fill-current"})})}),e]}));vE.displayName=iu.displayName;const xE=d.forwardRef(({className:t,inset:e,...n},r)=>l.jsx(nu,{ref:r,className:B("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));xE.displayName=nu.displayName;const yE=d.forwardRef(({className:t,...e},n)=>l.jsx(au,{ref:n,className:B("-mx-1 my-1 h-px bg-muted",t),...e}));yE.displayName=au.displayName;function wE({message:t,sender:e,currentUser:n,isGroupChat:r,showAvatar:o,showTimestamp:i,onEdit:s,onDelete:a,onReply:c,onReact:p}){const[f,m]=d.useState(!1),u=t.senderId===n.id,h=()=>{navigator.clipboard.writeText(t.content)},x=["👍","❤️","😂","😮","😢","👏"];return l.jsxs("div",{className:B("group flex gap-3 px-4 py-2 hover:bg-notification-hover/50 transition-colors",u&&"flex-row-reverse"),onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),children:[l.jsx("div",{className:"flex-shrink-0",children:o?l.jsxs(In,{className:"w-8 h-8",children:[l.jsx(On,{src:e.avatar}),l.jsx(Ln,{className:"text-xs",children:e.name?e.name.charAt(0).toUpperCase():"U"})]}):l.jsx("div",{className:"w-8 h-8"})}),l.jsxs("div",{className:B("flex-1 max-w-md",u&&"flex flex-col items-end"),children:[r&&!u&&o&&l.jsx("p",{className:"text-xs font-medium text-primary mb-1",children:e.name||"Unknown User"}),l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:B("relative px-4 py-2 rounded-2xl break-words shadow-sm transition-all duration-200",u?"bg-primary text-primary-foreground rounded-br-md transform hover:scale-[1.01]":"bg-notification border border-notification-border rounded-bl-md hover:bg-notification/80 transform hover:scale-[1.01]"),children:[l.jsx("p",{className:"text-sm",children:t.content}),t.edited&&l.jsx("span",{className:"text-xs opacity-60 ml-2 italic",children:"(edited)"})]}),t.reactions&&t.reactions.length>0&&l.jsx("div",{className:"flex gap-1 mt-1",children:t.reactions.reduce((g,v)=>{const y=g.find(w=>w.emoji===v.emoji);return y?(y.count++,y.users.push(v.userId)):g.push({emoji:v.emoji,count:1,users:[v.userId]}),g},[]).map(g=>l.jsxs("button",{className:B("px-2 py-1 text-xs rounded-full border transition-all duration-200 shadow-sm transform hover:scale-110",g.users.includes(n.id)?"bg-primary/20 border-primary/30 hover:bg-primary/30":"bg-notification border-notification-border hover:bg-notification-hover"),onClick:()=>p==null?void 0:p(t.id,g.emoji),children:[g.emoji," ",g.count]},g.emoji))}),f&&l.jsx("div",{className:B("absolute top-0 flex items-center gap-1",u?"-left-20":"-right-20"),children:l.jsxs("div",{className:"flex items-center bg-card border border-notification-border rounded-lg shadow-md overflow-hidden",children:[x.slice(0,3).map(g=>l.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-primary/10 transition-colors duration-200 transform hover:scale-110",onClick:()=>p==null?void 0:p(t.id,g),children:g},g)),l.jsxs(uE,{children:[l.jsx(fE,{asChild:!0,children:l.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-primary/10 transition-colors duration-200 rounded-full",children:l.jsx($m,{className:"w-3 h-3 text-primary"})})}),l.jsxs(du,{align:"end",children:[l.jsxs(Yt,{onClick:()=>c==null?void 0:c(t.id),children:[l.jsx(Xm,{className:"w-4 h-4 mr-2"}),"Reply"]}),l.jsxs(Yt,{onClick:h,children:[l.jsx(zm,{className:"w-4 h-4 mr-2"}),"Copy"]}),l.jsx(Yt,{children:l.jsx("div",{className:"flex gap-1",children:x.slice(3).map(g=>l.jsx("button",{className:"hover:bg-notification-hover rounded p-1",onClick:()=>p==null?void 0:p(t.id,g),children:g},g))})}),u&&l.jsxs(l.Fragment,{children:[l.jsxs(Yt,{onClick:()=>s==null?void 0:s(t.id),children:[l.jsx(Zm,{className:"w-4 h-4 mr-2"}),"Edit"]}),l.jsxs(Yt,{onClick:()=>a==null?void 0:a(t.id),className:"text-destructive",children:[l.jsx(eh,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})]})})]}),i&&l.jsxs("div",{className:B("flex items-center gap-1 mt-1",u?"justify-end":"justify-start"),children:[t.status==="sent"&&l.jsx(xi,{className:"w-3 h-3 text-muted-foreground"}),t.status==="delivered"&&l.jsx(Ps,{className:"w-3 h-3 text-muted-foreground"}),t.status==="read"&&l.jsx(Ps,{className:"w-3 h-3 text-primary"}),l.jsxs("p",{className:"text-xs text-muted-foreground",children:[Na(t.timestamp,"HH:mm"),t.edited&&l.jsx("span",{className:"ml-1 opacity-70 italic",children:"(edited)"})]})]})]})]})}const pu=d.forwardRef(({className:t,...e},n)=>l.jsx("textarea",{className:B("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));pu.displayName="Textarea";function bE({placeholder:t="Type a message...",onSendMessage:e,onStartTyping:n,onStopTyping:r,disabled:o=!1,isLoading:i=!1,replyToMessage:s,onCancelReply:a}){const[c,p]=d.useState(""),[f,m]=d.useState(!1),u=d.useRef(null),h=d.useRef(),x=()=>{c.trim()&&!o&&!i&&(e(c.trim()),p(""),w(),u.current&&(u.current.style.height="auto"))},g=b=>{b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),x())},v=b=>{p(b),u.current&&(u.current.style.height="auto",u.current.style.height=`${Math.min(u.current.scrollHeight,120)}px`),b.trim()&&!f?y():!b.trim()&&f&&w(),h.current&&clearTimeout(h.current),b.trim()&&(h.current=setTimeout(()=>{w()},2e3))},y=()=>{f||(m(!0),n==null||n())},w=()=>{f&&(m(!1),r==null||r()),h.current&&clearTimeout(h.current)};return l.jsxs("div",{className:"border-t border-notification-border bg-card",children:[s&&l.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-notification-border bg-primary/5 rounded-t-lg shadow-sm transition-all duration-200",children:[l.jsxs("div",{className:"flex-1 min-w-0 border-l-2 border-primary pl-2",children:[l.jsxs("p",{className:"text-xs text-muted-foreground",children:["Replying to ",l.jsx("span",{className:"font-medium text-primary",children:s.senderName})]}),l.jsx("p",{className:"text-sm text-foreground truncate",children:s.content})]}),l.jsx(pe,{size:"sm",variant:"ghost",onClick:a,className:"h-6 w-6 p-0 ml-2 rounded-full hover:bg-primary/10 transition-colors duration-200",children:l.jsx(bi,{className:"w-4 h-4 text-primary"})})]}),l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"flex items-end gap-2",children:[l.jsx(pe,{size:"sm",variant:"ghost",className:"h-9 w-9 p-0 flex-shrink-0 rounded-full hover:bg-primary/10 transition-colors duration-200",disabled:o,onClick:()=>{const b=document.createElement("input");b.type="file",b.accept="*/*",b.onchange=S=>{var A;const _=(A=S.target.files)==null?void 0:A[0];_&&console.log("Selected file:",_.name)},b.click()},children:l.jsx(Gm,{className:"w-4 h-4 text-primary"})}),l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(pu,{ref:u,value:c,onChange:b=>v(b.target.value),onKeyDown:g,placeholder:i?"Sending...":t,disabled:o||i,className:B("min-h-9 max-h-32 resize-none bg-notification border-notification-border rounded-2xl","focus:ring-1 focus:ring-primary focus:border-primary shadow-sm","pr-20 transition-all duration-200",i&&"opacity-60 cursor-not-allowed"),rows:1}),l.jsxs("div",{className:"absolute right-2 bottom-2 flex items-center gap-1",children:[l.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 rounded-full hover:bg-primary/10 transition-colors duration-200",disabled:o,onClick:()=>{const b=document.createElement("input");b.type="file",b.accept="image/*",b.onchange=S=>{var A;const _=(A=S.target.files)==null?void 0:A[0];_&&console.log("Selected image:",_.name)},b.click()},children:l.jsx(Um,{className:"w-4 h-4 text-primary"})}),l.jsx(pe,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 rounded-full hover:bg-primary/10 transition-colors duration-200",disabled:o,onClick:()=>{console.log("Emoji picker clicked")},children:l.jsx(Jm,{className:"w-4 h-4 text-primary"})})]})]}),c.trim()?l.jsx(pe,{size:"sm",onClick:x,disabled:o||!c.trim()||i,className:"h-9 w-9 p-0 flex-shrink-0 bg-primary hover:bg-primary/90 rounded-full shadow-md transition-all duration-200 ease-in-out transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:i?l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):l.jsx(Qm,{className:"w-4 h-4"})}):l.jsx(pe,{size:"sm",variant:"ghost",className:"h-9 w-9 p-0 flex-shrink-0 rounded-full hover:bg-primary/10 transition-colors duration-200",disabled:o,onClick:()=>{console.log("Voice recording clicked")},children:l.jsx(Vm,{className:"w-4 h-4 text-primary"})})]})})]})}function SE({conversation:t,messages:e,currentUser:n,typingUsers:r,onSendMessage:o,onEditMessage:i,onDeleteMessage:s,onReactToMessage:a,onStartTyping:c,onStopTyping:p,isLoading:f=!1}){var T;const[m,u]=d.useState(null),h=d.useRef(null),x=d.useRef(null);d.useEffect(()=>{var C;(C=x.current)==null||C.scrollIntoView({behavior:"smooth"})},[e,r]);const g=()=>{if(t.type==="direct"){const k=t.participants.find(R=>R.id!==n.id);return(k==null?void 0:k.name)||"Unknown User"}return t.title?t.title:t.participants.filter(k=>k.id!==n.id).map(k=>k.name).join(", ")},v=()=>{if(t.type==="group")return`${t.participants.length} members`;const C=t.participants.find(k=>k.id!==n.id);return C?C.status==="online"?"Online":C.status==="away"?"Away":C.lastSeen?`Last seen ${Aa(C.lastSeen,{addSuffix:!0})}`:"Offline":""},y=(C,k)=>{if(k===e.length-1)return!0;const R=e[k+1];return R.senderId!==C.senderId||R.timestamp.getTime()-C.timestamp.getTime()>3e5},w=(C,k)=>{if(k===0)return!0;const R=e[k-1];return!xs(C.timestamp,R.timestamp)||C.timestamp.getTime()-R.timestamp.getTime()>3e5},b=(C,k)=>{if(k===0)return!0;const R=e[k-1];return!xs(C.timestamp,R.timestamp)},S=C=>{var R;const k=e.find(P=>P.id===C);if(k){let P="Unknown User";if((R=k.sender)!=null&&R.full_name)P=k.sender.full_name;else{const F=t.participants.find($=>$.id===k.senderId);P=(F==null?void 0:F.name)||"Unknown User"}u({id:C,content:k.content,senderName:P})}},_=()=>{const C=r.filter(k=>k.userId!==n.id).map(k=>{const R=t.participants.find(P=>P.id===k.userId);return(R==null?void 0:R.name)||"Someone"});return C.length===0?"":C.length===1?`${C[0]} is typing...`:C.length===2?`${C[0]} and ${C[1]} are typing...`:`${C[0]} and ${C.length-1} others are typing...`},A=Gd(),E=()=>{window.history.back()};return l.jsxs("div",{className:"flex flex-col h-full bg-card",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-notification-border",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[A&&l.jsx(pe,{variant:"ghost",size:"icon",className:"mr-1 bg-primary/5 hover:bg-primary/10 rounded-full transition-all duration-200 ease-in-out",onClick:E,children:l.jsx(uc,{className:"h-5 w-5 text-primary"})}),t.type==="group"?l.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:l.jsx(Mo,{className:"w-5 h-5 text-primary"})}):l.jsxs(In,{className:"w-10 h-10",children:[l.jsx(On,{src:(T=t.participants.find(C=>C.id!==n.id))==null?void 0:T.avatar}),l.jsx(Ln,{children:g().charAt(0).toUpperCase()})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-foreground",children:g()}),l.jsx("p",{className:"text-sm text-muted-foreground",children:v()})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(pe,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",children:l.jsx(wi,{className:"w-4 h-4"})}),l.jsx(pe,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>Re.info("Audio call feature coming soon!"),children:l.jsx(Wm,{className:"w-4 h-4"})}),l.jsx(pe,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>Re.info("Video call feature coming soon!"),children:l.jsx(nh,{className:"w-4 h-4"})}),l.jsx(pe,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",children:l.jsx(Hm,{className:"w-4 h-4"})}),l.jsx(pe,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",children:l.jsx(Fm,{className:"w-4 h-4"})})]})]}),l.jsx(Gr,{className:"flex-1",ref:h,children:l.jsx("div",{className:"py-4",children:e.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Mo,{className:"w-8 h-8 text-primary"})}),l.jsxs("p",{className:"text-muted-foreground",children:["Start a conversation with ",g()]})]}):l.jsxs(l.Fragment,{children:[e.map((C,k)=>{var P;let R;return(P=C.sender)!=null&&P.full_name?R={id:C.sender.id,name:C.sender.full_name,avatar:C.sender.avatar_url,status:"offline"}:R=t.participants.find($=>$.id===C.senderId)||{id:C.senderId,name:"Unknown User",avatar:void 0,status:"offline"},l.jsxs("div",{children:[b(C,k)&&l.jsx("div",{className:"flex items-center justify-center py-4",children:l.jsx("div",{className:"bg-notification border border-notification-border rounded-full px-3 py-1",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:Na(C.timestamp,"MMMM d, yyyy")})})}),l.jsx(wE,{message:C,sender:R,currentUser:n,isGroupChat:t.type==="group",showAvatar:y(C,k),showTimestamp:w(C,k),onEdit:i,onDelete:s,onReply:S,onReact:a})]},C.id)}),r.length>0&&l.jsx("div",{className:"px-4 py-2",children:l.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[l.jsxs("div",{className:"flex gap-1",children:[l.jsx("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce"}),l.jsx("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),l.jsx("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),l.jsx("span",{children:_()})]})}),l.jsx("div",{ref:x})]})})}),l.jsx(bE,{onSendMessage:o,onStartTyping:c,onStopTyping:p,replyToMessage:m,onCancelReply:()=>u(null),isLoading:f})]})}function _E({isOpen:t,onClose:e,onStartConversation:n,currentUser:r}){const[o,i]=d.useState(""),[s,a]=d.useState([]),[c,p]=d.useState(!1),f=async m=>{if(m.trim()===""){a([]);return}p(!0);try{const{data:u,error:h}=await I.from("profiles").select("id, full_name, avatar_url").ilike("full_name",`%${m}%`).neq("id",r.id).limit(10);if(h){console.error("Error searching users:",h),a([]);return}const x=u.map(g=>({id:g.id,name:g.full_name||"Unknown User",avatar:g.avatar_url?I.storage.from("avatars").getPublicUrl(g.avatar_url).data.publicUrl:void 0,status:"offline"}));a(x)}catch(u){console.error("Error during user search:",u),a([])}finally{p(!1)}};return l.jsx(bc,{open:t,onOpenChange:e,children:l.jsxs(_i,{className:"sm:max-w-[425px]",children:[l.jsxs(Ei,{children:[l.jsx(Ci,{children:"Start New Conversation"}),l.jsx(Ti,{children:"Search for users to start a new direct message."})]}),l.jsxs("div",{className:"grid gap-4 py-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),l.jsx(Xe,{placeholder:"Search users...",value:o,onChange:m=>{i(m.target.value),f(m.target.value)},className:"pl-9"})]}),l.jsx(Gr,{className:"h-[200px] w-full rounded-md border",children:c?l.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Searching..."}):s.length===0&&o.length>0?l.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"No users found."}):s.length===0&&o.length===0?l.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Start typing to search for users."}):l.jsx("div",{children:s.map(m=>l.jsxs("div",{className:"flex items-center gap-3 p-3 hover:bg-muted cursor-pointer",onClick:()=>n(m),children:[l.jsxs(In,{className:"w-8 h-8",children:[l.jsx(On,{src:m.avatar}),l.jsx(Ln,{children:m.name.charAt(0).toUpperCase()})]}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:m.name}),l.jsx("p",{className:"text-sm text-muted-foreground",children:m.status})]})]},m.id))})})]})]})})}const uu=t=>{const e=Ca();d.useEffect(()=>{let m=[],u,h;const g=(async()=>{try{const{data:{session:v}}=await I.auth.getSession();if(!(v!=null&&v.user)||!t){console.log("🔐 [SUBSCRIPTION] Auth check failed or no userId, skipping subscription setup");return}console.log("🔐 [SUBSCRIPTION] Setting up auth-aware subscription for user:",t);const{data:y,error:w}=await I.from("conversation_participants").select("conversation_id").eq("user_id",t);if(w){console.error("❌ [SUBSCRIPTION] Failed to fetch user participations:",w);return}m=(y==null?void 0:y.map(b=>b.conversation_id))||[],console.log(`📊 [SUBSCRIPTION] Setting up subscription for ${m.length} conversations`),h=I.channel(`auth-aware-conversations-${t}-${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"conversation_messages",filter:m.length>0?`conversation_id=in.(${m.join(",")})`:"conversation_id=eq.never"},async b=>{console.log("📨 [SUBSCRIPTION] Auth-aware message update:",b);try{const{data:{session:S}}=await I.auth.getSession();if(!(S!=null&&S.user))throw new Error("Not authenticated");setTimeout(()=>{e.invalidateQueries({queryKey:["optimized-conversations",t]})},100)}catch(S){console.warn("🔐 [SUBSCRIPTION] Auth failed during message update, ignoring:",S)}}).on("postgres_changes",{event:"*",schema:"public",table:"conversation_participants",filter:`user_id=eq.${t}`},async b=>{console.log("👥 [SUBSCRIPTION] Auth-aware participation update:",b);try{const{data:{session:S}}=await I.auth.getSession();if(!(S!=null&&S.user))throw new Error("Not authenticated");e.invalidateQueries({queryKey:["optimized-conversations",t]})}catch(S){console.warn("🔐 [SUBSCRIPTION] Auth failed during participation update, ignoring:",S)}}).subscribe(b=>{console.log("🔗 [SUBSCRIPTION] Channel status:",b)}),u=I.auth.onAuthStateChange(async(b,S)=>{console.log("🔐 [SUBSCRIPTION] Auth state changed:",b,!!S),b==="SIGNED_OUT"||!S?(console.log("🔐 [SUBSCRIPTION] User signed out, cleaning up subscription"),h&&(await I.removeChannel(h),h=null),e.removeQueries({queryKey:["optimized-conversations"]}),e.removeQueries({queryKey:["conversation-messages"]})):(b==="SIGNED_IN"||b==="TOKEN_REFRESHED")&&(console.log("🔐 [SUBSCRIPTION] User signed in/token refreshed, refreshing data"),e.invalidateQueries({queryKey:["optimized-conversations",t]}))})}catch(v){console.error("❌ [SUBSCRIPTION] Failed to setup auth-aware subscription:",v)}})();return()=>{g.then(()=>{var v,y;h&&I.removeChannel(h),u&&((y=(v=u.data)==null?void 0:v.subscription)==null||y.unsubscribe())})}},[e,t]);const[n,r]=d.useState(0),o=3,{data:i=[],isLoading:s,error:a}=pi({queryKey:["optimized-conversations",t],queryFn:async()=>{var m,u;try{console.log("🔄 [CONVERSATIONS] Starting fetch process");const h=Date.now();let x;if(t)x={id:t},console.log(`✅ [CONVERSATIONS] Using provided user ID: ${t}`);else{const{data:{session:g},error:v}=await I.auth.getSession();if(console.log(`⏱️ [CONVERSATIONS] Session fetch took ${Date.now()-h}ms`),v||!(g!=null&&g.user))return console.warn("❌ [CONVERSATIONS] No valid session:",{error:v==null?void 0:v.message,hasUser:!!(g!=null&&g.user)}),[];x=g.user,console.log(`✅ [CONVERSATIONS] Valid session for user: ${x.id}`)}try{const{data:g,error:v}=await I.from("conversation_participants").select("conversation_id").eq("user_id",x.id);if(v)return console.error("Error fetching user participations:",v),[];if(!g||g.length===0)return console.log("📭 [CONVERSATIONS] No conversations found for user"),[];const y=g.map(N=>N.conversation_id);console.log(`📊 [CONVERSATIONS] Found ${y.length} conversation IDs:`,y);const w=Date.now();console.log("🔄 [CONVERSATIONS] Starting batch fetch for conversations, participants, and messages");let b,S,_;try{[b,S,_]=await Promise.all([I.from("conversations").select("id, title, type, created_at, updated_at, last_message_at, created_by").in("id",y).order("updated_at",{ascending:!1}),I.from("conversation_participants").select(`
                conversation_id,
                user_id,
                joined_at,
                last_read_at,
                profiles!conversation_participants_user_id_fkey (id, full_name, avatar_url)
              `).in("conversation_id",y),I.from("conversation_messages").select(`
                id, 
                content, 
                sender_id, 
                created_at, 
                message_type, 
                conversation_id,
                sender:profiles!sender_id (
                  id,
                  full_name,
                  avatar_url
                )
              `).in("conversation_id",y).order("created_at",{ascending:!1})])}catch(N){console.warn("⚠️ [CONVERSATIONS] Embedding query failed, using fallback queries:",N),[b,S,_]=await Promise.all([I.from("conversations").select("id, title, type, created_at, updated_at, last_message_at, created_by").in("id",y).order("updated_at",{ascending:!1}),I.from("conversation_participants").select("conversation_id, user_id, joined_at, last_read_at").in("conversation_id",y),I.from("conversation_messages").select("id, content, sender_id, created_at, message_type, conversation_id").in("conversation_id",y).order("created_at",{ascending:!1})]);const L=((m=S.data)==null?void 0:m.map(j=>j.user_id))||[];if(L.length>0){const{data:j}=await I.from("profiles").select("id, full_name, avatar_url").in("id",L);S.data&&j&&(S.data=S.data.map(W=>({...W,profiles:j.find(z=>z.id===W.user_id)||null})))}const M=((u=_.data)==null?void 0:u.map(j=>j.sender_id))||[];if(M.length>0){const{data:j}=await I.from("profiles").select("id, full_name, avatar_url").in("id",M);_.data&&j&&(_.data=_.data.map(W=>({...W,sender:j.find(z=>z.id===W.sender_id)||null})))}}const{data:A,error:E}=b,{data:T,error:C}=S,{data:k,error:R}=_;if(console.log(`⏱️ [CONVERSATIONS] Batch fetch completed in ${Date.now()-w}ms`),console.log("📋 [CONVERSATIONS] Batch results:",{conversations:(A==null?void 0:A.length)||0,participants:(T==null?void 0:T.length)||0,messages:(k==null?void 0:k.length)||0}),E||C||R)return console.error("❌ [CONVERSATIONS] Error in batch fetch:"),console.error("🚨 [CONVERSATIONS ERROR] Raw errors:",JSON.stringify({convError:E,participantsError:C,messagesError:R},null,2)),E&&console.error("🚨 [CONV ERROR] Details:",E),C&&console.error("🚨 [PARTICIPANTS ERROR] Details:",C),R&&console.error("🚨 [MESSAGES ERROR] Details:",R),[];const P=new Map;T==null||T.forEach(N=>{P.has(N.conversation_id)||P.set(N.conversation_id,[]),P.get(N.conversation_id).push(N)});const F=new Map;k==null||k.forEach(N=>{F.has(N.conversation_id)||F.set(N.conversation_id,N)}),console.log("🔄 [CONVERSATIONS] Starting transformation process");const $=Date.now(),G=(A||[]).map(N=>{const L=P.get(N==null?void 0:N.id)||[];console.log(`👥 [CONVERSATIONS] Conv ${N==null?void 0:N.id}: ${L.length} participants found`);const M=L.find(K=>K.user_id===t),j=M==null?void 0:M.last_read_at;let W=0;if(k){const K=k.filter(ie=>ie.conversation_id===N.id);j?W=K.filter(ie=>new Date(ie.created_at)>new Date(j)&&ie.sender_id!==t).length:W=K.filter(ie=>ie.sender_id!==t).length}const z=(L||[]).map(K=>{var ie,ge;return{id:K.user_id,name:((ie=K.profiles)==null?void 0:ie.full_name)||"Unknown User",avatar:(ge=K.profiles)!=null&&ge.avatar_url?I.storage.from("avatars").getPublicUrl(K.profiles.avatar_url).data.publicUrl:void 0,status:"offline"}}),q=F.get(N.id);return{id:N.id,title:N.title||N.name||"Direct Message",participants:z,lastMessage:q?{id:q.id,content:q.content,senderId:q.sender_id,conversationId:N.id,timestamp:new Date(q.created_at),type:q.message_type,sender:q.sender}:void 0,unreadCount:W,type:N.type||"direct",createdAt:new Date(N.created_at||new Date().toISOString()),updatedAt:new Date(N.updated_at||N.last_message_at||new Date().toISOString())}})||[];return console.log(`✅ [CONVERSATIONS] Transformation completed in ${Date.now()-$}ms`),console.log(`📊 [CONVERSATIONS] Final result: ${G.length} conversations transformed`),console.log("🎯 [CONVERSATIONS] Detailed conversations:",G.map(N=>{var L;return{id:N.id,participantCount:((L=N.participants)==null?void 0:L.length)||0,hasLastMessage:!!N.lastMessage,type:N.type}})),G||[]}catch(g){return console.error("Error in optimized conversation fetch:",g),[]}}catch(h){return console.error("Critical error in conversation query:",h),[]}},enabled:!!t,staleTime:3e4,gcTime:3e5,retry:(m,u)=>(console.log(`🔄 [CONVERSATIONS] Query retry ${m}:`,u),r(m),m<o)}),c=d.useRef(new Map),p=vs({mutationFn:async({participantIds:m,title:u})=>{const h=m.sort().join(","),x=Date.now(),g=c.current.get(h);if(g&&g.count>=3&&x-g.lastAttempt<3e4)throw new Error("Too many attempts. Please wait 30 seconds before trying again.");console.log("Creating conversation - establishing stable session...");let v;if(t)v={id:t};else{const{data:{session:y}}=await I.auth.getSession();if(!(y!=null&&y.user))throw new Error("Authentication required");v=y.user}if(m.length===1&&Array.isArray(i)){console.log("Checking existing conversations:",i.length);const y=i.find(w=>{if(!w.participants)return console.warn("Conversation missing participants:",w.id),!1;if(w.participants.length!==2)return!1;const b=w.participants.some(_=>_.id===m[0]),S=w.participants.some(_=>_.id===v.id);return w.type==="direct"&&b&&S});if(y)return console.log("Using existing conversation:",y.id),c.current.delete(h),y;console.log("No existing direct conversation found, creating new one")}try{const y=c.current.get(h)||{count:0,lastAttempt:0};c.current.set(h,{count:y.count+1,lastAttempt:x}),console.log("Using RPC method for conversation creation");const{data:w,error:b}=await I.rpc("create_conversation_secure",{p_title:u||null,p_type:m.length===1?"direct":"group",p_participant_ids:m,p_created_by_id:v.id});if(b)throw console.error("RPC conversation creation failed:",b),new Error(`Failed to create conversation: ${b.message}`);if(console.log("RPC result:",w),w&&typeof w=="object"&&"exists"in w&&w.exists){console.log("RPC returned existing conversation:",w.id);const S=i.find(_=>_.id===w.id);if(S)return c.current.delete(h),S}return c.current.delete(h),w}catch(y){throw console.error("RPC conversation creation error:",y),y}},onSuccess:m=>{console.log("✅ [CONVERSATIONS] Successfully created/found conversation:",m),te.success("Conversation ready!"),e.invalidateQueries({queryKey:["optimized-conversations",t]})},onError:m=>{console.error("❌ [CONVERSATIONS] Failed to create conversation:",m),te.error(m.message||"Failed to create conversation. Please try again.")}}),f=vs({mutationFn:async({conversationId:m,content:u,type:h="text"})=>{if(console.log("📤 [SEND MESSAGE] Starting send process with RPC:",{conversationId:m,contentLength:u.length,type:h}),!t)throw console.error("❌ [SEND MESSAGE] No authenticated user"),new Error("User not authenticated - please log in");if(!u.trim())throw console.warn("❌ [SEND MESSAGE] Empty content provided"),new Error("Message content cannot be empty");console.log("💬 [SEND MESSAGE] Calling send_conversation_message RPC for conversation:",m);const{data:x,error:g}=await I.rpc("send_conversation_message",{p_conversation_id:m,p_content:u.trim(),p_message_type:h});if(g)throw console.error("❌ [SEND MESSAGE] RPC error:",g),new Error(`Failed to send message: ${g.message}`);if(x&&typeof x=="object"&&"success"in x){if(!x.success)throw console.error("❌ [SEND MESSAGE] RPC returned error:",x.error),new Error(String(x.error)||"Failed to send message");return console.log("✅ [SEND MESSAGE] Message sent successfully via RPC:",x.message_id),{id:x.message_id,conversation_id:x.conversation_id,sender_id:x.sender_id,content:x.content,message_type:x.message_type,created_at:x.created_at,updated_at:x.created_at,edited:!1,edited_at:null}}return console.log("✅ [SEND MESSAGE] Message sent successfully via RPC"),x},onSuccess:m=>{console.log("✅ [CONVERSATIONS] Message sent successfully:",m),te.success("Message sent!"),e.invalidateQueries({queryKey:["optimized-conversations",t]}),e.invalidateQueries({queryKey:["conversation-messages"]})},onError:m=>{console.error("❌ [CONVERSATIONS] Failed to send message:",m),te.error(m.message||"Failed to send message. Please try again.")}});return{conversations:i,isLoading:s,error:a,createConversation:p.mutate,isCreatingConversation:p.isPending,sendMessage:f.mutate,isSendingMessage:f.isPending,sendMessageError:f.error,sendMessageSuccess:f.isSuccess}},EE=t=>{const e=Ca();return d.useEffect(()=>{if(!t)return;let n,r;const i=(async()=>{try{const{data:{session:s}}=await I.auth.getSession();if(!(s!=null&&s.user)){console.log("🔐 [MESSAGE_SUB] Auth check failed, skipping message subscription setup");return}console.log("🔐 [MESSAGE_SUB] Setting up auth-aware message subscription for conversation:",t),n=I.channel(`auth-aware-messages-${t}-${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"conversation_messages",filter:`conversation_id=eq.${t}`},async a=>{console.log("📨 [MESSAGE_SUB] Auth-aware message update received:",a);try{const{data:{session:c}}=await I.auth.getSession();if(!(c!=null&&c.user))throw new Error("Not authenticated");e.invalidateQueries({queryKey:["conversation-messages",t]})}catch(c){console.warn("🔐 [MESSAGE_SUB] Auth failed during message update, ignoring:",c)}}).subscribe(a=>{console.log("🔗 [MESSAGE_SUB] Message channel status:",a)}),r=I.auth.onAuthStateChange(async(a,c)=>{console.log("🔐 [MESSAGE_SUB] Auth state changed for messages:",a,!!c),a==="SIGNED_OUT"||!c?(console.log("🔐 [MESSAGE_SUB] User signed out, cleaning up message subscription"),n&&(await I.removeChannel(n),n=null),e.removeQueries({queryKey:["conversation-messages",t]})):(a==="SIGNED_IN"||a==="TOKEN_REFRESHED")&&(console.log("🔐 [MESSAGE_SUB] User signed in/token refreshed, refreshing messages"),e.invalidateQueries({queryKey:["conversation-messages",t]}))})}catch(s){console.error("❌ [MESSAGE_SUB] Failed to setup auth-aware message subscription:",s)}})();return()=>{i.then(()=>{var s,a;n&&(console.log("🧹 [MESSAGE_SUB] Cleaning up message subscription for conversation:",t),I.removeChannel(n)),r&&((a=(s=r.data)==null?void 0:s.subscription)==null||a.unsubscribe())})}},[t,e]),pi({queryKey:["conversation-messages",t],queryFn:async()=>{if(!t)return[];console.log("📥 [MESSAGES] Fetching messages for conversation:",t);const{data:n,error:r}=await I.from("conversation_messages").select(`
          id,
          content,
          sender_id,
          created_at,
          updated_at,
          message_type,
          edited,
          edited_at,
          sender:profiles!sender_id (
            id,
            full_name,
            avatar_url
          )
        `).eq("conversation_id",t).order("created_at",{ascending:!0});if(r)throw console.error("❌ [MESSAGES] Error fetching messages:",r),r;return console.log(`✅ [MESSAGES] Fetched ${(n==null?void 0:n.length)||0} messages`),(n||[]).map(o=>({id:o.id,content:o.content,senderId:o.sender_id,conversationId:t,timestamp:new Date(o.created_at),type:o.message_type||"text",edited:o.edited||!1,editedAt:o.edited_at?new Date(o.edited_at):void 0,sender:o.sender?{id:o.sender.id,full_name:o.sender.full_name,avatar_url:o.sender.avatar_url}:void 0}))},enabled:!!t,staleTime:1e4,gcTime:3e5,retry:2})};function CE({className:t,recipientId:e,recipientName:n}){console.log("MessagingInterface: Loading with",{recipientId:e,recipientName:n});const[r,o]=d.useState(null),[i,s]=d.useState(!0),[a,c]=d.useState(null);d.useEffect(()=>{(async()=>{var L;console.log("👤 [MESSAGING] Fetching current user"),s(!0),c(null);try{const M=Date.now(),{data:{user:j},error:W}=await I.auth.getUser();if(console.log(`⏱️ [MESSAGING] User fetch took ${Date.now()-M}ms`),W){console.error("❌ [MESSAGING] Auth error:",W),c("Authentication failed"),s(!1);return}if(j){console.log(`✅ [MESSAGING] User found: ${j.id}`);const{data:z,error:q}=await I.from("profiles").select("full_name, avatar_url").eq("id",j.id).maybeSingle();q&&console.warn("⚠️ [MESSAGING] Profile fetch error:",q);const K={id:j.id,name:(z==null?void 0:z.full_name)||((L=j.email)==null?void 0:L.split("@")[0])||"You",avatar:z!=null&&z.avatar_url?I.storage.from("avatars").getPublicUrl(z.avatar_url).data.publicUrl:"https://i.pravatar.cc/150?img=32",status:"online"};console.log("👤 [MESSAGING] Setting current user:",K.id,K.name),o(K)}else console.warn("⚠️ [MESSAGING] No user found in auth"),c("No authenticated user")}catch(M){console.error("❌ [MESSAGING] Error fetching current user:",M),c("Failed to load user data")}finally{s(!1)}})()},[]);const{conversations:p,isLoading:f,createConversation:m,isCreatingConversation:u,sendMessage:h,isSendingMessage:x}=uu(r==null?void 0:r.id),[g,v]=d.useState();console.log("🖥️ [MESSAGING] Hook state",{conversationsCount:Array.isArray(p)?p.length:0,conversationsLoading:f,hasConversations:Array.isArray(p),selectedConversationId:g,currentUserId:r==null?void 0:r.id,authLoading:i});const{data:y=[],isLoading:w,error:b}=EE(g),[S,_]=d.useState(""),[A,E]=d.useState(!1);d.useEffect(()=>{g&&(r!=null&&r.id)&&(async()=>{try{console.log("📖 [READ_TRACKING] Updating last_read_at for conversation:",g);const{error:L}=await I.from("conversation_participants").update({last_read_at:new Date().toISOString()}).eq("conversation_id",g).eq("user_id",r.id);L?console.error("❌ [READ_TRACKING] Error updating last_read_at:",L):console.log("✅ [READ_TRACKING] Successfully updated last_read_at")}catch(L){console.error("❌ [READ_TRACKING] Error in updateLastReadAt:",L)}})()},[g,r==null?void 0:r.id]),d.useEffect(()=>{var N,L;try{console.log("🔄 [MESSAGING] Auto-select effect triggered",{selectedConversationId:g,conversationsLength:Array.isArray(p)?p.length:0,conversationsLoading:f,isArray:Array.isArray(p)}),!g&&Array.isArray(p)&&p.length>0&&!f?(console.log("✅ [MESSAGING] Auto-selecting first conversation:",(N=p[0])==null?void 0:N.id),v((L=p[0])==null?void 0:L.id)):console.log("⏸️ [MESSAGING] Auto-select conditions not met")}catch(M){console.error("❌ [MESSAGING] Error in auto-select:",M)}},[p,g,f]);const T=d.useCallback(N=>{u||m(N)},[m,u]),[C,k]=d.useState(new Map);d.useEffect(()=>{try{if(console.log("MessagingInterface: recipientId=",e,"recipientName=",n,"currentUser.id=",r.id),e&&n&&(r!=null&&r.id)&&!f){console.log("MessagingInterface: Processing recipient data, looking for existing conversation"),console.log("MessagingInterface: Current conversations:",Array.isArray(p)?p.length:"not array");const N=Array.isArray(p)?p.find(L=>(L==null?void 0:L.type)==="direct"&&Array.isArray(L==null?void 0:L.participants)&&L.participants.length===2&&L.participants.some(M=>(M==null?void 0:M.id)===e)&&L.participants.some(M=>(M==null?void 0:M.id)===r.id)):null;if(console.log("MessagingInterface: Existing conversation found:",N),N)console.log("MessagingInterface: Selecting existing conversation:",N.id),v(N.id),k(L=>{const M=new Map(L);return M.delete(e),M});else if(!u){const L=C.get(e)||0;L<3?(console.log("MessagingInterface: Creating new conversation with:",{participantIds:[e],title:n}),k(M=>{const j=new Map(M);return j.set(e,L+1),j}),T({participantIds:[e]})):console.warn("MessagingInterface: Max creation attempts reached for recipient:",e)}}else console.log("MessagingInterface: Missing required data, user not loaded, or conversations loading")}catch(N){console.error("MessagingInterface: Error in recipient handling:",N)}},[e,n,p,r==null?void 0:r.id,f,u]);const R=Array.isArray(p)?p.filter(N=>{var M;return N?(N.title||(Array.isArray(N.participants)?N.participants:[]).filter(j=>(j==null?void 0:j.id)!==(r==null?void 0:r.id)).map(j=>(j==null?void 0:j.name)||"Unknown").join(", ")).toLowerCase().includes(S.toLowerCase())||((M=N.lastMessage)==null?void 0:M.content)&&N.lastMessage.content.toLowerCase().includes(S.toLowerCase()):!1}):[],P=R.find(N=>N.id===g),F=d.useCallback(N=>{g&&N.trim()?(console.log("Sending message:",{conversationId:g,content:N}),h({conversationId:g,content:N.trim(),type:"text"})):console.warn("Cannot send message:",{selectedConversationId:g,hasContent:!!N.trim()})},[g,h]),$=()=>{E(!0)},G=async N=>{try{T({participantIds:[N.id]}),E(!1)}catch(L){console.error("Error creating conversation:",L)}};return i||!r?(console.log("🔄 [MESSAGING] Showing loading state - authentication in progress"),l.jsx("div",{className:B("flex items-center justify-center h-full bg-card rounded-lg border border-notification-border",t),children:l.jsxs("div",{className:"text-center p-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),l.jsx("div",{className:"text-muted-foreground",children:a?`Error: ${a}`:"Loading conversations..."}),a&&l.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",children:"Retry"})]})})):(console.log("🎯 [MESSAGING] Rendering interface",{conversationsLoading:f,filteredConversationsCount:R.length,selectedConversationId:g,currentUserId:r.id,messagesCount:Array.isArray(y)?y.length:0}),l.jsxs("div",{className:B("flex flex-col h-full bg-card rounded-lg border border-notification-border overflow-hidden",t),children:[l.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[l.jsx("div",{className:"w-80 flex-shrink-0",children:l.jsx(r_,{conversations:R,selectedConversationId:g,currentUser:r,onSelectConversation:v,onNewConversation:$,searchTerm:S,onSearchChange:_})}),l.jsx("div",{className:"flex-1",children:P?l.jsx(SE,{conversation:P,messages:Array.isArray(y)?y:[],currentUser:r,typingUsers:[],onSendMessage:F,isLoading:x}):l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx("svg",{className:"w-8 h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),l.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No conversation selected"}),l.jsx("p",{className:"text-muted-foreground",children:"Choose a conversation to start messaging"})]})})})]}),l.jsx(_E,{isOpen:A,onClose:()=>E(!1),onStartConversation:G,currentUser:r})]}))}function TE({isOpen:t,onClose:e,onMinimize:n,onMaximize:r,recipientId:o,recipientName:i,className:s}){const[a,c]=d.useState(!1),p=()=>{c(!0),n()},f=()=>{c(!1)};return t?l.jsxs("div",{className:B("fixed bottom-4 right-4 bg-card border border-notification-border rounded-lg shadow-2xl z-50 transition-all duration-300",a?"w-80 h-12":"w-96 h-[500px]",s),children:[l.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-notification-border bg-primary/5 rounded-t-lg",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(yi,{className:"w-5 h-5 text-primary"}),l.jsx("h3",{className:"font-medium text-foreground",children:a?"Chat":i||"Messages"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(pe,{size:"sm",variant:"ghost",onClick:a?f:p,className:"h-6 w-6 p-0 hover:bg-primary/10 rounded-full",children:l.jsx(qm,{className:"w-3 h-3"})}),l.jsx(pe,{size:"sm",variant:"ghost",onClick:r,className:"h-6 w-6 p-0 hover:bg-primary/10 rounded-full",children:l.jsx(Bm,{className:"w-3 h-3"})}),l.jsx(pe,{size:"sm",variant:"ghost",onClick:e,className:"h-6 w-6 p-0 hover:bg-destructive/10 rounded-full",children:l.jsx(bi,{className:"w-3 h-3"})})]})]}),!a&&l.jsx("div",{className:"h-[calc(100%-49px)] flex flex-col",children:l.jsx(CE,{className:"flex-1 border-0",recipientId:o,recipientName:i})})]}):null}function kE({onClick:t,unreadCount:e=0,className:n}){const[r,o]=d.useState(!1);return l.jsx("div",{className:B("fixed bottom-6 right-6 z-40",n),children:l.jsxs(pe,{size:"lg",onClick:t,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),className:B("h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-all duration-300","bg-primary hover:bg-primary/90 relative transform hover:scale-110",r&&"animate-pulse"),children:[l.jsx(yi,{className:"w-6 h-6"}),e>0&&l.jsx(np,{variant:"destructive",className:"absolute -top-2 -right-2 h-6 min-w-6 flex items-center justify-center text-xs px-1.5 animate-bounce",children:e>99?"99+":e})]})})}function AE({recipientId:t,recipientName:e}){const[n,r]=d.useState(!1),[o,i]=d.useState(!1),[s,a]=d.useState("popup"),{conversations:c}=uu(),p=ka(),f=Array.isArray(c)?c.reduce((v,y)=>v+(y.lastMessage?1:0),0):0;d.useEffect(()=>{t&&e&&(r(!0),a("popup"))},[t,e]);const m=()=>{r(!0),i(!1)},u=()=>{r(!1),i(!1)},h=()=>{i(!0)},x=()=>{r(!1),p("/messages",{state:{recipientId:t,recipientName:e}})},g=window.location.pathname==="/messages";return l.jsxs(l.Fragment,{children:[!g&&!n&&l.jsx(kE,{onClick:m,unreadCount:f}),l.jsx(TE,{isOpen:n,onClose:u,onMinimize:h,onMaximize:x,recipientId:t,recipientName:e})]})}const NE=new Su({defaultOptions:{queries:{staleTime:5*60*1e3,refetchOnWindowFocus:!1}}}),jE=({children:t})=>l.jsx(lS,{children:t}),RE=d.lazy(()=>ee(()=>import("./Index-ONyn82mb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]))),ME=d.lazy(()=>ee(()=>import("./Login-B81YrFw7.js"),__vite__mapDeps([32,1,2,22,31,7]))),PE=d.lazy(()=>ee(()=>import("./signup-oaSe6_1k.js"),__vite__mapDeps([33,1,2,22,31,7]))),IE=d.lazy(()=>ee(()=>import("./Profile-Dxm2dXg6.js"),__vite__mapDeps([34,1,2,23,11,24,25,27,35,30,36,37,19,38,39,40,41,42,43,44,45,46,47,48,49,22,31,7]))),OE=d.lazy(()=>ee(()=>import("./Map-DZ5C1Akv.js"),__vite__mapDeps([50,1,2,23,11,24,25,31,51,52,53,48,35,49,12,27,30,54,55,43,56,17,57,13,58,20,18,47,21,14,59,7,60,22]))),LE=d.lazy(()=>ee(()=>import("./More-OIQr9KKL.js"),__vite__mapDeps([61,1,2,23,11,24,25,37,19,40,42,22,31,7]))),DE=d.lazy(()=>ee(()=>import("./CarDetails-4MzY_KIz.js"),__vite__mapDeps([62,1,2,63,23,11,24,25,22,6,7,8,16,64,19,65,55,17,53,51,52,10,12,13,31,66,14,18,28,67,41,27,30,68,49]))),zE=d.lazy(()=>ee(()=>import("./AddCar-D3lYIgON.js"),__vite__mapDeps([69,1,2,23,11,24,25,70,71,55,29,56,64,19,65,17,53,16,22,31,7]))),FE=d.lazy(()=>ee(()=>import("./DriverLicense-B5kAe8Dh.js"),__vite__mapDeps([72,1,2,45,6,7,8,44,9,71,55,14,22,31]))),$E=d.lazy(()=>ee(()=>import("./EditCar-BlbnfRSs.js"),__vite__mapDeps([73,1,2,23,11,24,25,70,71,55,29,56,22,31,7]))),UE=d.lazy(()=>ee(()=>import("./SavedCars-Cl9DxnYB.js"),__vite__mapDeps([74,1,2,26,27,28,29,12,23,11,24,25,22,31,7]))),HE=d.lazy(()=>ee(()=>import("./BookingDetails-CyiVOgMV.js"),__vite__mapDeps([75,1,2,27,14,13,59,30,11,25,7,22,31]))),BE=d.lazy(()=>ee(()=>import("./NotificationDetails-CL6xGiq_.js"),__vite__mapDeps([76,1,2,27,77,14,25,24,30,41,11,36,7,22,31]))),VE=d.lazy(()=>ee(()=>import("./HelpCenter-C2qHhzjF.js"),__vite__mapDeps([78,1,2,27,12,47,39,30,13,22,31,7]))),qE=d.lazy(()=>ee(()=>import("./HelpSection-mwQm4CD0.js"),__vite__mapDeps([79,1,2,27,47,13,66,22,31,7]))),GE=d.lazy(()=>ee(()=>import("./BookingRequestDetails-Bz8q3ycA.js"),__vite__mapDeps([80,1,2,23,11,24,25,21,27,81,82,83,31,22,7,84,18,17,47,36,12,30,14,46,85,13,65]))),WE=d.lazy(()=>ee(()=>import("./Dashboard-CRpOfZYt.js"),__vite__mapDeps([86,1,2,87,23,11,24,25,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,38,30,63,27,65,88,57,81,82,83,31,84,47,36,89]))),KE=d.lazy(()=>ee(()=>import("./NotificationsRefactored-Bm3Z1gr7.js"),__vite__mapDeps([90,1,2,23,11,24,25,27,77,41,14,84,30,36,7,35,63,37,22,31]))),YE=d.lazy(()=>ee(()=>import("./Messages-DERxFkyq.js"),__vite__mapDeps([91,1,2,23,11,24,25,22,31,7]))),XE=d.lazy(()=>ee(()=>import("./RentalReview-CGqSzBnH.js"),__vite__mapDeps([92,1,2,27,71,55,67,29,12,22,31,7]))),QE=d.lazy(()=>ee(()=>import("./RentalDetailsRefactored-ClTUT8lr.js"),__vite__mapDeps([93,1,2,23,11,24,25,7,68,27,12,40,18,66,13,30,14,29,84,94,63,95,22,31]))),JE=d.lazy(()=>ee(()=>import("./ResetPassword-CcQypAA-.js"),__vite__mapDeps([96,1,2,22,31,7]))),ZE=d.lazy(()=>ee(()=>import("./ConfirmEmail-OoNvA6O5.js"),__vite__mapDeps([97,1,2,85,47,98,17,22,31,7]))),eC=d.lazy(()=>ee(()=>import("./Wallet-Bu1SG6VP.js"),__vite__mapDeps([99,1,2,27,82,83,31,22,7,84,18,17,47,36,63,15,100,46]))),tC=d.lazy(()=>ee(()=>import("./Verification-B0nLgyuD.js"),__vite__mapDeps([101,1,2,27,54,29,102,25,53,17,55,43,18,65,57,41,11,94,13,98,103,19,16,12,104,30,14,60,22,31,7]))),nC=d.lazy(()=>ee(()=>import("./NotificationPreferencesPage-BXnSpjoF.js"),__vite__mapDeps([105,1,2,24,22,31,7]))),rC=d.lazy(()=>ee(()=>import("./CreateCar-DmxdFASK.js"),__vite__mapDeps([106,1,2,70,71,55,29,56,23,11,24,25,22,31,7]))),oC=d.lazy(()=>ee(()=>import("./EditProfile-CZOtZOAk.js"),__vite__mapDeps([107,1,2,22,31,7]))),iC=d.lazy(()=>ee(()=>import("./CarListing-aRUvFKso.js"),__vite__mapDeps([108,1,2,26,27,28,29,12,5,6,7,8,9,10,11,13,14,15,63,22,31]))),sC=d.lazy(()=>ee(()=>import("./ResendTestPage-CkBfFt1_.js"),__vite__mapDeps([109,1,2,27,98,47,37,17,85,22,31,7]))),aC=d.lazy(()=>ee(()=>import("./AdminDashboard-CbM4TBzb.js"),__vite__mapDeps([110,1,2,111,29,4,63,30,84,41,60,37,42,87,89,27,112,31,14,12,98,11,59,100,36,46,25,65,17,85,13,35,102,19,103,8,22,7]))),cC=d.lazy(()=>ee(()=>import("./AdminUsers-CbQSeNn7.js"),__vite__mapDeps([113,1,2,111,29,4,63,30,84,41,60,37,42,87,112,27,31,14,12,98,11,59,100,36,46,25,65,17,85,13,35,102,19,103,8,22,7]))),lC=d.lazy(()=>ee(()=>import("./AdminCars-uzE1njMx.js"),__vite__mapDeps([114,1,2,111,29,4,63,30,84,41,60,37,42,87,27,35,85,17,22,31,7]))),dC=d.lazy(()=>ee(()=>import("./AdminBookings-CUYBZKP2.js"),__vite__mapDeps([115,1,2,111,29,4,63,30,84,41,60,37,42,87,27,22,31,7]))),pC=d.lazy(()=>ee(()=>import("./AdminTransactions-DQ80SIEo.js"),__vite__mapDeps([116,1,2,111,29,4,63,30,84,41,60,37,42,87,27,59,22,31,7]))),uC=d.lazy(()=>ee(()=>import("./AdminVerifications-DYXmL3MU.js"),__vite__mapDeps([117,1,2,111,29,4,63,30,84,41,60,37,42,87,27,17,85,22,31,7]))),fC=d.lazy(()=>ee(()=>import("./AdminMessages-0AYgaSGS.js"),__vite__mapDeps([118,1,2,111,29,4,63,30,84,41,60,37,42,87,27,58,22,31,7]))),mC=d.lazy(()=>ee(()=>import("./AdminManagement-DAjfNNES.js"),__vite__mapDeps([119,1,2,111,29,4,63,30,84,41,60,37,42,87,27,102,19,22,31,7]))),hC=d.lazy(()=>ee(()=>import("./HostBookings-CryibwOT.js"),__vite__mapDeps([120,1,2,23,11,24,25,27,56,29,95,14,30,104,7,59,17,85,57,88,13,46,22,31]))),gC=d.lazy(()=>ee(()=>import("./RenterBookings-DzQnDl_P.js"),__vite__mapDeps([121,1,2,23,11,24,25,63,27,57,13,7,30,17,22,31]))),vC=d.lazy(()=>ee(()=>import("./RoleAwareBookingsRedirect-Bg4RubNX.js"),__vite__mapDeps([122,1,2,21,63,22,31,7])));function xC(){return l.jsx(p0,{children:l.jsx(_u,{client:NE,children:l.jsx(rf,{children:l.jsx(d0,{children:l.jsx(T0,{children:l.jsx(Y0,{children:l.jsx(Q0,{children:l.jsx(AS,{children:l.jsxs(Au,{children:[l.jsxs(Nu,{children:[l.jsx(X,{path:"/",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(RE,{})})}),l.jsx(X,{path:"/login",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(ME,{})})}),l.jsx(X,{path:"/signup",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(PE,{})})}),l.jsx(X,{path:"/reset-password",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(JE,{})})}),l.jsx(X,{path:"/confirm-email",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(ZE,{})})}),l.jsx(X,{path:"/profile",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(IE,{})})})}),l.jsx(X,{path:"/edit-profile",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(oC,{})})})}),l.jsx(X,{path:"/dashboard",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(WE,{})})})}),l.jsx(X,{path:"/cars/:carId",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(DE,{})})}),l.jsx(X,{path:"/car-listing",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(iC,{})})}),l.jsx(X,{path:"/add-car",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(zE,{})})})}),l.jsx(X,{path:"/create-car",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(rC,{})})})}),l.jsx(X,{path:"/edit-car/:id",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx($E,{})})})}),l.jsx(X,{path:"/saved-cars",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(UE,{})})})}),l.jsx(X,{path:"/driver-license",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(FE,{})})})}),l.jsx(X,{path:"/rental-review/:bookingId",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(XE,{})})})}),l.jsx(X,{path:"/rental-details/:id",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(QE,{})})})}),l.jsx(X,{path:"/verification",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(tC,{})})})}),l.jsx(X,{path:"/notification-preferences",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(nC,{})})})}),l.jsx(X,{path:"/wallet",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(eC,{})})})}),l.jsx(X,{path:"/map",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(jE,{children:l.jsx(OE,{})})})})}),l.jsx(X,{path:"/more",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(LE,{})})})}),l.jsx(X,{path:"/bookings",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(vC,{})})})}),l.jsx(X,{path:"/bookings/:id",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(HE,{})})})}),l.jsx(X,{path:"/host-bookings",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(hC,{})})})}),l.jsx(X,{path:"/renter-bookings",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(gC,{})})})}),l.jsx(X,{path:"/booking-requests/:id",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(GE,{})})})}),l.jsx(X,{path:"/notifications",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(KE,{})})})}),l.jsx(X,{path:"/notifications/:id",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(BE,{})})})}),l.jsx(X,{path:"/help/:role",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(VE,{})})})}),l.jsx(X,{path:"/help/:role/:section",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(qE,{})})})}),l.jsx(X,{path:"/messages",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(YE,{})})})}),l.jsx(X,{path:"/test/resend",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fe,{children:l.jsx(sC,{})})})}),l.jsx(X,{path:"/admin",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(aC,{})})}),l.jsx(X,{path:"/admin/users",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(cC,{})})}),l.jsx(X,{path:"/admin/cars",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(lC,{})})}),l.jsx(X,{path:"/admin/bookings",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(dC,{})})}),l.jsx(X,{path:"/admin/transactions",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(pC,{})})}),l.jsx(X,{path:"/admin/verifications",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(uC,{})})}),l.jsx(X,{path:"/admin/messages",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(fC,{})})}),l.jsx(X,{path:"/admin/management",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx(mC,{})})}),l.jsx(X,{path:"*",element:l.jsx(d.Suspense,{fallback:l.jsx(Q,{}),children:l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Page Not Found"}),l.jsx("p",{className:"text-muted-foreground",children:"The page you're looking for doesn't exist."})]})})})})]}),l.jsx(AE,{}),l.jsx(nf,{position:"top-center"})]})})})})})})})})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/push-sw.js",{scope:"/"}).then(t=>{console.log("Service Worker registered successfully:",t.scope),t.waiting&&t.waiting.postMessage({action:"SKIP_WAITING"})}).catch(t=>{console.error("Service Worker registration failed:",t)})});ja(document.getElementById("root")).render(l.jsx(xC,{}));export{hv as $,l0 as A,pe as B,xi as C,bc as D,Gr as E,nT as F,Re as G,pu as H,Xe as I,te as J,eh as K,Q as L,Km as M,Ot as N,wt as O,Wm as P,ki as Q,D as R,Vv as S,th as T,Mo as U,Y as V,re as W,bi as X,Rn as Y,Do as Z,cv as _,oS as a,Lm as a$,B as a0,Om as a1,Xi as a2,tT as a3,AS as a4,iT as a5,sT as a6,NS as a7,Ym as a8,of as a9,i0 as aA,qm as aB,ZC as aC,Ke as aD,Jm as aE,zm as aF,it as aG,X0 as aH,Q0 as aI,Um as aJ,JC as aK,cn as aL,zi as aM,He as aN,Fi as aO,ke as aP,br as aQ,fi as aR,_r as aS,ui as aT,wr as aU,jn as aV,$i as aW,Ui as aX,ng as aY,xe as aZ,fc as a_,p0 as aa,lS as ab,DS as ac,Hm as ad,Y0 as ae,ht as af,Dm as ag,sg as ah,uE as ai,fE as aj,du as ak,Yt as al,uu as am,Zm as an,wi as ao,yi as ap,Gd as aq,tg as ar,Bc as as,Oo as at,Lo as au,hc as av,Ro as aw,kC as ax,CE as ay,jo as az,_i as b,Am as b0,Nm as b1,jm as b2,cc as b3,Rm as b4,Tr as b5,ac as b6,lc as b7,dc as b8,CC as b9,TC as ba,Ma as bb,Lh as bc,le as c,Ei as d,Ci as e,mt as f,ql as g,qv as h,Kl as i,s0 as j,Yl as k,a0 as l,kr as m,Ar as n,In as o,On as p,Ln as q,eT as r,I as s,Ti as t,XC as u,np as v,Se as w,QC as x,uc as y,Qm as z};
