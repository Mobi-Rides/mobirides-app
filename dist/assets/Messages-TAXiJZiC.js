var c=Object.defineProperty;var d=(r,t,s)=>t in r?c(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var o=(r,t,s)=>d(r,typeof t!="symbol"?t+"":t,s);import{j as e}from"./query-vendor-C7aRRP05.js";import{r as l,f as m}from"./react-vendor-mnpoGfEl.js";import{m as h,T as x,n as g,B as n,ap as p,a8 as f,ay as u}from"./index-6IS4AKTX.js";import{N as j}from"./Navigation-BQmAR9Jk.js";import"./supabase-vendor-BOn0LdFJ.js";import"./mapbox-vendor-fnXFVHMy.js";import"./date-vendor-Dhms5dOu.js";import"./map-pin-FLVtiGuW.js";import"./bell-ClNaiYuo.js";import"./user-BZvrovAH.js";class N extends l.Component{constructor(){super(...arguments);o(this,"state",{hasError:!1,error:null,errorId:""});o(this,"handleRetry",()=>{console.log(`MessagingErrorBoundary [${this.state.errorId}]: Attempting retry`),this.setState({hasError:!1,error:null,errorId:""})});o(this,"handleRefresh",()=>{console.log(`MessagingErrorBoundary [${this.state.errorId}]: Refreshing page`),window.location.reload()})}static getDerivedStateFromError(s){const a=`msg-error-${Date.now()}`;return console.error(`MessagingErrorBoundary [${a}]:`,s),{hasError:!0,error:s,errorId:a}}componentDidCatch(s,a){console.error(`MessagingErrorBoundary [${this.state.errorId}] caught:`,s,a),console.error("Component stack:",a.componentStack),console.error("Error boundary details:",{errorMessage:s.message,errorStack:s.stack,timestamp:new Date().toISOString()})}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"flex items-center justify-center h-full p-4",children:e.jsxs(h,{className:"max-w-md border-destructive",children:[e.jsx(x,{className:"h-4 w-4 text-destructive"}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-destructive",children:"Messages Failed to Load"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"There was an error loading the messaging interface. This might be a temporary issue."}),e.jsxs("details",{className:"mt-2 text-xs",children:[e.jsx("summary",{className:"cursor-pointer text-muted-foreground hover:text-foreground",children:"Technical details"}),e.jsxs("div",{className:"mt-1 p-2 bg-muted rounded text-xs font-mono",children:[e.jsxs("div",{children:["Error ID: ",this.state.errorId]}),e.jsxs("div",{children:["Message: ",(s=this.state.error)==null?void 0:s.message]}),e.jsxs("div",{children:["Time: ",new Date().toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{onClick:this.handleRetry,className:"flex-1",variant:"outline",size:"sm",children:[e.jsx(p,{className:"mr-2 h-3 w-3"}),"Try Again"]}),e.jsxs(n,{onClick:this.handleRefresh,className:"flex-1",variant:"destructive",size:"sm",children:[e.jsx(f,{className:"mr-2 h-3 w-3"}),"Refresh Page"]})]})]})]})}):this.props.children}}const D=()=>{var a,i;const r=m();l.useEffect(()=>{r.state&&console.log("Received state from navigation:",r.state)},[r]);const t=(a=r.state)==null?void 0:a.recipientId,s=(i=r.state)==null?void 0:i.recipientName;return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx("div",{className:"flex-1 flex flex-col pb-16",children:e.jsx(N,{children:e.jsx(u,{className:"flex-1",recipientId:t,recipientName:s})})}),e.jsx(j,{})]})};export{D as default};
