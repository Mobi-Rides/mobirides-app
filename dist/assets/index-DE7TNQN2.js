import{r as w}from"./react-vendor-mnpoGfEl.js";import{j as h}from"./query-vendor-C7aRRP05.js";var _=Object.defineProperty,P=Object.getOwnPropertyDescriptor,C=Object.getOwnPropertyNames,E=Object.prototype.hasOwnProperty,b=(e,r)=>{for(var t in r)_(e,t,{get:r[t],enumerable:!0})},m=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of C(r))!E.call(e,s)&&s!==t&&_(e,s,{get:()=>r[s],enumerable:!(n=P(r,s))||n.enumerable});return e},y=e=>m(_({},"__esModule",{value:!0}),e),g=(e,r,t)=>new Promise((n,s)=>{var v=u=>{try{i(t.next(u))}catch(l){s(l)}},f=u=>{try{i(t.throw(u))}catch(l){s(l)}},i=u=>u.done?n(u.value):Promise.resolve(u.value).then(v,f);i((t=t.apply(e,r)).next())}),S={};b(S,{SessionContextProvider:()=>j,useSession:()=>N,useSessionContext:()=>D,useSupabaseClient:()=>L,useUser:()=>U});var T=y(S),o=w,O=h,c=(0,o.createContext)({isLoading:!0,session:null,error:null,supabaseClient:{}}),j=({supabaseClient:e,initialSession:r=null,children:t})=>{const[n,s]=(0,o.useState)(r),[v,f]=(0,o.useState)(!r),[i,u]=(0,o.useState)();(0,o.useEffect)(()=>{!n&&r&&s(r)},[n,r]),(0,o.useEffect)(()=>{let d=!0;function a(){return g(this,null,function*(){const{data:{session:p},error:x}=yield e.auth.getSession();if(d){if(x){u(x),f(!1);return}s(p),f(!1)}})}return a(),()=>{d=!1}},[]),(0,o.useEffect)(()=>{const{data:{subscription:d}}=e.auth.onAuthStateChange((a,p)=>{p&&(a==="SIGNED_IN"||a==="TOKEN_REFRESHED"||a==="USER_UPDATED")&&s(p),a==="SIGNED_OUT"&&s(null)});return()=>{d.unsubscribe()}},[]);const l=(0,o.useMemo)(()=>v?{isLoading:!0,session:null,error:null,supabaseClient:e}:i?{isLoading:!1,session:null,error:i,supabaseClient:e}:{isLoading:!1,session:n,error:null,supabaseClient:e},[v,n,i]);return(0,O.jsx)(c.Provider,{value:l,children:t})},D=()=>{const e=(0,o.useContext)(c);if(e===void 0)throw new Error("useSessionContext must be used within a SessionContextProvider.");return e};function L(){const e=(0,o.useContext)(c);if(e===void 0)throw new Error("useSupabaseClient must be used within a SessionContextProvider.");return e.supabaseClient}var N=()=>{const e=(0,o.useContext)(c);if(e===void 0)throw new Error("useSession must be used within a SessionContextProvider.");return e.session},U=()=>{var e,r;const t=(0,o.useContext)(c);if(t===void 0)throw new Error("useUser must be used within a SessionContextProvider.");return(r=(e=t.session)==null?void 0:e.user)!=null?r:null};export{T as d};
