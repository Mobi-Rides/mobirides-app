-- Fix search_path for all postgres-owned public functions
-- Generated from exact function signatures in database

ALTER FUNCTION public.add_conversation_creator_as_participant() SET search_path = public;
ALTER FUNCTION public.analyze_conversation_query_performance() SET search_path = public;
ALTER FUNCTION public.auth_uid_test() SET search_path = public;
ALTER FUNCTION public.check_circular_reply() SET search_path = public;
ALTER FUNCTION public.check_circular_reply_conversation() SET search_path = public;
ALTER FUNCTION public.check_column_exists(table_name text, column_name text) SET search_path = public;
ALTER FUNCTION public.check_conversation_access(p_conversation_id uuid, p_user_id uuid) SET search_path = public;
ALTER FUNCTION public.check_verification_completion(user_uuid uuid) SET search_path = public;
ALTER FUNCTION public.check_verification_completion() SET search_path = public;
ALTER FUNCTION public.clean_expired_locations() SET search_path = public;
ALTER FUNCTION public.cleanup_expired_bypass_sessions() SET search_path = public;
ALTER FUNCTION public.cleanup_expired_confirmations() SET search_path = public;
ALTER FUNCTION public.cleanup_expired_notifications() SET search_path = public;
ALTER FUNCTION public.cleanup_expired_notifications_enhanced() SET search_path = public;
ALTER FUNCTION public.cleanup_expired_tokens() SET search_path = public;
ALTER FUNCTION public.cleanup_rate_limits() SET search_path = public;
ALTER FUNCTION public.count_unread_notifications() SET search_path = public;
ALTER FUNCTION public.create_booking_notification(p_booking_id uuid, p_renter_notification_type notification_type, p_host_notification_type notification_type, p_title text, p_description text, p_metadata jsonb, p_role_target notification_role) SET search_path = public;
ALTER FUNCTION public.create_booking_notification(p_booking_id uuid, p_renter_notification_type notification_type, p_host_notification_type notification_type, p_title text, p_description text, p_metadata jsonb) SET search_path = public;
ALTER FUNCTION public.create_check_column_function() SET search_path = public;
ALTER FUNCTION public.create_conversation_with_participants(p_created_by uuid, p_participant_ids uuid[], p_title text, p_type text) SET search_path = public;
ALTER FUNCTION public.create_handover_notification(p_user_id uuid, p_handover_type text, p_car_brand text, p_car_model text, p_location text, p_status text, p_step_name text, p_progress_percentage integer) SET search_path = public;
ALTER FUNCTION public.create_handover_progress_notification(p_handover_session_id uuid) SET search_path = public;
ALTER FUNCTION public.create_handover_progress_notification(p_handover_session_id uuid, p_completed_steps integer, p_total_steps integer) SET search_path = public;
ALTER FUNCTION public.create_handover_step_notification(p_handover_session_id uuid, p_step_name text, p_completed_by uuid) SET search_path = public;
ALTER FUNCTION public.create_handover_step_notification(p_handover_session_id uuid, p_step_name text, p_step_status text) SET search_path = public;
ALTER FUNCTION public.create_notification_with_expiration(p_user_id uuid, p_type notification_type, p_title text, p_description text, p_content text, p_role_target notification_role, p_related_booking_id uuid, p_related_car_id uuid, p_related_user_id uuid, p_priority integer, p_metadata jsonb, p_custom_expiration_hours integer) SET search_path = public;
ALTER FUNCTION public.create_wallet_notification(p_wallet_transaction_id uuid, p_user_id uuid, p_type notification_type, p_title text, p_description text, p_metadata jsonb, p_role_target notification_role) SET search_path = public;
ALTER FUNCTION public.decrypt_message_content(p_cipher bytea) SET search_path = public;
ALTER FUNCTION public.delete_old_notifications(p_days_old integer) SET search_path = public;
ALTER FUNCTION public.encrypt_message_content(p_text text) SET search_path = public;
ALTER FUNCTION public.ensure_conversation_integrity() SET search_path = public;
ALTER FUNCTION public.generate_audit_hash(event_type audit_event_type, actor_id uuid, target_id uuid, action_details jsonb, event_timestamp timestamp with time zone, previous_hash text) SET search_path = public;
ALTER FUNCTION public.get_bypass_statistics(p_start_date timestamp with time zone, p_end_date timestamp with time zone) SET search_path = public;
ALTER FUNCTION public.get_conversation_messages(p_conversation_id uuid, p_user_id uuid) SET search_path = public;
ALTER FUNCTION public.get_encryption_key() SET search_path = public;
ALTER FUNCTION public.get_notification_expiration_info(p_notification_type notification_type) SET search_path = public;
ALTER FUNCTION public.get_public_profile(user_uuid uuid) SET search_path = public;
ALTER FUNCTION public.get_reply_chain(p_message_id uuid, p_max_depth integer) SET search_path = public;
ALTER FUNCTION public.get_reply_counts(conversation_id_param uuid, message_ids uuid[]) SET search_path = public;
ALTER FUNCTION public.get_user_conversations(p_user_id uuid) SET search_path = public;
ALTER FUNCTION public.get_user_conversations(p_page integer, p_page_size integer, p_search_term text) SET search_path = public;
ALTER FUNCTION public.get_user_notifications(p_page integer, p_page_size integer, p_only_unread boolean) SET search_path = public;
ALTER FUNCTION public.handle_handover_completion() SET search_path = public;
ALTER FUNCTION public.handle_handover_step_completion() SET search_path = public;
ALTER FUNCTION public.handle_new_message_notification() SET search_path = public;
ALTER FUNCTION public.handle_new_user(user_id uuid) SET search_path = public;
ALTER FUNCTION public.handle_user_restrictions_updated_at() SET search_path = public;
ALTER FUNCTION public.has_active_bypass_session(p_user_id uuid) SET search_path = public;
ALTER FUNCTION public.initialize_conversation(p_title text, p_type character varying, p_participant_ids uuid[]) SET search_path = public;
ALTER FUNCTION public.log_audit_event(p_event_type audit_event_type, p_severity audit_severity, p_actor_id uuid, p_target_id uuid, p_session_id text, p_ip_address inet, p_user_agent text, p_location_data jsonb, p_action_details jsonb, p_resource_type text, p_resource_id uuid, p_reason text, p_anomaly_flags jsonb, p_compliance_tags text[]) SET search_path = public;
ALTER FUNCTION public.log_bypass_session_creation() SET search_path = public;
ALTER FUNCTION public.log_bypass_session_deactivation() SET search_path = public;
ALTER FUNCTION public.log_bypass_session_usage() SET search_path = public;
ALTER FUNCTION public.log_notification_creation() SET search_path = public;
ALTER FUNCTION public.mark_notifications_read(p_notification_ids bigint[]) SET search_path = public;
ALTER FUNCTION public.migrate_legacy_messages() SET search_path = public;
ALTER FUNCTION public.migrate_legacy_messages_to_conversations() SET search_path = public;
ALTER FUNCTION public.prevent_audit_log_modification() SET search_path = public;
ALTER FUNCTION public.remove_message_operation() SET search_path = public;
ALTER FUNCTION public.send_conversation_message(p_conversation_id uuid, p_content text, p_message_type text, p_related_car_id uuid, p_reply_to_message_id uuid, p_metadata jsonb) SET search_path = public;
ALTER FUNCTION public.sync_message_operation() SET search_path = public;
ALTER FUNCTION public.trigger_cleanup_expired_confirmations() SET search_path = public;
ALTER FUNCTION public.update_campaign_delivery_logs_updated_at() SET search_path = public;
ALTER FUNCTION public.update_last_updated_at_column() SET search_path = public;
ALTER FUNCTION public.update_message_delivery_status() SET search_path = public;
ALTER FUNCTION public.update_message_operations_updated_at() SET search_path = public;
ALTER FUNCTION public.update_notification_expiration_policy(p_notification_type notification_type, p_expiration_hours integer, p_auto_cleanup_enabled boolean) SET search_path = public;
ALTER FUNCTION public.update_notification_preferences_timestamp() SET search_path = public;
ALTER FUNCTION public.update_updated_at_column() SET search_path = public;
ALTER FUNCTION public.update_user_location(user_id uuid, lat numeric, lng numeric) SET search_path = public;
ALTER FUNCTION public.update_user_public_keys_updated_at() SET search_path = public;
ALTER FUNCTION public.update_user_verification_timestamp() SET search_path = public;
ALTER FUNCTION public.update_verification_columns() SET search_path = public;
ALTER FUNCTION public.update_verification_step(user_uuid uuid, new_step verification_step) SET search_path = public;
ALTER FUNCTION public.user_owns_verification(verification_uuid uuid) SET search_path = public;
ALTER FUNCTION public.validate_conversation_creation() SET search_path = public;
ALTER FUNCTION public.verify_audit_chain_integrity() SET search_path = public;
ALTER FUNCTION public.verify_conversation_policies() SET search_path = public;
ALTER FUNCTION public.verify_no_recursion_policies() SET search_path = public;
ALTER FUNCTION public.verify_no_recursive_policies() SET search_path = public;